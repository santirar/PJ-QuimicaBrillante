"use strict";(self.webpackChunkcircle=self.webpackChunkcircle||[]).push([[3373],{3917:(e,t,n)=>{n.d(t,{x6:()=>i,_u:()=>a,gX:()=>s});var r=n(34128),o=n(49326),i=function(e){var t=e.spaceId,n=e.payload;return(0,r.Cu)(o.av.imagePosts.create(t),n)},a=function(e){var t=e.spaceId,n=e.postSlug,i=e.payload;return(0,r.aU)(o.av.imagePosts.update(t,n),i)},s=function(e){var t=e.spaceId,n=e.postSlug,i=e.payload;return(0,r.aU)(o.av.imagePosts.duplicate(t,n),i)}},83749:(e,t,n)=>{n.d(t,{g:()=>i});var r=n(34128),o=n(49326),i=function(e){var t=e.entityId,n=e.entityType,i=void 0===n?"CommunityMember":n,a=e.mode,s=void 0===a?"view":a;return(0,r.Cu)(o.av.masquerading.masquerades.create({entityId:t,entityType:i,mode:s}),{method:"POST"})}},2571:(e,t,n)=>{n.d(t,{O:()=>i});var r=n(34128),o=n(20557),i={create:function(e){var t=e.blobSignedId;return(0,r.Cu)(o.a.mediaTranscodings.create(),{blob_signed_id:t})}}},87588:(e,t,n)=>{n.d(t,{R:()=>b});var r=n(34128),o=n(49326),i=["subject","text","area","type","is_important","zendeskUploadIds","source","chatBotSessionId","submitPageUrl","viewportHeight","viewportWidth"],a=["comment","id","zendeskUploadIds"],s=["signedId","target"],l=["postId","helpful"],c=["message","authorType","sessionId","productArea"],u=["message","sessionId"],d=["mediaUrl","mediaIsImage","sessionId"];function m(){return m=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},m.apply(this,arguments)}function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){v(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function h(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var b={listTutorialPosts:function(){return(0,r.UT)(o.av.supportWidget.listTutorialPosts())},listPosts:function(e){var t=e.spaceId,n=e.searchText;return(0,r.UT)(o.av.supportWidget.listPosts({spaceId:t,searchText:n}))},listNews:function(){return(0,r.UT)(o.av.supportWidget.listNews())},showPost:function(e){return(0,r.UT)(o.av.supportWidget.showPost({id:e}))},showPinnedPost:function(){return(0,r.UT)(o.av.supportWidget.showPinnedPost())},spaceGroups:function(){return(0,r.UT)(o.av.supportWidget.spaceGroups())},createConversation:function(e){var t=e.subject,n=e.text,a=e.area,s=e.type,l=e.is_important,c=e.zendeskUploadIds,u=e.source,d=void 0===u?null:u,m=e.chatBotSessionId,f=void 0===m?null:m,v=e.submitPageUrl,b=void 0===v?"":v,g=e.viewportHeight,y=void 0===g?"":g,_=e.viewportWidth,j=void 0===_?"":_,x=h(e,i);return(0,r.t5)(o.av.supportWidget.createConversation(),p({method:"POST",body:JSON.stringify({conversation:{subject:t,text:n,area:a,type:s,is_important:l,zendesk_upload_ids:c,submit_page_url:b},source:d,chat_bot_session_id:f,viewport_height:y,viewport_width:j})},x))},listConversations:function(){return(0,r.UT)(o.av.supportWidget.listConversations())},checkConversations:function(){return(0,r.UT)(o.av.supportWidget.checkConversations())},showConversation:function(e){var t=e.id;return(0,r.UT)(o.av.supportWidget.showConversation({id:t}))},updateConversation:function(e){var t=e.comment,n=e.id,i=e.zendeskUploadIds,s=h(e,a);return(0,r.t5)(o.av.supportWidget.updateConversation({id:n}),p({method:"PATCH",body:JSON.stringify({conversation:{comment:t,zendesk_upload_ids:i}})},s))},createAttachment:function(e){var t=e.signedId,n=e.target,i=h(e,s);return(0,r.t5)(o.av.supportWidget.createAttachment(),p({method:"POST",body:JSON.stringify({signed_id:t,target:n})},i))},checkAttachment:function(e){var t=e.zendeskUploadId,n=e.target;return(0,r.UT)(o.av.supportWidget.checkAttachment({zendeskUploadId:t,target:n}))},createPostFeedback:function(e){var t=e.postId,n=e.helpful,i=h(e,l);return(0,r.t5)(o.av.supportWidget.createPostFeedback(),p({method:"POST",body:JSON.stringify({post_id:t,helpful:n})},i))},listEvents:function(){return(0,r.UT)(o.av.supportWidget.listEvents())},createChatMessage:function(e){var t=e.message,n=e.authorType,i=e.sessionId,a=e.productArea,s=h(e,c);return(0,r.t5)(o.av.supportWidget.createChatMessage(),p({method:"POST",body:JSON.stringify({message:t,author_type:n,session_id:i,product_area:a})},s))},createLiveChatMessage:function(e){var t=e.message,n=e.sessionId,i=h(e,u);return(0,r.t5)(o.av.supportWidget.createLiveChatMessage(),p({method:"POST",body:JSON.stringify({message:t,session_id:n})},i))},uploadLiveChatAttachment:function(e){var t=e.mediaUrl,n=e.mediaIsImage,i=e.sessionId,a=h(e,d);return(0,r.t5)(o.av.supportWidget.uploadLiveChatAttachment(),p({method:"POST",body:JSON.stringify({media_url:t,media_is_image:n,session_id:i})},a))},completeOnboarding:function(e){var t=m({},e);return(0,r.t5)(o.av.supportWidget.completeOnboarding(),p({method:"PATCH"},t))},getLiveChatStatus:function(){return(0,r.UT)(o.av.supportWidget.getLiveChatStatus())}}},28607:(e,t,n)=>{n.d(t,{vk:()=>p});var r=n(64687),o=n.n(r),i=n(96486),a=n(88767),s=n(31023),l=n(34128),c=n(49326);function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){m(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function f(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}var p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.params,n=void 0===t?{}:t,r=e.isCalendarView,u=void 0!==r&&r,m=(0,s.d)(),p=m.removeRecord,v=m.findAndReplaceRecord,h=["all","events",n,{type:u?"calendar":"default"}],b=(0,a.useQueryClient)(),g=function(){var e,t=(e=o().mark((function e(t){var n,r,i=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=(i.length>1&&void 0!==i[1]?i[1]:{}).refetch,r=t,void 0!==n&&!n){e.next=6;break}return e.next=5,b.fetchQuery(c.av.posts.show({spaceId:t.space_id,postSlug:t.slug,spaceSlug:t.space_slug}));case 5:r=e.sent;case 6:return e.abrupt("return",v(r,h));case 7:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){f(i,r,o,a,s,"next",e)}function s(e){f(i,r,o,a,s,"throw",e)}a(void 0)}))});return function(e){return t.apply(this,arguments)}}(),y=(0,a.useInfiniteQuery)(h,(function(e){var t,r=e.pageParam;return t=void 0===r?1:r,(0,l.UT)(c.av.events.allEvents({params:d({page:t,per_page:u?250:20},n)}))}),{select:function(e){var t=e.pages,n=void 0===t?[]:t;return{pages:(0,i.flatten)(n.map((function(e){return e.records}))),pageParams:n.map((function(e){return e.page})),pagesList:n}},keepPreviousData:u,getNextPageParam:function(e){return e.has_next_page?Number(e.page)+1:void 0}}),_=y.data,j=(_=void 0===_?{}:_).pages,x=void 0===j?[]:j,w=_.pagesList,O=void 0===w?[]:w,S=y.isLoading,P=y.refetch,C=y.hasNextPage,k=y.fetchNextPage,I=O.map((function(e){return e.records.map((function(e){return e.id}))}));return{events:x,pagesList:O,isLoading:S,refetchAllEvents:P,hasNextPage:C,fetchNextPage:k,perPageEventIds:I,onEventChange:g,onEventDestroy:function(e){p(e,h)}}}},77329:(e,t,n)=>{n.d(t,{R:()=>d});var r=n(94184),o=n.n(r),i=n(85893),a=["children","className"];function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var d=function(e){var t=e.children,n=e.className,r=void 0===n?"":n,s=u(e,a);return(0,i.jsx)("div",l(l({},s),{},{className:o()("bg-secondary text-dark mx-6 mb-6 rounded-lg p-4 text-center text-sm",r),children:t}))}},83216:(e,t,n)=>{n.d(t,{k:()=>g});var r=n(64687),o=n.n(r),i=n(86013),a=n(96486),s=n(24185),l=n(97012),c=n(87958),u=n(55675),d=n(49326),m=n(84495),f=n(26953),p=n(59393),v=n(30887),h=n(85893);function b(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}var g=function(e){var t=e.communityMemberId,n=e.showIcon,r=void 0===n||n,g=e.onClick,y=void 0===g?a.noop:g,_=e.shouldOpenInNewTab,j=e.variant,x=void 0===j?"button":j,w=(0,s.k6)(),O=(0,l.wh)().isViewOnlyMasquerading,S=(0,m.pB)().findOrCreateChatRoom,P=(0,f.ef)(),C=function(){var e,n=(e=o().mark((function e(){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S({kind:p.g8,community_member_ids:[t]});case 2:n=e.sent,y(),_?window.open((0,d.so)({uuid:n}),"_blank"):w.push((0,d.co)({url:(0,d.so)({uuid:n})}));case 5:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){b(i,r,o,a,s,"next",e)}function s(e){b(i,r,o,a,s,"throw",e)}a(void 0)}))});return function(){return n.apply(this,arguments)}}();return(0,h.jsx)(c.T,{placement:"bottom",content:(0,i.t)("post.share.message"),interactive:!1,disabled:"icon"!==x,children:(0,h.jsxs)(u.z,{variant:"secondary",onClick:O?a.noop:C,"aria-label":(0,i.t)("post.share.message"),"data-testid":"chat-button",children:[r&&(0,h.jsx)(v.JO,{type:"16-message",size:16,useWithFillCurrentColor:!0,"aria-hidden":!0}),!P&&"icon"!==x&&(0,h.jsx)("span",{className:"ml-1",children:(0,i.t)("message")})]})})}},42286:(e,t,n)=>{n.d(t,{f:()=>v});var r=n(86013),o=n(96486),i=n(72675),a=n(75062),s=n(71032),l=n(26045),c=n(49322),u=n(85893);function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var f=function(e){var t=e.chatRoom,n=e.currentParticipant,d=e.handleSubmit,m=e.messageId,f=e.isEditMessage,p=void 0!==f&&f,v=e.isInitialPage,h=void 0!==v&&v,b=e.message,g=e.onConfirm,y=void 0===g?o.noop:g,_=e.participants,j=e.repliesCount,x=(0,i.dd)(),w=(0,a._q)().deleteRichTextMessage;return(0,u.jsxs)(s.c,{isOpen:x.visible,onClose:x.visible?x.hide:o.noop,onConfirm:function(){w({chatRoomUuid:t.uuid,messageId:m}),x.hide(),y()},confirmText:(0,r.t)("delete"),confirmVariant:"danger",title:(0,r.t)("messaging.delete_message.title"),children:[(0,u.jsx)("div",{className:"mb-6",children:(0,l.eB)(j)}),(0,u.jsx)("div",{className:"border-primary w-full rounded-md border py-5",children:(0,u.jsx)(c.t,{isModal:!0,handleSubmit:d,currentParticipant:n,message:b,isInitialPage:h,isEditMessage:p,chatRoom:t,participants:_})})]})},p=i.gk.create((function(e){return(0,u.jsx)(f,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){m(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e))})),v=function(){return(0,i.dd)(p)}},7489:(e,t,n)=>{n.d(t,{P:()=>k});var r=n(67294),o=n(94184),i=n.n(o),a=n(73328),s=n(84495),l=n(26045),c=n(20640),u=n.n(c),d=n(86013),m=n(96486),f=n(88767),p=n(24185),v=n(1320),h=n(40754),b=n(87958),g=n(97012),y=n(60060),_=n(20633),j=n(1002),x=n(21809),w=n(85893),O=function(e){var t=e.isPinned,n=void 0!==t&&t,r=e.setEditMessageId,o=e.currentParticipant,i=void 0===o?{}:o,a=e.toggleDeleteConfirmationModal,c=e.message,O=e.chatRoom,S=e.isMessageThread,P=void 0!==S&&S,C=e.canUserModifyMessage,k=void 0!==C&&C,I=e.setUnreadMessageFlow,N=void 0===I?m.noop:I,A=e.isLiveStream,E=void 0!==A&&A,T=e.isRenderedOnHeader,D=void 0!==T&&T,R=e.chatRoomUrl,L=void 0===R?"":R,M=e.setActiveMessageId,F=(0,p.TH)().pathname,U=(0,g.wh)(),B=U.currentCommunity,z=void 0===B?{}:B,H=U.currentCommunitySettings,q=(void 0===H?{}:H).unfurl_chat_messages_enabled,Z=F.includes("/messages"),V=(0,s.aK)().appendUnreadChatRoomUuids,W=c.id,Q=c.chat_room_participant_id,$=c.parent_message_id,G=i.admin,J=Q===i.id,K=(0,x.p)(),Y="direct"==O.chat_room_kind,X=(0,g.L2)().data,ee=(0,y.L)([null===X||void 0===X?void 0:X.id]).refetchSpaceNotifications,te=(0,f.useQueryClient)(),ne=J||O.lesson||E,re=(0,f.useMutation)((function(e){return v.MS.markAsUnread({uuid:O.uuid,chat_room:e})}),{onSuccess:function(){N(!0),te.invalidateQueries((0,h.S)(O.uuid)),X?ee():te.invalidateQueries(s.Nh),K.success((0,d.t)("messaging.actions.mark_as_unread_success"))},onError:function(){K.error((0,d.t)("messaging.actions.mark_as_unread_error"))}}).mutate,oe=(0,f.useMutation)((function(e){return v.MS.pinMessage({uuid:O.uuid,chat_room:e})}),{onError:function(){K.error((0,d.t)("messaging.actions.pin_error"))}}).mutate,ie=[{value:"edit-message",label:(0,d.t)("edit"),onClick:function(){return r(W)},hide:!J},{value:"pin-message",label:n?(0,d.t)("unpin"):(0,d.t)("pin"),onClick:function(){return e=W,void oe({pinned_message_id:n?null:e});var e},hide:!k||P||!G&&!Y},{value:"unread-message",label:(0,d.t)("unread"),onClick:function(){return re({message_id:W}),void(Z&&z.id&&V(z.id,O.uuid))},hide:ne},{value:"copy-link",label:(0,d.t)("messaging.actions.copy_link"),onClick:function(){var e=(0,l.Q1)({id:W,parentMessageId:$,isRenderedOnHeader:D,chatRoomUrl:L});u()(e),K.success((0,d.t)("messaging.actions.copy_link_success"))},hide:!q||E},{value:"delete-message",label:(0,d.t)("delete"),onClick:a,color:"text-v2-danger",hide:!k}];if(ie.every((function(e){return e.hide})))return null;var ae=document.getElementById("threads-scroll-view")||document.getElementById("message-thread-scroll-view")||document.getElementById("message-scroll-view")||document.body,se=(0,l.h7)(W,P);return(0,w.jsx)(j.Lt,{direction:"bottom-end",button:(0,w.jsx)(j.Lt.MenuButton,{onClick:function(){return M(se)},children:(0,w.jsx)(b.T,{content:(0,d.t)("messaging.more_actions"),children:(0,w.jsx)(_.h,{name:"16-menu-dots-horizontal",ariaLabel:(0,d.t)("messaging.more_actions")})})}),options:ie,dataTestId:"message-actions",appendTo:ae})},S=n(21909),P=n(37903),C=function(e){var t=e.message,n=void 0===t?{}:t,r=e.chatRoom,o=e.isMessageThread,i=void 0!==o&&o,a=e.chatThreadsEnabled,c=void 0!==a&&a,u=e.isParentMessage,f=void 0!==u&&u,v=e.isRenderedOnHeader,h=void 0!==v&&v,y=e.currentParticipant,j=e.onBookmarkToggle,x=n.id,O=n.embedded,C=(n.rich_text_body||{}).group_mentions,k=void 0===C?[]:C,I=(0,s.KR)().removeThreadIdUrlParam,N=(0,s.xX)(),A=N.openThreadsRailbar,E=N.setMessageHighlightId,T=N.isLiveStream,D=N.isCourseSpace,R=T||D,L=window.location.href.includes("threads"),M=(0,m.isFunction)(j)&&!R,F=(0,p.k6)(),U=(y||{}).community_member_id,B=((0,g.wh)().currentCommunitySettings||{}).chat_reactions_enabled,z=k.length>0,H=(0,m.throttle)((function(){E(x),(0,l.o7)(x,(function(){(0,m.delay)((function(){return E(null)}),5e3)}))}),5e3,{leading:!0,trailing:!1});return(0,w.jsxs)(w.Fragment,{children:[B&&U&&(0,w.jsx)(S.D,{reactions:n.reactions,currentCommunityMemberId:U,reactionableId:n.id,reactionableType:"chat_room_message"}),M&&(0,w.jsx)(P.e,{bookmarkType:"message",record:n,onSuccess:function(){return j(n.id)}}),c&&!i&&!z&&(0,w.jsx)(b.T,{content:(0,d.t)("messaging.reply_in_threads"),dataTestId:"reply-thread",interactive:!1,children:(0,w.jsx)(_.h,{name:"16-open-threads",ariaLabel:(0,d.t)("messaging.reply_in_threads"),onClick:function(){I(),A(n,r)},iconSize:16})}),f&&i&&!h&&!R&&(0,w.jsx)(b.T,{content:(0,d.t)(O?"messaging.open_in_space":"messaging.open_in_messages"),interactive:!1,children:(0,w.jsx)(_.h,{name:"16-open-in-space",ariaLabel:(0,d.t)(O?"messaging.open_in_space":"messaging.open_in_messages"),onClick:function(){L||h?F.push((0,l.ZZ)(r,n)):H()},iconSize:16})})]})},k=function(e){var t=e.isPinned,n=void 0!==t&&t,o=e.setEditMessageId,c=e.currentParticipant,u=void 0===c?{}:c,d=e.toggleDeleteConfirmationModal,m=e.message,f=e.chatRoom,p=e.isMessageThread,v=void 0!==p&&p,h=e.canUserModifyMessage,b=void 0!==h&&h,g=e.chatThreadsEnabled,y=void 0!==g&&g,_=e.isParentMessage,j=void 0!==_&&_,x=e.isPinnedMessageAtTop,S=void 0!==x&&x,P=e.isRenderedOnHeader,k=void 0!==P&&P,I=e.onBookmarkToggle,N=e.setUnreadMessageFlow,A=e.isLiveStream,E=void 0!==A&&A,T=e.chatRoomUrl,D=(0,r.useRef)(null),R=(0,s.f4)(),L=R.activeMessageId,M=R.setActiveMessageId,F="message-actions-".concat(m.id);(0,a.Z)(D,(function(){M(null)}));var U=(0,l.XE)({activeMessageId:L,id:m.id,isMessageThread:v});return(0,w.jsx)("div",{className:"absolute right-0 top-0 mb-3",children:(0,w.jsx)("div",{id:F,className:i()("border-primary bg-primary -mt-2 mr-4 flex rounded-md border",{"!mt-2":S,invisible:!L||!U,"group-hover/action:visible":!L||U}),children:(0,w.jsxs)("div",{className:"flex min-h-[34px] items-center justify-around space-x-1 px-1",children:[(0,w.jsx)(C,{message:m,isMessageThread:v,chatThreadsEnabled:y,chatRoom:f,isParentMessage:j,isRenderedOnHeader:k,currentParticipant:u,onBookmarkToggle:I}),u&&(0,w.jsx)("div",{ref:D,children:(0,w.jsx)(O,{isPinned:n,setEditMessageId:o,currentParticipant:u,toggleDeleteConfirmationModal:d,message:m,chatRoom:f,isMessageThread:v,canUserModifyMessage:b,setUnreadMessageFlow:N,isLiveStream:E,isRenderedOnHeader:k,chatRoomUrl:T,setActiveMessageId:M})})]})})})}},49322:(e,t,n)=>{n.d(t,{t:()=>q});var r=n(94184),o=n.n(r),i=n(86013),a=n(96486),s=n(63001),l=n(67294),c=n(97012),u=n(87958),d=n(87868),m=n(42885),f=n(85893);function p(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return v(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return v(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var h=function(e){var t=e.reaction,n=e.currentCommunityMemberId,r=e.reactionableId,s=e.reactionableType,v=(0,c.wh)().isViewOnlyMasquerading,h=t.emoji,b=t.count,g=t.community_member_ids,y=d.V[h],_=p((0,l.useState)([]),2),j=_[0],x=_[1],w=g.includes(n),O=function(e,t,n,r){var o=e.findIndex((function(e){return e.id===n}));-1!==o&&(e.splice(o,1),e.unshift({id:n,full_name:(0,i.t)("reactions.you")}));var a=e.map((function(e){return e.full_name}));return r>5?a.join(", ")+" ".concat((0,i.t)("reactions.and")," ").concat(r-5," ").concat((0,i.t)("reactions.more_reacted_with")," :").concat(t,":"):a.join(", ").replace(/,([^,]*)$/," ".concat((0,i.t)("reactions.and"),"$1"))+" ".concat((0,i.t)("reactions.reacted_with")," :").concat(t,":")}(j,h,n,b),S=(0,m.z)({currentCommunityMemberId:n,emoji:h,reactionableId:r,reactionableType:s,setCommunityMembers:x,communityMemberIds:g}),P=S.addReaction,C=S.removeReaction,k=S.fetchCommunityMembers,I=S.isLoading;if(!y)return null;var N=(0,f.jsxs)("button",{type:"button",className:o()("text-default border-primary relative flex cursor-pointer gap-1 rounded-full border px-2 py-0.5 text-xs font-semibold",{"!border-circle text-brand hover:border-brand bg-circle/5":w,"hover:border-gray-400":n&&!w}),onClick:v?a.noop:function(){if(n&&!I){var e,t,o,i=(o=r,(t=s)in(e={emoji:h})?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e);w?C(i):P(i)}},onMouseEnter:function(){return k()},"data-testid":"reaction-content",children:[(0,f.jsx)("div",{children:y}),(0,f.jsx)("div",{children:b})]});return j.length>0?(0,f.jsx)(u.T,{placement:"top",content:O,interactive:!1,children:N}):(0,f.jsx)("div",{children:N})},b=n(21909),g=function(e){var t=e.reactions,n=void 0===t?[]:t,r=e.currentCommunityMemberId,o=e.reactionableId,i=e.reactionableType;return 0===n.length?null:(0,f.jsxs)("div",{className:"my-2 flex flex-wrap gap-1",children:[n.map((function(e){return(0,f.jsx)(h,{reaction:e,currentCommunityMemberId:r,reactionableId:o,reactionableType:i},e.emoji)})),r&&(0,f.jsx)(b.D,{reactions:n,currentCommunityMemberId:r,reactionableId:o,reactionableType:i,showBorder:!0})]})},y=n(30887),_=n(38870),j=n(25807),x=n(26045),w=n(53731),O="text-sm font-normal mb-1 whitespace-pre-line chat-message-word-wrap text-dark",S=function(e,t,n){return(0,f.jsx)("a",{href:e,target:"_blank",rel:"noopener noreferrer",children:t},n)},P=function(e){var t=e.body,n=e.isPinnedMessageAtTop,r=void 0!==n&&n;return(0,f.jsx)("div",{className:o()(O,{"pinned-message-body":r}),"data-testid":"message-text",children:(0,f.jsx)(w.Z,{componentDecorator:S,children:t})})},C=n(34974),k=n(16743),I=n(54754),N=function(e){var t=e.editedAt,n=e.isInitialPage,r=void 0!==n&&n,a=e.isPinnedMessageAtTop,s=void 0!==a&&a,l=e.rich_text_body,c=e.chatRoomAccessArr;return l?(0,f.jsx)(C.S,{renderFunc:function(){return(0,f.jsx)(k.Z.LabelSm,{color:"text-v2-danger",children:(0,i.t)("messaging.message_error")})},children:(0,f.jsx)("div",{className:o()(O,{"pinned-message-body":s}),"data-testid":"message-text",children:(0,f.jsx)(I.T,{editable:!1,rich_text_body:l,shouldScrollIntoView:r,shouldRefetch:!0,isUpdate:s,editedAt:t,chatRoomAccessArr:c})})}):null},A=function(e){var t=e.message,n=e.isInitialPage,r=void 0!==n&&n,o=e.isPinnedMessageAtTop,i=void 0!==o&&o;return t.rich_text_body?(0,f.jsx)(N,{rich_text_body:t.rich_text_body,isInitialPage:r,isPinnedMessageAtTop:i,editedAt:t.edited_at,chatRoomAccessArr:t.embedded_chat_message_access}):(0,f.jsx)(P,{body:t.body,isPinnedMessageAtTop:i})},E=n(20640),T=n.n(E),D=n(40160),R=n(49326),L=n(87811),M=n(25401),F=n(21809),U=function(e){var t=e.message,n=e.chatRoom,r=e.isParentMessage,a=void 0!==r&&r,s=e.isMessageThread,l=void 0!==s&&s,c=e.isRenderedOnHeader,u=void 0!==c&&c,d=window.location.href.includes("threads"),m=t.id,p=t.sent_at,v=t.parent_message_id,h=(0,L.H)(p),b=h.day,g=h.time,y=(0,M.TF)(p),_=(0,F.p)(),j=function(){return l?a?"".concat(b," at ").concat(g):y:g};return d||u?(0,f.jsx)(D.rU,{to:(0,R.co)({url:(0,x._z)(n,t),hash:a?(0,x.uo)(t):(0,x.d6)(t),search:a?"":"message_id=".concat(t.id)}),className:o()({"inline-flex flex-row items-center":u}),children:(0,f.jsx)("span",{className:"text-light inline cursor-pointer text-xs hover:underline",children:m?j():(0,i.t)("messaging.sending")})}):(0,f.jsx)("button",{type:"button",className:o()("text-light inline text-xs",{"hover:underline":m}),onClick:function(){var e=(0,x.Q1)({id:m,parentMessageId:v,isRenderedOnHeader:u});T()(e),_.success((0,i.t)("messaging.actions.copy_link_success"))},children:m?j():(0,i.t)("messaging.sending")})},B=n(24185),z=function(e){var t=e.chatRoom,n=e.isRenderedOnHeader,r=void 0!==n&&n,o=e.message,a=e.onDelete,s=e.onSubmit,l=(0,B.TH)().pathname,c=o.rich_text_body||{body:o.body},u=(0,x.$S)(t),d=(0,x.C9)(t),m=l.includes("/messages"),p=(0,x.jr)(m,r);return(0,f.jsxs)("div",{className:"chat-message-word-wrap text-dark mb-1 whitespace-pre-line text-sm font-normal","data-testid":"message-text",children:[(0,f.jsx)(I.T,{autofocus:!0,editable:!0,rich_text_body:c,onSubmit:s,onDelete:a,isUpdate:!0,chatProps:{isThread:!!o.parent_message_id,isDirectMessaging:u,isChatAdminOrModerator:d},portalTargetId:p}),(0,f.jsxs)("div",{className:"-mt-5 text-xs",children:[(0,i.t)("messaging.esc_to")," ",(0,f.jsx)("span",{className:"font-semibold",children:(0,i.t)("cancel")})," ",(0,i.t)("messaging.bullet")," ",(0,i.t)("messaging.enter_to")," ",(0,f.jsx)("span",{className:"font-semibold",children:(0,i.t)("save")})]})]})},H=function(e){var t=e.role;return(0,f.jsx)(u.T,{placement:"top",content:(0,i.t)("live_roles.".concat(t)),children:(0,f.jsx)(y.JO,{type:t,size:16,className:"-ml-1 -mt-1"})})},q=function(e){var t=e.chatRoom,n=e.currentParticipant,r=void 0===n?{}:n,l=e.handleSubmit,u=e.isEditMessage,d=void 0!==u&&u,m=e.isInitialPage,p=void 0!==m&&m,v=e.isMessageThread,h=void 0!==v&&v,b=e.isModal,w=void 0!==b&&b,O=e.isParentMessage,S=void 0!==O&&O,P=e.isPinned,C=void 0!==P&&P,k=e.isPinnedMessageAtTop,I=void 0!==k&&k,N=e.isRenderedOnHeader,E=void 0!==N&&N,T=e.message,D=e.messageBodyClassName,R=e.participants,L=void 0===R?[]:R,M=e.roles,F=void 0===M?{}:M,B=e.toggleDeleteConfirmationModal,q=void 0===B?a.noop:B,Z=(0,s.r)(),V=T.chat_room_participant_id,W=L.find((function(e){return e.id===V})),Q=(0,x.cY)(null===W||void 0===W?void 0:W.community_member_id,F),$=(0,a.isEmpty)(W),G=null===W||void 0===W?void 0:W.user_public_uid,J=((0,c.wh)().currentCommunitySettings||{}).chat_reactions_enabled,K=(r||{}).community_member_id,Y=function(){G&&Z.show({memberPublicId:W.user_public_uid})};return(0,f.jsxs)("div",{className:o()({"ml-1 mt-2 flex w-[98%] justify-start py-1.5 pl-5":!E,"flex w-full justify-start px-5 py-1.5":E}),children:[(0,f.jsx)("button",{type:"button",className:o()("mr-3 self-start",{"cursor-default":!G}),"aria-label":(0,i.t)("messaging.open_member_profile_button_aria_label",{name:null===W||void 0===W?void 0:W.name}),onClick:Y,children:$?(0,f.jsx)(j.qE,{}):(0,f.jsx)(_.s,{src:W.avatar_url,name:W.name,size:"10"})}),(0,f.jsxs)("div",{className:o()("w-full overflow-x-auto",D),children:[(0,f.jsxs)("div",{className:"mb-px flex items-center gap-2",children:[(0,f.jsx)("button",{type:"button",className:o()("text-darkest text-left text-sm font-semibold",{"cursor-default":!G}),onClick:Y,"data-testid":"number-of-replies",children:$?(0,f.jsx)(j.X2,{md:!0}):(0,f.jsxs)(f.Fragment,{children:[W.id===(null===r||void 0===r?void 0:r.id)?(0,i.t)("messaging.you"):W.name," ",(0,f.jsx)("span",{className:"font-normal",children:W.deleted_at?(0,i.t)("messaging.removed_or_left"):""})]})}),Q&&(0,y.Er)(Q)&&(0,f.jsx)(H,{role:Q}),C&&(0,f.jsx)(y.JO,{type:"pin","aria-label":(0,i.t)("messaging.pinned_message"),"aria-hidden":!1}),(0,f.jsx)(U,{chatRoom:t,message:T,isParentMessage:S,isMessageThread:h,isRenderedOnHeader:E})]}),!w&&d?(0,f.jsx)(z,{message:T,onSubmit:l,onDelete:q,chatRoom:t,isRenderedOnHeader:E}):(0,f.jsx)(A,{message:T,isInitialPage:p,isPinnedMessageAtTop:I}),J&&(0,f.jsx)(g,{reactions:T.reactions,currentCommunityMemberId:K,reactionableId:T.id,reactionableType:"chat_room_message"})]})]})}},51297:(e,t,n)=>{n.d(t,{R:()=>j});var r=n(67294),o=n(94184),i=n.n(o),a=n(95172),s=n(24185),l=n(84495),c=n(75062),u=n(37803),d=n(86013),m=n(85893),f=function(){return(0,m.jsx)("div",{id:"unread-thread-message-breakpoint",className:"relative flex items-center justify-center z-0 mx-5 before:w-full before:m-0 before:border-t before:border-solid before:border-v2-danger before:z-[-1] before:content-['']",children:(0,m.jsx)("span",{className:"text-v2-danger border-none py-[5px] pl-[10px] text-xs font-semibold uppercase",children:(0,d.t)("messaging.new")})})},p=n(26045),v=n(42286),h=n(7489),b=n(49322),g=n(63178);function y(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return _(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var j=function(e){var t=e.chatRoom,n=e.chatThreadsEnabled,o=void 0!==n&&n,d=e.currentParticipant,_=e.isInitialPage,j=void 0!==_&&_,x=e.isParentMessage,w=void 0!==x&&x,O=e.isRenderedOnHeader,S=void 0!==O&&O,P=e.isUnreadMessageLineEnabled,C=void 0!==P&&P,k=e.lastReadMessageId,I=e.message,N=e.onBookmarkToggle,A=e.participants,E=e.roles,T=void 0===E?{}:E,D=e.setUnreadMessageFlow,R=e.chatRoomUrl,L=e.isLiveStream,M=void 0!==L&&L,F=(0,c._q)().updateRichTextMessage,U=(0,u.x)().messageHighlightId,B="/threads"===(0,s.TH)().pathname,z=(0,l.f4)().activeMessageId,H=y((0,r.useState)(null),2),q=H[0],Z=H[1],V=I.id,W=I.replies_count,Q=!!V&&q===V,$=(0,g.O5)({message:I,chatRoom:t}).canUserModifyMessage,G=!!d,J=function(){return Z(null)};(0,a.y1)("esc",J,{enabled:Q,enableOnContentEditable:!0},[Q]);var K=function(e){var n=e.body,r=e.attachments,o=void 0===r?[]:r;F({chatRoomUuid:t.uuid,messageId:V,rich_text_body:{body:n,attachments:o}}),J()},Y=(0,v.f)(),X=function(){Y.visible?Y.hide():Y.show({chatRoom:t,currentParticipant:d,handleSubmit:K,isEditMessage:Q,isInitialPage:j,message:I,messageId:V,participants:A,repliesCount:W})},ee=C&&k===I.id,te=(0,p.XE)({activeMessageId:z,id:V,isMessageThread:!0});return(0,m.jsxs)("div",{children:[(0,m.jsxs)("div",{id:"thread-".concat(V),className:i()("group/action bg-primary relative flex w-full flex-col",{relative:!w||B,"hover:bg-secondary":!z&&G,"!bg-secondary":Q||te,"message-highlight":(0,p.DH)({id:V,messageHighlightId:U,isParentMessage:w})}),"data-testid":"message-item",children:[(0,m.jsx)(b.t,{isModal:!1,handleSubmit:K,currentParticipant:d,message:I,isInitialPage:j,isEditMessage:Q,toggleDeleteConfirmationModal:X,isPinned:!1,roles:T,isParentMessage:w,chatRoom:t,participants:A,isMessageThread:!0,isRenderedOnHeader:S,messageBodyClassName:"mr-4"}),G&&(0,m.jsx)(h.P,{isPinned:!1,setEditMessageId:Z,chatRoom:t,toggleDeleteConfirmationModal:X,message:I,currentParticipant:d,canUserModifyMessage:$,chatThreadsEnabled:o,isParentMessage:w,isRenderedOnHeader:S,isMessageThread:!0,onBookmarkToggle:N,setUnreadMessageFlow:D,chatRoomUrl:R,isLiveStream:M})]}),ee&&(0,m.jsx)(f,{})]})};j.displayName="MessageItem"},63178:(e,t,n)=>{n.d(t,{O5:()=>i,Sh:()=>v,O1:()=>b});var r=n(96486),o=n(59393),i=function(e){var t=e.message,n=e.chatRoom,i=t.id,a=t.chat_room_participant_id,s=n.current_participant,l=void 0===s?{}:s,c=n.chat_room_kind===o.g8,u=a===(null===l||void 0===l?void 0:l.id),d=!(0,r.isNull)(i),m=null===l||void 0===l?void 0:l.admin;c&&(m=!1);var f=Boolean(d&&u),p=Boolean(d&&(u||m));return{canUserDeleteMessage:p,canUserEditMessage:f,canUserModifyMessage:f||p}},a=n(67294),s=n(95172),l=n(97012),c=n(87811),u=n(84495),d=n(26045),m=n(42286);function f(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return p(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return p(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var v=function(e){var t=e.chatRoom,n=e.chatThreadsEnabled,o=void 0!==n&&n,p=e.currentParticipant,v=e.isInitialPage,h=void 0!==v&&v,b=e.isLastMessage,g=void 0!==b&&b,y=e.message,_=e.participants,j=e.prevDayRef,x=(0,l.wh)().isViewOnlyMasquerading,w=(0,u._q)().updateRichTextMessage,O=(0,u.ub)(),S=O.setScrollInfo,P=O.calculateScrollInfo,C=f((0,a.useState)(null),2),k=C[0],I=C[1],N=y.id,A=y.sent_at,E=y.replies_count,T=(0,c.H)(A).day,D=!(0,r.isFunction)(j)&&(null===j||void 0===j?void 0:j.current)!==T;j&&!(0,r.isFunction)(j)&&(j.current=T);var R=!(x||!N)&&k===N,L=(0,m.f)(),M=i({message:y,chatRoom:t}).canUserModifyMessage,F=!R&&(M||o),U=function(){return I(null)};(0,a.useEffect)((function(){R&&g&&(0,d.o7)(N)}),[R]),(0,s.y1)("esc",U,{enabled:R,enableOnContentEditable:!0},[R]);var B=function(e){S(P({event:e}))},z=function(e){var n=e.body,r=e.attachments,o=void 0===r?[]:r;w({chatRoomUuid:t.uuid,messageId:N,rich_text_body:{body:n,attachments:o}}),B("messageUpdated"),U()};return{canUserModifyMessage:M,day:T,handleSubmit:z,id:N,isDayChange:D,isEditMessage:R,isViewOnlyMasquerading:x,setEditMessageId:I,shouldShowMessageActions:F,shouldShowRepliesBlock:o&&E>0,toggleDeleteConfirmationModal:function(){L.visible?L.hide():L.show({chatRoom:t,currentParticipant:p,handleSubmit:z,isEditMessage:R,isInitialPage:h,message:y,messageId:N,participants:_,onConfirm:function(){B("messageDeleted")},repliesCount:E})}}},h=n(24185),b=function(){var e=(0,h.k6)(),t=function(t){var n=t.id;e.push({hash:"message_".concat(n)})};return{redirectToMessage:t,handlePinnedMessage:function(e){document.getElementById(e.id)?(0,d.o7)(e.id):t(e)}}}},4209:(e,t,n)=>{n.d(t,{Q1:()=>r,XE:()=>o,h7:()=>i});var r=function(e){var t=e.id,n=e.parentMessageId,r=e.isRenderedOnHeader,o=e.chatRoomUrl;return window.location.protocol+"//"+window.location.host+(r?o:window.location.pathname)+(n?"?message_id=".concat(t,"#message_").concat(n):"#message_".concat(t))},o=function(e){var t=e.activeMessageId,n=e.id,r=e.isMessageThread;return t===i(n,void 0!==r&&r)},i=function(e,t){return"".concat(t?"thread-":"message-").concat(String(e))}},26045:(e,t,n)=>{n.d(t,{UT:()=>h,cj:()=>A,XE:()=>E.XE,nR:()=>C,h7:()=>E.h7,uo:()=>O,ZZ:()=>P,_z:()=>w,d6:()=>S,Q1:()=>E.Q1,eB:()=>x,YQ:()=>b,jo:()=>m,jr:()=>N,cY:()=>p,C9:()=>I,$S:()=>k,o7:()=>f,uR:()=>_,DH:()=>j,Pd:()=>g,PM:()=>y});var r=n(86013),o=n(96486),i=n(59393),a=n(49326),s=n(49164);function l(e){return function(e){if(Array.isArray(e))return d(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||u(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||u(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,t){if(e){if("string"===typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(e,t):void 0}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}s.Mz,s.Q_;var m=function(e){var t="";return e.forEach((function(n,r){t=r==e.length-1?t+n.name+".":r==e.length-2?t+n.name+" and ":t+n.name+", "})),t},f=function(e,t){var n=document.getElementById(e),r=setTimeout((function(){null===n||void 0===n||n.scrollIntoView({behavior:"smooth"}),null===t||void 0===t||t()}),100);return function(){return clearTimeout(r)}},p=function(e,t){for(var n=0,r=Object.entries(t);n<r.length;n++){var o=c(r[n],2),i=o[0];if(o[1].includes(e))return i}},v=function(e,t){return e.sender.id===t.id},h=function(e){var t=e.calculateScrollInfo,n=e.chatRoomMessages,r=e.currentParticipant,i=e.isInitialPageLoaded,a=void 0===i||i,s=e.lastMessage,c=e.setChatRoomMessages,u=e.setFirstMessageId,d=e.setMessagesHasPrevPage,m=e.setScrollInfo;if(null!=s&&a){var f=l(n);f.length>80&&(c(f=f.slice(-60)),u(f[0].id),d(!0));var p=(0,o.last)(f);if((null===p||void 0===p?void 0:p.id)!=s.id&&!function(e,t){return e&&!!e.id&&(null===e||void 0===e?void 0:e.creation_uuid)===(null===t||void 0===t?void 0:t.creation_uuid)}(p,s)){m(t({event:v(s,r)?"messageSent":"messageReceived"}));var h=l(f);return!function(){var e=arguments.length>1?arguments[1]:void 0;return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).some((function(t){return t.creation_uuid===e.creation_uuid&&(!e.id||!t.id)}))}(h,s)?h.push(s):h=h.map((function(e){return e.creation_uuid===s.creation_uuid&&!function(e){return!!e.id}(e)?s:e})),h}}},b=function(){return(window.location.hash||"").split("#message_")[1]},g=function(e,t){return e&&t},y=function(e){var t=e.id,n=e.isPinned,r=e.disableUnreadMessageLine,i=e.unreadMessageId;return!(0,o.isNull)(t)&&!n&&!r&&i===t},_=function(e){var t=e.id,n=e.messageHashId,r=e.messageHighlightId;return n&&t==n||r&&t==r},j=function(e){var t=e.id,n=e.messageHighlightId;return!e.isParentMessage&&n&&t==n},x=function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)>0?"".concat((0,r.t)("messaging.delete_message.description")," ").concat((0,r.t)("messaging.delete_message.threads")):(0,r.t)("messaging.delete_message.description")},w=function(e,t){if((0,o.isEmpty)(e))return"";var n=e.embedded_space,r=e.uuid,i=(n||{}).slug;return t.embedded?(0,a.kr)({spaceSlug:i}):(0,a.so)({uuid:r})},O=function(e){return"message_".concat(e.id)},S=function(e){return"message_".concat(e.parent_message_id)},P=function(e,t){var n=w(e,t);return"".concat(n,"#message_").concat(t.id)},C=function(e,t){var n=[];return e.map((function(e){var r=e.chat_room_participant_id;t.find((function(e){return(null===e||void 0===e?void 0:e.id)===r}))||n.includes(r)||n.push(r)})),n},k=function(e){return Boolean((null===e||void 0===e?void 0:e.chat_room_kind)===i.g8)},I=function(e){var t=(e||{}).current_participant,n=void 0===t?{}:t;return Boolean((null===n||void 0===n?void 0:n.admin)||(null===n||void 0===n?void 0:n.moderator))},N=function(e,t){var n=null;return e?n="fullscreen-modal-body":t&&(n="chat-threads-header"),n},A=function(e){var t,n,r=e.searchInputClientHeight,o=void 0===r?0:r,i=e.footerClientHeight,a=void 0===i?0:i,l=e.isSmOrMdScreen,c=void 0!==l&&l,u=e.isLiveStream,d=void 0!==u&&u,m=e.isInCourseSpace,f=void 0!==m&&m,p=e.isMessagingModalOpen,v=void 0!==p&&p,h=a;return o&&(h+=o),t=document.getElementById("mobile-bottom-toolbar"),Boolean(t)&&(h+=s.Q_),!f&&(n=document.getElementById("bookmarks-bar"),Boolean(n))&&(h+=40),c?h+=d||f?s.Mz:64+s.Mz:d?h=64:f&&(h=document.getElementById("lesson-hello-bar")?112:s.Mz),v&&(h=function(e){return e<20?100:e}(h)),h},E=n(4209)},80621:(e,t,n)=>{n.d(t,{I:()=>T});var r=n(86013),o=n(96486),i=n(24185),a=n(84495),s=n(1320),l=n(67621),c=n(89203),u=n(37803),d=n(30990),m=n(49164),f=n(67294),p=n(24897),v=n(97012),h=n(25067),b=n(77329),g=n(51297),y=n(26045),_=n(77853),j=n(20447),x=n(4181),w=n(85893),O=function(e){var t=e.children,n=e.isLastPage,r=e.isFirstPage,o=e.setIsFirstPage,i=e.setIsLastPage,a=e.chatRoomUuid,s=e.parentMessage,l=(0,j.T)(),c=l.messagesHasPrevPage,u=l.messagesHasNextPage,d=l.fetchChatMessages,m=l.isLoading,f=l.firstMessageId,p=l.lastMessageId;return(0,w.jsx)(x.Y,{shouldShowPrevLoader:!n,shouldShowNextLoader:!r,hasNextPage:u,hasPrevPage:c,onNextPage:function(e){d({chatRoomUuid:a,id:e,previousPerPage:0,nextPerPage:20,parentMessage:s}),o(!1)},onPrevPage:function(e){d({chatRoomUuid:a,id:e,parentMessage:s}),i(!1)},firstItemId:f,lastItemId:p,componentId:"message-thread-scroll-view",isLoading:m,children:t})},S=function(e){var t=e.count;return(0,w.jsx)("div",{id:"replies-message-line",className:"before:border-primary relative z-0 mx-5 flex items-center justify-start before:absolute before:bottom-0 before:left-0 before:top-1/2 before:z-[-1] before:m-0 before:w-full before:border-t before:border-solid before:content-['']",children:(0,w.jsx)("span",{className:"bg-primary w-[68px] border-none py-0.5 pr-[10px] text-xs text-gray-400",children:1===t?(0,r.t)("threads.one_reply"):(0,r.t)("threads.many_replies",{count:t})})})};function P(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return C(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return C(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function C(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var k=function(e){var t=e.parentMessage,n=e.chatRoom,i=P((0,f.useState)(!0),2),s=i[0],l=i[1],c=P((0,f.useState)(!0),2),u=c[0],d=c[1],m=P((0,f.useState)(0),2),j=m[0],x=m[1],C=P((0,f.useState)(!1),2),k=C[0],I=C[1],N=(0,a.KR)().removeThreadIdUrlParam,A=(0,a.uk)(n.uuid).chatParticipants,E=(0,v.L2)().data,T=(0,a.Tl)(),D=T.fetchChatMessages,R=T.chatMessages,L=T.onEventReceive,M=T.isInitialPageLoaded,F=T.totalMessagesCount,U=T.adjustScroller,B=T.messagesHasPrevPage,z=T.messagesHasNextPage,H=T.metaData,q=T.isLoading,Z=T.handleReactionFromWebsocket,V=T.onBookmarkToggle,W=(0,a.xX)(),Q=W.messageHighlightId,$=W.isLiveStream,G=(0,y.YQ)(),J=Number(G)!==Q,K=n.current_participant,Y=(0,a.Lx)(n),X=Y.canSendMessage,ee=Y.canParticipantsMessage;(0,f.useEffect)((function(){var e={chatRoomUuid:n.uuid,isInitialPage:!0,parentMessage:t};return Q&&J&&(e.id=Q,e.nextPerPage=20),D(e),function(){return x(0)}}),[t,null===n||void 0===n?void 0:n.uuid]),(0,p.s)({channel:"Chats::RoomChannel",chat_room_uuid:null===n||void 0===n?void 0:n.uuid,onMessageReceive:function(e){var n=e.event,r=e.json_message;if("newMessage"===n){if(null===r||void 0===r||!r.parent_message_id||r.parent_message_id!==t.id)return;x((function(e){return e+1}))}else"deletedMessage"===n&&x((function(e){return e-1}));L(e,R,K)},canCreateConnection:Boolean(null===n||void 0===n?void 0:n.uuid)},[null===n||void 0===n?void 0:n.uuid]),(0,f.useEffect)((function(){M&&Q&&J&&(0,y.o7)(Q)}),[M,Q]),(0,f.useEffect)((function(){!M||Q&&J||(0,o.defer)(U)}),[R,M,Q]);var te=(0,o.uniqBy)(R,"id"),ne=(0,o.sortBy)(te,"sent_at"),re=(H||{}).last_read_message_id,oe=(0,o.last)(ne),ie=(0,f.useMemo)((function(){return(0,y.nR)(te,A)}),[te,A]);(0,a.gJ)({uuid:n.uuid,ids:ie,enabled:Boolean(A.length&&ie.length)}),(0,f.useEffect)((function(){if(!q&&M){var e=!(0,o.isNull)(re),t=re!==(null===oe||void 0===oe?void 0:oe.id);I(e&&t)}}),[re,M,t.id,q]),(0,p.s)({channel:"ChatRoomChannel",onMessageReceive:function(e){"createReaction"!==e.event&&"destroyReaction"!==e.event||Z(e)},community_member_id:null===K||void 0===K?void 0:K.community_member_id,canCreateConnection:Boolean(null===K||void 0===K?void 0:K.community_member_id)},[null===K||void 0===K?void 0:K.community_member_id]);var ae=F+j;return M?(0,w.jsx)("div",{id:"scrollWrapper",className:"flex h-full grow flex-col border-r-0",children:(0,w.jsxs)(O,{isLastPage:s,isFirstPage:u,setIsLastPage:l,setIsFirstPage:d,chatRoomUuid:n.uuid,parentMessage:t,children:[!B&&(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(g.R,{message:t,currentParticipant:K,chatRoom:n,participants:A,isLiveStream:$,isParentMessage:!0,chatThreadsEnabled:!0}),ae>0&&(0,w.jsx)(S,{count:ae})]}),ne.map((function(e){return(0,w.jsx)(g.R,{message:e,displayDayChange:!1,currentParticipant:K,chatRoom:n,chatThreadsEnabled:!0,isUnreadMessageLineEnabled:k,lastReadMessageId:re,participants:A,isLiveStream:$,onBookmarkToggle:V},e.id)})),!z&&(X?(0,w.jsx)(_.Fx,{chatRoom:n,parentMessageId:t.id,onClick:N,spaceId:null===E||void 0===E?void 0:E.id,portalTargetId:"rail-content"}):(0,w.jsx)(b.R,{className:"mt-2",children:ee?(0,r.t)("community_member.join_space_to_message"):(0,r.t)("community_member.messaging_disabled")}))]})}):(0,w.jsx)("div",{id:"message-thread-scroll-view",children:(0,w.jsx)(h.gi,{variant:"chat-thread"})})},I=n(26953),N=n(20633),A=n(16743),E=function(e){var t=e.title,n=e.onClose,o=(0,I.kK)(),i=(0,a.xX)(),s=i.isCourseSpace,l=i.isLiveStream;return o?(0,w.jsxs)("div",{className:"flex w-full items-center justify-between",children:[(0,w.jsx)(N.h,{name:"16-arrow-left",onClick:n,iconClassName:"!text-dark",className:"flex-none",ariaLabel:(0,r.t)("close")}),(0,w.jsx)("div",{className:"flex-auto text-center",children:(0,w.jsx)(A.Z.TitleSm,{as:"h2",weight:"semibold",children:t})})]}):l||s?(0,w.jsxs)("div",{className:"flex w-full items-center justify-start",children:[(0,w.jsx)(N.h,{name:"20-back",onClick:n,iconSize:20,buttonSize:20,iconClassName:"!text-dark !h-5 !w-5",className:"mr-3 h-8 w-8 flex-none",ariaLabel:(0,r.t)("back")}),(0,w.jsx)(A.Z.TitleSm,{as:"h2",weight:"semibold",children:t})]}):(0,w.jsxs)("div",{className:"flex w-full items-center justify-between",children:[(0,w.jsx)(A.Z.TitleSm,{as:"h2",weight:"semibold",children:t}),(0,w.jsx)(N.h,{name:"20-close",iconSize:20,onClick:n,iconClassName:"!text-dark",ariaLabel:(0,r.t)("close")})]})},T=function(){var e=(0,d.T)(),t=e.ref,n=e.height,f=(0,i.k6)(),p=(0,u.x)(),v=p.closeThreadsRailbar,h=p.parentMessage,b=p.chatRoom,g=void 0===b?{}:b,y=p.messageHighlightId,_=p.setMessageHighlightId,j=p.shouldShowRailBar,x=p.isCourseSpace,O=(0,a.rZ)(),S=O.unreadChatThreadIds,P=O.isUnreadThreadFlow;return!j||(0,o.isEmpty)(g)?null:(0,w.jsxs)(l.x,{position:x?"portal":"header",noBorderLeft:x,children:[(0,w.jsx)("div",{ref:t,children:(0,w.jsx)(m.S0.Header,{children:(0,w.jsx)(E,{title:(0,r.t)("messaging.thread"),onClose:function(){y&&(f.push({search:(0,c.iO)("message_id")}),_(null)),h.chat_thread_id&&S.includes(h.chat_thread_id)&&!P&&(0,s.ex)(h.chat_thread_id),v()}})})}),(0,w.jsx)(m.S0.Content,{heightGap:n,isCourseSpace:x,noPadding:!0,children:(0,w.jsx)(a.k0,{children:(0,w.jsx)(k,{parentMessage:h,chatRoom:g})})})]})}},98075:(e,t,n)=>{n.d(t,{F2:()=>o,bb:()=>i});var r=n(59393),o=function(){var e=[],t=[];return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).forEach((function(n){n.admin?e.push(n):t.push(n)})),[].concat(e,t)},i=function(e){var t=[],n=[],o=[];return e.filter((function(e){return!e.deleted_at})).forEach((function(e){e.status===r.eh.online?t.push(e):e.status===r.eh.idle?o.push(e):n.push(e)})),{onlineParticipants:[].concat(t,o),offlineParticipants:n}}},70850:(e,t,n)=>{n.d(t,{F:()=>v});var r=n(64687),o=n.n(r),i=n(24185),a=n(59393),s=n(54754),l=n(97012),c=n(95071),u=n(84495),d=n(75062),m=n(26045),f=n(85893);function p(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}var v=function(e){var t=e.onClick,n=e.autoFocus,r=void 0!==n&&n,v=e.disabled,h=void 0!==v&&v,b=e.spaceId,g=e.chatRoom,y=e.isChatPreview,_=e.parentMessageId,j=e.userList,x=void 0===j?[]:j,w=e.isLiveStream,O=void 0!==w&&w,S=e.isChatSpace,P=void 0!==S&&S,C=e.isInCourseSpace,k=void 0!==C&&C,I=e.portalTargetId,N=void 0===I?"chat-threads-header":I,A=e.isLoading,E=void 0!==A&&A,T=(0,i.UO)().uuid,D=(0,l.wh)().currentCommunityMember,R=(0,d._q)().sendRichTextMessage,L=(0,i.k6)(),M=(0,u.pB)().findOrCreateChatRoom,F=function(){var e,t=(e=o().mark((function e(t){var n,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.richTextBody,r=x.length>1?a.RN:a.g8,e.next=4,M({kind:r,community_member_ids:x.map((function(e){return e.id})),rich_text_body:n,shouldNavigate:!0});case 4:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){p(i,r,o,a,s,"next",e)}function s(e){p(i,r,o,a,s,"throw",e)}a(void 0)}))});return function(e){return t.apply(this,arguments)}}();(0,c.P4)()&&(r=!1);var U=(0,m.$S)(g),B=(0,m.C9)(g),z=(0,l.wh)().isViewOnlyMasquerading;return(0,f.jsx)("div",{className:"bg-primary relative px-5 pt-2",children:(0,f.jsx)(s.T,{autofocus:r,disabled:h||z,onSubmit:function(e){var n=e.body,r=e.attachments,o=e.localAttachments,i=e.localSgidToObjectMap;h||(null===t||void 0===t||t(),g?(R({chatRoom:g,rich_text_body:{body:n,attachments:r},localAttachments:o,currentCommunityMember:D,localSgidToObjectMap:i,parentMessageId:_}),!y||"new"!=T&&T||L.push("/messages/".concat(g.uuid))):F({richTextBody:{body:n,attachments:r}}))},spaceId:b,id:"tiptapMessageTextBox",portalTargetId:N,isLiveStream:O,isChatSpace:P,shouldShowTextModifiersMenu:!E,chatProps:{disableGroupMentions:O||k,isThread:!!_,isDirectMessaging:U,isChatAdminOrModerator:B,chatParticipantsCount:null===g||void 0===g?void 0:g.chat_room_participants_count}})})}},65057:(e,t,n)=>{n.d(t,{s:()=>a});var r=n(86013),o=n(71032),i=n(85893),a=function(e){var t=e.shouldShowConfirmationModal,n=e.toggleConfirmationModal,a=e.handleSubmit,s=e.chatParticipantsCount;return(0,i.jsx)(o.c,{isOpen:t,onClose:n,onConfirm:function(){a(!0),n()},confirmText:(0,r.t)("send"),title:(0,r.t)("messaging.send_group_message.title",{participants_count:s}),children:(0,i.jsx)("div",{className:"mb-6",children:(0,r.t)("messaging.send_group_message.description")})})}},8522:(e,t,n)=>{n.d(t,{u:()=>s});var r=n(67294),o=n(86013),i=n(71032),a=n(85893),s=function(e){var t=e.shouldShowPrivateMessageConfirmationModal,n=e.togglePrivateMessageConfirmationModal,s=e.handleSubmit,l=e.shouldShowPrivateMessageConfirmationOnSubmit,c=e.setShouldShowPrivateMessageConfirmationOnSubmit;return(0,r.useEffect)((function(){l||(s(!0),n())}),[l,s,n]),(0,a.jsx)(i.c,{isOpen:t,onClose:n,onConfirm:function(){c(!1)},confirmText:(0,o.t)("send"),title:(0,o.t)("messaging.share_private_message.title"),cancelText:(0,o.t)("messaging.edit_message"),children:(0,a.jsx)("div",{className:"mb-6",children:(0,o.t)("messaging.share_private_message.description")})})}},77853:(e,t,n)=>{n.d(t,{Qk:()=>c,E0:()=>u,GW:()=>i,Fx:()=>a.F});var r=n(86013),o=n(85893),i=function(e){var t=e.isLiveStream,n=void 0!==t&&t,i=e.isInCourseSpace,a=void 0!==i&&i;return n?(0,o.jsxs)("div",{className:"block px-5 py-4",children:[(0,o.jsx)("div",{className:"text-darkest text-lg font-medium",children:(0,r.t)("messaging.live_stream_start_conversation")}),(0,o.jsx)("div",{className:"text-dark",children:(0,r.t)("messaging.live_stream_start_conversation_description")})]}):a?(0,o.jsxs)("div",{className:"block px-5 py-4",children:[(0,o.jsx)("div",{className:"text-darkest text-lg font-medium",children:(0,r.t)("messaging.course_lesson_chat_start_conversation")}),(0,o.jsx)("div",{className:"text-dark",children:(0,r.t)("messaging.course_lesson_chat_start_conversation_description")})]}):null},a=n(70850),s=n(94762),l=n(4181),c=function(e){var t=e.children,n=e.isLastPage,r=e.isFirstPage,i=e.setIsFirstPage,a=e.setIsLastPage,c=e.chatRoomUuid,u=(0,s.u)(),d=u.messagesHasPrevPage,m=u.messagesHasNextPage,f=u.fetchChatMessages,p=u.isLoading,v=u.firstMessageId,h=u.lastMessageId;return(0,o.jsx)("div",{className:"flex h-auto grow flex-col overflow-auto",children:(0,o.jsx)(l.Y,{shouldShowPrevLoader:!n,shouldShowNextLoader:!r,hasNextPage:m,hasPrevPage:d,onNextPage:function(e){f({chatRoomUuid:c,id:e,previousPerPage:0,nextPerPage:20}),i(!1)},onPrevPage:function(e){f({chatRoomUuid:c,id:e}),a(!1)},firstItemId:v,lastItemId:h,componentId:"message-scroll-view",isLoading:p,children:t})})},u=function(e){var t=e.label,n=e.onClick;return(0,o.jsx)("button",{type:"submit",className:"bg-brand rounded-2xl px-2.5 py-1 text-xs font-semibold leading-5 text-white hover:opacity-90",onClick:n,children:t})}},5827:(e,t,n)=>{n.d(t,{z:()=>u,E:()=>d});var r=n(67294),o=n(88767),i=n(34128),a=n(49326);function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var u=function(e){return["commentHierarchy",e.postId,e.id]},d=function(e){var t=e.postId,n=e.id,s=e.postCommentsClosed,c=(0,o.useQueryClient)(),d=(0,r.useMemo)((function(){return u({postId:t,id:n})}),[t,n]);(0,r.useEffect)((function(){c.removeQueries(d)}),[s,c,d]);var m=(0,o.useQuery)(d,(function(){return(0,i.UT)(a.av.comments.commentHierarchy({postId:t,id:n}))}),{cacheTime:0}),f=m.data,p=m.isLoading;return{comment:f,isLoading:p,updateQueryData:function(e){return c.setQueryData(d,l(l({},e),{},{replies:f.replies}))}}}},92789:(e,t,n)=>{n.d(t,{k:()=>y,w:()=>_});var r=n(67294),o=n(96486),i=n(43063),a=n.n(i),s=n(45578),l=n.n(s),c=n(88767),u=n(34128),d=n(49326);function m(e){return function(e){if(Array.isArray(e))return b(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||h(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function v(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||h(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e,t){if(e){if("string"===typeof e)return b(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?b(e,t):void 0}}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var g="comments_list",y=function(e){var t=e.postId,n=e.parentCommentId;return[g,t,n].filter(Boolean)},_=function(e){var t=e.postId,n=e.parentCommentId,i=e.preloaded,s=void 0!==i&&i,h=e.preloadedComments,b=void 0===h?[]:h,g=e.preloadedCommentsTotalCount,_=void 0===g?0:g,j=e.postCommentsClosed,x=v((0,r.useState)(b||[]),2),w=x[0],O=x[1],S=v((0,r.useState)(j),2),P=S[0],C=S[1],k=(0,c.useInfiniteQuery)(y({postId:t,parentCommentId:n}),(function(e){var r=e.pageParam,o={per_page:10,page:void 0===r?1:r},i=n?function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){p(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({parent_comment_id:n},o):o;return(0,u.UT)(d.av.comments.index({postId:t,params:i}))}),{getNextPageParam:function(e){return e.has_next_page?e.page+1:void 0},onSuccess:function(e){var t=e.pages;O(l()((0,o.flatMap)(t,(function(e){return e.records})),"id"))},initialData:function(){if(s)return{pages:[{records:b,page:0,has_next_page:_>b.length}],pageParams:[]}},cacheTime:0,staleTime:1/0,notifyOnChangeProps:"tracked"}),I=k.isLoading,N=k.isFetchingNextPage,A=k.hasNextPage,E=k.fetchNextPage,T=k.remove;(0,r.useEffect)((function(){s||P===j||(C(j),O([]),T())}),[s,P,j,T]);return{comments:w,isLoading:I,isFetchingNextPage:N,hasNextPage:A,fetchNextPage:E,addCommentToList:function(e){return O((function(t){return[].concat(m(t),[e])}))},updateCommentInList:function(e){return O((function(t){return t.map((function(t){return t.id===e.id?e:t}))}))},removeCommentFromList:function(e){var t=e.id;return O((function(e){return a()(e,["id",t])}))}}}},93404:(e,t,n)=>{n.d(t,{q:()=>r,Q:()=>o});var r="#comment_wrapper_",o="#all_comments"},71542:(e,t,n)=>{n.d(t,{G:()=>a});var r=n(54754),o=n(37109),i=n(85893),a=function(e){var t=e.tiptapBody;return"post"===(null===t||void 0===t?void 0:t.format)?(0,i.jsx)(o.R,{readOnly:!0,value:t.body,sgidToObjectMap:t.sgids_to_object_map,inlineAttachments:t.inline_attachments,openInternalLinksInCurrentTab:!0,disabledExtensions:["cta"]}):(0,i.jsx)(r.T,{type:"comment",editable:!1,rich_text_body:t,openInternalLinksInCurrentTab:!0})}},42602:(e,t,n)=>{n.d(t,{z:()=>d,E:()=>m});var r=n(67294),o=n(88767),i=n(34128),a=n(49326),s=n(64209);function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var d=function(e){var t=e.postId,n=e.id,r=e.usedIn,o=void 0===r?null:r;return[s.bx,t,"hierarchy",n,o]},m=function(e){var t=e.postId,n=e.id,s=e.postCommentsClosed,l=e.postLikingDisabled,u=e.usedIn,m=(0,o.useQueryClient)(),f=(0,r.useMemo)((function(){return d({postId:t,id:n,usedIn:u})}),[t,n,u]);(0,r.useEffect)((function(){m.removeQueries(f)}),[s,l,m,f]);var p=(0,o.useQuery)(f,(function(){return(0,i.UT)(a.av.comments.commentHierarchy({postId:t,id:n}))}),{cacheTime:0}),v=p.data,h=p.isLoading;return{comment:v,isLoading:h,updateQueryData:function(e){return m.setQueryData(f,c(c({},e),{},{replies:v.replies}))}}}},64209:(e,t,n)=>{n.d(t,{bx:()=>g,kW:()=>_,wS:()=>j});var r=n(67294),o=n(96486),i=n(43063),a=n.n(i),s=n(45578),l=n.n(s),c=n(88767),u=n(34128),d=n(49326);function m(e){return function(e){if(Array.isArray(e))return b(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||h(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function v(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||h(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e,t){if(e){if("string"===typeof e)return b(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?b(e,t):void 0}}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var g="comments",y="list",_=function(e){var t=e.postId,n=e.parentCommentId,r=e.usedIn;return[g,t,y,n,void 0===r?null:r].filter(Boolean)},j=function(e){var t=e.postId,n=e.parentCommentId,i=e.preloaded,s=void 0!==i&&i,h=e.preloadedComments,b=void 0===h?[]:h,g=e.preloadedCommentsTotalCount,y=void 0===g?0:g,j=e.postCommentsClosed,x=e.postLikingDisabled,w=e.usedIn,O=void 0===w?"post":w,S=v((0,r.useState)(b||[]),2),P=S[0],C=S[1],k=v((0,r.useState)(j),2),I=k[0],N=k[1],A=v((0,r.useState)(x),2),E=A[0],T=A[1],D=(0,c.useInfiniteQuery)(_({postId:t,parentCommentId:n,usedIn:O}),(function(e){var r=e.pageParam,o={per_page:10,page:void 0===r?1:r},i=n?function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){p(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({parent_comment_id:n},o):o;return(0,u.UT)(d.av.comments.index({postId:t,params:i}))}),{getNextPageParam:function(e){return e.has_next_page?e.page+1:void 0},onSuccess:function(e){var t=e.pages;C(l()((0,o.flatMap)(t,(function(e){return e.records})),"id"))},initialData:function(){if(s)return{pages:[{records:b,page:0,has_next_page:y>b.length}],pageParams:[]}},cacheTime:0,staleTime:1/0,notifyOnChangeProps:"tracked"}),R=D.isLoading,L=D.isFetchingNextPage,M=D.hasNextPage,F=D.fetchNextPage,U=D.remove,B=j!==I||x!==E;(0,r.useEffect)((function(){!s&&B&&(N(j),T(x),C([]),U())}),[s,B,j,x,U]);return{comments:P,isLoading:R,isFetchingNextPage:L,hasNextPage:M,fetchNextPage:F,addCommentToList:function(e){return C((function(t){return[].concat(m(t),[e])}))},updateCommentInList:function(e){return C((function(t){return t.map((function(t){return t.id===e.id?e:t}))}))},removeCommentFromList:function(e){var t=e.id;return C((function(e){return a()(e,["id",t])}))}}}},86747:(e,t,n)=>{n.d(t,{q:()=>r,Q:()=>o});var r="#comment_wrapper_",o="#all_comments"},63001:(e,t,n)=>{n.d(t,{r:()=>j});var r=n(72675),o=n(86013),i=n(88291),a=n(15130),s=n(26953),l=n(71362),c=n(82487),u=n(86078),d=n(16743),m=n(68990),f=n(20633),p=n(1002),v=n(85893),h=function(e){var t=e.memberPublicId,n=e.member,r=e.drawer,i=(0,m.w)({memberPublicId:t,member:n}),a=i.shouldShowEditProfileButton,s=i.onClickOpenEditProfileDrawer,l=i.handleCopyProfileLink;return(0,v.jsxs)("div",{className:"flex w-full items-center justify-between px-5 py-3",children:[(0,v.jsx)(f.h,{name:"20-arrow-left",iconSize:20,onClick:r.hide,ariaLabel:(0,o.t)("back")}),(0,v.jsxs)(p.Lt,{size:"medium",direction:"bottom-end",button:(0,v.jsx)(f.h,{name:"20-menu-dots-horizontal",iconSize:20,ariaLabel:(0,o.t)("options_dropdown")}),children:[(0,v.jsx)(p.Lt.ItemLink,{onClick:l,children:(0,o.t)("profile_drawer.dropdown.copy_profile_link")}),a&&(0,v.jsx)(p.Lt.ItemLink,{onClick:s,children:(0,o.t)("profile_drawer.dropdown.edit_member_profile")})]})]})},b=function(e){var t=e.isLoading,n=e.isError,r=e.isSmScreen,i=e.member,a=e.drawer,s=e.memberPublicId,l=e.shouldOpenInNewTab;return t?(0,v.jsx)(u.m,{}):n?(0,v.jsx)("p",{className:"p-6",children:(0,v.jsx)(d.Z.BodyMd,{children:(0,o.t)("error_loading_profile")})}):(0,v.jsxs)(v.Fragment,{children:[r&&(0,v.jsx)(h,{memberPublicId:s,member:i,drawer:a}),(0,v.jsx)(c.N,{memberPublicId:s,member:i,shouldOpenInNewTab:l,onClose:a.hide,isFullPageProfile:!1})]})},g={page_name:a.$q.PROFILE_VIEW},y=function(e){var t=e.memberPublicId,n=e.params,a=(0,i.P)({memberPublicId:t,params:g}).getProfileInfoQuery,c=a.data,u=a.isLoading,d=a.isError,m=(n||{}).shouldOpenInNewTab,f=(0,r.dd)(),p=(0,s.kK)();return(0,v.jsx)(l.d,{noWrapperPadding:!0,fixedHeader:!0,maskClosable:!0,title:(0,o.t)("profile"),open:f.visible,onClose:f.hide,hideHeader:p,children:(0,v.jsx)(b,{isLoading:u,isError:d,isSmScreen:p,member:c,drawer:f,memberPublicId:t,shouldOpenInNewTab:m})})},_=r.gk.create((function(e){var t=e.memberPublicId,n=e.params;return(0,v.jsx)(y,{memberPublicId:t,params:n})})),j=function(){return(0,r.dd)(_)}},19503:(e,t,n)=>{n.d(t,{C:()=>P});var r=n(68375),o=n(54168),i=n(24885),a=n(86013),s=n(44580),l=n(42155),c=n(94997),u=n(72675),d=n(53448),m=n(47144),f=n(97957),p=n(32224),v=n(38870),h=n(16743),b=n(85893);function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){_(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var j=function(e){var t=e.member,n=t.name,r=t.avatar_url,o=t.rsvp_status,i=t.public_uid,a=(0,p.O)({public_uid:i});return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"hover:bg-secondary group flex h-14 items-center rounded-md px-2",children:[(0,b.jsx)("div",{className:"mr-3",children:(0,b.jsx)("a",y(y({},a),{},{title:n,children:(0,b.jsx)(v.s,{src:r,name:n,size:"8"})}))}),(0,b.jsx)("div",{className:"w-full",children:(0,b.jsx)("a",y(y({},a),{},{title:n,children:(0,b.jsx)(f.Y,{children:(0,b.jsx)(h.Z.LabelSm,{weight:"semibold",children:n})})}))}),(0,b.jsx)("div",{className:"mx-2 flex w-24 shrink-0 justify-end",children:(0,b.jsx)(m.j,{rsvpStatus:o})})]}),(0,b.jsx)("hr",{})]})};function x(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function w(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var O=function(e){var t=e.event,n=(0,u.dd)(),r=(0,l.V)(t,c.a.PARTICIPANT),o=r.records,i=r.fetchPrevPage,m=r.fetchNextPage,f=r.hasPrevPage,p=r.hasNextPage,v=r.totalRecordCount,h=r.totalConfirmedRecordCount,g=r.startRecordNumber,y=r.endRecordNumber,_=r.resetPage;return(0,b.jsxs)(d.u_,{isOpen:n.visible,onClose:function(){_(),n.hide()},children:[(0,b.jsx)(d.u_.Overlay,{}),(0,b.jsxs)(d.u_.Content,{children:[(0,b.jsxs)(d.u_.Header,{children:[(0,b.jsxs)(d.u_.Title,{size:"sm",className:"text-center",children:[h," ",(0,a.t)("events.attendees")]}),(0,b.jsx)(d.u_.HeaderActions,{children:(0,b.jsx)(d.u_.CloseButton,{onClick:n.hide})})]}),(0,b.jsx)(d.u_.Body,{className:"overflow-y-auto md:!px-6",children:(0,b.jsxs)("div",{children:[(null===o||void 0===o?void 0:o.length)>0&&(0,b.jsx)("div",{className:"flex w-full flex-col",children:null===o||void 0===o?void 0:o.map((function(e){return(0,b.jsx)(j,{member:e},e.id)}))}),v>0&&(0,b.jsx)(s.t,{startRecordNumber:g,endRecordNumber:y,totalRecordCount:v,fetchPrevPage:i,fetchNextPage:m,hasPrevPage:f,hasNextPage:p})]})})]})]})},S=u.gk.create((function(e){return(0,b.jsx)(O,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?x(Object(n),!0).forEach((function(t){w(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e))})),P=function(e){var t=e||{},n=t.event_setting_attributes,a=t.event_attendees,s=t.slug,l=t.space_slug,c=(0,r.ou)(e),d=(0,r.sN)(e),m=(0,i.Z)(),f=(0,u.dd)(S),p=a||{},v=p.records,h=p.count,b=n||{},g=b.hide_attendees;if(b.rsvp_disabled||g)return null;return{attendees:v,totalCount:h,canManageEvent:c,handleAttendeesClick:function(){l&&s&&(d?m.show({event:e,defaultSection:o.SA.people}):f.show({event:e}))},canUpdateEvent:d}}},47653:(e,t,n)=>{n.d(t,{A:()=>u});var r=n(94184),o=n.n(r),i=n(86013),a=n(20073),s=n(25401),l=n(46367),c=n(85893),u=function(e){var t=e.startsAt,n=e.endsAt,r=e.status,u=(void 0===r?null:r)===l.Q_.DRAFT,d=(0,a.aA)(n),m=null;return m=!(0,a.aA)(t)||d||u?u?(0,i.t)("events.details.draft"):d?(0,i.t)("events.details.finished",{time_string:(0,s.TF)(n)}):(0,i.t)("events.details.starts",{time_string:(0,s.TF)(t)}):(0,i.t)("events.details.in_progress"),(0,c.jsx)("div",{className:o()("event-counter-badge",{"event-counter-badge--finished":d,"event-counter-badge--draft":u}),children:"".concat(m)})}},82621:(e,t,n)=>{n.d(t,{t:()=>m});var r=n(67294),o=n(86013),i=n(71032),a=n(77761),s=n(46367),l=n(85893);function c(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return u(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var d="events.delete.recurring_event_modal",m=function(e){var t=e.show,n=void 0!==t&&t,u=e.onConfirm,m=e.onCloseModal,f=c((0,r.useState)(),2),p=f[0],v=f[1];return(0,l.jsx)(i.c,{title:(0,o.t)("".concat(d,".title")),isOpen:n,confirmText:(0,o.t)("".concat(d,".accept")),cancelText:(0,o.t)("".concat(d,".cancel")),onClose:m,onCancel:m,onConfirm:function(){u(p)},confirmVariant:"danger",size:"sm",children:(0,l.jsx)("div",{className:"mt-6",children:(0,l.jsx)(a.S,{defaultChecked:s.HA.CURRENT,name:"recurring_event_settings.frequency_edit",options:[{label:(0,o.t)("".concat(d,".this_event")),value:s.HA.CURRENT},{label:(0,o.t)("".concat(d,".this_and_following")),value:s.HA.REMAINING},{label:(0,o.t)("".concat(d,".all_events")),value:s.HA.ALL}],size:"sm",onChange:function(e){v(e)}})})})}},8070:(e,t,n)=>{n.d(t,{E:()=>b,e:()=>_});var r,o,i=n(67294),a=n(87536),s=n(46367),l=n(63367),c=n(20073),u=n(90283);function d(e){return function(e){if(Array.isArray(e))return p(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||f(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||f(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,t){if(e){if("string"===typeof e)return p(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(e,t):void 0}}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var h="events.recurring",b=function(e){var t=e.startsAt,n=e.firstLetterCapital,r=void 0===n||n?"frequencies_capital_letter":"frequencies",o=new Date(t).getDate(),i=(0,u.UZ)(t),a=(0,u.ZY)(t),c=(0,u.cz)(t),d=(0,u.Rc)(t);return[{label:(0,l.t)("".concat(h,".").concat(r,".daily"),{dayName:i}),value:s.PB.DAILY},{label:(0,l.t)("".concat(h,".").concat(r,".weekly"),{dayName:i}),value:s.PB.WEEKLY},{label:(0,l.t)("".concat(h,".").concat(r,".bi_weekly"),{dayName:i}),value:s.PB.BI_WEEKLY},{label:(0,l.t)("".concat(h,".").concat(r,".monthly"),{dayNumberWithOrdinal:d}),value:s.PB.MONTHLY_WEEK_BASED},{label:(0,l.t)("".concat(h,".").concat(r,".monthly"),{dayNumberWithOrdinal:c}),value:s.PB.MONTHLY},{label:(0,l.t)("".concat(h,".").concat(r,".annually"),{monthName:a,dayNumber:o}),value:s.PB.ANNUALLY}]},g=(v(r={},s.PB.DAILY,60),v(r,s.PB.WEEKLY,360),v(r,s.PB.BI_WEEKLY,720),v(r,s.PB.MONTHLY,720),v(r,s.PB.MONTHLY_WEEK_BASED,720),v(r,s.PB.ANNUALLY,3600),r),y=(v(o={},s.PB.DAILY,60),v(o,s.PB.WEEKLY,52),v(o,s.PB.BI_WEEKLY,52),v(o,s.PB.MONTHLY,24),v(o,s.PB.MONTHLY_WEEK_BASED,24),v(o,s.PB.ANNUALLY,10),o),_=function(){var e=(0,a.Gc)().setValue,t=(0,a.qo)({name:"event_setting_attributes.starts_at"}),n=(0,a.qo)({name:"recurring_setting_attributes.range_type"}),r=(0,a.qo)({name:"recurring_setting_attributes.frequency"}),o=(0,a.qo)({name:"event_type"}),u=m((0,i.useState)(!0),2),f=u[0],p=u[1],v=m((0,i.useState)(),2),_=v[0],j=v[1],x=m((0,i.useState)(),2),w=x[0],O=x[1],S=m((0,i.useState)(),2),P=S[0],C=S[1],k=(0,i.useMemo)((function(){return{label:(0,l.t)("".concat(h,".does_not_repeat")),value:!1}}),[]),I=m((0,i.useState)([k]),2),N=I[0],A=I[1],E=[{label:(0,l.t)("".concat(h,".ending.on_day")),value:s.pd.ON},{label:(0,l.t)("".concat(h,".ending.after")),value:s.pd.AFTER}];return(0,i.useEffect)((function(){var e=b({startsAt:t}),n=[k].concat(d(e));A(n),C(t)}),[t,k]),(0,i.useEffect)((function(){p(Boolean(r))}),[r]),(0,i.useEffect)((function(){if(n==s.pd.ON&&r){e("recurring_setting_attributes.occurrences",null);var o=(0,c.Xz)(t,g[r]);j(o)}else n==s.pd.AFTER&&r&&(e("recurring_setting_attributes.ends_at",null),O(y[r]))}),[n,r,t,e]),{endsAtMaxDate:_,endsAfterMaxOccurrences:w,isRecurringEvent:o===s.E_.RECURRING,frequencyOptions:N,endingOptions:E,endsAtMinDate:P,endsOnValue:n,showRecurringFields:f}}},31389:(e,t,n)=>{n.d(t,{Bq:()=>i,mv:()=>a,f0:()=>s,oL:()=>c,Mk:()=>u,S2:()=>d});var r=n(11909),o=n(46367);var i={VIRTUAL:"virtual",IN_PERSON:"in_person",TBD:"tbd",LIVE_STREAM:"live_stream",LIVE_ROOM:"live_room"},a=function(e){return(null===e||void 0===e?void 0:e.status)===o.Q_.DRAFT},s=function(e){return(null===e||void 0===e?void 0:e.event_type)===o.E_.RECURRING},l=function(e){var t,n;return null===e||void 0===e||null===(t=e.event_setting_attributes)||void 0===t||null===(n=t.live_stream_room_setting_attributes)||void 0===n?void 0:n.stream_status},c=function(e){return l(e)===r.LV.ENDED},u=function(e){return l(e)===r.LV.BACKSTAGE},d=function(e){return l(e)===r.LV.LIVE}},62711:(e,t,n)=>{n.d(t,{D:()=>b});var r=n(86013),o=n.n(r),i=n(88767),a=n(24185),s=n(24885),l=n(43548),c=n(97012),u=n(34128),d=n(49326),m=n(55675),f=n(61926),p=n(78270),v=n(21809),h=n(85893),b=function(e){var t=e.event,n=e.onClose,r=e.show,b=(0,a.k6)(),g=(0,v.p)(),y=g.success,_=g.error,j=(0,c.nT)(),x=j.isLoading,w=j.helpers,O=w.findById,S=w.spacesWithEventCreationAllowed;if(x)return null;var P=S(),C=(0,c.L2)().data,k=(0,s.Z)(),I=(0,i.useMutation)((function(e){return(0,u.t5)(d.av.events.duplicate({spaceId:t.space_id,slug:t.slug}),{method:"PUT",body:JSON.stringify({event:{event_id:t.id,space_id:e.space_id}}),forReactQuery:!0})}),{onSuccess:function(e){var t=O(e.space_id);b.push((0,d.Xq)({spaceSlug:t.slug,eventSlug:e.slug})),setTimeout((function(){return k.show({event:e})}),500),y(o().t("event_duplicated_successfully"))},onError:function(){_(o().t("event_duplication_failed"))}});return(0,h.jsx)(p.u,{overflowVisible:!0,title:o().t("duplicate_event_title",{event_title:t.name}),show:r,onClose:n,children:(0,h.jsxs)(f.l,{onSubmit:I.mutate,defaultValues:{space_id:null===C||void 0===C?void 0:C.id},children:[(0,h.jsx)(f.l.Item,{name:"space_id",hideBorder:!0,fullWidth:!0,description:o().t("duplicate_event_to_space"),rules:{required:o().t("events.create.form.space_required_error")},children:(0,h.jsx)(l.M,{spaces:P,name:"space_id",variant:"form-input",defaultValue:null===C||void 0===C?void 0:C.id})}),(0,h.jsx)("p",{className:"modal__small text-dark mb-4",children:o().t("attendees_wont_be_duplicated")}),(0,h.jsx)(m.z,{type:"submit",variant:"primary",children:o().t("duplicate")})]})})}},64850:(e,t,n)=>{n.d(t,{E:()=>l});var r=n(86013),o=n(97646),i=n(1002),a=n(91290),s=n(85893),l=function(e){var t=e.canEdit,n=e.event,l=n.pinned_at_top_of_space,c=(0,a.B)(n).onPinToTop;return t?(0,s.jsx)(i.Lt.ItemLink,{onClick:c,children:(0,s.jsx)(o.sI,{label:(0,r.t)("pin_to_space"),field:"pin_to_top",value:l,variant:"small"})}):null}},91290:(e,t,n)=>{n.d(t,{B:()=>g});var r=n(64687),o=n.n(r),i=n(88767),a=n(29583),s=n(31389),l=n(46367),c=n(52942),u=n(1061),d=n(24885),m=n(97012),f=n(63099),p=n(21809);function v(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}function h(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return b(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return b(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var g=function(e,t){var n=(0,m.wh)().isViewOnlyMasquerading,r=(0,c.q)(),b=(0,d.Z)(),g=(e||{}).policies||{},y=g.can_destroy_post,_=g.can_update_post,j=g.can_duplicate_post,x=e.pinned_at_top_of_space,w=(0,p.p)(),O=w.success,S=w.error,P=h((0,f.k)(!1),2),C=P[0],k=P[1],I=h((0,f.k)(),2),N=I[0],A=I[1],E=h((0,f.k)(),2),T=E[0],D=E[1],R=(0,s.f0)(e),L=k,M=(0,i.useMutation)((function(t){return a.S.destroy({event:e,params:{delete_mode:t}})}),{onSuccess:function(){t(e.id);var n=e.status===l.Q_.DRAFT,o=R?I18n.t("events.recurring_deletion_successful"):I18n.t("event_dropdown_actions.delete_successful");n&&(o=R?I18n.t("events.recurring_draft_deletion_successful"):I18n.t("event_dropdown_actions.draft_delete_successful")),O(o,{duration:"short",shouldUseProgress:!1}),r()},onError:function(){return S(I18n.t("event_dropdown_actions.delete_failed"))}}),F=function(){var t,n=(t=o().mark((function t(){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.S.pin({event:e,formData:{pin_to_top:!0,is_pinned:!x}});case 2:t.sent.ok?(O(I18n.t(x?"event_unpinned":"event_pinned")),r({shouldInvalidateHomePagePosts:!0})):S(I18n.t(x?"event_unpinned_error":"event_pinned_error"));case 4:case"end":return t.stop()}}),t)})),function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(e){v(i,r,o,a,s,"next",e)}function s(e){v(i,r,o,a,s,"throw",e)}a(void 0)}))});return function(){return n.apply(this,arguments)}}();return{canEdit:_,onEdit:function(){_&&!n&&b.show({event:e})},canDelete:y,canDuplicate:j,onDelete:M.mutate,onPinToTop:F,onDuplicate:L,onDeleteClickHandler:function(){n||((0,u.H3)(e)?D(!0):A(!0))},showDuplicateEventModal:C,showConfirmationModal:N,toggleConfirmationModal:A,isRecurringModalOpen:T,setIsRecurringModalOpen:D}}},34729:(e,t,n)=>{n.d(t,{i:()=>P});var r=n(86013),o=n(30658),i=n(97012),a=n(26953),s=n(30887),l=n(1002),c=n(16743),u=n(85751),d=n(61345),m=n(55675),f=n(97646),p=n(67294),v=n(20640),h=n.n(v),b=n(49326),g=n(21809);function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach((function(t){j(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function j(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function x(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return w(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return w(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var O=n(85893),S=function(e){var t=e.getSharePostLink,n=e.post,o=e.sharePostData,a=function(e){var t=e.post,n=e.getSharePostLink,o=e.sharePostData,a=(0,g.p)().success,s=(0,i.wh)().currentCommunity,l=(0,i.L2)().data,c=x((0,p.useState)({post:{show_post_teaser:!(null===t||void 0===t||!t.show_post_teaser),share_to_web:!(null===t||void 0===t||!t.share_post_enabled),share_post_enabled:!(null===t||void 0===t||!t.share_post_enabled),minimal_layout:!(null===t||void 0===t||!t.minimal_layout)}}),2),u=c[0],d=c[1],m=(0,b.LM)({spaceSlug:null===t||void 0===t?void 0:t.space_slug,slug:null===t||void 0===t?void 0:t.slug});return(0,p.useEffect)((function(){t.share_post_enabled&&!o&&n({postId:null===t||void 0===t?void 0:t.id,body:u})}),[null===t||void 0===t?void 0:t.share_post_enabled,o,u,n,null===t||void 0===t?void 0:t.id]),{onClickCopyLink:function(e){h()(e||window.location.origin+m),a((0,r.t)("post.share.link_copied"),{duration:"short",shouldUseProgress:!1})},onChange:function(e){d((function(r){var o={post:_(_({},r.post),e)};return n({postId:null===t||void 0===t?void 0:t.id,body:o}),o}))},formData:u,currentCommunity:s,currentSpace:l}}({post:n,getSharePostLink:t,sharePostData:o}),v=a.onClickCopyLink,y=a.onChange,j=a.formData,w=a.currentCommunity,S=a.currentSpace,P=(0,d.$n)(S)||(0,d.WB)(S)||(null===w||void 0===w?void 0:w.is_private);return w.is_private||null!==S&&void 0!==S&&S.is_private?(0,O.jsxs)("div",{children:[(0,O.jsx)(l.Lt.ItemLink,{onClick:function(){y({share_to_web:!j.post.share_to_web})},children:(0,O.jsx)(f.sI,{label:(0,r.t)("post.share.share_to_web"),tooltipText:(0,r.t)("post.share.share_to_web_on_description"),field:"share_to_web",value:j.post.share_to_web,variant:"small"})}),j.post.share_to_web&&(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)("div",{className:"flex flex-row items-center",children:(0,O.jsx)("div",{className:"mb-2 mt-1 flex-1 px-5",children:(0,O.jsx)(u.I,{disabled:!0,value:null===o||void 0===o?void 0:o.share_post_link,rightAddon:(0,O.jsx)("button",{type:"button",onClick:function(){return v(null===o||void 0===o?void 0:o.share_post_link)},children:(0,O.jsx)(s.JO,{type:"20-copy"})})})})}),P&&(0,O.jsx)("div",{className:"flex flex-row items-center",children:(0,O.jsx)("div",{className:"mb-2 mt-1 flex-1 px-5",children:(0,O.jsx)(c.Z.LabelSm,{children:null!==w&&void 0!==w&&w.is_private&&"open"==(null===S||void 0===S?void 0:S.visibility)?(0,r.t)("post.share.share_to_web_open_content_warning"):(0,d.$n)(S)?(0,r.t)("post.share.share_to_web_secret_content_warning"):(0,r.t)("post.share.share_to_web_private_content_warning")})})}),!(null!==w&&void 0!==w&&w.is_private)&&(0,O.jsx)(l.Lt.ItemLink,{onClick:function(){return y({minimal_layout:!j.post.minimal_layout})},children:(0,O.jsx)(f.sI,{label:(0,r.t)("post.share.minimal_layout"),tooltipText:(0,r.t)("post.share.minimal_layout_description"),field:"minimal_layout",value:j.post.minimal_layout,variant:"small"})})]})]}):(0,O.jsxs)("div",{className:"flex flex-row items-center px-4 py-2",children:[(0,O.jsxs)("div",{className:"flex flex-1 flex-col",children:[(0,O.jsx)(c.Z.LabelMd,{weight:"bold",children:(0,r.t)("post.share.share_to_web")}),(0,O.jsx)(c.Z.LabelSm,{children:(0,r.t)("post.share.post_is_public")})]}),(0,O.jsx)("div",{children:(0,O.jsx)(m.z,{type:"button",variant:"secondary",onClick:function(){return v(null)},children:(0,r.t)("copy_link")})})]})},P=function(e){var t=e.onChange,n=e.button,u=(0,o.m)({onChangeSharePost:t}),d=u.showShareOnWebOptions,m=u.post,f=u.getSharePostLink,p=u.sharePostData,v=(0,a.kK)(),h=(0,i.L2)().data,b=null!==n&&void 0!==n?n:(0,O.jsx)(s.JO,{type:"16-share",size:20});return d(h)?(0,O.jsx)(l.Lt,{size:"extra-large",direction:"bottom-end",menuButtonEl:"button",className:"w-full",buttonClassName:"w-full focus-visible:outline-secondary focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-1 md:p-1 hover:bg-tertiary rounded group flex items-center",button:v?b:(0,O.jsx)(c.Z.LabelSm,{weight:"medium",color:"text-default group-hover:text-dark",children:(0,r.t)("post.share.title")}),children:(0,O.jsx)(S,{post:m,getSharePostLink:f,sharePostData:p})}):null}},54558:(e,t,n)=>{n.d(t,{c:()=>b});var r=n(86013),o=n(59075),i=n(55675),a=n(78270),s=n(30887),l=n(70544),c=n(28772),u=n(22148),d=n(90208),m=n(85893);function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){v(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var h=function(e){var t=e.event,n=e.label,r=(t||{}).event_setting_attributes||{},o=r.starts_at,i=r.ends_at,a=r.time_zone,f=(0,l.N)(o),v=f.dayOfMonth,h=f.shortMonthString,b=(0,c.Dk)(o,a),g=(0,c.Dk)(i,a);return(0,m.jsxs)("div",{className:"event-confirmation__date",children:[(0,m.jsxs)("div",{className:"event-confirmation__date-picker",children:[(0,m.jsx)(s.JO,{type:"calendar",className:"icon"}),"".concat(v," ").concat(h,", ").concat(b," - ").concat(g)]}),(0,m.jsx)("div",{className:"event-confirmation__date-button",children:(0,m.jsx)(u.a,p({},(0,d.q)(t,n)))})]})},b=function(e){var t=e.event,n=e.show,s=e.onClose,l=e.shouldShowConfirmationDate,c=void 0===l||l,u=e.isRecurring,d=void 0!==u&&u,f=e.eventsCount,p=t||{},v=p.name,b=p.event_setting_attributes||{},g=b.confirmation_message_title,y=b.confirmation_message_description,_=b.confirmation_message_button_title,j=b.confirmation_message_button_link;return(0,m.jsx)(a.u,{variant:"default",show:!!n,onClose:s,overflowVisible:!0,children:(0,m.jsxs)("div",{className:"event-confirmation",children:[(0,m.jsx)("h2",{children:(0,r.t)("events.notifications.event_setting_attributes.clap")}),(0,m.jsx)("h3",{children:g||(0,r.t)("events.notifications.event_setting_attributes.confirmation_message_title_placeholder",{event_name:v})}),(0,m.jsx)("p",{children:d?y||(0,r.t)("events.rsvp.recurring_modal.confirmation_description",{events:"".concat(f," ").concat(1===f?(0,r.t)("events.rsvp.recurring_modal.event"):(0,r.t)("events.rsvp.recurring_modal.events"))}):y||(0,r.t)("events.notifications.event_setting_attributes.confirmation_message_description_placeholder")}),c&&(0,m.jsx)(h,{event:t,label:d?(0,r.t)("add_all_events_to_calendar"):""}),(0,m.jsx)(i.z,{variant:"primary",full:!0,onClick:function(){j&&function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"_blank";if(window&&window.open&&(0,o.K)(e)){e.match(/^https?:\/\//i)||(e="http://".concat(e));var n=window.open(e,t);n&&n.focus()}}(j),s()},children:_||(0,r.t)("events.notifications.event_setting_attributes.confirmation_message_button_title_placeholder")})]})})}},27241:(e,t,n)=>{n.d(t,{u:()=>s});var r=n(16743),o=n(37808),i=n(16118),a=n(85893),s=function(e){var t=e.event,n=e.onChange,s=e.buttonText,l=(0,i.j)({event:t}),c=l.isRecurringRsvpOpen,u=l.openRecurringRsvpModal,d=l.onRecurringModalCose;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{type:"submit",onClick:u,children:(0,a.jsx)(r.Z.LabelSm,{weight:"medium",color:"text-brand",children:s})}),(0,a.jsx)(o.O,{event:t,show:c,onClose:d,onChange:n,eventRsvpedByDefault:!1})]})}},5596:(e,t,n)=>{n.d(t,{n:()=>u});var r=n(86013),o=n(16743),i=n(97012),a=n(31889),s=n(49326),l=n(55675),c=n(85893),u=function(e){var t=e.event,n=(0,i.wh)().currentCommunityMember,u=(0,a.vb)(n),d=t.community_member_id==n.id,m=!u&&!d,f=u?(0,r.t)("events.locations.limit_exceeded.admin_message"):(0,r.t)("events.locations.limit_exceeded.non_admin_owner_message");return(0,c.jsxs)("div",{className:"flex flex-col",children:[u&&(0,c.jsx)("div",{className:"my-2",children:(0,c.jsx)(l.z,{variant:"primary",onClick:function(){var e=(0,s.f$)();window.open(e,"_blank")},children:(0,r.t)("events.locations.limit_exceeded.upgrade")})}),(u||d)&&(0,c.jsx)(o.Z.BodySm,{children:f}),m&&(0,c.jsx)(o.Z.BodySm,{children:(0,r.t)("events.locations.limit_exceeded.member_message")})]})}},16118:(e,t,n)=>{n.d(t,{j:()=>y});var r=n(64687),o=n.n(r),i=n(67294),a=n(96486),s=n(88767),l=n(22229),c=n(79517),u=n(52520),d=n(97012),m=n(55734);function f(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){h(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function b(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return g(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var y=function(e){var t=e.event,n=e.onClose,r=void 0===n?a.noop:n,p=e.onChange,g=void 0===p?a.noop:p,y=e.eventRsvpedByDefault,_=void 0===y||y,j=b((0,i.useState)(),2),x=j[0],w=j[1],O=b((0,i.useState)(),2),S=O[0],P=O[1],C=b((0,i.useState)(),2),k=C[0],I=C[1],N=(0,s.useQueryClient)(),A=(0,d.xJ)(),E=(0,u.S)(t)?"host":"participant",T=(0,m.K)({event:t}),D=T.isLoading,R=T.events,L=T.fetchEvents,M=T.onRecurringRsvpSubmit,F=(0,c.i)(),U=F.canUsersSignUp,B=F.userSignUpUrl,z=function(){var e,n=(e=o().mark((function e(){var n,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Object.entries(S).filter((function(e){return b(e,2)[1]})).map((function(e){return b(e,1)[0]})),i=n.find((function(e){return e.id===t.id})),e.next=4,M({eventIds:n,role:E});case 4:g(v(v({},t),{},{rsvped_event:Boolean(i)})),H(),r();case 7:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){f(i,r,o,a,s,"next",e)}function s(e){f(i,r,o,a,s,"throw",e)}a(void 0)}))});return function(){return n.apply(this,arguments)}}(),H=function(){N.invalidateQueries("posts")};return(0,i.useEffect)((function(){if(R){var e={};R.forEach((function(n){e["".concat(n.id)]=!(!_||n.id!==t.id)||n.rsvped_event})),P(e)}}),[R]),(0,i.useEffect)((function(){S&&I(Object.values(S).filter((function(e){return e})).length)}),[S]),{isLoading:D,events:R.filter((function(e){return!e.rsvp_limit_reached})),eventsState:S,isRecurringRsvpOpen:x,eventsSelectedCount:k,fetchEvents:L,onSubmit:z,onCheckboxChange:function(e){var t=e.name,n=e.value;P((function(e){return v(v({},e),{},h({},t,n))}))},onSelectAllClickHandler:function(){P((function(e){for(var t={},n=Object.entries(e),r=n.every((function(e){return e[1]})),o=0,i=n;o<i.length;o++){t[b(i[o],1)[0]]=!r}return t}))},openRecurringRsvpModal:function(){A?w((function(e){return!e})):window.location.href=(0,l.U)(U,B,!0)},onRecurringModalCose:function(){w(!1)}}}},37808:(e,t,n)=>{n.d(t,{O:()=>j});var r=n(67294),o=n(94184),i=n.n(o),a=n(86013),s=n(96486),l=n(94997),c=n(16743),u=n(28772),d=n(78573),m=n(61926),f=n(5295),p=n(79051),v=n(54558),h=n(76530),b=n(47972),g=n(85893),y=function(e){var t=e.id,n=e.name,r=e.date,o=e.time,i=e.value,a=e.onChange;return(0,g.jsx)("li",{children:(0,g.jsxs)("label",{className:"m-0 flex items-center justify-between pr-1",htmlFor:t,children:[(0,g.jsxs)("div",{className:"leading-none",children:[(0,g.jsx)("div",{children:(0,g.jsx)(c.Z.LabelSm,{weight:"semibold",children:r})}),(0,g.jsx)("div",{className:"text-gray-500",children:(0,g.jsx)(c.Z.LabelXs,{children:o})})]}),(0,g.jsx)(b.X,{id:t,name:n,isFormItem:!1,checked:i,onChange:function(e){return a({name:n,value:e.target.checked})},option:{value:"",label:""}})]})})},_=n(16118),j=function(e){var t=e.event,n=e.eventRsvpedByDefault,o=void 0!==n&&n,b=e.onChange,j=e.onClose,x=e.show,w=void 0!==x&&x,O="events.rsvp.recurring_modal",S=(0,_.j)({event:t,onClose:j,onChange:b,eventRsvpedByDefault:o}),P=S.isLoading,C=S.events,k=S.eventsState,I=S.eventsSelectedCount,N=S.fetchEvents,A=S.onSubmit,E=S.onCheckboxChange,T=S.onSelectAllClickHandler,D=(0,h.q)(t),R=D.shouldShowConfirmation,L=D.setShouldShowConfirmation;(0,r.useEffect)((function(){w&&N()}),[w]);var M=t||{},F=M.event_setting_attributes,U=M.recurring_setting_attributes,B=F||{},z=B.starts_at,H=B.time_zone_abbreviations,q=B.time_zone,Z=B.start_date,V=(U||{}).frequency,W=(0,p.O)({startsAt:Z,frequency:V,firstLetterCapital:!1}).label,Q="".concat((0,u.Dk)(z,q)," ").concat(H,".");return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)(d.W,{size:"md",title:t.name,actionText:(0,a.t)("".concat(O,".rsvp")),actionVariant:"primary",isOpen:!!w,onClose:function(){j()},onAction:function(){A(),L(!0)},disabled:P||0===I,children:[(0,g.jsxs)("div",{className:"mt-2.5 text-center text-gray-500",children:[(0,g.jsxs)(c.Z.BodyMd,{children:[(0,a.t)("".concat(O,".description_line_1"))," ",W," ",(0,a.t)("".concat(O,".at"))," ",Q]}),(0,g.jsx)(c.Z.BodyMd,{children:(0,a.t)("".concat(O,".description_line_2"))})]}),P&&(0,g.jsx)(f.a,{}),k&&!P&&(0,g.jsxs)(m.l,{defaultValues:k,onSubmit:s.noop,children:[(0,g.jsxs)("div",{className:"mt-7 flex items-center justify-between text-gray-500",children:[(0,g.jsxs)(c.Z.LabelSm,{weight:"medium",children:[null===C||void 0===C?void 0:C.length," ",(0,a.t)("".concat(O,".events"))]}),(0,g.jsx)("button",{type:"button",className:"text-circle",onClick:T,children:(0,g.jsx)(c.Z.LabelSm,{weight:"medium",children:(0,a.t)("".concat(O,".select_all"))})})]}),(0,g.jsx)("div",{className:"mt-4 overflow-auto md:max-h-80",children:(0,g.jsx)("ul",{className:i()("flex list-none flex-col gap-4",{"pr-4":(null===C||void 0===C?void 0:C.length)>6}),children:C.map((function(e){var t=e.id,n=e.starts_at,r=e.start_date,o=e.ends_at,i=e.time_zone,a=e.time_zone_abbreviations;return(0,g.jsx)(y,{id:"".concat(t),name:"".concat(t),date:r,time:"".concat((0,u.Dk)(n,i)," - ").concat((0,u.Dk)(o,i)," ").concat(a),value:k["".concat(t)],onChange:E},t)}))})})]})]}),!(0,l.yl)(t)&&(0,g.jsx)(v.c,{event:t,shouldShowConfirmationDate:!0,isRecurring:!0,eventsCount:I,show:R,onClose:function(){L(!1)}})]})}},11127:(e,t,n)=>{n.d(t,{w:()=>T});var r=n(94997),o=n(30414),i=n(46367),a=n(54558),s=n(86013),l=n(55675),c=n(53448),u=n(16743),d=n(85893),m=function(e){var t=e.isOpen,n=e.onClose,r=e.toggleRsvp;return(0,d.jsxs)(c.u_,{title:(0,s.t)("events.rsvp.unrsvp_modal.title"),isOpen:!!t,onClose:n,children:[(0,d.jsx)(c.u_.Overlay,{}),(0,d.jsxs)(c.u_.Content,{children:[(0,d.jsxs)(c.u_.Header,{children:[(0,d.jsx)(c.u_.Title,{size:"md",className:"text-center",children:(0,s.t)("events.rsvp.unrsvp_modal.title")}),(0,d.jsx)(c.u_.HeaderActions,{children:(0,d.jsx)(c.u_.CloseButton,{onClick:n})})]}),(0,d.jsx)(c.u_.Body,{children:(0,d.jsx)("div",{className:"px-6 pb-4 pt-5 text-center",children:(0,d.jsx)(u.Z.BodyMd,{size:"text-sm",children:(0,s.t)("events.rsvp.unrsvp_modal.description")})})}),(0,d.jsxs)(c.u_.Footer,{className:"space-y-2",children:[(0,d.jsx)(l.z,{variant:"circle",full:!0,large:!0,onClick:function(){r(),n()},className:"h-10",children:(0,s.t)("events.rsvp.unrsvp_modal.confirm_button")}),(0,d.jsx)(l.z,{variant:"secondary",full:!0,large:!0,onClick:n,className:"h-10",children:(0,s.t)("events.rsvp.unrsvp_modal.decline_button")})]})]})]})},f=n(20761),p=n(94184),v=n.n(p),h=n(62596),b=function(){return(0,d.jsx)("img",{loading:"lazy",src:h,alt:(0,s.t)("events.rsvp.attending")})},g=function(e){var t=e.confirmed,n=e.full,r=e.toggleRsvp,o=e.loading,i=e.paidEvent,a=e.variant,c=void 0===a?"primary":a,u=e.isRsvpDisabled,m=void 0!==u&&u;return(0,d.jsxs)(d.Fragment,{children:[!t&&(0,d.jsx)(l.z,{variant:c,full:n,onClick:r,disabled:o||m,className:v()({"!border-primary":"secondary"===c}),children:i?(0,s.t)("events.rsvp.buy_ticket"):(0,s.t)("events.rsvp.rsvp")}),t&&(0,d.jsx)(b,{})]})},y=n(67294),_=n(72510),j=n(47031),x=n(13342),w=n(42274),O=function(e){var t=e.label,n=e.renderIcon;return(0,d.jsxs)("div",{className:"rsvp-radio__button__label",children:[n,(0,d.jsx)("span",{className:"button-text !text-dark",children:t})]})},S=function(e){var t=e.renderIcon,n=e.label,r=e.value,o=e.disabled,i=e.onClick;return(0,d.jsx)(_.v.Item,{disabled:o,className:function(e){var t=e.active;return v()("rsvp-radio__list__option",{"rsvp-radio__list__option--active":t,"rsvp-radio__list__option--disabled":o})},children:function(){return(0,d.jsxs)("button",{type:"submit",className:"rsvp-radio__list__option",onClick:i,children:[(0,d.jsxs)("div",{className:"rsvp-radio__list__option__label",children:[t,(0,d.jsx)("span",{className:"label-text",children:n})]}),(0,d.jsx)("input",{type:"radio",checked:r,readOnly:!0})]})}},"rsvp-attending")};function P(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function C(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?P(Object(n),!0).forEach((function(t){k(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):P(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function k(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var I=function(e){var t=e.confirmed,n=e.full,r=e.toggleRsvp,o=e.loading,i=e.setShouldShowUnrsvpConfirmation,a=e.showUnrsvpPopup,l=(0,s.t)("events.rsvp.attending"),c=(0,s.t)("events.rsvp.not_attending"),u=function(e){e!==t&&(!1===e&&a?i(!0):r())};return(0,d.jsx)("div",{className:v()("rsvp-radio",{"rsvp-radio--full":n}),children:(0,d.jsx)(_.v,{children:function(e){var n=e.open;return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)(_.v.Button,{className:v()("rsvp-radio__button !border-primary",{"rsvp-radio__button--open":n}),children:[t?(0,d.jsx)(O,{label:l,renderIcon:(0,d.jsx)(b,{})}):(0,d.jsx)(O,{label:c}),(0,d.jsx)("span",{className:"button-icon-container",children:(0,d.jsx)(x.Z,{className:"button-icon","aria-hidden":"true"})})]}),(0,d.jsx)(j.u,C(C({as:y.Fragment,show:n},w.SP),{},{children:(0,d.jsxs)(_.v.Items,{static:!0,className:"rsvp-radio__list",children:[(0,d.jsx)(S,{label:l,value:t,disabled:o,onClick:function(){return u(!0)}},"rsvp-attending"),(0,d.jsx)(S,{label:c,value:!t,disabled:o,onClick:function(){return u(!1)}},"rsvp-not-attending")]})}))]})}})})};function N(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function A(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?N(Object(n),!0).forEach((function(t){E(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):N(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function E(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var T=function(e){var t=e.event,n=e.onChange,s=e.toggleRecurringRsvp,l=e.full,c=e.variant,u=void 0===c?"primary":c,p=(0,f.O)(t,n),v=p.toggleRsvp,h=p.loading,b=p.showConfirmation,y=p.dismissConfirmation,_=p.dismissUnrsvpConfirmation,j=p.eventEnded,x=p.confirmed,w=p.rsvpStatus,O=p.setShouldShowUnrsvpConfirmation,S=p.shouldShowUnrsvpConfirmation,P=t.event_type===i.E_.RECURRING,C=t||{},k=C.event_setting_attributes,N=C.paywall_attributes,E=(k||{}).rsvp_limit_reached,T={confirmed:x,rsvpStatus:w,full:l,toggleRsvp:P&&!(0,r.yl)(t)?s:v,loading:h,paidEvent:(0,r.yl)(t),setShouldShowUnrsvpConfirmation:O,showUnrsvpPopup:(0,r.yl)(t)&&!(null!==N&&void 0!==N&&N.invited)};return j?null:(0,d.jsxs)(o.T,{children:[w?(0,d.jsx)(I,A({},T)):(0,d.jsx)(g,A(A({},T),{},{variant:u,isRsvpDisabled:E})),!P&&(0,d.jsx)(a.c,{event:t,show:b,onClose:y}),x&&(0,r.yl)(t)&&(0,d.jsx)(m,{isOpen:S,onClose:_,toggleRsvp:v})]})}},20761:(e,t,n)=>{n.d(t,{O:()=>g});var r=n(64687),o=n.n(r),i=n(86013),a=n(22229),s=n(49326),l=n(29583),c=n(79517),u=n(94997),d=n(97012),m=n(76530);function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){v(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function h(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}function b(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){h(i,r,o,a,s,"next",e)}function s(e){h(i,r,o,a,s,"throw",e)}a(void 0)}))}}var g=function(e,t){var n=(0,m.q)(e),r=n.currentUser,f=n.error,v=n.hasEventEnded,h=n.isConfirmed,g=n.isLoading,y=n.isUnconfirmed,_=n.role,j=n.setShouldShowConfirmation,x=n.shouldShowConfirmation,w=n.setIsLoading,O=n.rsvpStatus,S=n.ticketData,P=n.setShouldShowUnrsvpConfirmation,C=n.shouldShowUnrsvpConfirmation,k=(0,d.wh)().currentCommunityMember,I=(0,c.i)(),N=I.canUsersSignUp,A=I.userSignUpUrl,E=function(){var n=b(o().mark((function n(){var i,s,c;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!g){n.next=2;break}return n.abrupt("return");case 2:if(r&&k){n.next=5;break}return(0,u.yl)(e)?window.location.href=e.paywall_attributes.checkout_url:window.location.href=(0,a.U)(N,A),n.abrupt("return");case 5:return i=(0,u.yl)(e)&&!O,s=i||y?l.S.rsvp:l.S.unRsvp,w(!0),n.prev=8,n.next=11,s({event:e,params:{role:_}});case 11:null!==(c=n.sent)&&void 0!==c&&c.redirect_url?window.location.href=c.redirect_url:(j(y),t(p(p({},e),{},{rsvped_event:y,rsvp_status:y?"yes":"no"}))),n.next=19;break;case 15:n.prev=15,n.t0=n.catch(8),f(n.t0.message),console.error("useEventRsvp - could not rsvp - ",null===e||void 0===e?void 0:e.slug);case 19:w(!1);case 20:case"end":return n.stop()}}),n,null,[[8,15]])})));return function(){return n.apply(this,arguments)}}(),T=function(){var n=b(o().mark((function n(){var a;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!g){n.next=2;break}return n.abrupt("return");case 2:if(r){n.next=6;break}return f((0,i.t)("log_in_to_perform_action",{action:(0,i.t)("events.rsvp.rsvp")})),window.location.href=s.$T.signIn({params:{post_login_redirect:window.location.href}}),n.abrupt("return");case 6:return n.next=8,l.S.rsvp({event:e});case 8:(a=n.sent).ok&&(null!==a&&void 0!==a&&a.redirect_url?window.location.href=a.redirect_url:t(p(p({},e),{},{rsvped_event:!0})));case 10:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();return{toggleRsvp:E,loading:g,confirmed:h,rsvpStatus:O,showConfirmation:x,dismissConfirmation:function(){return j(!1)},dismissUnrsvpConfirmation:function(){return P(!1)},eventEnded:v,rsvpWhileJoiningEvent:T,ticketData:S,setShouldShowUnrsvpConfirmation:P,shouldShowUnrsvpConfirmation:C}}},76530:(e,t,n)=>{n.d(t,{q:()=>u});var r=n(67294),o=n(97012),i=n(20073),a=n(21809),s=n(52520);function l(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return c(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var u=function(e){var t=e||{},n=t.rsvp_status,c=t.event_setting_attributes,u=t.paywall_attributes,d=(c||{}).ends_at,m=(0,i.aA)(d),f=l((0,r.useState)(!1),2),p=f[0],v=f[1],h=l((0,r.useState)(!1),2),b=h[0],g=h[1],y="CALENDAR_EVENT_".concat(e.id),_=l((0,r.useState)("true"===window.sessionStorage.getItem(y)),2),j=_[0],x=_[1];return{currentUser:(0,o.xJ)(),error:(0,a.p)().error,hasEventEnded:m,isConfirmed:"yes"===n,isLoading:p,isUnconfirmed:!n||"no"===n,role:(0,s.S)(e)?"host":"participant",setShouldShowConfirmation:function(e){try{window.sessionStorage.setItem(y,e)}catch(t){console.error("Error accessing session storage",t)}x(e)},shouldShowConfirmation:j,setIsLoading:v,rsvpStatus:n,ticketData:u,setShouldShowUnrsvpConfirmation:g,shouldShowUnrsvpConfirmation:b}}},36586:(e,t,n)=>{n.d(t,{P:()=>i});var r=n(31389),o=n(20073),i=function(e){var t=e||{},n=t.event_setting_attributes,i=t.policies,a=n||{},s=a.starts_at,l=a.location_type,c=a.live_stream_slug,u=i||{},d=u.can_manage_post,m=u.can_update_post,f=(0,o.Gs)(s,20),p=[r.Bq.LIVE_STREAM,r.Bq.LIVE_ROOM].includes(l);return{issueCreatingLive:f&&p&&!!!c&&d,canCreateLive:d||m}}},13743:(e,t,n)=>{n.d(t,{y:()=>c});var r=n(86013),o=n(88767),i=n(1320),a=n(94997),s=n(49326),l=n(21809),c=function(e){var t=(0,l.p)();return(0,o.useMutation)((function(){return i.S1.createLiveRoomForEvent({event:e})}),{onSuccess:function(t){var n=((t||{}).event_setting_attributes||{}).live_stream_slug;if(n){var r=s.dE.room({roomSlug:n});(0,a.L6)(e)&&(r=s.dE.publicRoom({roomSlug:n})),window.open(r,"_blank")}},onError:function(){t.error((0,r.t)("events.can_not_create_live_room_for_event"))}})}},90195:(e,t,n)=>{n.d(t,{Y:()=>$});var r=n(94184),o=n.n(r),i=n(86013),a=n(87915),s=n.n(a),l=n(53691),c=n(16743),u=n(97012),d=n(20073),m=n(28772),f=n(22148),p=n(27299),v=n(25067),h=n(73105),b=n(19503),g=n(85893),y=function(e){var t=e.event,n=e.size,r=void 0===n?"md":n,o=(0,b.C)(t)||{},i=o.attendees,a=o.totalCount,s=o.handleAttendeesClick;return null!==i&&void 0!==i&&i.length?(0,g.jsx)("button",{type:"button",onClick:s,children:(0,g.jsx)(h.v,{users:i,totalCount:a,size:r})}):null},_=n(90208),j=n(46367),x=n(79051),w=n(67294),O=n(37054),S=n(68375),P=n(55675),C=["places"],k={streetViewControl:!1,mapTypeControl:!1,scrollWheel:!1,fullscreenControl:!1,panControl:!1,rotateControl:!1,gestureHandling:"none",clickableIcons:!1,controlSize:25,disableDoubleClickZoom:!0,draggableCursor:"arrow",draggingCursor:"arrow",keyboardShortcuts:!1},I=function(e){var t=e.serializedLocation,n=(0,O.Ji)({id:"google-map-script",googleMapsApiKey:window.GOOGLE_MAPS_API_KEY,libraries:C}).isLoaded,r=(0,w.useMemo)((function(){return(0,S.qO)(t)}),[t]),o=(0,w.useMemo)((function(){return function(e){var t,n,r,o;return null!==e&&void 0!==e&&e.geometry?{lat:null===e||void 0===e||null===(t=e.geometry)||void 0===t||null===(n=t.location)||void 0===n?void 0:n.lat,lng:null===e||void 0===e||null===(r=e.geometry)||void 0===r||null===(o=r.location)||void 0===o?void 0:o.lng}:null}(r)}),[r]);return n?(0,g.jsxs)("div",{className:"in-person-location",children:[o&&(0,g.jsx)(O.b6,{mapContainerClassName:"in-person-location__map-container",zoom:15,options:k,center:o,children:(0,g.jsx)(O.Jx,{cursor:"arrow",position:o})}),(0,g.jsxs)("div",{className:"in-person-location__location",children:[(0,g.jsxs)("div",{className:"info",children:[(null===r||void 0===r?void 0:r.name)&&(0,g.jsx)("p",{className:"name",children:null===r||void 0===r?void 0:r.name}),r.formatted_address&&(0,g.jsx)("p",{children:r.formatted_address})]}),r.url&&(0,g.jsx)("div",{className:"view-map-button",children:(0,g.jsx)(P.z,{variant:"secondary",onClick:function(){window.open(r.url,"_blank")},full:!0,children:(0,i.t)("events.rsvp.view_map")})})]})]}):null},N=(0,w.memo)(I),A=n(27241),E=n(36586),T=n(94997),D=n(31256),R=n(49326),L=n(31389),M=n(5596),F=n(13743),U=function(e){var t=e.event,n=(0,u.wh)().currentUser,r=(0,D.IO)(),o=r.isMonthlyHourLimitReached,a=r.isStorageLimitReached,s=!!n,l=(t||{}).event_setting_attributes||{},d=l.location_type,m=l.live_stream_slug,f=l.live_stream_room_setting_attributes,p=(0,E.P)(t)||{},v=p.issueCreatingLive,h=p.canCreateLive,b=(0,F.y)(t),y=h&&(v||(0,L.oL)(t)),_=m&&((0,L.Mk)(t)||(0,L.S2)(t));return o||(null===f||void 0===f?void 0:f.recording_enabled)&&a?(0,g.jsx)(M.n,{event:t}):(0,g.jsxs)(g.Fragment,{children:[y&&(0,g.jsx)("div",{className:"my-2",children:(0,g.jsx)(P.z,{variant:"primary",onClick:b.mutate,disabled:(0,L.mv)(t)||b.isLoading||b.isSuccess,children:(0,i.t)("events.locations.create_".concat(d))})}),_?(0,g.jsx)("div",{className:"mt-2",children:(0,g.jsx)(P.z,{variant:"primary",onClick:function(){var e=R.dE.room({roomSlug:m});(0,T.L6)(t)&&!s&&(e=R.dE.publicRoom({roomSlug:m})),window.open(e,"_blank")},children:(0,i.t)("events.locations.".concat(d,"_link"))})}):(0,g.jsx)(c.Z.BodySm,{children:(0,i.t)("events.locations.".concat(d,"_not_available"))})]})},B=n(37808),z=n(16118),H=n(11127);function q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?q(Object(n),!0).forEach((function(t){V(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):q(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function V(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var W={validate:{url:function(e){return/^[^A-Z]/.test(e)}}},Q=function(e){var t=e.onChange,n=e.isMinimal,r=void 0!==n&&n,a=(0,u.Zh)().record,h=a||{},w=h.event_type,O=h.event_setting_attributes,S=h.rsvped_event,P=h.recurring_setting_attributes,C=h.upcoming_occurrences_count,k=((0,b.C)(a)||{}).totalCount,I=(P||{}).frequency,E=(0,z.j)({event:a}),T=E.isRecurringRsvpOpen,D=E.openRecurringRsvpModal,R=E.onRecurringModalCose,L=(0,l.C)(),M=O||{},F=M.starts_at,q=M.ends_at,V=M.time_zone_abbreviations,Q=M.start_date,$=M.time_zone,G=M.location_type,J=M.in_person_location,K=M.virtual_location_url,Y=M.rsvp_disabled,X=M.hide_attendees,ee=M.hide_location_from_non_attendees,te=(0,x.O)({startsAt:F,frequency:I}).label;if(!O)return(0,g.jsx)(v.gi,{variant:"right-sidebar"});var ne=!!q&&(0,d.aA)(q),re=w===j.E_.RECURRING,oe=a.rsvped_event,ie=Z({event:a,onChange:t,full:!r},re&&{toggleRecurringRsvp:oe?function(){L.show({event:a,onChange:t})}:D});return(0,g.jsxs)(p.s,{withBorder:!r,className:o()({"lg:mb-12":!r}),children:[(0,g.jsxs)("div",{className:o()("rsvp-section",{"rsvp-section--minimal":r}),children:[!ne&&!Y&&(0,g.jsx)("div",{className:"rsvp-section__button",children:(0,g.jsx)(H.w,Z({},ie))}),(0,g.jsxs)("div",{className:"rsvp-section__section rsvp-section__section-date","data-testid":"event-date",children:[(0,g.jsx)(c.Z.LabelMd,{weight:"semibold",children:re?(0,i.t)("events.rsvp.date"):(0,i.t)("events.rsvp.date_and_time")}),(0,g.jsxs)("div",{className:"rsvp-section__section__details",children:[(0,g.jsx)("div",{children:(0,g.jsx)(c.Z.LabelSm,{children:Q})}),(0,g.jsx)("div",{children:(0,g.jsxs)(c.Z.LabelSm,{children:[" ","".concat((0,m.Dk)(F,$)," - ").concat((0,m.Dk)(q,$)," ").concat(V)]})})]}),(0,g.jsxs)("div",{className:"rsvp-section__section__footer",children:[!ne&&(0,g.jsx)(f.a,Z({},(0,_.q)(a))),re&&C>0&&(0,g.jsxs)("div",{className:"mt-2 lg:mt-4",children:[(0,g.jsx)("div",{children:(0,g.jsx)(c.Z.LabelSm,{children:te})}),(0,g.jsx)(A.u,{event:a,onChange:t,buttonText:(0,i.t)("events.rsvp.show_all_events")})]})]})]}),(!ee||S)&&(0,g.jsxs)("div",{className:"rsvp-section__section rsvp-section__section-location","data-testid":"event-location",children:[(0,g.jsx)(c.Z.LabelMd,{weight:"semibold",children:(0,i.t)("events.rsvp.location")}),!ne||"live_stream"!==G&&"live_room"!==G?(0,g.jsxs)(g.Fragment,{children:["virtual"===G&&(0,g.jsx)("div",{className:"rsvp-section__section__details rsvp-section__section__details--truncate text-dark",children:K?(0,g.jsx)(s(),{options:W,children:K}):(0,g.jsx)(c.Z.BodyMd,{children:(0,i.t)("events.locations.virtual")})}),"in_person"===G&&(0,g.jsx)("div",{className:"rsvp-section__section__details",children:(0,g.jsx)(N,{serializedLocation:J})}),"tbd"===G&&(0,g.jsx)("div",{className:"rsvp-section__section__details",children:(0,i.t)("events.rsvp.tbd")}),[j.Bq.LIVE_STREAM,j.Bq.LIVE_ROOM].includes(G)&&(0,g.jsx)("div",{className:"rsvp-section__section__details text-dark",children:(0,g.jsx)(U,{event:a})})]}):(0,g.jsx)("div",{className:"rsvp-section__section__details",children:(0,i.t)("events.ended")})]}),!!k&&!Y&&!X&&(0,g.jsxs)("div",{className:"rsvp-section__section rsvp-section__section-attendees",children:[!r&&(0,g.jsx)("div",{className:"lg:mb-2",children:(0,g.jsx)(c.Z.LabelMd,{weight:"semibold",children:(0,i.t)("events.rsvp.attendees")})}),(0,g.jsx)("div",{className:"rsvp-section__section__details",children:(0,g.jsx)(y,{event:a,size:"md"})})]}),r&&0==k&&(0,g.jsx)("div",{className:"rsvp-section__section rsvp-section__section-attendees",children:(0,g.jsx)("p",{className:"rsvp-section__no-attendees",children:(0,i.t)("events.rsvp.first_to_attend")})})]}),(0,g.jsx)(B.O,{event:a,show:T,onClose:R,onChange:t})]})},$=function(e){var t=e.onChange,n=e.insidePost,r=void 0!==n&&n;return(0,g.jsx)("section",{className:o()("right-sidebar-container",{"right-sidebar-container--insidePost":r}),children:(0,g.jsx)(Q,{onChange:t})})}},90208:(e,t,n)=>{n.d(t,{q:()=>c});var r=n(20073),o=n(90283),i=n(68375),a=n(49326),s=n(46367);function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var c=function(e,t){var n,c=e||{},u=c.name,d=c.calendar_description,m=c.event_setting_attributes,f=c.rsvped_event,p=c.slug,v=c.space_slug,h=c.event_type,b=c.recurring_setting_attributes,g=m||{},y=g.calendar_starts_at,_=g.calendar_ends_at,j=g.location_type,x=g.in_person_location,w=g.virtual_location_url,O=g.hide_location_from_non_attendees,S=g.start_date,P=g.event_recurrences,C=g.calendar_time_zone,k=!O||f,I=(0,i.qO)(x),N=h===s.E_.RECURRING,A="".concat(window.location.origin).concat((0,a.LM)({spaceSlug:v,slug:p})),E=N?"".concat(window.location.origin,"/c/").concat(v):A,T=(l(n={},s.Bq.VIRTUAL,w),l(n,s.Bq.IN_PERSON,null!==I&&void 0!==I&&I.name?null===I||void 0===I?void 0:I.name.concat(", ",null===I||void 0===I?void 0:I.formatted_address):null===I||void 0===I?void 0:I.formatted_address),l(n,s.Bq.LIVE_STREAM,E),l(n,s.Bq.LIVE_ROOM,E),l(n,s.Bq.TBD,""),n);return{label:t,title:u,description:d,location:k?T[j]:"",startTime:y,endTime:_,recurring:N?function(){switch(null===b||void 0===b?void 0:b.frequency){case s.PB.DAILY:return{repeat:s.PB.DAILY,count:P};case s.PB.WEEKLY:return{repeat:s.PB.WEEKLY,count:P,byDay:(0,o.mM)(S)};case s.PB.BI_WEEKLY:return{repeat:s.PB.WEEKLY,count:P,byDay:(0,o.mM)(S),interval:2};case s.PB.MONTHLY:return{repeat:s.PB.MONTHLY,count:P};case s.PB.MONTHLY_WEEK_BASED:return{repeat:s.PB.MONTHLY,count:P,byDay:(0,r.tX)(S)};case s.PB.ANNUALLY:return{repeat:s.PB.YEARLY,count:P};default:return{}}}():{},timeZone:C}}},46367:(e,t,n)=>{n.d(t,{Bq:()=>o,gP:()=>i,E_:()=>a,PB:()=>s,pd:()=>l,HA:()=>c,Q_:()=>u});var r=n(86013),o={VIRTUAL:"virtual",IN_PERSON:"in_person",TBD:"tbd",LIVE_STREAM:"live_stream",LIVE_ROOM:"live_room"},i={virtual:(0,r.t)("events.location_types.virtual"),in_person:(0,r.t)("events.location_types.in_person"),tbd:(0,r.t)("events.location_types.tbd"),live_stream:(0,r.t)("events.location_types.live_stream"),live_room:(0,r.t)("events.location_types.live_room")},a={SINGLE:"single",RECURRING:"recurring"},s={DAILY:"daily",WEEKLY:"weekly",BI_WEEKLY:"bi_weekly",MONTHLY:"monthly",MONTHLY_WEEK_BASED:"monthly_weekday_based",ANNUALLY:"annually",YEARLY:"yearly"},l={ON:"on",NEVER:"never",AFTER:"after"},c={CURRENT:"current",REMAINING:"remaining",ALL:"all"},u={PUBLISHED:"published",DRAFT:"draft"}},79517:(e,t,n)=>{n.d(t,{i:()=>i});var r=n(97012),o=n(98929),i=function(){var e=(0,r.wh)().currentCommunity,t=(0,o.pn)(e),n=e||{},i=n.private_sign_up_url,a=n.is_private,s=n.allow_signups_to_public_community;return{canUsersSignUp:!a&&s||a&&!!i,userSignUpUrl:i||t}}},69589:(e,t,n)=>{n.d(t,{m:()=>i});var r=n(24185),o=n(97012),i=function(){var e,t=(0,o.nT)(),n=(0,r.UO)().spaceSlug,i=(t.helpers.spacesWithPostCreationAllowed()||[]).filter((function(e){return"event"===e.post_type})),a=(null===(e=i.find((function(e){return e.slug===n})))||void 0===e?void 0:e.id)||null;return{spaces:i,spaceId:a}}},52942:(e,t,n)=>{n.d(t,{q:()=>o});var r=n(88767),o=function(){var e=(0,r.useQueryClient)();return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.shouldInvalidateHomePagePosts,r=void 0!==n&&n,o=t.shouldInvalidateAllEvents,i=void 0!==o&&o;e.invalidateQueries("post-show"),e.invalidateQueries("posts"),e.invalidateQueries("space-show",{refetchInactive:!0}),i&&e.invalidateQueries(["all","events","calendar-view"]),r&&e.invalidateQueries("home-page-posts")}}},52520:(e,t,n)=>{n.d(t,{S:()=>o});var r=n(97012),o=function(e){var t=(0,r.wh)().currentCommunityMember;return!(!e||!t)&&(null===e||void 0===e?void 0:e.community_member_id)===(null===t||void 0===t?void 0:t.id)}},79051:(e,t,n)=>{n.d(t,{O:()=>i});var r=n(86013),o=n(8070),i=function(e){var t=e.startsAt,n=e.frequency,i=e.firstLetterCapital,a=void 0===i||i,s=e.frequencyFirstLetterCapital,l=void 0!==s&&s,c=e.includeRepeatsOn,u=void 0===c||c;if(!t||!n)return{label:""};var d=(0,o.E)({startsAt:t,firstLetterCapital:l}).find((function(e){return e.value===n})),m=(0,r.t)("events.recurring.".concat(a?"frequencies_capital_letter":"frequencies",".repeats"));return{label:d&&u?"".concat(m," ").concat(d.label):d.label}}},47144:(e,t,n)=>{n.d(t,{j:()=>a});var r=n(86013),o=n(72855),i=n(85893),a=function(e){var t=e.rsvpStatus;if(!t)return null;var n="yes"===t?"success":"default",a="yes"===t?(0,r.t)("events.rsvp.attending"):(0,r.t)("events.rsvp.not_attending");return(0,i.jsx)(o.O,{variant:n,children:a})}},44580:(e,t,n)=>{n.d(t,{t:()=>s});var r=n(86013),o=n(55675),i=n(16743),a=n(85893),s=function(e){var t=e.startRecordNumber,n=e.endRecordNumber,s=e.totalRecordCount,l=e.fetchPrevPage,c=e.fetchNextPage,u=e.hasPrevPage,d=e.hasNextPage;return(0,a.jsxs)("div",{className:"flex h-16 w-full items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-end",children:[(0,a.jsx)("div",{children:(0,a.jsx)(i.Z.LabelSm,{children:(0,r.t)("events.edit_modal.pagination.showing")})}),(0,a.jsx)("div",{className:"mx-1",children:(0,a.jsxs)(i.Z.LabelSm,{weight:"semibold",children:[t,"-",n]})}),(0,a.jsx)("div",{className:"mr-1",children:(0,a.jsx)(i.Z.LabelSm,{children:(0,r.t)("events.edit_modal.pagination.of")})}),(0,a.jsx)("div",{children:(0,a.jsx)(i.Z.LabelSm,{weight:"semibold",children:s})})]}),(u||d)&&(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(o.z,{variant:"secondary",type:"button",className:"mr-3",disabled:!u,onClick:l,children:(0,r.t)("events.edit_modal.pagination.previous")}),(0,a.jsx)(o.z,{variant:"secondary",type:"button",disabled:!d,onClick:c,children:(0,r.t)("events.edit_modal.pagination.next")})]})]})}},42155:(e,t,n)=>{n.d(t,{V:()=>m});var r=n(67294),o=n(86013),i=n(88767),a=n(1320),s=n(20557),l=n(21809),c=n(94997);function u(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return d(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var m=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c.a.PARTICIPANT,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,d=e||{},m=d.space_id,f=d.slug,p=(0,l.p)(),v=p.error,h=p.success,b=u((0,r.useState)(1),2),g=b[0],y=b[1],_=(0,i.useQuery)(s.a.eventAttendees.index({spaceId:m,slug:f,params:{page:g,role:t,per_page:n}}),{keepPreviousData:!0,enabled:!!e}),j=_.isLoading,x=_.isFetching,w=_.data,O=_.refetch,S=_.remove,P=(null===w||void 0===w?void 0:w.records)||[],C=null===w||void 0===w?void 0:w.count,k=null===w||void 0===w?void 0:w.total_confirmed_record_count,I=null===w||void 0===w?void 0:w.page_count,N=C?Math.ceil(C/10):0,A=g>1,E=!(null===w||void 0===w||!w.has_next_page),T=10*(g-1)+1,D=T+I-1,R=(0,i.useMutation)((function(t){return a.S1.bulkRsvp({event:e,params:t})}),{onSuccess:function(){y(1),S(),h((0,o.t)("events.edit_modal.people.add_attendees_success"))},onError:function(){v((0,o.t)("events.edit_modal.people.add_attendees_error"))}}),L=R.isLoading,M=R.mutateAsync;return{page:g,records:P,totalRecordCount:C,totalConfirmedRecordCount:k,pageRecordCount:I,pageCount:N,hasPrevPage:A,hasNextPage:E,startRecordNumber:T,endRecordNumber:D,isLoading:j,isFetching:x,isAdding:L,addAttendeesAsync:M,refetch:O,fetchNextPage:function(){y(g+1)},fetchPrevPage:function(){y(Math.max(g-1,1))},resetPage:function(){y(1)}}}},54168:(e,t,n)=>{n.d(t,{SA:()=>o,Bq:()=>i,E_:()=>a,Mj:()=>s,pd:()=>l,HA:()=>c,Q_:()=>u,a:()=>d,n4:()=>m});var r=n(86013),o={overview:(0,r.t)("events.edit_modal.overview.title"),people:(0,r.t)("events.edit_modal.people.title"),basicInfo:(0,r.t)("events.create.form.basic_info"),details:(0,r.t)("events.edit_modal.details.title"),notifications:(0,r.t)("events.edit_modal.notifications.title"),email:(0,r.t)("events.edit_modal.email.title"),advancedOptions:(0,r.t)("events.edit_modal.advanced_options.title")},i={VIRTUAL:"virtual",IN_PERSON:"in_person",TBD:"tbd",LIVE_STREAM:"live_stream",LIVE_ROOM:"live_room"},a={SINGLE:"single",RECURRING:"recurring"},s={FREE:"free",PAID:"paid"},l={ON:"on",NEVER:"never",AFTER:"after"},c={CURRENT:"current",REMAINING:"remaining",ALL:"all"},u={PUBLISHED:"published",DRAFT:"draft"},d={PARTICIPANT:"participant",COHOST:"cohost",HOST:"host"},m={ATTENDEES:"attendees",COHOSTS:"cohosts"}},1061:(e,t,n)=>{n.d(t,{mv:()=>a,s9:()=>s,f0:()=>l,dy:()=>c,L6:()=>u,UJ:()=>d,VL:()=>m,Rv:()=>f,yl:()=>p,hA:()=>v,H3:()=>h});var r=n(20073),o=n(11909),i=n(54168),a=function(e){return(null===e||void 0===e?void 0:e.status)===i.Q_.DRAFT},s=function(e){return(null===e||void 0===e?void 0:e.status)===i.Q_.PUBLISHED},l=function(e){return(null===e||void 0===e?void 0:e.event_type)===i.E_.RECURRING},c=function(e){var t;return(null===e||void 0===e||null===(t=e.event_setting_attributes)||void 0===t?void 0:t.location_type)===i.Bq.LIVE_ROOM},u=function(e){var t,n;return function(e){var t;return(null===e||void 0===e||null===(t=e.event_setting_attributes)||void 0===t?void 0:t.location_type)===i.Bq.LIVE_STREAM}(e)&&(null===e||void 0===e||null===(t=e.event_setting_attributes)||void 0===t||null===(n=t.live_stream_room_setting_attributes)||void 0===n?void 0:n.access_type)===o._d.PUBLIC_STREAM},d=function(e){return[i.Bq.LIVE_STREAM,i.Bq.LIVE_ROOM].includes(e)},m=function(e){var t;return(0,r.aA)(null===e||void 0===e||null===(t=e.event_setting_attributes)||void 0===t?void 0:t.ends_at)},f=function(e){var t;return e&&(0,r.aA)(null===e||void 0===e||null===(t=e.event_setting_attributes)||void 0===t?void 0:t.starts_at)},p=function(e){var t;return(null===e||void 0===e||null===(t=e.event_setting_attributes)||void 0===t?void 0:t.ticket_type)==i.Mj.PAID},v=function(e){var t;return e&&(null===e||void 0===e||null===(t=e.paywall_attributes)||void 0===t?void 0:t.published)},h=function(e){return l(e)&&!p(e)}},94997:(e,t,n)=>{n.d(t,{a:()=>r.a,E_:()=>r.E_,Bq:()=>r.Bq,n4:()=>r.n4,HA:()=>r.HA,pd:()=>r.pd,SA:()=>r.SA,Q_:()=>r.Q_,Mj:()=>r.Mj,hA:()=>o.hA,VL:()=>o.VL,Rv:()=>o.Rv,mv:()=>o.mv,UJ:()=>o.UJ,dy:()=>o.dy,yl:()=>o.yl,L6:()=>o.L6,s9:()=>o.s9,f0:()=>o.f0});var r=n(54168),o=n(1061)},36658:(e,t,n)=>{n.d(t,{G:()=>ir});var r=n(94184),o=n.n(r),i=n(97012),a=n(26953),s=n(55825),l=n(73793),c=n(14955),u=n(61926),d=n(86013),m=n(20633),f=n(16743),p=n(64687),v=n.n(p),h=n(67294),b=n(96486);function g(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}var y=function(){var e=(0,h.useRef)(null),t=function(){var t,n=(t=v().mark((function t(n,r){return v().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(0,b.isFunction)(e.current)){t.next=6;break}return t.next=3,e.current();case 3:if(t.sent){t.next=6;break}return t.abrupt("return");case 6:r(n);case 7:case"end":return t.stop()}}),t)})),function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(e){g(i,r,o,a,s,"next",e)}function s(e){g(i,r,o,a,s,"throw",e)}a(void 0)}))});return function(e,t){return n.apply(this,arguments)}}();return{validateAndSetCurrentSection:t,triggerValidationRef:e}},_=n(94997),j=n(85893),x=function(e){var t=e.isOpen,n=e.handleClose,r=e.isEditMode,o=(0,s.eW)(),i=o.currentSection,a=o.setCurrentSection,u=y().validateAndSetCurrentSection;return i===_.SA.overview?(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(l.x.HeaderContent,{children:(0,j.jsx)(f.Z.TitleSm,{truncate:!0,weight:"semibold",children:(0,d.t)("edit_event")})}),(0,j.jsx)(c.o,{onClick:n,isVisible:t,className:"!pr-0"})]}):(0,j.jsx)(l.x.HeaderContent,{children:(0,j.jsxs)("div",{className:"flex w-full items-center justify-between gap-2",children:[r&&(0,j.jsx)(m.h,{name:"16-arrow-left",onClick:function(){u(_.SA.overview,a)},ariaLabel:(0,d.t)("back")}),(0,j.jsx)(f.Z.TitleSm,{truncate:!0,weight:"semibold",children:r?(0,d.t)("edit_event"):(0,d.t)("events.create.title")}),(0,j.jsx)(c.o,{onClick:n,isVisible:t})]})})},w=n(55675),O=n(71032),S=n(77761);function P(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return C(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return C(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function C(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var k="events.edit.recurring_event_modal",I=function(e){var t=e.show,n=void 0!==t&&t,r=e.onConfirm,o=e.onCloseModal,i=e.isPublishing,a=void 0!==i&&i,s=e.showCurrentOptionOnly,l=e.shouldHideAllEventOption,c=P((0,h.useState)(),2),u=c[0],m=c[1],f=[{label:(0,d.t)("".concat(k,".this_event")),value:_.HA.CURRENT},{label:(0,d.t)("".concat(k,".this_and_following")),value:_.HA.REMAINING},{label:(0,d.t)("".concat(k,".all_events")),value:_.HA.ALL}],p=f.filter((function(e){return e.value!==_.HA.ALL})),v=f.filter((function(e){return e.value===_.HA.CURRENT})),b=(0,h.useMemo)((function(){var e=f;return s?e=v:l&&(e=p),e}),[s,l]);return(0,j.jsx)(O.c,{title:a?(0,d.t)("".concat(k,".title_publish")):(0,d.t)("".concat(k,".title")),isOpen:n,confirmText:(0,d.t)("".concat(k,".accept")),cancelText:(0,d.t)("".concat(k,".cancel")),onClose:o,onCancel:o,onConfirm:function(){r(u)},size:"sm",children:(0,j.jsx)("div",{className:"mt-6",children:(0,j.jsx)(S.S,{defaultChecked:_.HA.CURRENT,name:"recurring_event_settings.frequency_edit",options:b,size:"sm",onChange:function(e){m(e)}})})})},N=["onEditModeConfirm","isRecurringEvent","isPublishing","children","isStartsAtDirty","shouldHideAllEventOption"];function A(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function E(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?A(Object(n),!0).forEach((function(t){T(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):A(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function T(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function D(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return R(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return R(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function R(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function L(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var M=function(e){var t=e.onEditModeConfirm,n=e.isRecurringEvent,r=void 0!==n&&n,o=e.isPublishing,i=void 0!==o&&o,a=e.children,s=e.isStartsAtDirty,l=e.shouldHideAllEventOption,c=L(e,N),u=D((0,h.useState)(!1),2),d=u[0],m=u[1];return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(w.z,E(E({type:"button",onClick:function(){r?m(!0):t(_.HA.CURRENT)}},c),{},{children:a})),(0,j.jsx)(I,{show:d,onConfirm:function(e){m(!1),t(e)},onCloseModal:function(){return m(!1)},isPublishing:i,showCurrentOptionOnly:s,shouldHideAllEventOption:l})]})},F=n(49326),U=n(30887),B=function(e){var t=e.event,n=e.isEventDraft,r=t||{},o=r.slug,i=r.space_slug;return(0,j.jsxs)("button",{type:"button",className:"flex cursor-pointer items-center whitespace-nowrap",onClick:function(){window.open((0,F.LM)({spaceSlug:i,slug:o}),"_blank")},children:[(0,j.jsx)(f.Z.LabelSm,{weight:"medium",children:(0,d.t)(n?"events.edit_modal.preview":"events.edit_modal.overview.view_event")}),(0,j.jsx)(U.JO,{type:"16-arrow-top-right",size:16})]})},z=function(e){var t=e.event,n=e.onPublish,r=e.className,i=(0,s.eW)().isSaving,a=(0,_.mv)(t);return(0,j.jsxs)(s.h4.Actions,{className:o()("justify-between px-5 pb-6 pt-2 md:justify-end md:p-0",r),children:[t&&(0,j.jsx)(B,{event:t,isEventDraft:a}),a&&(0,j.jsx)(M,{variant:"circle",disabled:i,onEditModeConfirm:n,isRecurringEvent:(0,_.f0)(t),isPublishing:!0,children:(0,d.t)("events.edit_modal.buttons.publish")})]})},H=n(12939),q=function(e){var t=e.onChangeSection,n=(0,s.eW)(),r=n.sections,o=n.currentSection,i=n.setCurrentSection,a=r.map((function(e){return{value:e,label:e}}));return(0,j.jsx)(s.h4.Actions,{className:"items-center justify-center",children:(0,j.jsx)(H.S,{value:o,onChange:function(e){t(e,i)},options:a})})},Z=n(39834),V=n(97957);function W(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Q(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?W(Object(n),!0).forEach((function(t){$(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):W(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function $(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var G=function(e){var t=e.event,n=e.isCreating,r=e.isEditMode,o=e.actionsProps,i=(0,s.eW)().title,l=(0,_.s9)(t)?(0,d.t)("events.badge_status.published"):(0,d.t)("events.badge_status.draft");return(0,a.kK)()?(0,j.jsxs)("div",{className:"flex w-full flex-col gap-4 px-5 py-4",children:[(0,j.jsxs)("div",{className:"flex items-center justify-between",children:[r&&(0,j.jsx)(Z.g,{label:l}),r&&(0,j.jsx)(z,Q(Q({},o),{},{className:"inline-flex lg:hidden"}))]}),(0,j.jsx)(f.Z.TitleSm,{truncate:!0,weight:"semibold",children:i})]}):(0,j.jsxs)("div",{className:"flex w-full min-w-0 items-center justify-between gap-4",children:[(0,j.jsx)(V.Y,{className:"flex",children:!n&&i&&(0,j.jsxs)("div",{className:"flex items-center gap-2",children:[(0,j.jsx)(f.Z.TitleSm,{truncate:!0,weight:"semibold",children:i}),(0,j.jsx)("div",{className:"flex items-center",children:r&&(0,j.jsx)(Z.g,{label:l})})]})}),r&&(0,j.jsx)(z,Q(Q({},o),{},{className:"lg:hidden"}))]})};function J(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function K(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?J(Object(n),!0).forEach((function(t){Y(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):J(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var X=function(e){var t=e.isOpen,n=e.isEditMode,r=e.isCreating,o=e.event,i=e.onPublish,s=e.validateAndSetCurrentSection,c=e.handleClose,u={event:o,isEditMode:n,onPublish:i};return(0,a.kK)()?(0,j.jsx)(x,{isOpen:t,isEditMode:n,handleClose:c}):(0,j.jsxs)(l.x.HeaderContent,{children:[(0,j.jsx)(G,{event:o,isCreating:r,isEditMode:n,actionsProps:u}),n&&(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(l.x.HeaderContent.Navigation,{children:(0,j.jsx)(q,{event:o,onPublish:i,onChangeSection:s})}),(0,j.jsx)(z,K(K({},u),{},{className:"hidden lg:flex"}))]})]})},ee=n(87536),te=n(46367),ne=["children","name","rules","tooltipText","hidePlaceholder","placeholder","inlineReverse","translationRoot","hideLabel","className"];function re(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function oe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?re(Object(n),!0).forEach((function(t){ie(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):re(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ie(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ae(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var se=function(e){var t=e.children,n=e.name,r=e.rules,o=void 0===r?{}:r,i=e.tooltipText,a=e.hidePlaceholder,s=void 0!==a&&a,l=e.placeholder,c=e.inlineReverse,d=void 0!==c&&c,m=e.translationRoot,f=void 0===m?"events.edit_modal":m,p=e.hideLabel,v=void 0!==p&&p,h=e.className,b=void 0===h?"":h,g=ae(e,ne);return(0,j.jsx)(u.l.Item,oe(oe({name:n,hideDescription:!0,translationRoot:f,rules:o,hideBorder:!0,fullWidth:!0,hidePlaceholder:s,placeholder:l,tooltipText:i,inlineReverse:d,hideLabel:v,className:b},g),{},{children:t}))},le=function(){return(0,j.jsx)("div",{className:"w-[100px]",children:(0,j.jsx)(u.l.Item,{name:"event_setting_attributes.rsvp_limit",hideLabel:!0,hideBorder:!0,placeholder:(0,d.t)("events.edit_modal.event_setting_attributes.rsvp_limit_placeholder"),rules:{required:(0,d.t)("events.edit_modal.event_setting_attributes.rsvp_limit_required"),min:{value:1,message:(0,d.t)("events.edit_modal.event_setting_attributes.rsvp_limit_error")}},children:(0,j.jsx)(u.l.Input,{})})})},ce=function(e){var t=e.event,n=(0,ee.qo)({name:"event_setting_attributes.rsvp_limit_enabled",defaultValue:(null===t||void 0===t?void 0:t.event_setting_attributes.rsvp_limit_enabled)||!1});return(0,j.jsxs)("div",{className:"mb-6 md:mb-12",children:[(0,j.jsx)("div",{className:"mb-0 mt-6 md:mb-3 md:mt-8",children:(0,j.jsx)(f.Z.TitleMd,{children:(0,d.t)("events.edit_modal.advanced_options.attendees")})}),["hide_from_featured_areas","event_setting_attributes.rsvp_disabled","event_setting_attributes.hide_attendees","event_setting_attributes.rsvp_limit_enabled"].map((function(e){return(0,j.jsx)(se,{name:e,tooltipText:(0,d.t)("events.edit_modal.".concat(e,"_tooltip")),inlineReverse:!0,className:"!pb-0",children:(0,j.jsx)(u.l.ToggleSwitch,{variant:"small"})},e)})),n&&(0,j.jsx)(le,{})]})},ue=n(59393),de=n(74442),me=n(71299),fe=n(36883),pe=function(){return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)("div",{className:"md:mb-3",children:(0,j.jsx)(f.Z.TitleMd,{children:(0,d.t)("events.edit_modal.advanced_options.meta_tags")})}),(0,j.jsxs)("div",{className:"pb-4",children:[(0,j.jsx)(se,{name:"meta_tag_attributes.meta_title",hidePlaceholder:!0,label:(0,d.t)("events.edit_modal.meta_tag_attributes.meta_title"),tooltipText:(0,d.t)("events.edit_modal.meta_tag_attributes.meta_title_description",{obj:"event"}),children:(0,j.jsx)(u.l.Input,{})}),(0,j.jsx)(se,{name:"meta_tag_attributes.meta_description",hidePlaceholder:!0,label:(0,d.t)("events.edit_modal.meta_tag_attributes.meta_description"),tooltipText:(0,d.t)("events.edit_modal.meta_tag_attributes.meta_description_description"),children:(0,j.jsx)(u.l.Input,{variant:"textarea"})}),(0,j.jsx)(se,{name:"meta_tag_attributes.opengraph_title",hidePlaceholder:!0,label:(0,d.t)("events.edit_modal.meta_tag_attributes.opengraph_title"),tooltipText:(0,d.t)("events.edit_modal.meta_tag_attributes.opengraph_title_description",{obj:"event"}),children:(0,j.jsx)(u.l.Input,{})}),(0,j.jsx)(se,{name:"meta_tag_attributes.opengraph_description",hidePlaceholder:!0,label:(0,d.t)("events.edit_modal.meta_tag_attributes.opengraph_description"),tooltipText:(0,d.t)("events.edit_modal.meta_tag_attributes.opengraph_description_description"),children:(0,j.jsx)(u.l.Input,{variant:"textarea"})}),(0,j.jsx)("div",{className:"mt-4 grid grid-cols-1",children:(0,j.jsxs)("div",{className:"w-full",children:[(0,j.jsx)(de.Q,{field:"hide_location_from_non_attendees",label:(0,d.t)("events.edit_modal.meta_tag_attributes.opengraph_image"),description:" "}),(0,j.jsx)(me.D,{name:"meta_tag_attributes[opengraph_image]",alt:(0,d.t)("spaces.form.edit.options.seo.opengraph_image.label"),className:"relative",showAddCoverBtn:!0,aspectRatio:ue.pI.OPEN_GRAPH,changeImageText:(0,d.t)("spaces.form.edit.options.seo.opengraph_image.change"),customAddCoverBtn:(0,j.jsx)(fe.Z,{title:(0,d.t)("spaces.form.edit.options.seo.opengraph_image.add"),description:(0,d.t)("spaces.form.edit.options.seo.opengraph_image.description")})})]})})]})]})},ve=function(){return(0,j.jsxs)("div",{className:"mb-6 md:mb-12",children:[(0,j.jsx)("div",{className:"mb-0 mt-6 md:mb-3 md:mt-8",children:(0,j.jsx)(f.Z.TitleMd,{children:(0,d.t)("events.edit_modal.advanced_options.permissions")})}),["hide_meta_info","is_comments_disabled","is_liking_disabled"].map((function(e){return(0,j.jsx)(se,{name:e,tooltipText:(0,d.t)("events.edit_modal.".concat(e,"_tooltip")),inlineReverse:!0,className:"!pb-0",children:(0,j.jsx)(u.l.ToggleSwitch,{variant:"small"})},e)}))]})},he=function(e){var t=e.event;return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(f.Z.TitleXl,{children:(0,d.t)("events.edit_modal.advanced_options.title")}),(0,j.jsx)(ve,{}),(0,j.jsx)(ce,{event:t}),(0,j.jsx)(pe,{})]})},be=n(69589),ge=n(49646),ye=n(43548),_e=function(e){var t=e.event,n=e.canSelectTopics,r=e.canCreateTopics,o=e.requireTopicSelection,i=(0,be.m)().spaces,a=!!t,s=a?"w-full pr-0 md:pr-2 md:w-1/2":"w-full",l=n&&o?{required:(0,d.t)("events.create.form.topics_required_error")}:{required:!1};return(0,j.jsxs)("div",{className:"my-6 md:my-8",children:[(0,j.jsx)(f.Z.TitleMd,{children:(0,d.t)("events.create.form.event_name")}),(0,j.jsxs)("div",{className:"flex flex-col items-stretch gap-2 md:flex-row",children:[(0,j.jsx)("div",{className:s,children:(0,j.jsx)(se,{name:"name",rules:{required:(0,d.t)("events.create.form.name_required_error"),maxLength:{value:255,message:(0,d.t)("events.create.form.name_length_error")}},placeholder:(0,d.t)("events.create.form.name_placeholder"),translationRoot:"events.create.form",children:(0,j.jsx)(u.l.Input,{autoFocus:!0,"data-testid":"event-title"})})}),a&&(0,j.jsx)("div",{className:"w-full pl-0 md:w-1/2 md:pl-2",children:(0,j.jsx)(se,{name:"slug",hidePlaceholder:!0,rules:{maxLength:{value:255,message:(0,d.t)("events.create.form.slug_length_error")}},tooltipText:(0,d.t)("events.edit_modal.slug_tooltip",{url:window.location.origin}),children:(0,j.jsx)(u.l.Input,{})})})]}),(0,j.jsxs)("div",{className:"flex flex-col items-stretch md:flex-row",children:[(0,j.jsx)("div",{className:"w-full pr-0 md:w-1/2 md:pr-2",children:(0,j.jsx)(se,{name:"space_id",rules:{required:(0,d.t)("events.create.form.space_required_error")},translationRoot:"events.create.form",children:(0,j.jsx)(ye.M,{spaces:i,name:"space_id",variant:"form-input",dropdownClassName:"!top-[100%] -mt-1"})})}),(0,j.jsx)("div",{className:"w-full pl-0 md:w-1/2 md:pl-2",children:(0,j.jsx)(se,{name:"user_id",translationRoot:"events.create.form",children:(0,j.jsx)(u.l.CommunityMemberSelect,{name:"user_id",dropdownClassName:"!top-[93px]",direction:"down",valueField:"user_id",hideIcon:!0})})})]}),n&&(0,j.jsx)("div",{className:"flex flex-col items-stretch md:flex-row",children:(0,j.jsx)(se,{name:"topics",tooltipText:(0,d.t)("events.edit_modal.topics_tooltip"),rules:l,children:(0,j.jsx)(ge.w,{containerClassName:"bg-primary border-primary rounded-md border",name:"topics",creatable:r})})})]})},je=n(8070),xe=n(20073),we=n(58474),Oe=n(60208),Se=function(e){var t=e.event,n=(0,je.e)(),r=n.endsAtMaxDate,o=n.endsAfterMaxOccurrences,i=n.frequencyOptions,a=n.endingOptions,s=n.endsAtMinDate,l=n.endsOnValue,c=n.showRecurringFields,m=t&&(0,_.VL)(t),p=((0,_.mv)(t)||(0,_.s9)(t))&&(0,_.f0)(t);return(0,j.jsxs)("div",{className:"my-6 md:mb-8 md:mt-16",children:[(0,j.jsx)(f.Z.TitleMd,{children:(0,d.t)("events.create.form.date_and_time")}),(0,j.jsx)("div",{className:"flex flex-col items-stretch md:flex-row",children:(0,j.jsx)("div",{className:"w-full",children:(0,j.jsx)(se,{label:(0,d.t)("events.create_modal.event_setting_attributes.starts_at",{timeZone:(0,xe.ED)(xe.tq)}),translationRoot:"events.create.form",children:(0,j.jsx)(we.D,{startsAtConfig:{name:"event_setting_attributes.starts_at",minDate:new Date},endsAtConfig:{name:"event_setting_attributes.ends_at"},durationConfig:{name:"event_setting_attributes.duration_in_seconds"},disabled:m})})})}),(0,j.jsx)("div",{className:"flex items-stretch",children:(0,j.jsx)("div",{className:"w-full pr-0 md:w-1/2 md:pr-2",children:(0,j.jsx)(se,{name:"recurring_setting_attributes.frequency",translationRoot:"events.create.form",children:(0,j.jsx)(u.l.AnimatedSelect,{fullWidth:!0,options:i,disabled:!!t,dataTestId:"event-repeats"})})})}),(0,j.jsxs)("div",{className:"flex flex-col items-stretch md:flex-row",children:[c&&(0,j.jsx)("div",{className:"w-full pr-0 md:w-1/2 md:pr-2",children:(0,j.jsx)(se,{name:"recurring_setting_attributes.range_type",translationRoot:"events.create.form",children:(0,j.jsx)(u.l.AnimatedSelect,{fullWidth:!0,options:a,disabled:p,dataTestId:"event-ends"})})}),c&&(0,j.jsxs)("div",{className:"w-full pl-0 md:w-1/2 md:pl-2",children:[(!l||l===te.pd.ON)&&(0,j.jsx)("div",{className:"mt-0 flex items-end md:mt-7",children:(0,j.jsx)(se,{name:"recurring_setting_attributes.ends_at",hideLabel:!0,rules:{required:(0,d.t)("events.create.form.ends_at_required")},translationRoot:"events.create.form",children:(0,j.jsx)(Oe.x,{name:"recurring_setting_attributes.ends_at",minDate:new Date(s),maxDate:new Date(r),disabled:p,dataTestId:"recurring_event_ends_at",datePlaceholder:(0,d.t)("events.create.form.recurring_setting_attributes.date_placeholder"),timePlaceholder:(0,d.t)("events.create.form.recurring_setting_attributes.time_placeholder")})})}),l===te.pd.AFTER&&(0,j.jsx)("div",{className:"flex items-end",children:(0,j.jsx)("div",{className:"grow",children:(0,j.jsx)(se,{name:"recurring_setting_attributes.occurrences",rules:{required:(0,d.t)("events.create.form.occurrences_required"),max:{value:o,message:(0,d.t)("events.create.form.max_occurrences_error")}},translationRoot:"events.create.form",children:(0,j.jsx)(u.l.Input,{type:"number",min:1,max:o,autoFocus:!0,disabled:p,"data-testid":"event-occurrences",customOpacity:"70"})})})})]})]})]})},Pe=n(81196),Ce=function(){return(0,Pe.H)("location-picker-z-index-override"),(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(se,{name:"event_setting_attributes.in_person_location",variant:"extra-bottom-margin",translationRoot:"events.create.form",rules:{required:(0,d.t)("events.create_modal.event_setting_attributes.location_address_required_error")},children:(0,j.jsx)(u.l.LocationPicker,{autoFocus:!0})}),(0,j.jsx)(se,{name:"event_setting_attributes.hide_location_from_non_attendees",inlineReverse:!0,translationRoot:"events.create.form",children:(0,j.jsx)(u.l.ToggleSwitch,{variant:"small"})})]})},ke=n(42240),Ie=n(31256),Ne=n(11909),Ae=n(46027),Ee=n(1002),Te=function(e){var t=e.name,n=e.roomType,r=void 0===n?Ne.H0.STREAM:n,o=(0,be.m)().spaces,i=(0,Ie.oQ)().config,a=null===i||void 0===i?void 0:i.live_room_participants_capacity,s=(0,ee.Gc)(),l=s.control,c=s.getValues,u=s.setValue,m=c("space_id"),p=c("event_setting_attributes.ticket_type"),v=o.find((function(e){return e.id==m})),b=v?v.visibility:"open",g=[{value:Ne._d.SECRET,label:(0,d.t)("events.create.form.".concat(b,".access_type_secret")),description:(0,j.jsx)(f.Z.LabelSm,{children:(0,d.t)("events.create.form.".concat(b,".access_type_secret_label"))})}];p==_.Mj.FREE&&g.push({value:Ne._d.OPEN,label:(0,d.t)("events.create.form.".concat(b,".access_type_space")),description:(0,j.jsx)(f.Z.LabelSm,{children:(0,d.t)("events.create.form.".concat(b,".access_type_space_label"),{maxCapacity:a})})}),r===Ne.H0.STREAM&&p==_.Mj.FREE&&g.push({value:Ne._d.PUBLIC_STREAM,label:(0,d.t)("events.create.form.".concat(b,".access_type_public")),description:(0,j.jsx)(f.Z.LabelSm,{children:(0,d.t)("events.create.form.".concat(b,".access_type_public_label"))})}),(0,h.useEffect)((function(){"paid"==p&&u("event_setting_attributes.live_stream_room_setting_attributes.access_type",Ne._d.SECRET,{shouldDirty:!0})}),[p,u]);return(0,j.jsx)(ee.Qr,{control:l,name:t,render:function(e){var t=e.field,n=t.onChange,r=function(e){return g.find((function(t){return t.value===e}))}(t.value)||g[0];return(0,j.jsx)(Ee.Lt,{direction:"bottom-start",linkType:"button",button:(0,j.jsx)(Ee.Lt.MenuButton,{className:"form-control relative inline-block w-full text-left",children:(0,j.jsxs)("div",{className:"flex justify-between",children:[(0,j.jsx)("div",{className:"content-start",children:(0,j.jsx)(f.Z.LabelMd,{children:null===r||void 0===r?void 0:r.label})}),(0,j.jsx)("div",{className:"flex content-end",children:(0,j.jsx)(U.JO,{type:"cheveron-down"})})]})}),buttonClassName:"w-full",className:"relative w-full",size:Ee.wk.EXTRA_LARGE,onChange:n,options:g,labelWeight:"semibold"})}})},De=function(e){var t,n,r=e.recordingEnabled,o=e.showRecordingToggle,i=void 0!==o&&o,a=e.showAddonsLimits,s=void 0!==a&&a,l=e.roomTypeOverride,c=e.event,m=(0,Ie.tm)(),p=m.streamingHoursAvailable,v=m.recordingHoursAvailable,b=m.streamingTotalPlanHours,g=m.recordingTotalPlanHours,y=(0,Ae.n)().limitUrlSharingEnabled,x=!!c,w=(0,Ie.Yq)().currentQuantity,O=(0,Ie.$v)().currentQuantity,S=s&&P||s&&!p,P=r&&!v,C=(0,ee.Gc)(),k=C.watch,I=C.setValue,N=k("event_setting_attributes.live_stream_room_setting_attributes.access_type"),A=k("event_setting_attributes.ticket_type"),E=N===Ne._d.PUBLIC_STREAM,T="event_setting_attributes.live_stream_room_setting_attributes.limit_url_sharing",D=(0,h.useRef)(null===c||void 0===c||null===(t=c.event_setting_attributes)||void 0===t?void 0:t.ticket_type),R=x&&D.current==A?null===c||void 0===c||null===(n=c.event_setting_attributes)||void 0===n?void 0:n.live_stream_room_setting_attributes.limit_url_sharing:A===_.Mj.PAID;return(0,h.useEffect)((function(){N===Ne._d.PUBLIC_STREAM&&I(T,!1,{shouldDirty:!0})}),[N,I]),(0,h.useEffect)((function(){I(T,R,{shouldDirty:!0})}),[A,I]),(0,j.jsxs)(j.Fragment,{children:[(0,j.jsxs)("div",{className:"flex items-stretch",children:[(0,j.jsx)("div",{className:"w-1/2 pr-2",children:(0,j.jsx)(se,{name:"event_setting_attributes.live_stream_room_setting_attributes.view_type",labelClassName:"mb-3 text-lg",translationRoot:"events.create.form",children:(0,j.jsx)(ke.bW,{roomType:l})})}),(0,j.jsx)("div",{className:"w-1/2 pl-2",children:(0,j.jsx)(se,{name:"event_setting_attributes.live_stream_room_setting_attributes.access_type",labelClassName:"mb-3 text-lg",translationRoot:"events.create.form",children:(0,j.jsx)(Te,{roomType:l})})})]}),i&&(0,j.jsxs)("div",{className:"mt-4",children:[(0,j.jsx)(se,{name:"event_setting_attributes.live_stream_room_setting_attributes.recording_enabled",tooltipText:(0,d.t)("events.create_modal.event_setting_attributes.recording_enabled_tooltip"),inlineReverse:!0,translationRoot:"events.create.form",className:"!pt-1",labelClassName:"!font-normal",children:(0,j.jsx)(u.l.ToggleSwitch,{variant:"small"})}),r&&(0,j.jsx)(se,{name:"event_setting_attributes.live_stream_room_setting_attributes.auto_post_recording_enabled",tooltipText:(0,d.t)("events.create_modal.event_setting_attributes.auto_post_recording_enabled_tooltip"),inlineReverse:!0,translationRoot:"events.create.form",className:"!pt-1",labelClassName:"!font-normal",children:(0,j.jsx)(u.l.ToggleSwitch,{variant:"small"})}),(0,j.jsx)(se,{name:"event_setting_attributes.live_stream_room_setting_attributes.mute_on_join",inlineReverse:!0,translationRoot:"events.create.form",className:"!pt-1",labelClassName:"!font-normal",children:(0,j.jsx)(u.l.ToggleSwitch,{variant:"small"})})]}),(0,j.jsx)(se,{name:"event_setting_attributes.hide_location_from_non_attendees",inlineReverse:!0,translationRoot:"events.create.form",className:"!pt-1",labelClassName:"!font-normal",children:(0,j.jsx)(u.l.ToggleSwitch,{variant:"small"})}),y&&!E&&(0,j.jsx)(se,{name:T,translationRoot:"events.create.form",tooltipText:(0,d.t)("events.create_modal.event_setting_attributes.limit_url_sharing_tooltip"),inlineReverse:!0,className:"!pt-1",labelClassName:"!font-normal",children:(0,j.jsx)(u.l.ToggleSwitch,{variant:"small"})}),S?(0,j.jsxs)("div",{className:"mt-12",children:[P&&(0,j.jsx)("div",{className:"px-1 text-justify",children:(0,j.jsx)(f.Z.BodyXs,{children:(0,d.t)("live_streams.form.upgrade_recording_hours_label",{hours:g+w})})}),!p&&(0,j.jsx)("div",{className:"px-1 text-justify",children:(0,j.jsx)(f.Z.BodyXs,{children:(0,d.t)("live_streams.form.upgrade_streaming_hours_label",{hours:b+O})})})]}):null]})},Re=n(79599),Le=function(){return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(se,{name:"event_setting_attributes.virtual_location_url",rules:{required:(0,d.t)("events.create_modal.event_setting_attributes.virtual_location_required_error"),pattern:{value:Re.lu,message:(0,d.t)("events.create.form.virtual_location_url_error")}},translationRoot:"events.create.form",children:(0,j.jsx)(u.l.Input,{"data-testid":"url-event-location"})}),(0,j.jsx)(se,{name:"event_setting_attributes.hide_location_from_non_attendees",inlineReverse:!0,translationRoot:"events.create.form",children:(0,j.jsx)(u.l.ToggleSwitch,{variant:"small"})})]})},Me=n(18919),Fe=function(e){var t,n,r=e.setLocationType,o=e.event,i=!!o,a=(0,Me.Y)().setRecordingEnabled,s=(0,ee.Gc)().setValue,l=(0,ee.qo)({name:"event_setting_attributes.location_type"}),c=(0,ee.qo)({name:"event_setting_attributes.live_stream_room_setting_attributes.recording_enabled"}),u=(0,ee.qo)({name:"event_setting_attributes.ticket_type"}),d=(0,h.useRef)(null===o||void 0===o||null===(t=o.event_setting_attributes)||void 0===t?void 0:t.ticket_type),m=i&&d.current==u?null===o||void 0===o||null===(n=o.event_setting_attributes)||void 0===n?void 0:n.hide_location_from_non_attendees:u===_.Mj.PAID;(0,h.useEffect)((function(){[_.Bq.TBD,_.Bq.IN_PERSON].includes(l)||s("event_setting_attributes.hide_location_from_non_attendees",m,{shouldDirty:!0})}),[u,s,l]),(0,h.useEffect)((function(){r(l)}),[l,r]),(0,h.useEffect)((function(){return a(c)}),[c,a]);var f=l===_.Bq.LIVE_ROOM?Ne.H0.CONFERENCE:Ne.H0.STREAM;switch(l){case _.Bq.IN_PERSON:return(0,j.jsx)(Ce,{});case _.Bq.VIRTUAL:return(0,j.jsx)(Le,{});case _.Bq.LIVE_ROOM:case _.Bq.LIVE_STREAM:return(0,j.jsx)(De,{recordingEnabled:c,showRecordingToggle:!0,roomTypeOverride:f,event:o});case _.Bq.TBD:default:return null}},Ue=function(e){var t=e.event,n=e.setRecordingEnabled,r=e.setLocationType,o=(0,i.wh)().currentCommunity.supports_live_streams,a=[{label:(0,d.t)("events.create_modal.event_setting_attributes.location_type_in_person"),value:_.Bq.IN_PERSON},{label:(0,d.t)("events.create_modal.event_setting_attributes.location_type_virtual"),value:_.Bq.VIRTUAL},{label:(0,d.t)("events.create_modal.event_setting_attributes.location_type_live_stream"),value:_.Bq.LIVE_STREAM,hidden:!o},{label:(0,d.t)("events.create_modal.event_setting_attributes.location_type_live_room"),value:_.Bq.LIVE_ROOM,hidden:!o},{label:(0,d.t)("events.create_modal.event_setting_attributes.location_type_tbd"),value:_.Bq.TBD}];return(0,j.jsxs)("div",{className:"my-6 md:mb-8 md:mt-16",children:[(0,j.jsx)(f.Z.TitleMd,{children:(0,d.t)("events.create.form.event_location")}),(0,j.jsx)("div",{className:"flex items-stretch",children:(0,j.jsx)("div",{className:"w-full",children:(0,j.jsx)(se,{name:"event_setting_attributes.location_type",placeholder:(0,d.t)("events.create_modal.event_setting_attributes.location_type_placeholder"),rules:{required:(0,d.t)("events.create_modal.event_setting_attributes.location_required_error")},translationRoot:"events.create.form",children:(0,j.jsx)(u.l.AnimatedSelect,{fullWidth:!0,options:a,allowEmpty:!0,dataTestId:"event-location"})})})}),(0,j.jsx)(Fe,{setRecordingEnabled:n,setLocationType:r,event:t})]})},Be=n(98929),ze=n(6809),He=function(){return(0,j.jsx)("div",{className:"bg-tertiary mb-16 mt-5 flex h-[208px] w-full items-center justify-center rounded-xl",children:(0,j.jsxs)("div",{className:"flex w-[300px] flex-col space-y-6 text-center",children:[(0,j.jsx)(f.Z.LabelLg,{weight:"medium",children:(0,d.t)("events.create.form.connect_to_stripe_description")}),(0,j.jsx)("div",{className:"mx-6",children:(0,j.jsx)(ze.Q,{href:"/settings/paywalls",variant:"circle",full:!0,children:(0,d.t)("events.create.form.connect_to_stripe")})})]})})},qe=n(89761),Ze=n(91741),Ve=n(5295),We=n(649),Qe=n(61666),$e=function(e){var t=e.name,n=e.labelKey,r=e.placeholder,i=e.currency,a=e.isDisabled,s=(0,ee.Gc)().formState.errors[t];if(!i)return null;var l=(0,We.Bj)(i,{amountInCents:!0}),c=(0,d.t)("settings.paywalls.modal.tabs.pricing.add_price_modal.field_errors.amount",{min:(0,Qe.I)(i,i.min_charge_amount,{amountInCents:!0,includeCurrencyCode:!1}),max:(0,Qe.I)(i,i.max_charge_amount,{amountInCents:!0,includeCurrencyCode:!1})});return(0,j.jsx)(u.l.Item,{name:t,className:o()({"border-red-500":s},"m-0 grow"),label:(0,d.t)("events.create.form.paywall_attributes.".concat(n)),placeholder:r||l(0),rules:{validate:{bounds:function(e){var t=(0,We.LG)(e);return!isNaN(t)&&t>=(null===i||void 0===i?void 0:i.min_charge_amount)&&t<=(null===i||void 0===i?void 0:i.max_charge_amount)||c}}},transformValue:l,labelClassName:"mb-2 text-sm font-semibold leading-5 tighter normal-case text-dark",labelWrapperClassName:"m-0",errorClassName:"mt-1 text-red-500 text-sm",hideDescription:!0,hideBorder:!0,children:(0,j.jsx)(u.l.Input,{"data-testid":"ticket-price",disabled:a})})},Ge=function(e){var t,n=e.event,r=(0,ee.Gc)().watch,o=!!n,i=n&&(0,_.Rv)(n),a=r("event_setting_attributes.ticket_type"),s=(0,_.yl)(n)||"paid"==a,l=(0,_.hA)(n),c=o&&s&&l&&!(0,_.mv)(n)||i||(0,_.f0)(n),m=r("paywall_attributes.currency_id")||(null===n||void 0===n||null===(t=n.paywall_attributes)||void 0===t?void 0:t.currency_id),f=(0,Ze.K)(),p=f.data;if(f.isLoading)return(0,j.jsx)(Ve.a,{});var v=null===p||void 0===p?void 0:p.find((function(e){return e.id.toString()===(null===m||void 0===m?void 0:m.toString())}));return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsxs)("div",{className:"flex flex-col items-stretch md:flex-row",children:[(0,j.jsx)("div",{className:"w-full pr-0 md:w-1/2 md:pr-2",children:(0,j.jsx)($e,{name:"paywall_attributes.price_amount",labelKey:"price",currency:v,placeholder:(0,d.t)("events.create.form.paywall_attributes.price_placeholder"),isDisabled:i})}),(0,j.jsx)("div",{className:"w-full pl-0 md:w-1/2 md:pl-2",children:(0,j.jsx)(qe.H,{formItemName:"paywall_attributes.currency_id",formItemTranslationRoot:"events.create.form",disabled:c,markDefaultCurrencyDirty:!0})})]}),(0,j.jsx)("div",{className:"flex flex-col items-stretch",children:(0,j.jsx)(se,{name:"paywall_attributes.description",rules:{maxLength:{value:16777215,message:(0,d.t)("events.create.form.paywall_attributes.description_length_error")}},placeholder:(0,d.t)("events.create.form.paywall_attributes.description_placeholder"),translationRoot:"events.create.form",children:(0,j.jsx)(u.l.TextArea,{"data-testid":"event-paywall-description",disabled:i})})})]})},Je=function(e){var t=e.event,n=(0,i.wh)().currentCommunity,r=(0,ee.qo)({name:"event_setting_attributes.ticket_type"});return r===_.Mj.FREE?(0,j.jsx)("null",{}):r!==_.Mj.PAID||(0,Be.qF)(n)?(0,j.jsx)(Ge,{event:t}):(0,j.jsx)(He,{})},Ke=function(e){var t=e.event,n=(0,ee.Gc)().watch,r=(0,_.Rv)(t)||(0,_.f0)(t),o=n("event_setting_attributes.ticket_type"),i=n("event_setting_attributes.location_type"),a=o==_.Mj.PAID&&[_.Bq.LIVE_STREAM,_.Bq.LIVE_ROOM].includes(i),s=[{label:(0,d.t)("events.create_modal.event_setting_attributes.free_event"),value:_.Mj.FREE},{label:(0,d.t)("events.create_modal.event_setting_attributes.paid_event"),value:_.Mj.PAID}];return(0,j.jsxs)("div",{className:"my-6 md:mb-8 md:mt-16",children:[(0,j.jsx)(f.Z.TitleMd,{children:(0,d.t)("events.create.form.event_ticket")}),(0,j.jsx)("div",{className:"flex items-stretch",children:(0,j.jsx)("div",{className:"w-full",children:(0,j.jsx)(se,{name:"event_setting_attributes.ticket_type",placeholder:(0,d.t)("events.create_modal.event_setting_attributes.ticket_type_placeholder"),rules:{required:(0,d.t)("events.create_modal.event_setting_attributes.ticket_type_required_error")},translationRoot:"events.create.form",children:(0,j.jsx)(u.l.AnimatedSelect,{fullWidth:!0,options:s,dataTestId:"event-ticket-type",disabled:r})})})}),a&&(0,j.jsxs)("div",{className:"bg-tertiary my-2.5 flex h-14 w-full flex-none items-center justify-start gap-x-3 rounded-lg",children:[(0,j.jsx)(U.JO,{type:"24-info",size:24,className:"ms-3"}),(0,j.jsx)(f.Z.LabelSm,{color:"bg-tertiary",children:(0,d.t)("events.create.form.event_setting_attributes.live_stream_room_setting_attributes.paid_event_warning_msg")})]}),(0,j.jsx)(Je,{event:t})]})};function Ye(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return Xe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Xe(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Xe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function et(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function tt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var nt=function(e){var t,n,r=(0,i.wh)().currentCommunity,o=(0,ee.Gc)(),a=o.setValue,s=o.getValues,l=(0,h.useRef)(null===e||void 0===e||null===(t=e.event_setting_attributes)||void 0===t?void 0:t.location_type),c=null===(n=s().event_setting_attributes)||void 0===n?void 0:n.location_type,u=(0,be.m)().spaces,d=(0,ee.qo)({name:"space_id"}),m=(null===u||void 0===u?void 0:u.find((function(e){return e.id===d})))||null,f=["private","secret"].includes(null===m||void 0===m?void 0:m.visibility)?Ne._d.SECRET:Ne._d.OPEN,p=(0,h.useMemo)((function(){var t;return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?et(Object(n),!0).forEach((function(t){tt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):et(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({access_type:f,view_type:Ne.Bk.GRID,recording_enabled:r.live_stream_recording_enabled,auto_post_recording_enabled:r.live_stream_auto_post_recording_enabled,room_type:Ne.H0.STREAM},null===e||void 0===e||null===(t=e.event_setting_attributes)||void 0===t?void 0:t.live_stream_room_setting_attributes)}),[r,e,f]);return(0,h.useEffect)((function(){(0,_.UJ)(c)&&l.current!==c&&(Object.entries(p).forEach((function(e){var t=Ye(e,2),n=t[0],r=t[1];a("event_setting_attributes.live_stream_room_setting_attributes.".concat(n),r,{shouldDirty:!0,shouldTouch:!0})})),l.current=c)}),[c,p,a]),{space:m}},rt=function(e){var t=e.event,n=e.setLocationType,r=nt(t).space,o=(0,i.wh)(),a=o.currentCommunitySettings,s=o.currentCommunityMember,l=a||{},c=l.paid_event_phase1_enabled,u=l.paid_event_phase2_enabled,m=l.event_topics_enabled,p=(s||{}).is_admin,v=p&&c,h=(0,ee.qo)({name:"recurring_setting_attributes.frequency"}),b=!!u||!h;return(0,j.jsxs)(j.Fragment,{children:[t&&(0,j.jsx)(f.Z.TitleXl,{children:(0,d.t)("events.create.form.basic_info")}),(0,j.jsx)(_e,{event:t,canSelectTopics:m,canCreateTopics:p,requireTopicSelection:null===r||void 0===r?void 0:r.require_topic_selection}),(0,j.jsx)(Se,{event:t}),(0,j.jsx)(Ue,{event:t,setLocationType:n}),v&&b&&(0,j.jsx)(Ke,{event:t})]})},ot=n(61989),it=function(){return(0,j.jsxs)("div",{className:"create-event-details__cover-image",children:[(0,j.jsx)("label",{children:(0,d.t)("events.create.form.cover_image")}),(0,j.jsx)(me.D,{name:"cover_image",alt:"",customAspectRatioHelpText:(0,d.t)("image_upload.recommended_size_event_cover"),showAddCoverBtn:!0,customAddCoverBtn:(0,j.jsxs)("div",{className:"create-event-details__cover-image-add",children:[(0,j.jsx)("div",{className:"create-event-details__cover-image-add__icon-wrapper",children:(0,j.jsx)(U.JO,{type:"plus-big",viewBox:"0 0 20 20"})}),(0,j.jsx)("span",{className:"text-dark font-semibold",children:(0,d.t)("events.create.form.cover_image_upload")}),(0,j.jsx)("span",{className:"text-light mt-1 text-sm",children:(0,d.t)("events.create.form.event_cover_image_recommended_size")})]})})]})},at=function(){var e=(0,h.useRef)();return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(f.Z.TitleXl,{children:(0,d.t)("events.edit_modal.details.title")}),(0,j.jsxs)("div",{className:"my-8",children:[(0,j.jsx)(f.Z.TitleMd,{children:(0,d.t)("events.edit_modal.details.cover_image")}),(0,j.jsx)(it,{})]}),(0,j.jsxs)("div",{className:"mb-8 mt-6 md:mt-12",children:[(0,j.jsx)(f.Z.TitleMd,{children:(0,d.t)("events.edit_modal.details.description")}),(0,j.jsx)(se,{name:"body",hideLabel:!0,children:(0,j.jsx)("div",{className:"trix-v2 event-description-wrapper trix-v2--modal-3 mt-2",children:(0,j.jsx)(ot.O,{placeholder:(0,d.t)("events.edit_modal.details.description_placeholder"),id:"event-details-body",ref:e,name:"body"})})})]})]})},st=n(51420),lt=n(20336),ct=n(26022),ut=n(52701),dt=n(41910),mt=n(48895),ft=n(76207),pt=n(78573);function vt(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}var ht=function(e){var t=e.shouldShowConfirmationModal,n=e.toggleConfirmationModal,r=e.handleSubmit,o=e.isLoading,i=function(){var e,t=(e=v().mark((function e(){return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r();case 2:n();case 3:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){vt(i,r,o,a,s,"next",e)}function s(e){vt(i,r,o,a,s,"throw",e)}a(void 0)}))});return function(){return t.apply(this,arguments)}}();return(0,j.jsx)(pt.W,{isOpen:t,onClose:n,onAction:i,actionText:(0,d.t)("scheduled_emails.delete.email"),title:(0,d.t)("scheduled_emails.delete.modal_title"),size:"sm",actionVariant:"danger",disabled:o,children:(0,j.jsx)("div",{className:"my-4 text-center",children:(0,d.t)("scheduled_emails.delete.modal_description")})})};function bt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return gt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return gt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function gt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var yt=function(){var e=bt((0,h.useState)(!1),2),t=e[0],n=e[1];return{isOpen:t,openModal:function(){n(!0)},closeModal:function(){n(!1)}}},_t=n(88767),jt=(0,h.createContext)({scheduledEmailList:[],isLoading:!1,hasScheduledEmails:function(){return!1},refetch:function(){return new Promise((function(e){return e}))}});jt.displayName="ScheduledEmailContext";var xt=function(e){var t=e.recordID,n=e.children,r=(0,ft.T)().getScheduledEmailList,o=(0,_t.useQuery)(["scheduled-email-list",t],(function(){return r({record_id:t,scheduled_email_type:"event"})})),i=o.data,a=o.isLoading,s=o.refetch,l={scheduledEmailList:(null===i||void 0===i?void 0:i.records)||[],isLoading:a,refetch:s,hasScheduledEmails:function(){var e;return!(null===i||void 0===i||null===(e=i.records)||void 0===e||!e.length)}};return(0,j.jsx)(jt.Provider,{value:l,children:n})},wt=function(){var e=(0,h.useContext)(jt);if(void 0===e)throw new Error("useScheduledEmailContext must be used within a ScheduledEmailProvider");return e};function Ot(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}function St(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){Ot(i,r,o,a,s,"next",e)}function s(e){Ot(i,r,o,a,s,"throw",e)}a(void 0)}))}}var Pt=function(e){var t=e.scheduledEmail,n=yt(),r=n.isOpen,o=n.closeModal,i=n.openModal,a=yt(),s=a.isOpen,l=a.closeModal,c=a.openModal,u=wt().refetch,f=(0,ft.T)(),p=f.destroyScheduledEmail,h=f.isDestroyLoading,b=function(){var e=St(v().mark((function e(){return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o(),e.next=3,null===u||void 0===u?void 0:u();case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),g=function(){var e=St(v().mark((function e(){return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p(t);case 2:return l(),e.next=5,null===u||void 0===u?void 0:u();case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsxs)(Ee.Lt,{direction:"bottom-end",menuButtonEl:"div",button:(0,j.jsx)(m.h,{name:"20-menu-dots-horizontal",iconClassName:"!text-default group-hover:!text-dark !w-5 !h-5",className:"group",variant:"secondary",iconSize:20,buttonSize:28,ariaLabel:(0,d.t)("events.event_actions"),dataTestId:"action-more"}),transitionWrapperClassName:"z-50",size:"small",children:[(0,j.jsx)(Ee.Lt.ItemWithLink,{onClick:i,linkType:"button",children:(0,d.t)("edit")}),(0,j.jsx)(Ee.Lt.ItemWithLink,{onClick:c,linkType:"button",children:(0,j.jsx)("span",{className:"text-v2-danger",children:(0,d.t)("delete")})})]}),(0,j.jsx)(dt.D,{isOpen:r,onClose:b,scheduledEmail:t}),(0,j.jsx)(ht,{shouldShowConfirmationModal:s,toggleConfirmationModal:l,handleSubmit:g,isLoading:h})]})},Ct=function(e){var t=e.scheduledEmail,n=t.scheduled_at,r=t.metadata,o=t.subject,i=r.send_to;return(0,j.jsxs)("div",{className:"border-primary flex items-center gap-3 border-b py-4",children:[(0,j.jsx)("div",{className:"bg-tertiary flex h-12 w-12 items-center justify-center rounded-lg",children:(0,j.jsx)(U.JO,{type:"16-email",size:16})}),(0,j.jsxs)("div",{className:"grow",children:[(0,j.jsx)(f.Z.LabelMd,{weight:"semibold",children:o}),(0,j.jsxs)("div",{children:[(0,j.jsxs)(f.Z.LabelSm,{weight:"medium",children:[(0,d.t)("events.edit_modal.email.to",{send_to:i}),(0,d.t)("events.edit_modal.email.separator")]}),(0,j.jsx)(f.Z.LabelSm,{weight:"medium",color:"text-v2-warning",children:(0,d.t)("events.edit_modal.email.scheduled_at",{scheduled_at:n&&(0,mt.w)({dateTime:new Date(n),format:mt.f.short_date_at_short_time})})})]})]}),(0,j.jsx)(Pt,{scheduledEmail:t})]})},kt=function(){var e=wt(),t=e.isLoading,n=e.scheduledEmailList;return t?(0,j.jsx)(Ve.a,{}):n&&0!==n.length?(0,j.jsx)(j.Fragment,{children:n.map((function(e){return(0,j.jsx)(Ct,{scheduledEmail:e},e.id)}))}):null};function It(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}function Nt(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){It(i,r,o,a,s,"next",e)}function s(e){It(i,r,o,a,s,"throw",e)}a(void 0)}))}}var At="event_setting_attributes.send_email_reminder",Et=function(e){var t,n,r,o=e.event,i=yt(),a=i.isOpen,s=i.openModal,l=i.closeModal,c=wt(),m=c.refetch,p=c.hasScheduledEmails,b=(0,ee.Gc)(),g=b.getValues,y=b.setValue,_=(0,h.useMemo)((function(){return(0,st.AW)((0,d.t)("events.edit_modal.email.email_body_default_text",{event_name:o.name}).replace(/[{}]/g,(function(e){return"".concat(e).concat(e)})),[lt.Z,ct.Z,ut.Z])}),[o.name]),x=(0,xe.ZX)(null===o||void 0===o||null===(t=o.event_setting_attributes)||void 0===t||null===(n=t.starts_at)||void 0===n?void 0:n.toString(),-3600),O={record_id:String(null===o||void 0===o?void 0:o.id),scheduled_email_type:"event",scheduled_at:x,subject:(0,d.t)("events.edit_modal.email.default_subject",{event_name:o.name}),email_body:{body:_},metadata:{send_to:"going",email_type:"reminder"}},S=function(){var e=Nt(v().mark((function e(){var t,n,r;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l(),e.next=3,m();case 3:r=e.sent,0===(null===(t=r.data)||void 0===t||null===(n=t.records)||void 0===n?void 0:n.length)&&y(At,!1,{shouldDirty:!0});case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),P=function(){var e=Nt(v().mark((function e(){return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){return setTimeout(e,0)}));case 2:if(g(At)){e.next=5;break}return e.abrupt("return");case 5:if(!p()){e.next=7;break}return e.abrupt("return");case 7:s();case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),C=null===o||void 0===o||null===(r=o.event_setting_attributes)||void 0===r?void 0:r.starts_at,k=C?new Date(C):void 0;return(0,j.jsxs)("div",{className:"mb-6 md:mb-12",children:[(0,j.jsx)(f.Z.TitleXl,{children:(0,d.t)("events.edit_modal.email.long_title")}),(0,j.jsx)("div",{className:"md:my-3",children:(0,j.jsx)(se,{name:At,tooltipText:(0,d.t)("events.edit_modal.event_setting_attributes.send_email_reminder_tooltip"),inlineReverse:!0,className:"!pb-0",children:(0,j.jsx)(u.l.ToggleSwitch,{name:At,variant:"small",onClick:P})})}),(0,j.jsx)("div",{className:"mt-6 md:mb-3 md:mt-8",children:(0,j.jsx)(f.Z.TitleMd,{children:(0,d.t)("events.edit_modal.email.schedule")})}),(0,j.jsx)(kt,{}),(0,j.jsx)(w.z,{type:"button",variant:"secondary",onClick:s,className:"mt-4 min-w-[96px]",children:(0,d.t)("events.edit_modal.email.add_reminder")}),(0,j.jsx)(dt.D,{isOpen:a,onClose:S,scheduledEmail:O,maxDate:k})]})},Tt=function(e){var t=e.event;return(0,j.jsx)(xt,{recordID:null===t||void 0===t?void 0:t.id,children:(0,j.jsx)(Et,{event:t})})},Dt=n(96087),Rt=function(){return(0,j.jsxs)(Dt.t,{backgroundNone:!0,className:"!p-0 md:!px-4 md:!py-2",children:[(0,j.jsx)(se,{name:"event_setting_attributes.confirmation_message_title",hideLabel:!0,children:(0,j.jsx)(u.l.Input,{})}),(0,j.jsx)(se,{name:"event_setting_attributes.confirmation_message_description",hideLabel:!0,children:(0,j.jsx)(u.l.TextArea,{})}),(0,j.jsx)(se,{name:"event_setting_attributes.confirmation_message_button_title",hideLabel:!0,children:(0,j.jsx)(u.l.Input,{})}),(0,j.jsx)(se,{name:"event_setting_attributes.confirmation_message_button_link",hideLabel:!0,children:(0,j.jsx)(u.l.Input,{})})]})},Lt=function(e){var t=e.event,n=(0,ee.qo)({name:"event_setting_attributes.enable_custom_thank_you_message",defaultValue:(null===t||void 0===t?void 0:t.event_setting_attributes.enable_custom_thank_you_message)||!1});return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsxs)("div",{className:"mb-6 md:mb-12",children:[(0,j.jsx)(f.Z.TitleXl,{children:(0,d.t)("events.edit_modal.notifications.title")}),(0,j.jsx)("div",{className:"mt-6 md:mb-3 md:mt-8",children:(0,j.jsx)(f.Z.TitleMd,{children:(0,d.t)("events.edit_modal.notifications.publish")})}),(0,j.jsx)(se,{name:"event_setting_attributes.send_publish_email",tooltipText:(0,d.t)("events.edit_modal.event_setting_attributes.send_publish_email_tooltip"),inlineReverse:!0,className:"!pb-0",children:(0,j.jsx)(u.l.ToggleSwitch,{variant:"small"})}),(0,j.jsx)("div",{className:"mt-6 md:mb-3 md:mt-8",children:(0,j.jsx)(f.Z.TitleMd,{children:(0,d.t)("events.edit_modal.notifications.confirmation")})}),(0,j.jsx)(se,{name:"event_setting_attributes.send_email_confirmation",tooltipText:(0,d.t)("events.edit_modal.event_setting_attributes.send_email_confirmation_tooltip"),inlineReverse:!0,className:"!pb-0",children:(0,j.jsx)(u.l.ToggleSwitch,{variant:"small"})}),(0,j.jsx)(se,{name:"event_setting_attributes.send_in_app_notification_confirmation",tooltipText:(0,d.t)("events.edit_modal.event_setting_attributes.send_in_app_notification_confirmation_tooltip"),inlineReverse:!0,className:"!pb-0",children:(0,j.jsx)(u.l.ToggleSwitch,{variant:"small"})}),(0,j.jsx)(se,{name:"event_setting_attributes.enable_custom_thank_you_message",tooltipText:(0,d.t)("events.edit_modal.event_setting_attributes.enable_custom_thank_you_message_tooltip"),inlineReverse:!0,className:"!pb-0",children:(0,j.jsx)(u.l.ToggleSwitch,{variant:"small"})}),n&&(0,j.jsx)(Rt,{})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("div",{className:"md:mb-3",children:(0,j.jsx)(f.Z.TitleMd,{children:(0,d.t)("events.edit_modal.notifications.reminder")})}),(0,j.jsx)(se,{name:"event_setting_attributes.send_email_reminder",tooltipText:(0,d.t)("events.edit_modal.event_setting_attributes.send_email_reminder_tooltip"),inlineReverse:!0,className:"!pb-0",children:(0,j.jsx)(u.l.ToggleSwitch,{variant:"small"})}),(0,j.jsx)(se,{name:"event_setting_attributes.send_in_app_notification_reminder",tooltipText:(0,d.t)("events.edit_modal.event_setting_attributes.send_in_app_notification_reminder_tooltip"),inlineReverse:!0,className:"!pb-0",children:(0,j.jsx)(u.l.ToggleSwitch,{variant:"small"})})]})]})},Mt=n(73105),Ft=n(42155),Ut=function(e){var t=e.event,n=e.onClick,r=(0,Ft.V)(t,_.a.PARTICIPANT,3),o=r.records,i=r.totalRecordCount,a=i||(0,d.t)("events.edit_modal.overview.zero");return(0,j.jsxs)("button",{type:"button",className:"border-primary flex h-full w-full cursor-pointer flex-col justify-between rounded-lg border p-4",onClick:n,"aria-label":(0,d.t)("events.edit_modal.overview.rsvps"),children:[(0,j.jsxs)("div",{className:"mb-2 flex w-full items-start justify-between",children:[(0,j.jsx)(f.Z.LabelMd,{weight:"medium",color:"text-light",children:(0,d.t)("events.edit_modal.overview.rsvps")}),(0,j.jsx)(Mt.v,{users:o,totalCount:i,size:"md"})]}),(0,j.jsx)(f.Z.TitleMd,{children:a})]})},Bt=function(e){var t=e.event,n=e.onClick,r=(0,Ft.V)(t,_.a.COHOST,3),o=r.records,i=r.totalRecordCount,a=i||(0,d.t)("events.edit_modal.overview.zero");return(0,j.jsxs)("button",{type:"button",className:"border-primary flex h-full w-full cursor-pointer flex-col justify-between rounded-lg border p-4",onClick:n,"aria-label":(0,d.t)("events.edit_modal.overview.cohosts"),children:[(0,j.jsxs)("div",{className:"mb-2 flex w-full items-start justify-between",children:[(0,j.jsx)(f.Z.LabelMd,{weight:"medium",color:"text-light",children:(0,d.t)("events.edit_modal.overview.cohosts")}),(0,j.jsx)(Mt.v,{users:o,totalCount:i,size:"md"})]}),(0,j.jsx)(f.Z.TitleMd,{children:a})]})},zt=n(28772),Ht=n(38870),qt=function(e){var t=e.name,n=e.avatarUrl,r=e.email,o=e.rsvpDate,i=(0,zt.ie)(o,{year:"numeric",month:"short",day:"numeric"});return(0,j.jsxs)("tr",{children:[(0,j.jsxs)("td",{className:"flex items-center pt-6",children:[(0,j.jsx)("div",{className:"mr-4",children:(0,j.jsx)(Ht.s,{name:t,src:n,size:"8"})}),(0,j.jsx)(f.Z.LabelSm,{weight:"semibold",color:"text-dark",children:t})]}),(0,j.jsx)("td",{className:"hidden pt-6 md:[display:revert]",children:(0,j.jsx)(f.Z.LabelSm,{color:"text-light",children:r})}),(0,j.jsx)("td",{className:"pt-6",children:(0,j.jsx)(f.Z.LabelSm,{color:"text-light",children:i})})]})},Zt=function(){return(0,j.jsx)("div",{className:"flex h-64 w-full flex-col items-center justify-center",children:(0,j.jsx)(f.Z.TitleSm,{weight:"semibold",children:(0,d.t)("events.edit_modal.overview.empty_rsvp")})})},Vt=function(e){var t=e.event,n=(0,Ft.V)(t,_.a.PARTICIPANT,10),r=n.isLoading,o=n.records;return(0,j.jsxs)("div",{className:"border-primary w-full rounded-lg border p-4",children:[(0,j.jsx)(f.Z.LabelMd,{weight:"medium",color:"text-light",children:(0,d.t)("events.edit_modal.overview.latest_rsvps")}),(null===o||void 0===o?void 0:o.length)>0&&(0,j.jsxs)("table",{className:"mt-6 w-full",children:[(0,j.jsxs)("thead",{className:"text-xxs text-light uppercase",children:[(0,j.jsx)("th",{children:(0,d.t)("events.edit_modal.overview.name")}),(0,j.jsx)("th",{className:"hidden md:[display:revert]",children:(0,d.t)("events.edit_modal.overview.email")}),(0,j.jsx)("th",{children:(0,d.t)("events.edit_modal.overview.rsvp_date")})]}),(0,j.jsx)("tbody",{children:o.map((function(e){return(0,j.jsx)(qt,{name:e.name,avatarUrl:e.avatar_url,email:e.email,rsvpDate:e.rsvp_date},e.id)}))})]}),!r&&!(null!==o&&void 0!==o&&o.length)&&(0,j.jsx)(Zt,{})]})},Wt=n(70544),Qt=n(20640),$t=n.n(Qt),Gt=n(21809),Jt=function(e){var t=e.label,n=void 0===t?(0,d.t)("share_link.label"):t,r=e.link,o=void 0===r?window.location.href:r,i=(0,Gt.p)().success;return(0,j.jsxs)("button",{type:"button",className:"flex cursor-pointer items-center",onClick:function(){$t()(o),i((0,d.t)("share_link.copied"),{duration:"short",shouldUseProgress:!1})},children:[(0,j.jsx)(f.Z.LabelSm,{weight:"medium",children:n}),(0,j.jsx)(U.JO,{type:"16-copy",size:16,className:"ml-1","aria-hidden":!0})]})},Kt=function(e){var t=e.event||{},n=t.slug,r=t.space_slug,o=(0,F.LM)({spaceSlug:r,slug:n}),i="".concat(window.location.origin).concat(o);return(0,j.jsx)(Jt,{label:(0,d.t)("events.edit_modal.overview.copy_url"),link:i})},Yt=function(e){var t=e.event||{},n=t.share_uid,r=t.space_slug,o=(0,F.LM)({spaceSlug:r,slug:n}),i="".concat(window.location.origin).concat(o);return(0,j.jsx)(Jt,{label:(0,d.t)("events.edit_modal.overview.copy_public_url"),link:i})},Xt=function(e){var t,n,r,o=e.event,i=null===o||void 0===o||null===(t=o.event_setting_attributes)||void 0===t?void 0:t.live_stream_slug,a=null===o||void 0===o||null===(n=o.event_setting_attributes)||void 0===n||null===(r=n.live_stream_room_setting_attributes)||void 0===r?void 0:r.limit_url_sharing,s=F.dE.room({roomSlug:i}),l=window.location.origin,c=(0,Ae.n)().limitUrlSharingEnabled;return i?(0,j.jsxs)("div",{className:"flex",children:[c&&a?null:(0,j.jsx)(Jt,{label:(0,d.t)("events.edit_modal.overview.copy_live_room_url"),link:l+s}),(0,_.L6)(o)&&(0,j.jsx)("div",{className:"ml-3",children:(0,j.jsx)(Jt,{label:(0,d.t)("events.edit_modal.overview.copy_live_stream_url"),link:l+F.dE.publicRoom({roomSlug:i})})})]}):null},en=function(e){var t=e.event||{},n=t.slug,r=t.space_slug;return(0,j.jsxs)("button",{type:"button",className:"flex items-center",onClick:function(){window.open((0,F.LM)({spaceSlug:r,slug:n}),"_blank")},children:[(0,j.jsx)(f.Z.LabelSm,{weight:"medium",children:(0,d.t)("events.edit_modal.overview.view_event")}),(0,j.jsx)(U.JO,{type:"16-arrow-top-right",size:16,"aria-hidden":!0})]})},tn=function(e){var t=e.event,n=function(e){var t,n,r=(0,ee.Gc)(),o=r.formState.dirtyFields,i=(0,r.watch)(),a=i.name,s=i.event_setting_attributes,l=(null===o||void 0===o||null===(t=o.event_setting_attributes)||void 0===t?void 0:t.duration_in_seconds)||(null===o||void 0===o||null===(n=o.event_setting_attributes)||void 0===n?void 0:n.starts_at),c=e||{},u=c.event_setting_attributes,d=c.share_post_enabled,m=(null===s||void 0===s?void 0:s.starts_at)||(null===u||void 0===u?void 0:u.starts_at),f=l?(0,xe.ZX)(m,null===s||void 0===s?void 0:s.duration_in_seconds):null===u||void 0===u?void 0:u.ends_at,p=null===u||void 0===u?void 0:u.time_zone_abbreviations,v=null===u||void 0===u?void 0:u.time_zone,h=(0,Wt.N)(m,v);return{name:a,startsAt:m,endsAt:f,timeZoneAbbreviations:p,timeZone:v,dayOfMonth:h.dayOfMonth,shortMonthString:h.shortMonthString,sharePostEnabled:d}}(t),r=n.name,o=n.startsAt,i=n.endsAt,s=n.timeZoneAbbreviations,l=n.timeZone,c=n.dayOfMonth,u=n.shortMonthString,d=n.sharePostEnabled;return(0,a.kK)()?null:(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(f.Z.TitleXl,{children:r}),(0,j.jsx)("div",{className:"mt-4",children:(0,j.jsxs)("div",{className:"flex items-center",children:[(0,j.jsx)(U.JO,{type:"16-calendar",size:16,className:"mr-3"}),(0,j.jsx)(f.Z.LabelSm,{children:"".concat(u," ").concat(c," \xb7 ").concat((0,zt.Dk)(o,l)," - ").concat((0,zt.Dk)(i,l),"  ").concat(s)})]})}),(0,j.jsxs)("div",{className:"mt-7 flex items-center",children:[(0,j.jsx)("div",{className:"mr-3",children:(0,j.jsx)(en,{event:t})}),(0,j.jsx)("div",{className:"mr-3",children:(0,j.jsx)(Kt,{event:t})}),d&&(0,j.jsx)("div",{className:"mr-3",children:(0,j.jsx)(Yt,{event:t})}),(0,j.jsx)("div",{className:"mr-3",children:(0,j.jsx)(Xt,{event:t})})]})]})},nn=function(e){var t=e.event,n=(0,s.eW)().setCurrentSection,r=function(){return n(_.SA.people)};return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(tn,{event:t}),(0,j.jsxs)("div",{className:"my-4 flex flex-col items-stretch gap-4 md:my-6 md:flex-row",children:[(0,j.jsx)("div",{className:"w-full pr-0 md:w-1/2 md:pr-3",children:(0,j.jsx)(Ut,{event:t,onClick:r})}),(0,j.jsx)("div",{className:"w-full pl-0 md:w-1/2 md:pl-3",children:(0,j.jsx)(Bt,{event:t,onClick:r})})]}),(0,j.jsx)("div",{className:"mt-4 md:my-6",children:(0,j.jsx)(Vt,{event:t})})]})},rn=n(90846),on=n(1320),an=function(e){var t=function(e){var t=(0,Gt.p)(),n=t.success,r=t.error,o=(0,_t.useMutation)((function(){return on.S1.downloadCSV({event:e})}),{onSuccess:function(e){return n(null===e||void 0===e?void 0:e.message)},onError:function(){return r((0,d.t)("something_went_wrong"))}}).mutate;return function(e){e.preventDefault(),o()}}(e.event);return(0,j.jsxs)(w.z,{onClick:t,variant:"link",className:"!text-dark !flex !items-center !px-0 !text-sm !font-normal",children:[(0,j.jsx)("span",{className:"mr-2",children:(0,d.t)("events.edit_modal.people.download_csv")}),(0,j.jsx)(U.JO,{type:"download",size:20})]})},sn=n(53397),ln=function(){return(0,j.jsx)("div",{className:"mb-4",children:(0,j.jsx)(f.Z.LabelSm,{children:(0,d.t)("events.edit_modal.people.add_attendees_warning_message")})})},cn=function(e,t){var n=(0,Gt.p)(),r=n.success,o=n.error,i=(0,_t.useQueryClient)();return{removeCohostMutation:(0,_t.useMutation)((function(t){return on.S1.removeAttendeeById({event:e,attendeeId:t,forReactQuery:!0})}),{onSuccess:function(){r((0,d.t)("events.event_attendee_deleted")),i.invalidateQueries("events-people-cohost"),i.invalidateQueries("events-people-participant"),t&&t()},onError:function(){return o((0,d.t)("events.can_not_delete_event_attendee"))}})}},un=function(e){var t=e.event,n=e.attendeeId,r=e.onRemove,o=e.accessType,i=e.setSelectedAttendeeId,a=e.setShouldShowAttendeeRemovalConfirmation,s=cn(t,r).removeCohostMutation;return(0,j.jsx)(Ee.Lt,{direction:"bottom-end",className:"flex justify-end",button:(0,j.jsx)(Ee.Lt.MenuButton,{className:"invisible w-full group-hover:visible",children:(0,j.jsx)(U.JO,{type:"20-menu-3-dot",size:20,className:"text-dark"})}),children:(0,j.jsx)(Ee.Lt.Item,{onClick:function(){return e=n,void("invited"!=o&&(0,_.yl)(t)?(i(e),a(!0)):s.mutate(e));var e},children:(0,j.jsx)(Ee.Lt.ItemLink,{type:"button",children:(0,d.t)("remove_member")})})})},dn=n(71806),mn=n(53448),fn=function(e){var t=e.isOpen,n=void 0!==t&&t,r=e.onClose,o=e.removeAttendeeMutation,i=e.attendeeId;return(0,j.jsxs)(mn.u_,{title:(0,d.t)("events.rsvp.remove_member_modal.title"),isOpen:n,onClose:r,children:[(0,j.jsx)(mn.u_.Overlay,{}),(0,j.jsxs)(mn.u_.Content,{children:[(0,j.jsxs)(mn.u_.Header,{children:[(0,j.jsx)(mn.u_.Title,{size:"md",className:"text-center",children:(0,d.t)("events.rsvp.remove_member_modal.title")}),(0,j.jsx)(mn.u_.HeaderActions,{children:(0,j.jsx)(mn.u_.CloseButton,{onClick:r})})]}),(0,j.jsx)(mn.u_.Body,{children:(0,j.jsx)("div",{className:"px-6 pb-4 pt-5 text-center",children:(0,j.jsx)(f.Z.BodyMd,{size:"text-sm",children:(0,d.t)("events.rsvp.remove_member_modal.description")})})}),(0,j.jsxs)(mn.u_.Footer,{className:"space-y-2",children:[(0,j.jsx)(w.z,{variant:"danger",full:!0,large:!0,onClick:function(){return o(i),void r()},className:"h-10",children:(0,d.t)("events.rsvp.remove_member_modal.confirm_button")}),(0,j.jsx)(w.z,{variant:"secondary",full:!0,large:!0,onClick:r,className:"h-10",children:(0,d.t)("events.rsvp.remove_member_modal.decline_button")})]})]})]})},pn=n(47144);function vn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return hn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return hn(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function hn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var bn=function(e){var t=e.records,n=e.event,r=e.onChange,o=cn(n,r).removeCohostMutation,i=vn((0,h.useState)(null),2),a=i[0],s=i[1],l=vn((0,h.useState)(!1),2),c=l[0],u=l[1];if(null===t||void 0===t||!t.length)return null;return(0,j.jsxs)("div",{className:"flex w-full flex-col",children:[(null===t||void 0===t?void 0:t.length)>0&&(0,j.jsx)("hr",{}),null===t||void 0===t?void 0:t.map((function(e){var t,o,i=e.id,a=e.avatar_url,l=e.name,c=e.email,d=e.rsvp_date,m=e.rsvp_status,p=e.public_uid,v=e.access_type;return(0,j.jsxs)(h.Fragment,{children:[(0,j.jsxs)("div",{className:"hover:bg-secondary group flex h-14 items-center rounded-md px-2",children:[(0,j.jsx)("div",{className:"mr-3",children:(0,j.jsx)(dn.o,{member:{name:l,public_uid:p},children:(0,j.jsx)(Ht.s,{src:a,name:l,size:"8"})})}),(0,j.jsx)("div",{className:"w-1/2 shrink-0 md:w-1/3",children:(0,j.jsx)(dn.o,{member:{name:l,public_uid:p},children:(0,j.jsx)(V.Y,{children:(0,j.jsx)(f.Z.LabelSm,{weight:"semibold",children:l})})})}),(0,j.jsx)("div",{className:"hidden w-1/4 shrink-0 md:[display:revert]",children:(0,j.jsx)(V.Y,{children:(0,j.jsx)(f.Z.LabelSm,{children:c})})}),(0,j.jsx)("div",{className:"w-1/2 text-right md:w-1/4",children:(0,j.jsx)(f.Z.LabelSm,{children:(t=d,(0,zt.ie)(t,{day:"numeric",month:"long",year:"numeric",timeZone:o}))})}),(0,j.jsx)("div",{className:"mx-2 flex w-24 shrink-0 justify-end",children:(0,j.jsx)(pn.j,{rsvpStatus:m})}),(0,j.jsx)("div",{className:"flex-1",children:(0,j.jsx)(un,{event:n,attendeeId:i,onRemove:r,accessType:v,setSelectedAttendeeId:s,setShouldShowAttendeeRemovalConfirmation:u})})]}),(0,j.jsx)("hr",{})]},i)})),(0,_.yl)(n)&&(0,j.jsx)(fn,{isOpen:c,onClose:function(){return u(!1)},removeAttendeeMutation:o.mutate,attendeeId:a})]})},gn=n(44580);function yn(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}var _n=function(e){var t=e.event,n=(0,Ft.V)(t,_.a.PARTICIPANT),r=n.records,o=n.refetch,i=n.fetchPrevPage,a=n.fetchNextPage,s=n.hasPrevPage,l=n.hasNextPage,c=n.totalRecordCount,u=n.totalConfirmedRecordCount,m=n.addAttendeesAsync,p=n.startRecordNumber,h=n.endRecordNumber,b=(0,ee.Gc)().resetField,g=function(){var e,t=(e=v().mark((function e(t){var n,r,o,i;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==t&&void 0!==t&&null!==(n=t.spaces_ids)&&void 0!==n&&n.length||null!==t&&void 0!==t&&null!==(r=t.space_groups_ids)&&void 0!==r&&r.length||null!==t&&void 0!==t&&null!==(o=t.member_tags_ids)&&void 0!==o&&o.length||null!==t&&void 0!==t&&null!==(i=t.members_ids)&&void 0!==i&&i.length){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,m({invited_entities_ids:t});case 5:b("attendee_invite_attributes.invited_entities_ids"),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),console.error(e.t0);case 11:case"end":return e.stop()}}),e,null,[[2,8]])})),function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){yn(i,r,o,a,s,"next",e)}function s(e){yn(i,r,o,a,s,"throw",e)}a(void 0)}))});return function(e){return t.apply(this,arguments)}}();return(0,j.jsxs)("div",{className:"flex h-full flex-col items-stretch pt-4",children:[(0,j.jsxs)("div",{className:"flex w-full items-center justify-between",children:[(0,j.jsx)(f.Z.LabelMd,{weight:"semibold",children:"".concat(u||0," ").concat((0,d.t)("events.edit_modal.people.attendees"))}),(0,j.jsx)(se,{name:"attendee_invite_attributes.invited_entities_ids",className:"!w-auto",hideLabel:!0,children:(0,j.jsx)(sn.lH,{variant:sn.ZC.BUTTON,buttonLabel:(0,d.t)("events.edit_modal.people.add_attendees"),selectionLabel:(0,d.t)("events.edit_modal.people.attendees_selection_label"),searchPlaceholder:(0,d.t)("events.edit_modal.people.attendees_placeholder"),modalSaveButtonLabel:(0,d.t)("save"),onModalSave:g,renderAfterSelection:(0,j.jsx)(ln,{}),includeAllResultTypes:!0})})]}),(0,j.jsx)("div",{className:"mt-4"}),(null===r||void 0===r?void 0:r.length)>0&&(0,j.jsx)(bn,{event:t,records:r,fetchNextPage:a,hasNextPage:l,onChange:o}),c>0&&(0,j.jsx)(gn.t,{startRecordNumber:p,endRecordNumber:h,totalRecordCount:c,fetchPrevPage:i,fetchNextPage:a,hasPrevPage:s,hasNextPage:l})]})},jn=n(35103),xn=function(e){var t=e.setIsLimitReached,n=e.initialCohostQuantity,r=void 0===n?1:n,o=e.shouldDisplayDisabledSearchMessage,i=void 0!==o&&o,a=((0,jn.B)().selectionState||{}).memberCount+r||1,s=(0,Ie.oQ)().config,l=null===s||void 0===s?void 0:s.live_stream_max_host_capacity,c=a>=l;return(0,h.useEffect)((function(){l&&(a<=l-Ne.ln?t(!1):t(!0))}),[a,l]),(0,j.jsxs)("div",{className:"mb-4 text-center",children:[(0,j.jsx)("div",{children:(0,j.jsx)(f.Z.LabelSm,{weight:c?"medium":"normal",children:(0,d.t)("live_streams.room.cohosts_counter_message",{count:Math.min(a,l),hostCapacity:l})})}),i&&(0,j.jsx)("div",{children:(0,j.jsx)(f.Z.LabelSm,{children:(0,d.t)("live_streams.room.cohosts_disable_search_message")})})]})};function wn(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}function On(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return Sn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Sn(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Sn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Pn=function(e){var t=e.event,n=On((0,h.useState)(!1),2),r=n[0],o=n[1],i=(0,Ft.V)(t,_.a.COHOST),a=i.records,s=i.refetch,l=i.fetchPrevPage,c=i.fetchNextPage,u=i.hasPrevPage,m=i.hasNextPage,p=i.totalRecordCount,b=i.totalConfirmedRecordCount,g=i.addAttendeesAsync,y=i.startRecordNumber,x=i.endRecordNumber,w=(0,ee.Gc)().resetField,O=function(){var e,t=(e=v().mark((function e(t){return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==t&&void 0!==t&&t.length){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,g({community_member_ids:t,role:_.a.COHOST});case 5:w("attendee_invite_attributes.invited_cohost_ids"),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),console.error(e.t0);case 11:case"end":return e.stop()}}),e,null,[[2,8]])})),function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){wn(i,r,o,a,s,"next",e)}function s(e){wn(i,r,o,a,s,"throw",e)}a(void 0)}))});return function(e){return t.apply(this,arguments)}}(),S=function(e){var t=(0,(0,ee.Gc)().watch)().event_setting_attributes,n=(e||{}).event_setting_attributes;return{locationType:(null===t||void 0===t?void 0:t.location_type)||(null===n||void 0===n?void 0:n.location_type),formEventData:t,eventData:n}}(t),P=S.locationType,C=r,k=null===a||void 0===a?void 0:a.map((function(e){return e.community_member_id})),I=P===te.Bq.LIVE_STREAM||P===te.Bq.LIVE_ROOM;return(0,j.jsxs)("div",{className:"flex h-full flex-col items-stretch pt-4",children:[(0,j.jsxs)("div",{className:"flex w-full items-center justify-between",children:[(0,j.jsx)(f.Z.LabelMd,{weight:"semibold",children:"".concat(b||0," ").concat((0,d.t)("events.edit_modal.people.cohosts"))}),(0,j.jsx)(se,{name:"attendee_invite_attributes.invited_cohost_ids",className:"!w-auto",hideLabel:!0,children:(0,j.jsx)(sn.lH,{variant:sn.ZC.BUTTON,countLabel:(0,d.t)("events.edit_modal.people.cohosts_added_label"),selectionLabel:(0,d.t)("events.edit_modal.people.cohosts_selection_label"),searchPlaceholder:(0,d.t)("events.edit_modal.people.cohosts_placeholder"),disableSearch:C,excludedMemberIds:k,modalSaveButtonLabel:(0,d.t)("save"),allowCurrentCommunityMember:!0,onModalSave:O,renderAfterSelection:I?(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(ln,{}),(0,j.jsx)(xn,{setIsLimitReached:o,initialCohostQuantity:p+Ne.ln,shouldDisplayDisabledSearchMessage:C})]}):(0,j.jsx)(ln,{})})})]}),(0,j.jsx)("div",{className:"mt-4"}),(null===a||void 0===a?void 0:a.length)>0&&(0,j.jsx)(bn,{event:t,records:a,fetchNextPage:c,hasNextPage:m,onChange:s}),p>0&&(0,j.jsx)(gn.t,{startRecordNumber:y,endRecordNumber:x,totalRecordCount:p,fetchPrevPage:l,fetchNextPage:c,hasPrevPage:u,hasNextPage:m})]})},Cn=function(e){var t=e.event,n=e.currentTab;switch(null===n||void 0===n?void 0:n.key){case _.n4.COHOSTS:return(0,j.jsx)(Pn,{event:t});case _.n4.ATTENDEES:default:return(0,j.jsx)(_n,{event:t})}};function kn(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}function In(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return Nn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Nn(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Nn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var An=function(e){var t=[{label:(0,d.t)("events.edit_modal.people.attendees"),key:_.n4.ATTENDEES}];e||t.push({label:(0,d.t)("events.edit_modal.people.cohosts"),key:_.n4.COHOSTS});var n=t.find((function(e){return e.label===(0,d.t)("events.edit_modal.people.attendees")})),r=In((0,h.useState)(n),2),o=r[0],i=r[1],a=function(){var e,n=(e=v().mark((function e(n){var r;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=t.find((function(e){return e.label===n})),i(r);case 2:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){kn(i,r,o,a,s,"next",e)}function s(e){kn(i,r,o,a,s,"throw",e)}a(void 0)}))});return function(e){return n.apply(this,arguments)}}();return{tabs:t,currentTab:o,onTabClick:a}},En=function(e){var t=e.event,n=(0,_.dy)(t),r=An(n),o=r.onTabClick,i=r.currentTab,a=r.tabs,s=(null===i||void 0===i?void 0:i.key)===_.n4.ATTENDEES;return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(f.Z.TitleXl,{children:(0,d.t)("events.create.form.people")}),(null===i||void 0===i?void 0:i.label)&&(0,j.jsxs)("div",{className:"relative",children:[(0,j.jsx)(rn.m,{variant:"underline",className:"sticky",wrapperClassName:"overflow-x-auto overflow-y-hidden",controlled:!0,activeTab:i.label,onClick:o,options:a}),s&&(0,j.jsx)("div",{className:"absolute bottom-2 right-0",children:(0,j.jsx)(an,{event:t})})]}),(0,j.jsx)(Cn,{event:t,currentTab:i})]})},Tn=n(82111),Dn=function(e){var t,n,r,o=e.event,i=e.triggerValidationRef,a=e.setValueRef,l=e.setIsDirty,c=e.setLocationType,u=e.locationType,d=e.isLiveLocation,m=e.setStartsAtDirty,f=e.setPaywallAttributesDirty,p=(0,s.eW)().currentSection,v=(0,ee.Gc)(),b=v.trigger,g=v.setValue,y=v.formState.dirtyFields;(0,h.useEffect)((function(){i&&b&&(i.current=b)}),[i,b]),(0,h.useEffect)((function(){a&&g&&(a.current=g)}),[a,g]);var x=Object.values(y),w=!(null===y||void 0===y||null===(t=y.event_setting_attributes)||void 0===t||!t.starts_at),O=!(null===y||void 0===y||null===(n=y.paywall_attributes)||void 0===n||!n.price_amount)||!(null===y||void 0===y||null===(r=y.paywall_attributes)||void 0===r||!r.description);(0,h.useEffect)((function(){var e=null===x||void 0===x?void 0:x.some((function(e){return!!e}));l(e)}),[l,x]),(0,h.useEffect)((function(){m(w)}),[m,w]),(0,h.useEffect)((function(){f(O)}),[f,O]);var S=(0,Me.Y)().limitsReachedIsOpen;return(0,j.jsxs)(j.Fragment,{children:[d&&S&&(0,j.jsx)(Tn.l,{roomType:function(){switch(u){case te.Bq.LIVE_STREAM:return Ne.H0.STREAM;case te.Bq.LIVE_ROOM:return Ne.H0.CONFERENCE}}()}),(0,j.jsxs)("div",{className:"p-4 md:p-6 lg:py-8",children:[p===_.SA.overview&&(0,j.jsx)(nn,{event:o}),p===_.SA.people&&(0,j.jsx)(En,{event:o}),p===_.SA.basicInfo&&(0,j.jsx)(rt,{event:o,setLocationType:c}),p===_.SA.details&&(0,j.jsx)(at,{}),p===_.SA.notifications&&(0,j.jsx)(Lt,{event:o}),p===_.SA.email&&(0,j.jsx)(Tt,{event:o}),p===_.SA.advancedOptions&&(0,j.jsx)(he,{event:o})]})]})},Rn=function(e){var t=e.event,n=e.isCreating,r=e.isDirty,o=e.onSubmit,i=e.locationType,a=e.isStartsAtDirty,l=e.shouldHideAllEventOption,c=(0,s.eW)(),u=c.isSaving,m=c.onExit,f=(0,Me.Y)(),p=f.streamingHoursAvailable,v=f.limitsReachedOnOpen,h=f.recordingHoursReached,b=function(e){e.preventDefault(),v()},g=i===te.Bq.LIVE_STREAM||i===te.Bq.LIVE_ROOM;return(0,j.jsx)(j.Fragment,{children:!n&&(0,j.jsxs)("div",{className:"ml-auto flex space-x-4",children:[g&&!p&&h?(0,j.jsxs)("div",{className:"flex justify-start",children:[(0,j.jsx)("button",{type:"button",className:"mr-1 cursor-pointer underline",onClick:b,children:(0,d.t)("live_streams.form.two_upgrades")}),(0,j.jsx)("p",{children:(0,d.t)("live_streams.form.included")})]}):!g||p&&!h?null:(0,j.jsxs)("div",{className:"flex justify-start",children:[(0,j.jsx)("button",{type:"button",className:"mr-1 cursor-pointer underline",onClick:b,children:(0,d.t)("live_streams.form.one_upgrade")}),(0,j.jsx)("p",{children:(0,d.t)("live_streams.form.included")})]}),r&&(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(w.z,{type:"button",onClick:m,variant:"secondary",children:(0,d.t)("cancel")}),(0,j.jsx)(M,{type:"submit",variant:"circle",disabled:u,onEditModeConfirm:o,isRecurringEvent:(0,_.f0)(t),isStartsAtDirty:a,shouldHideAllEventOption:l,children:t?(0,d.t)("save_changes"):(0,d.t)("save_draft")})]})]})})},Ln=function(){return(0,j.jsxs)("div",{className:"flex flex-col items-center justify-center py-52",children:[(0,j.jsx)("div",{className:"override-svg-width",children:(0,j.jsx)(Ve.a,{})}),(0,j.jsx)("div",{className:"mb-4 text-center",children:(0,j.jsx)(f.Z.TitleMd,{children:(0,d.t)("events.create_modal.creating_event")})}),(0,j.jsx)("div",{className:"mb-4 text-center",children:(0,j.jsx)(f.Z.LabelMd,{children:(0,d.t)("events.create_modal.creating_event_message")})})]})},Mn={strategy:"fixed",modifiers:[{name:"offset",options:{offset:[0,-1]}}]},Fn=function(e){var t,n=e.event,r=function(e){var t,n=e||{},r=n.slug,o=n.space_slug,i=(0,Gt.p)().success,a=(0,F.LM)({spaceSlug:o,slug:r}),s="".concat(window.location.origin).concat(a),l=null===e||void 0===e||null===(t=e.event_setting_attributes)||void 0===t?void 0:t.live_stream_slug,c=F.dE.room({roomSlug:l}),u=window.location.origin;return{onViewEvent:function(){window.open(a,"_blank")},onCopyLink:function(e){$t()(e),i((0,d.t)("share_link.copied"),{duration:"short",shouldUseProgress:!1})},eventUrl:s,liveRoomUrl:"".concat(u).concat(c),publicLiveRoomUrl:"".concat(u).concat(F.dE.publicRoom({roomSlug:l}))}}(n),o=r.onViewEvent,i=r.onCopyLink,a=r.eventUrl,s=r.liveRoomUrl,l=null===n||void 0===n||null===(t=n.event_setting_attributes)||void 0===t?void 0:t.live_stream_slug,c=window.location.origin+F.dE.publicRoom({roomSlug:l}),u=(0,_.dy)(n)?(0,d.t)("events.edit_modal.overview.copy_live_room_url"):(0,d.t)("events.edit_modal.overview.copy_live_stream_url"),f=(0,_.dy)(n)?s:c,p=[{label:(0,d.t)("events.edit_modal.overview.view_event"),onClick:o,iconName:"16-arrow"},{label:(0,d.t)("events.edit_modal.overview.copy_url"),onClick:function(){return i(a)},iconName:"16-copy"},{label:u,onClick:function(){return i(f)},iconName:"16-copy",disabled:!l}];return(0,j.jsx)(Ee.Lt,{size:"medium",direction:"bottom-start",button:(0,j.jsx)(m.h,{name:"16-menu-dots-horizontal",className:"!text-dark",ariaLabel:(0,d.t)("options_dropdown")}),buttonWrapperClassName:"flex items-center ml-4",popperOptions:Mn,transitionWrapperClassName:"z-30",dataTestId:"user-profile",children:p.map((function(e){return(0,j.jsx)(h.Fragment,{children:!e.disabled&&(0,j.jsx)(Ee.Lt.ItemWithLink,{onClick:e.onClick,children:(0,j.jsxs)("div",{className:"text-dark flex items-center justify-between",children:[e.label,(0,j.jsx)(U.JO,{size:16,type:e.iconName,className:"text-dark"})]})})},e.label)}))})},Un=function(e){var t,n,r,o,i,a,l,c,u,m,p=e.validateAndSetCurrentSection,v=e.event,h=e.isEditMode,b=e.title,g=(0,s.eW)(),y=g.sections,x=g.setCurrentSection,w=g.currentSection,O=y.filter((function(e){return e!==_.SA.overview})).map((function(e){return{value:e,label:e}})),S=(0,_.s9)(v)?(0,d.t)("events.badge_status.published"):(0,d.t)("events.badge_status.draft"),P=null===v||void 0===v||null===(t=v.event_setting_attributes)||void 0===t?void 0:t.starts_at,C=(0,xe.ZX)(P,(null===v||void 0===v||null===(n=v.event_setting_attributes)||void 0===n?void 0:n.duration_in_seconds)||3600),k=w===_.SA.overview,I=(0,Wt.N)(P,null===v||void 0===v||null===(r=v.event_setting_attributes)||void 0===r?void 0:r.time_zone),N=I.dayOfMonth,A=I.shortMonthString,E=null===v||void 0===v||null===(o=v.event_setting_attributes)||void 0===o?void 0:o.time_zone_abbreviations,T="".concat(null!==(i=null===N||void 0===N?void 0:N.toString())&&void 0!==i?i:""," ").concat(null!==A&&void 0!==A?A:""," ").concat((0,zt.Dk)(null!==P&&void 0!==P?P:(new Date).toISOString(),null!==(a=null===v||void 0===v||null===(l=v.event_setting_attributes)||void 0===l?void 0:l.time_zone)&&void 0!==a?a:"")," - ").concat((0,zt.Dk)(null!==(c=C.toISOString())&&void 0!==c?c:(new Date).toISOString(),null!==(u=null===v||void 0===v||null===(m=v.event_setting_attributes)||void 0===m?void 0:m.time_zone)&&void 0!==u?u:""),",").concat(null!==E&&void 0!==E?E:"");return k?(0,j.jsxs)(j.Fragment,{children:[(0,j.jsxs)("div",{className:"mb-4 mt-5 flex flex-col gap-2 px-5",children:[(0,j.jsxs)("div",{className:"flex w-full items-center justify-between",children:[h&&(0,j.jsx)(Z.g,{label:S}),(0,j.jsx)(Fn,{event:v})]}),(0,j.jsx)(f.Z.TitleSm,{truncate:!0,weight:"semibold",children:b}),(0,j.jsx)(f.Z.LabelSm,{weight:"font-semibold",children:T})]}),(0,j.jsx)("div",{className:"flex flex-col px-5",children:O.map((function(e){return(0,j.jsxs)("button",{type:"button",className:"border-b-primary text-default flex items-center justify-between border-b py-3 text-sm",onClick:function(){return t=e.value,void p(t,x);var t},children:[e.label,(0,j.jsx)(U.JO,{size:16,type:"16-chevron-right",className:"text-default h-4 w-4"})]},e.label)}))})]}):null},Bn=n(28607);function zn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Hn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?zn(Object(n),!0).forEach((function(t){qn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):zn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function qn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Zn=n(24185),Vn=n(52942);function Wn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Qn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Wn(Object(n),!0).forEach((function(t){$n(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Wn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function $n(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Gn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Jn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Gn(Object(n),!0).forEach((function(t){Kn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Gn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Kn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Yn(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}function Xn(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){Yn(i,r,o,a,s,"next",e)}function s(e){Yn(i,r,o,a,s,"throw",e)}a(void 0)}))}}var er="force_dirty",tr=function(e){var t=e.onClose,n=e.event,r=e.isDirty,o=e.isEditMode,a=e.setEvent,s=e.shouldClearEventStateOnHide,l=e.onEventChange,c=e.isLiveLocation,u=(0,Zn.k6)(),m=(0,Gt.p)(),f=m.success,p=m.error,b=(0,Vn.q)(),g=(0,Zn.TH)().pathname,y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return(0,_t.useMutation)((function(t){return e?on.S1.update({event:e,formData:Qn(Qn({},t),{},{event_type:e.event_type}),forReactQuery:!0}):on.S1.create({formData:t,forReactQuery:!0})}))}(n),j=!n&&y.isLoading,x=((0,i.wh)().currentCommunitySettings||{}).paid_event_phase2_enabled,w=(0,h.useRef)(null),O=(0,h.useRef)(),S=(0,Me.Y)(),P=S.purchaseRecordingsAddonWhenLimitReached,C=S.purchaseStreamingAddonWhenLimitReached,k=S.shouldUpgradeAddons,I="/events"===g,N=function(){var e=Xn(v().mark((function e(t,r){var i,a,s,l,c,u,d,m,f;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=r.reset,e.prev=1,c=null===n||void 0===n?void 0:n.event_type,o?delete t[er]:(u=t.recurring_setting_attributes.frequency,c=u?_.E_.RECURRING:_.E_.SINGLE),(o?null===t||void 0===t||null===(a=t.paywall_attributes)||void 0===a?void 0:a.price_amount:(0,_.yl)(t))&&(d=t.paywall_attributes.price_amount,m=(0,We.LG)(d),t.paywall_attributes.price_amount=m),!o&&(null===t||void 0===t||null===(s=t.event_setting_attributes)||void 0===s?void 0:s.ticket_type)==_.Mj.PAID&&[_.Bq.LIVE_ROOM,_.Bq.LIVE_STREAM].includes(null===t||void 0===t||null===(l=t.event_setting_attributes)||void 0===l?void 0:l.location_type)&&(t.event_setting_attributes.live_stream_room_setting_attributes.access_type=Ne._d.SECRET),c==_.E_.RECURRING&&!x&&t.paywall_attributes&&(t.event_setting_attributes.ticket_type=_.Mj.FREE,delete t.paywall_attributes),e.next=11,A();case 11:f={onSuccess:function(e){return E(e,i)},onError:L},y.mutate(Jn(Jn({},t),{},{event_type:c}),f),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(1),M(e.t0);case 18:case"end":return e.stop()}}),e,null,[[1,15]])})));return function(t,n){return e.apply(this,arguments)}}(),A=function(){var e=Xn(v().mark((function e(){return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!c||!k){e.next=6;break}return e.next=3,P();case 3:return e.next=5,C();case 5:f((0,d.t)("settings.billing.add_ons.changes_succeeded"));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),E=function(e,r){var o=n?(0,d.t)("events.saved_successfully"):(0,d.t)("events.created_successfully");f(o),b({shouldInvalidateAllEvents:I}),I&&l(n),T(e)?(t(),a(null),D(e)):R(e,r)},T=function(e){return(null===n||void 0===n?void 0:n.status)===_.Q_.DRAFT&&(null===e||void 0===e?void 0:e.status)===_.Q_.PUBLISHED},D=function(e){u.push(F.xu.show({spaceSlug:e.space_slug,slug:e.slug}))},R=function(e,t){t(Jn(Jn({},e),{},{body:e.body_for_editor})),a(e)},L=function(){var e=n?(0,d.t)("events.save_error"):(0,d.t)("events.create_error");p(e)},M=function(e){e instanceof Error&&console.error(e.message)},U=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_.HA.CURRENT;w.current&&O.current&&(w.current("recurring_setting_attributes.edit_mode",e,{shouldDirty:!0}),w.current(er,!0,{shouldDirty:!0}),O.current())};return{handleClose:function(){r&&!confirm((0,d.t)("events.edit_modal.close_warning"))||(t(),s&&a(null))},onSubmit:N,onSave:U,onPublish:function(e){w.current&&w.current("status",_.Q_.PUBLISHED,{shouldDirty:!0}),U(e)},isCreating:j,setValueRef:w,triggerFormSubmitRef:O,mutation:y}};function nr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return rr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return rr(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function rr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var or=function(e){var t,n=e.onClose,r=e.event,o=e.spaceId,a=e.locationType,s=e.shouldClearEventStateOnHide,l=void 0!==s&&s,c=nr((0,h.useState)(r),2),u=c[0],m=c[1],f=!!r&&(0,xe.aA)(null===(t=r.event_setting_attributes)||void 0===t?void 0:t.ends_at),p=(0,Bn.vk)({params:{past_events:f}}).onEventChange;(0,h.useEffect)((function(){m(r)}),[r]);var v=!!u,b=v?u.name:(0,d.t)("events.create.title"),g=function(e,t,n){var r=(0,i.wh)(),o=r.currentUser,a=r.currentCommunity,s=(0,be.m)().spaces.find((function(n){return n.id===(t||(null===e||void 0===e?void 0:e.space_id))}))||null,l=["private","secret"].includes(null===s||void 0===s?void 0:s.visibility),c=(0,xe.TP)(new Date),u=(0,xe.ZX)(c,3600);return e?Hn(Hn({},e),{},{body:e.body_for_editor,attendee_invite_attributes:{invited_entities_ids:null}}):{user_id:null===o||void 0===o?void 0:o.id,space_id:t,event_type:_.E_.SINGLE,status:_.Q_.DRAFT,event_setting_attributes:{location_type:n,starts_at:c.toUTCString(),ends_at:u.toUTCString(),duration_in_seconds:3600,live_stream_room_setting_attributes:{access_type:l?Ne._d.SECRET:Ne._d.OPEN,view_type:Ne.Bk.GRID,recording_enabled:a.live_stream_recording_enabled,auto_post_recording_enabled:a.live_stream_auto_post_recording_enabled,room_type:Ne.H0.STREAM,mute_on_join:!1,limit_url_sharing:!1},send_email_confirmation:!0,send_in_app_notification_confirmation:!0,send_email_reminder:!0,send_in_app_notification_reminder:!0,send_publish_email:!0,ticket_type:_.Mj.FREE},recurring_setting_attributes:{range_type:_.pd.ON,occurrences:null,ends_at:u.toUTCString()}}}(u,o,a),j=nr((0,h.useState)(!1),2),x=j[0],w=j[1],O=nr((0,h.useState)(!1),2),S=O[0],P=O[1],C=nr((0,h.useState)(!1),2),k=C[0],I=C[1],N=nr((0,h.useState)(a),2),A=N[0],E=N[1],T=y(),D=T.triggerValidationRef,R=T.validateAndSetCurrentSection,L=A===te.Bq.LIVE_STREAM||A===te.Bq.LIVE_ROOM,M=(0,_.f0)(u)&&k,F=tr({onClose:n,event:u,isDirty:x,isEditMode:v,setEvent:m,shouldClearEventStateOnHide:l,onEventChange:p,isLiveLocation:L}),U=F.handleClose,B=F.onSubmit,z=F.onSave,H=F.onPublish,q=F.setValueRef,Z=F.triggerFormSubmitRef,V=F.mutation;return{event:u,isEditMode:v,isCreating:F.isCreating,isDirty:x,isStartsAtDirty:S,locationType:A,setLocationType:E,isLiveLocation:L,handleClose:U,onSubmit:B,onSave:z,onPublish:H,setValueRef:q,triggerFormSubmitRef:Z,triggerValidationRef:D,validateAndSetCurrentSection:R,formDefaultValues:g,title:b,mutation:V,setIsDirty:w,setStartsAtDirty:P,shouldHideAllEventOption:M,setPaywallAttributesDirty:I}},ir=function(e){var t=e.isOpen,n=e.onClose,r=e.event,d=e.spaceId,m=e.locationType,f=e.shouldClearEventStateOnHide,p=void 0!==f&&f,v=e.initialSection,h=void 0===v?_.SA.basicInfo:v,b=or({spaceId:d,event:r,shouldClearEventStateOnHide:p,locationType:m,onClose:n}),g=b.event,y=b.isEditMode,x=b.isCreating,w=b.isDirty,O=b.isStartsAtDirty,S=b.locationType,P=b.setLocationType,C=b.setValueRef,k=b.triggerFormSubmitRef,I=b.formDefaultValues,N=b.title,A=b.handleClose,E=b.onSubmit,T=b.onSave,D=b.onPublish,R=b.validateAndSetCurrentSection,L=b.triggerValidationRef,M=b.setIsDirty,F=b.setStartsAtDirty,U=b.mutation,B=b.isLiveLocation,H=b.setPaywallAttributesDirty,q=b.shouldHideAllEventOption,Z=(0,a.kK)(),V=((0,i.wh)().currentCommunitySettings||{}).scheduled_emails_enabled,W=Object.values(_.SA).filter((function(e){return e!==_.SA.email||V}));return(0,j.jsxs)(j.Fragment,{children:[!Z&&(0,j.jsx)(c.o,{onClick:A,className:"z-[1100]",isVisible:t}),(0,j.jsx)(l.x,{isOpen:t,shouldShowCloseButton:!1,contentPortalId:"events",children:(0,j.jsxs)(s.MW,{formId:"events",sections:W,initialSection:Z&&y?_.SA.overview:h,title:N,onExit:A,onSave:E,isSaving:U.isLoading,children:[(0,j.jsx)(l.x.Header,{className:o()("!px-5 !py-3 md:!px-6 md:!py-5",{"!border-0":x}),children:(0,j.jsx)(X,{isEditMode:y,isCreating:x,event:g,onPublish:D,handleClose:A,validateAndSetCurrentSection:R})}),(0,j.jsxs)(l.x.Body,{children:[Z&&(0,j.jsx)(Un,{validateAndSetCurrentSection:R,event:r,isEditMode:y,title:N}),(0,j.jsxs)(u.l,{id:"events",onSubmit:E,passThroughProps:{onCancel:A},defaultValues:I,triggerFormSubmitRef:k,submitDirtyOnly:y,children:[!x&&(0,j.jsx)(Dn,{event:g,triggerValidationRef:L,setValueRef:C,setIsDirty:M,setLocationType:P,locationType:S,isLiveLocation:B,setStartsAtDirty:F,setPaywallAttributesDirty:H}),x&&(0,j.jsx)(Ln,{}),Z&&(0,j.jsx)(z,{event:g,isEditMode:y,onPublish:D})]})]}),(0,j.jsx)(l.x.Footer,{className:o()({"!border-0 !p-0":x||!w}),children:(0,j.jsx)(Rn,{event:g,isCreating:x,isDirty:w,onSubmit:T,locationType:S,isStartsAtDirty:O,shouldHideAllEventOption:q})})]})})]})}},85751:(e,t,n)=>{n.d(t,{I:()=>d});var r=n(94184),o=n.n(r),i=n(85893),a=["label","value","placeholder","error","disabled","leftAddon","rightAddon"];function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var d=function(e){var t=e.label,n=e.value,r=e.placeholder,s=e.error,c=e.disabled,d=e.leftAddon,m=e.rightAddon,f=u(e,a);return(0,i.jsxs)("div",{children:[t&&(0,i.jsx)("div",{className:"text-sm font-semibold",children:t}),(0,i.jsxs)("div",{className:"mt-2 flex w-full",children:[d&&(0,i.jsx)("div",{className:o()({"cursor-not-allowed bg-gray-50":c},"flex h-11 items-center rounded-l-lg border border-gray-300 bg-white px-4 py-3"),children:d}),(0,i.jsx)("input",l({className:o()({"border-red-600 focus:border-red-600":s,"border-primary bg-secondary text-light cursor-not-allowed":c,"text-dark border-gray-400":!c,"rounded-l-none":d,"rounded-r-none":m},"placeholder:text-light h-11 grow rounded-lg border border-solid px-4 py-3 outline-none placeholder:opacity-100 focus:border-2 focus:border-gray-500"),value:n,placeholder:r,disabled:c},f)),m&&(0,i.jsx)("div",{className:o()({"border-primary bg-secondary text-light cursor-not-allowed":c},"bg-primary border-primary text-dark ml-[-1px] flex h-11 items-center rounded-r-lg border px-4 py-3"),children:m})]}),s&&(0,i.jsx)("div",{className:"mt-2 text-sm text-red-600",children:s})]})}},67621:(e,t,n)=>{n.d(t,{x:()=>p});var r=n(86215),o=n(96486),i=n(73935),a=n(37803),s=n(49164),l=n(85893),c=["position","children"];function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){m(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function f(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var p=function(e){var t=e.position,n=void 0===t?"header":t,u=e.children,m=f(e,c),p=(0,a.x)(),v=p.shouldShowRailBar,h=void 0===v||v,b=p.toggleShowRailBar,g=void 0===b?o.noop:b,y="#rail-bar-".concat(n),_=document.querySelector(y);return _?(0,l.jsx)(l.Fragment,{children:(0,i.createPortal)((0,l.jsx)(r.J,{children:(0,l.jsx)(r.J.Panel,{as:"div",static:h,children:(0,l.jsx)(s.S0,d(d({toggleShowRailBar:g},m),{},{children:u}))})}),_)}):null}},11960:(e,t,n)=>{n.d(t,{k:()=>p});var r=n(67294),o=n(86013),i=n.n(o),a=n(31889),s=n(20073),l=n(25401),c=n(15830),u=n(65771),d=n(97012),m=n(28772),f=n(26953),p=function(){var e=(0,d.wh)(),t=e.currentCommunity,n=e.currentCommunityMember,o=e.currentCommunitySettings,p=(0,u.E)(),v=p.isCommunityOnTrial,h=p.canChooseCurrency,b=p.defaultCurrency,g=(0,f.BT)(),y=(0,r.useMemo)((function(){return window.location.pathname.startsWith("/communities/new")}),[window.location]),_="pt"===(0,c.cm)()&&v&&(h||"brl"===b),j=(0,r.useMemo)((function(){return/^\/communities\/\d+\/questions\/?$/.test(window.location.pathname)}),[window.location]),x=(0,r.useMemo)((function(){return/^\/communities\/\d+\/templates\/?$/.test(window.location.pathname)}),[window.location]),w=(0,r.useMemo)((function(){return null!==t&&void 0!==t&&t.trial_ends_at?(0,m.ie)(t.trial_ends_at,{day:"2-digit",month:"2-digit"}):""}),[t]),O=(0,r.useMemo)((function(){return null!==t&&void 0!==t&&t.trial_ends_at?(0,l.TF)(t.trial_ends_at):""}),[t]),S=(0,r.useMemo)((function(){var e=(0,s.eC)(new Date,new Date(null===t||void 0===t?void 0:t.trial_ends_at));return e<=1?"1 ".concat(i().t("trial_banner.day")):"".concat(e," ").concat(i().t("trial_banner.days"))}),[t]),P=(0,r.useMemo)((function(){return!v&&(!(null===t||void 0===t||!t.subscription)&&Boolean(t.subscription.cancelled))}),[t,v]),C=(0,r.useMemo)((function(){return!(null===t||void 0===t||!t.promotion_enabled)}),[t]),k=(0,r.useMemo)((function(){var e=(0,a.vb)(n),t=null===o||void 0===o?void 0:o.hide_trial_banner;return Boolean(e&&(v||P)&&!y&&!j&&!x&&!t&&!g&&!C)}),[t,n,v,P,g]),I=document.getElementById("trial-banner"),N=Boolean(I);return{trialEndsInWords:O,trialDaysRemainingInWords:S,trialEndDateFormatted:w,isSubscriptionCancelled:P,shouldSeeBrazilTrialBanner:_,isCommunityOnTrial:v,shouldShowTrialBanner:k,isTrialBannerExists:N}}},18919:(e,t,n)=>{n.d(t,{K:()=>b,Y:()=>g});var r=n(64687),o=n.n(r),i=n(67294),a=n(96486),s=n(31256),l=n(56789),c=n(97012),u=n(31889),d=n(85893);function m(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}function f(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){m(i,r,o,a,s,"next",e)}function s(e){m(i,r,o,a,s,"throw",e)}a(void 0)}))}}function p(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return v(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return v(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var h=(0,i.createContext)({streamingHoursAvailable:!1,recordingHoursReached:!1,totalStreamingHours:0,totalRecordingHours:0,limitsReachedIsOpen:!1,limitsReachedOnClose:a.noop,setRecordingEnabled:a.noop,recordingEnabled:!1,limitsReachedOnOpen:a.noop,shouldUpgradeAddons:!1,purchaseRecordingsAddonWhenLimitReached:function(){return Promise.resolve()},purchaseStreamingAddonWhenLimitReached:function(){return Promise.resolve()}});h.displayName="AddonsContext";var b=function(e){var t=e.children,n=(0,c.wh)().currentCommunityMember,r=(0,u.vb)(n),m=(0,s.tm)({enabled:r}),v=m.streamingHoursAvailable,b=m.recordingHoursAvailable,g=m.streamingTotalPlanHours,y=m.recordingTotalPlanHours,_=m.isLoading,j=(0,l.h)(),x=j.recordingEnabled,w=j.setRecordingEnabled,O=void 0===w?a.noop:w,S=!_&&x&&!b,P=(0,s.$v)(null,{enabled:r}),C=P.purchaseAsync,k=P.currentQuantity,I=P.unitSize,N=(0,s.Yq)(null,{enabled:r}),A=N.purchaseAsync,E=N.currentQuantity,T=N.unitSize,D=Number(g)+Number(k),R=Number(y)+Number(E),L=p((0,i.useState)(!1),2),M=L[0],F=L[1];(0,i.useEffect)((function(){F(!_&&(!v||S))}),[_,v,S]);var U=!v||S,B=function(){var e=f(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(x){e.next=2;break}return e.abrupt("return");case 2:if(!b){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,A(T);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),z=function(){var e=f(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!v){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,C(I);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),H={streamingHoursAvailable:v,recordingHoursReached:S,totalStreamingHours:D,totalRecordingHours:R,limitsReachedIsOpen:M,limitsReachedOnClose:function(){F(!1)},setRecordingEnabled:O,recordingEnabled:x,limitsReachedOnOpen:function(){F(!0)},shouldUpgradeAddons:U,purchaseRecordingsAddonWhenLimitReached:B,purchaseStreamingAddonWhenLimitReached:z};return(0,d.jsx)(h.Provider,{value:H,children:t})},g=function(){var e=(0,i.useContext)(h);if(void 0===e)throw new Error("useAddonsContext must be used within a AddonsProvider");return e}},42240:(e,t,n)=>{n.d(t,{WP:()=>ye,uT:()=>de,$_:()=>v,xJ:()=>be,h4:()=>s,bW:()=>_e});var r=n(86013),o=n(55825),i=n(16743),a=n(85893),s=function(){return(0,a.jsx)(o.h4.Actions,{children:(0,a.jsx)(i.Z.TitleSm,{weight:"semibold",children:(0,r.t)("live_streams.form.title_v3")})})},l=n(94997),c=n(81372),u=n(24885),d=n(11909),m=n(55675),f=n(18919),p=n(16620),v=function(e){var t=e.roomType,n=e.validateAndContinue,s=function(e){var t=(0,p.qj)(e).sectionTitles,n=(0,o.eW)(),r=n.currentSection,i=n.setCurrentSection,a=n.formId,s=n.isSaving,l=n.onExit,c=n.onSave,u=t.indexOf(r),d=u+1,m=(null===t||void 0===t?void 0:t.length)||0;return{formId:a,isSaving:s,currentStep:d,totalSteps:m,isFirstStep:1===d,isLastStep:d===m,next:function(){u!==m-1&&i(t[u+1])},prev:function(){0!==u&&i(t[u-1])},onSave:c,onExit:l}}(t),v=s.formId,h=s.isSaving,b=s.currentStep,g=s.totalSteps,y=s.isFirstStep,_=s.isLastStep,j=s.next,x=s.prev,w=s.onExit,O=(0,u.Z)(),S=(0,f.Y)(),P=S.streamingHoursAvailable,C=S.recordingHoursReached,k=S.limitsReachedOnOpen,I=function(e){e.preventDefault(),k()};return(0,a.jsxs)("div",{className:"flex w-full items-center justify-between",children:[(0,a.jsx)(i.Z.TitleSm,{weight:"semibold",color:"text-gray-800",children:(0,r.t)("live_streams.form.step",{currentStep:b,totalSteps:g})}),(0,a.jsxs)("div",{className:"flex items-center gap-5",children:[b===c.nw&&!P&&C?(0,a.jsxs)("div",{className:"flex justify-start",children:[(0,a.jsx)("button",{type:"button",className:"mr-1 cursor-pointer underline",onClick:I,children:(0,r.t)("live_streams.form.two_upgrades")}),(0,a.jsx)("p",{children:(0,r.t)("live_streams.form.included")})]}):b!==c.nw||P&&!C?null:(0,a.jsxs)("div",{className:"flex justify-start",children:[(0,a.jsx)("button",{type:"button",className:"mr-1 cursor-pointer underline",onClick:I,children:(0,r.t)("live_streams.form.one_upgrade")}),(0,a.jsx)("p",{children:(0,r.t)("live_streams.form.included")})]}),y&&(0,a.jsx)(m.z,{onClick:w,variant:"secondary",children:(0,r.t)("live_streams.form.cancel")}),!y&&(0,a.jsx)(m.z,{onClick:x,type:"button",variant:"secondary",children:(0,r.t)("live_streams.form.prev")}),!_&&(0,a.jsx)(m.z,{onClick:function(){t==d.H0.EVENT?(w(),O.show({locationType:l.Bq.LIVE_STREAM})):n(j)},type:"button",variant:"circle",className:"border-darkest border",children:(0,r.t)("live_streams.form.next")}),_&&(0,a.jsx)(m.z,{form:v,disabled:h,type:"submit",variant:"circle",className:"border-darkest border",children:(0,r.t)("live_streams.form.submit_button_label")})]})]})},h=n(67294),b=n(94184),g=n.n(b),y=n(87536),_=n(61926),j=["appendTranslationRoot","children"];function x(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?x(Object(n),!0).forEach((function(t){O(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function O(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function S(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var P=function(e){var t=e.appendTranslationRoot,n=void 0===t?"":t,r=e.children,o=S(e,j);return(0,a.jsx)(_.l.Item,w(w({hideBorder:!0,fullWidth:!0,hideDescription:!0,translationRoot:n?"live_streams.form.".concat(n):"live_streams.form"},o),{},{children:r}))},C=n(31256),k=n(97012),I=n(31889),N=n(30887),A=function(e){var t=e.iconType,n=e.text;return(0,a.jsx)("li",{className:"list-none",children:(0,a.jsxs)("div",{className:"flex items-start gap-2.5 text-left",children:[(0,a.jsx)("span",{className:"mt-0.5 flex w-4",children:(0,a.jsx)(N.JO,{size:16,type:t})}),(0,a.jsx)(i.Z.LabelSm,{children:n})]})})},E=function(e){var t=e.title,n=e.onClick,r=e.isSelected,o=e.disabled,s=e.children;return(0,a.jsxs)("button",{type:"button",className:g()("order-none box-border flex h-[264px] w-[325.33px] shrink-0 grow cursor-pointer flex-col items-stretch gap-2 rounded-lg border border-solid px-6 py-5",{"bg-tertiary border-tertiary":r,"pointer-events-none cursor-not-allowed opacity-70":o}),onClick:function(){o||n()},children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(i.Z.LabelLg,{weight:"semibold",children:t}),(0,a.jsx)("div",{className:"text-dark",children:(0,a.jsx)(N.JO,{type:r?"circle-checked":"circle-unchecked",size:16})})]}),s&&(0,a.jsx)("div",{className:"mt-1",children:s})]})},T=function(e){var t=e.onChange,n=e.value,o=e.liveStreamConfig,i=e.shouldDisableEventOption,s=(0,k.wh)().currentCommunityMember,l=(0,I.vb)(s),c=null===o||void 0===o?void 0:o.live_stream_max_host_capacity,u=(null===o||void 0===o?void 0:o.live_stream_max_spectator_capacity)+((0,C.wK)({enabled:l}).currentQuantity||0),m=null===o||void 0===o?void 0:o.live_room_participants_capacity;return(0,a.jsxs)("div",{className:"order-1 flex h-[264px] w-[1024px] flex-none flex-row items-start gap-6 self-stretch p-0",children:[(0,a.jsx)("div",{className:"w-1/3","data-testid":"schedule-a-live-event",children:(0,a.jsx)(E,{title:(0,r.t)("live_streams.room_type_picker.live_event.v3.title"),onClick:function(){return t(d.H0.EVENT)},isSelected:n===d.H0.EVENT,disabled:i,children:(0,a.jsxs)("ul",{className:"order-1 flex h-44 w-[277.33px] flex-none list-outside flex-col items-start gap-3 self-stretch p-0",children:[(0,a.jsx)(A,{iconType:"16-join-date",text:(0,r.t)("live_streams.room_type_picker.live_event.v3.bullet_1",{spectators:u})}),(0,a.jsx)(A,{iconType:"16-calendar-add",text:(0,r.t)("live_streams.room_type_picker.live_event.v3.bullet_2",{cohosts:c})}),(0,a.jsx)(A,{iconType:"16-live",text:(0,r.t)("live_streams.room_type_picker.live_event.v3.bullet_3")}),(0,a.jsx)(A,{iconType:"20-members",text:(0,r.t)("live_streams.room_type_picker.live_event.v3.bullet_4")})]})})}),(0,a.jsx)("div",{className:"w-1/3","data-testid":"start-a-live-room",children:(0,a.jsx)(E,{title:(0,r.t)("live_streams.room_type_picker.live_room.title"),onClick:function(){return t(d.H0.CONFERENCE)},isSelected:n===d.H0.CONFERENCE,children:(0,a.jsxs)("ul",{className:"order-1 flex h-[188px] w-[277.33px] flex-none list-outside flex-col items-start gap-3 self-stretch p-0",children:[(0,a.jsx)(A,{iconType:"20-checkmark-circle",text:(0,r.t)("live_streams.room_type_picker.live_room.v3.bullet_1")}),(0,a.jsx)(A,{iconType:"20-members",text:(0,r.t)("live_streams.room_type_picker.live_room.v3.bullet_2",{participants:m})}),(0,a.jsx)(A,{iconType:"16-video",text:(0,r.t)("live_streams.room_type_picker.live_room.v3.bullet_3")}),(0,a.jsx)(A,{iconType:"16-chat",text:(0,r.t)("live_streams.room_type_picker.live_room.v3.bullet_4")})]})})}),(0,a.jsx)("div",{className:"w-1/3","data-testid":"start-a-live-stream",children:(0,a.jsx)(E,{title:(0,r.t)("live_streams.room_type_picker.live_stream.title"),onClick:function(){return t(d.H0.STREAM)},isSelected:n===d.H0.STREAM,children:(0,a.jsxs)("ul",{className:"order-1 flex h-44 w-[277.33px] flex-none list-outside flex-col items-start gap-3 self-stretch p-0",children:[(0,a.jsx)(A,{iconType:"20-checkmark-circle",text:(0,r.t)("live_streams.room_type_picker.live_stream.v3.bullet_1")}),(0,a.jsx)(A,{iconType:"20-members",text:(0,r.t)("live_streams.room_type_picker.live_stream.v3.bullet_2",{spectators:u})}),(0,a.jsx)(A,{iconType:"16-video",text:(0,r.t)("live_streams.room_type_picker.live_stream.v3.bullet_3")}),(0,a.jsx)(A,{iconType:"16-chat",text:(0,r.t)("live_streams.room_type_picker.live_stream.v3.bullet_4")})]})})})]})},D=["name","rules","liveStreamConfig","shouldDisableEventOption"];function R(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function L(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?R(Object(n),!0).forEach((function(t){M(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):R(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function M(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function F(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var U=function(e){var t=e.name,n=e.rules,r=e.liveStreamConfig,o=e.shouldDisableEventOption,i=F(e,D),s=(0,y.Gc)().control;return(0,a.jsx)(y.Qr,{control:s,name:t,rules:n,render:function(e){var t=e.field,n=t.onChange,s=t.value;return(0,a.jsx)(T,L(L({},i),{},{onChange:n,value:s,liveStreamConfig:r,shouldDisableEventOption:o}))}})},B=function(){var e=(0,C.oQ)().config,t={canCreateEvent:((0,k.nT)().helpers.spacesWithPostCreationAllowed()||[]).some((function(e){return"event"===e.post_type}))}.canCreateEvent;return(0,a.jsx)("div",{className:"mx-auto w-auto",children:(0,a.jsx)(P,{name:"room_type",rules:{required:(0,r.t)("live_streams.form.room_type_required_error")},hideLabel:!0,children:(0,a.jsx)(U,{liveStreamConfig:e,shouldDisableEventOption:!t})})})},z=n(67144),H=n(82111),q=function(e){var t=e.roomType,n=(0,y.qo)({name:"recording_enabled"}),o=(0,f.Y)(),s=o.limitsReachedIsOpen,l=o.setRecordingEnabled,c=(0,z.R)().limitUrlSharingEnabled,u=(0,y.Gc)(),m=u.watch,p=u.setValue,v=m("access_type"),b=v===d._d.PUBLIC_STREAM||v===d._d.OPEN,g="limit_url_sharing";return(0,h.useEffect)((function(){b&&p(g,!1,{shouldDirty:!0})}),[v,p]),(0,h.useEffect)((function(){l(n)}),[n]),(0,a.jsxs)(a.Fragment,{children:[s&&(0,a.jsx)(H.l,{roomType:t}),(0,a.jsx)(i.Z.TitleMd,{weight:"bold",children:(0,r.t)("live_streams.form.details")}),(0,a.jsxs)("div",{className:"mb-8 mt-4",children:[(0,a.jsxs)("div",{className:"flex items-start",children:[(0,a.jsx)("div",{className:"w-1/2 pr-3",children:(0,a.jsx)(be,{name:"name",rules:{required:(0,r.t)("live_streams.form.".concat(t,".name_required_error")),maxLength:{value:255,message:(0,r.t)("live_streams.form.".concat(t,".name_length_error"))}},children:(0,a.jsx)(_.l.Input,{autoFocus:!0})})}),(0,a.jsx)("div",{className:"w-1/2 pl-3",children:(0,a.jsx)(be,{name:"slug",tooltipText:"".concat(window.location.protocol,"//").concat(window.location.hostname,"/live/custom-url-slug"),rules:{maxLength:{value:255,message:(0,r.t)("live_streams.form.slug_length_error")}},children:(0,a.jsx)(_.l.Input,{})})})]}),(0,a.jsx)("div",{className:"mt-3 w-full",children:(0,a.jsx)(be,{name:"description",resizeDisabled:!0,rules:{maxLength:{value:255,message:(0,r.t)("live_streams.form.".concat(t,".description_length_error"))}},children:(0,a.jsx)(_.l.Input,{variant:"textarea",maxLength:255,rows:"6"})})}),(0,a.jsx)("div",{className:"mt-3",children:(0,a.jsx)(be,{name:"recording_enabled",appendTranslationRoot:t,tooltipText:(0,r.t)("live_streams.form.".concat(t,".recording_enabled_tooltip")),inlineReverse:!0,children:(0,a.jsx)(_.l.ToggleSwitch,{name:"recording_enabled",variant:"small"})})}),(0,a.jsx)("div",{className:"mt-3",children:(0,a.jsx)(be,{name:"mute_on_join",appendTranslationRoot:t,inlineReverse:!0,children:(0,a.jsx)(_.l.ToggleSwitch,{name:"mute_on_join",variant:"small"})})}),c&&!b&&(0,a.jsx)("div",{className:"mt-3",children:(0,a.jsx)(be,{name:g,appendTranslationRoot:t,tooltipText:(0,r.t)("live_streams.form.".concat(t,".limit_url_sharing_tooltip")),inlineReverse:!0,children:(0,a.jsx)(_.l.ToggleSwitch,{name:g,variant:"small"})})})]}),(0,a.jsx)(i.Z.TitleMd,{weight:"bold",children:(0,r.t)("live_streams.form.access")}),(0,a.jsx)("div",{className:"my-4",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"w-1/2 pr-3",children:(0,a.jsx)(be,{name:"view_type",labelClassName:"mb-3 text-lg",children:(0,a.jsx)(_e,{roomType:t})})}),(0,a.jsx)("div",{className:"w-1/2 pl-3",children:(0,a.jsx)(be,{name:"access_type",labelClassName:"mb-3 text-lg",children:(0,a.jsx)(ye,{roomType:t})})})]})})]})},Z=n(90846),V=n(53397),W=n(58533),Q=n(86078),$=n(97957),G=n(38870),J=n(88767),K=n(34128),Y=n(20557),X=function(e,t,n,r){var o,i=(0,J.useInfiniteQuery)("entities-preview-".concat(e,"-").concat(t,"-").concat(n,"-").concat(r),(function(o){var i=o.pageParam;return function(o){return(0,K.UT)(Y.a.entityPreviews.index({params:{page:o,spaces_ids:e,space_groups_ids:t,member_tags_ids:n,members_ids:r}}))}(void 0===i?1:i)}),{getNextPageParam:function(e){return e.has_next_page?e.page+1:void 0}}),a=i.isLoading,s=i.isFetching,l=i.data,c=i.refetch,u=i.fetchNextPage,d=i.fetchPreviousPage,m=null===l||void 0===l||null===(o=l.pages)||void 0===o?void 0:o.reduce((function(e,t){return e.concat(t.records)}),[]),f=(null===l||void 0===l?void 0:l.pages[(null===l||void 0===l?void 0:l.pages.length)-1])||{},p=f.page,v=f.count,h=f.page_count,b=50*(p-1)+1;return{page:p,records:m,totalRecordCount:v,pageRecordCount:h,pageCount:v?Math.ceil(v/50):0,hasNextPage:!!f.has_next_page,startRecordNumber:b,endRecordNumber:b+h-1,isLoading:a,isFetching:s,refetch:c,fetchNextPage:u,fetchPrevPage:d}},ee=function(e){var t=e.spaceIds,n=e.spaceGroupIds,r=e.memberTagIds,o=e.memberIds,s=X(t,n,r,o),l=s.records,u=s.fetchNextPage,d=s.hasNextPage;return(0,a.jsx)(W.Z,{next:u,hasMore:d,scrollableTarget:c.Um,loader:(0,a.jsx)(Q.m,{}),dataLength:(null===l||void 0===l?void 0:l.length)||0,children:(0,a.jsx)("div",{className:"flex w-full flex-col",children:null===l||void 0===l?void 0:l.map((function(e){var t=e.id,n=e.avatar_url,r=e.name,o=e.email;return(0,a.jsxs)("div",{className:"hover:bg-secondary group flex h-12 items-center rounded-md border-none px-2",children:[(0,a.jsx)("div",{className:"mr-3",children:(0,a.jsx)(G.s,{src:n,name:r,size:"8"})}),(0,a.jsx)("div",{className:"w-1/3",children:(0,a.jsx)($.Y,{children:(0,a.jsx)(i.Z.LabelSm,{weight:"semibold",children:r})})}),(0,a.jsx)("div",{className:"flex grow justify-end",children:(0,a.jsx)($.Y,{children:(0,a.jsx)(i.Z.LabelSm,{children:o})})})]},t)}))})})},te=function(){var e=(0,y.qo)({name:"invited_entities_ids"})||{},t=e.spaces_ids,n=e.space_groups_ids,o=e.member_tags_ids,i=e.members_ids,s=Object.values(e).some((function(e){return!(null===e||void 0===e||!e.length)}))?(0,r.t)("manage"):(0,r.t)("invite");return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(be,{name:"invited_entities_ids",className:"z-20 mb-6",hideLabel:!0,children:(0,a.jsx)(V.lH,{variant:V.ZC.MODAL,countLabel:(0,r.t)("live_streams.form.members_invited_label"),tooltipText:(0,r.t)("live_streams.form.members_invited_tooltip"),selectionLabel:(0,r.t)("live_streams.form.members_invited_selection_label"),searchPlaceholder:(0,r.t)("live_streams.form.members_invited_placeholder"),buttonLabel:s,includeAllResultTypes:!0})}),(0,a.jsx)(ee,{spaceIds:t,spaceGroupIds:n,memberTagIds:o,memberIds:i})]})},ne=n(35103),re=function(e){var t=e.setIsLimitReached,n=e.initialCohostQuantity,o=void 0===n?1:n,s=e.shouldDisplayDisabledSearchMessage,l=void 0!==s&&s,c=((0,ne.B)().selectionState||{}).memberCount+o||1,u=(0,C.oQ)().config,m=null===u||void 0===u?void 0:u.live_stream_max_host_capacity,f=c>=m;return(0,h.useEffect)((function(){m&&(c<=m-d.ln?t(!1):t(!0))}),[c,m,t]),(0,a.jsxs)("div",{className:"mb-4 text-center",children:[(0,a.jsx)("div",{children:(0,a.jsx)(i.Z.LabelSm,{weight:f?"medium":"normal",children:(0,r.t)("live_streams.room.cohosts_counter_message",{count:Math.min(c,m),hostCapacity:m})})}),l&&(0,a.jsx)("div",{children:(0,a.jsx)(i.Z.LabelSm,{children:(0,r.t)("live_streams.room.cohosts_disable_search_message")})})]})};function oe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return ie(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ie(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ie(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ae=function(){var e=(0,k.wh)().currentCommunityMember,t=oe((0,h.useState)(!1),2),n=t[0],o=t[1],i=n,s=[null===e||void 0===e?void 0:e.id],l=(0,y.qo)({name:"cohosts"});return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(be,{name:"cohosts",className:"z-20 mb-6",hideLabel:!0,children:(0,a.jsx)(V.lH,{variant:V.ZC.MODAL,countLabel:(0,r.t)("live_streams.form.cohosts_added_label"),selectionLabel:(0,r.t)("live_streams.form.cohosts_selection_label"),searchPlaceholder:(0,r.t)("live_streams.form.cohosts_placeholder"),disableSearch:i,excludedMemberIds:s,renderAfterSelection:(0,a.jsx)(re,{setIsLimitReached:o,initialCohostQuantity:d.ln,shouldDisplayDisabledSearchMessage:i})})}),(0,a.jsx)(ee,{memberIds:l})]})};function se(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return le(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return le(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function le(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ce=function(){var e=(0,p.B0)()===d.H0.STREAM,t=[{label:(0,r.t)("live_streams.form.sections.people_attendees"),key:c.n4.ATTENDEES}];e&&t.push({label:(0,r.t)("live_streams.form.sections.people_cohosts"),key:c.n4.COHOSTS});var n=t.length>1,o=se((0,h.useState)(t[0]),2),i=o[0],s=o[1];return(0,a.jsxs)(a.Fragment,{children:[n&&(0,a.jsx)(Z.m,{variant:"underline",className:"sticky",wrapperClassName:"overflow-x-auto overflow-y-hidden",controlled:!0,activeTab:i.label,onClick:function(e){var n=t.find((function(t){return t.label===e}));s(n)},options:t}),i.key===c.n4.ATTENDEES&&(0,a.jsx)(te,{}),i.key===c.n4.COHOSTS&&(0,a.jsx)(ae,{})]})},ue=n(85185),de=function(e){var t=e.setRoomType,n=e.triggerValidationRef,r=(0,o.eW)().currentSection,s=(0,ue.B)(t),l=(0,p.qj)(s).sections,c=(0,y.Gc)().trigger,u=r===l.roomType;return(0,h.useEffect)((function(){n&&c&&(n.current=c)}),[n,c]),(0,a.jsxs)("div",{className:g()("mx-auto py-14",{"max-w-screen-md":!u,"max-w-max":u}),children:[(0,a.jsx)(i.Z.TitleXl,{weight:"bold",children:r}),(0,a.jsxs)("div",{className:"mt-8",children:[r===l.roomType&&(0,a.jsx)(B,{}),r===l.details&&(0,a.jsx)(q,{roomType:s}),r===l.people&&(0,a.jsx)(ce,{})]})]})},me=["children","name","rules","tooltipText","hidePlaceholder","placeholder","inlineReverse","translationRoot","appendTranslationRoot","hideLabel"];function fe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function pe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fe(Object(n),!0).forEach((function(t){ve(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ve(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function he(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var be=function(e){var t=e.children,n=e.name,r=e.rules,o=void 0===r?{}:r,i=e.tooltipText,s=e.hidePlaceholder,l=void 0!==s&&s,c=e.placeholder,u=e.inlineReverse,d=void 0!==u&&u,m=e.translationRoot,f=void 0===m?"live_streams.form":m,p=e.appendTranslationRoot,v=e.hideLabel,h=void 0!==v&&v,b=he(e,me);return(0,a.jsx)(_.l.Item,pe(pe({name:n,hideDescription:!0,translationRoot:p?"".concat(f,".").concat(p):f,rules:o,hideBorder:!0,fullWidth:!0,hidePlaceholder:l,placeholder:c,tooltipText:i,inlineReverse:d,hideLabel:h},b),{},{children:t}))},ge=n(1002),ye=function(e){var t=e.name,n=e.roomType,o=void 0===n?d.H0.STREAM:n,s=(0,C.oQ)().config,l=(0,z.R)().publicLiveStreamsEnabled,c=null===s||void 0===s?void 0:s.live_room_participants_capacity,u=(0,y.Gc)().control,m=[{value:d._d.OPEN,label:(0,r.t)("live_streams.form.access_type_community"),description:(0,a.jsx)(i.Z.LabelSm,{children:(0,r.t)("live_streams.form.".concat(o,".access_type_community_label"),{maxCapacity:c})})},{value:d._d.SECRET,label:(0,r.t)("live_streams.form.access_type_secret"),description:(0,a.jsx)(i.Z.LabelSm,{children:(0,r.t)("live_streams.form.".concat(o,".access_type_secret_label"))})}];l&&o===d.H0.STREAM&&m.push({value:d._d.PUBLIC_STREAM,label:(0,r.t)("live_streams.form.access_type_public"),description:(0,a.jsx)(i.Z.LabelSm,{children:(0,r.t)("live_streams.form.".concat(o,".access_type_public_label"))})});return(0,a.jsx)(y.Qr,{control:u,name:t,render:function(e){var t=e.field,n=t.onChange,r=function(e){return m.find((function(t){return t.value===e}))}(t.value);return(0,a.jsx)(ge.Lt,{direction:"bottom-start",linkType:"button",button:(0,a.jsx)(ge.Lt.MenuButton,{className:"form-control relative inline-block w-full text-left",children:(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("div",{className:"content-start",children:(0,a.jsx)(i.Z.LabelMd,{children:null===r||void 0===r?void 0:r.label})}),(0,a.jsx)("div",{className:"flex content-end",children:(0,a.jsx)(N.JO,{type:"cheveron-down"})})]})}),buttonClassName:"w-full",className:"relative w-full",size:ge.wk.EXTRA_LARGE,onChange:n,options:m,labelWeight:"semibold"})}})},_e=function(e){var t=e.name,n=e.roomType,o=void 0===n?d.H0.STREAM:n,s=(0,y.Gc)().control,l=[{value:d.Bk.GRID,label:(0,r.t)("live_streams.form.view_type_grid"),icon:"gallery-view",description:(0,a.jsx)(i.Z.LabelSm,{children:(0,r.t)("live_streams.form.".concat(o,".view_type_description_grid"))})},{value:d.Bk.SPEAKER,label:(0,r.t)("live_streams.form.view_type_speaker"),icon:"speaker-view",description:(0,a.jsx)(i.Z.LabelSm,{children:(0,r.t)("live_streams.form.".concat(o,".view_type_description_speaker"))})}];return(0,a.jsx)(y.Qr,{control:s,name:t,render:function(e){var t=e.field,n=t.onChange,r=function(e){return l.find((function(t){return t.value===e}))}(t.value);return(0,a.jsx)(ge.Lt,{direction:"bottom-start",linkType:"button",button:(0,a.jsx)(ge.Lt.MenuButton,{className:"form-control relative inline-block w-full text-left",children:(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(N.JO,{type:null===r||void 0===r?void 0:r.icon,className:"ml-1 mr-2 flex"}),(0,a.jsx)(i.Z.LabelMd,{children:null===r||void 0===r?void 0:r.label})]}),(0,a.jsx)("div",{className:"flex content-end",children:(0,a.jsx)(N.JO,{type:"cheveron-down",className:" ml-1 mr-2"})})]})}),buttonClassName:"w-full",className:"relative w-full",size:ge.wk.EXTRA_LARGE,onChange:n,options:l,labelWeight:"semibold"})}})}},82111:(e,t,n)=>{n.d(t,{l:()=>c});var r=n(86013),o=n(18919),i=n(55675),a=n(53448),s=n(16743),l=n(85893),c=function(e){var t=e.roomType,n=(0,o.Y)(),c=n.streamingHoursAvailable,u=n.recordingHoursReached,d=n.totalStreamingHours,m=n.totalRecordingHours,f=n.limitsReachedIsOpen,p=n.limitsReachedOnClose;return(0,l.jsxs)(a.u_,{title:(0,r.t)("live_streams.form.limits_reached"),isOpen:f,onClose:p,className:"z-[2100]",children:[(0,l.jsx)(a.u_.Overlay,{}),(0,l.jsxs)(a.u_.Content,{className:"!overflow-visible",children:[(0,l.jsxs)(a.u_.Header,{children:[(0,l.jsx)(a.u_.Title,{className:"text-center",size:"md",children:(0,r.t)("live_streams.form.limits_reached")}),(0,l.jsx)(a.u_.HeaderActions,{children:(0,l.jsx)(a.u_.CloseButton,{onClick:p})})]}),(0,l.jsx)(a.u_.Body,{className:"!overflow-visible text-justify",children:(0,l.jsxs)("ul",{className:"text-default list-outside pl-4 text-sm font-normal",children:[!c&&(0,l.jsx)("li",{className:"text-dark text-xs font-normal",children:(0,l.jsx)(s.Z.BodyXs,{children:(0,r.t)("live_streams.form.".concat(t,".upgrade_streaming_hours_label_v3"),{hours:d})})}),u&&(0,l.jsx)("li",{className:"text-dark mt-2 text-xs font-normal",children:(0,l.jsx)(s.Z.BodyXs,{children:(0,r.t)("live_streams.form.".concat(t,".upgrade_recording_hours_label_v3"),{hours:m})})})]})}),(0,l.jsx)(a.u_.Footer,{children:(0,l.jsx)(i.z,{type:"submit",variant:"circle",full:!0,large:!0,onClick:p,children:(0,r.t)("live_streams.form.close")})})]})]})}},16620:(e,t,n)=>{n.d(t,{n3:()=>p,a1:()=>s,qj:()=>i,B0:()=>l.B});var r=n(86013),o=n(11909),i=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o.H0.STREAM,t={roomType:(0,r.t)("live_streams.form.sections.room_type"),details:(0,r.t)("live_streams.form.sections.".concat(e,".room_details")),people:(0,r.t)("live_streams.form.sections.people")};return{sections:t,sectionTitles:Object.values(t)}},a=n(97012),s=function(){var e=(0,a.wh)().currentCommunity;return{room_type:o.H0.STREAM,view_type:o.Bk.GRID,access_type:o._d.OPEN,recording_enabled:!(null===e||void 0===e||!e.live_stream_recording_enabled),mute_on_join:!1,limit_url_sharing:!1}},l=n(85185),c=n(88767),u=n(24185),d=n(1320),m=n(49326),f=n(21809),p=function(e,t){var n=(0,f.p)(),o=n.success,i=n.error,a=(0,u.k6)();return(0,c.useMutation)((function(e){return d.Qk.create({formData:e,forReactQuery:!0})}),{onSuccess:function(n){t&&t(),o((0,r.t)("live_streams.form.".concat(e,".created_successfully"))),a.push(m.dE.room({roomSlug:n.slug}))},onError:function(){return i((0,r.t)("live_streams.form.create_error"))}})}},85185:(e,t,n)=>{n.d(t,{B:()=>s});var r=n(67294),o=n(96486),i=n(87536),a=n(11909),s=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=(0,i.qo)({name:"room_type",defaultValue:a.H0.STREAM});return(0,r.useEffect)((function(){(0,o.isFunction)(e)&&e(t)}),[t,e]),t}},81372:(e,t,n)=>{n.d(t,{nw:()=>i,n4:()=>r,Um:()=>o});var r={ATTENDEES:"attendees",COHOSTS:"cohosts"},o="live-form-modal-body",i=2},31256:(e,t,n)=>{n.d(t,{wK:()=>h,Wk:()=>r.W,tm:()=>c,oQ:()=>a,IO:()=>x,Yq:()=>b,$v:()=>g,lQ:()=>j});var r=n(83218),o=n(88767),i=n(49326),a=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{enabled:!0}).enabled,t=(0,o.useQuery)(i.av.liveStreams.configurations(),{enabled:e}),n=t.data,r=t.isLoading,a={};return null===n||void 0===n||n.forEach((function(e){a[e.feature_flag]=e.value})),{isLoading:r,config:a}},s=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{enabled:!0}).enabled,t=(0,o.useQuery)(i.av.liveStreams.usage(),{enabled:e}),n=t.data,r=t.isLoading,a={};return null===n||void 0===n||n.forEach((function(e){a[e.type]=e.value})),{isLoading:r,usage:a}},l=3600,c=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{enabled:!0}).enabled,t=a({enabled:e}),n=t.config,r=t.isLoading,o=s({enabled:e}),i=o.usage,c=o.isLoading,u=b(null,{enabled:e}).currentQuantity,d=g(null,{enabled:e}).currentQuantity,m=r||c,f=(null===i||void 0===i?void 0:i.stream_duration)||0,p=(null===n||void 0===n?void 0:n.live_stream_monthly_stream_hours)||0,v=p*l||0,h=d*l||0,y=(null===i||void 0===i?void 0:i.recordings_duration)||0,_=(null===n||void 0===n?void 0:n.live_stream_recording_hours)||0;return{isLoading:m,streamingHoursAvailable:f<v+h,recordingHoursAvailable:y<(_*l||0)+(u*l||0),streamingTotalPlanHours:p+d,recordingTotalPlanHours:_+u}},u=n(86013),d=n(1320),m=n(20557),f=n(65771);var p=function(e,t,n){var r=(arguments.length>3&&void 0!==arguments[3]?arguments[3]:{enabled:!0}).enabled,a=(0,f.E)().isCommunityOnTrial,s=(0,o.useQuery)(m.a.communityPlanAddons.show({addonId:e}),{enabled:r}),l=s.data,c=s.isLoading,p=s.refetch,v=s.isFetching,h=l||{},b=h.id,g=h.max_purchasable_quantity,y=h.name,_=h.quantity,j=h.price,x=h.unit_size,w=null===g||_<g,O=function(e){return null===g||_+e<=g},S=function(){var e,t,n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return a?Promise.resolve().then((function(){return window.location.href=(0,i.xn)()})):O(r)?d.zV.create((n=_+r,(t=b)in(e={})?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e),{forReactQuery:!0}):Promise.reject((0,u.t)("addons.community_plan_addon_hook.quantity_not_available_message"))},P=(0,o.useMutation)((function(e){return S(e)}),{onSuccess:function(){p(),null===n||void 0===n||n()},onError:function(e){null===t||void 0===t||t(e)}}),C=P.mutate,k=P.mutateAsync,I=P.isLoading;return{id:b,currentQuantity:_,maxPurchasableQuantity:g,name:y,price:j,unitSize:x,canPurchase:w,canPurchaseQuantity:O,purchase:C,purchaseAsync:k,refetch:p,isLoading:c,isFetching:v,isPurchasing:I}},v=n(21809),h=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{enabled:!0},t=(0,v.p)().error;return p("live_stream_spectators",(function(){return t((0,u.t)("live_streams.room.attendees_addon_quantity_error"))}),null,e)},b=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{enabled:!0},n=(0,v.p)().error;return p("live_stream_recording_hours",(function(){return n((0,u.t)("live_streams.room.recording_hours_addon_error"))}),e,t)},g=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{enabled:!0},n=(0,v.p)().error;return p("live_stream_monthly_stream_hours",(function(){return n((0,u.t)("live_streams.room.stream_hours_addon_error"))}),e,t)},y=(n(56789),["refetch","isLoading"]);function _(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var j=function(){var e,t,n,r,o,i,l,c,u,d,m,f,p=a(),v=p.config,j=p.isLoading,x=s(),w=x.usage,O=x.isLoading,S=(e=b(),t=e.isLoading,n=e.currentQuantity,r=e.refetch,o=g(),i=o.isLoading,l=o.currentQuantity,c=o.refetch,u=h(),d=u.isLoading,m=u.currentQuantity,f=u.refetch,{recordingHoursAddonQuantity:n,streamHoursAddonQuantity:l,attendeeSeatsAddonQuantity:m,isLoading:t||i||d,refetch:function(){r(),c(),f()}}),P=S.refetch,C=S.isLoading,k=_(S,y),I=j||O||C;return{monthlyHourLimit:parseInt(null===v||void 0===v?void 0:v.live_stream_monthly_stream_hours)+parseInt((null===k||void 0===k?void 0:k.streamHoursAddonQuantity)||0),monthlyHourUsage:((null===w||void 0===w?void 0:w.stream_duration)||0)/3600,storageLimit:parseInt(null===v||void 0===v?void 0:v.live_stream_recording_hours)+parseInt((null===k||void 0===k?void 0:k.recordingHoursAddonQuantity)||0),storageUsage:((null===w||void 0===w?void 0:w.recordings_duration)||0)/3600,hostLimit:null===v||void 0===v?void 0:v.live_stream_max_host_capacity,participantLimit:parseInt(null===v||void 0===v?void 0:v.live_stream_max_spectator_capacity)+parseInt((null===k||void 0===k?void 0:k.attendeeSeatsAddonQuantity)||0),isLoading:I,refetchAddons:P}},x=function(){var e=(0,o.useQuery)(i.av.liveStreams.usageLimit()),t=e.data;return{isLoading:e.isLoading,isMonthlyHourLimitReached:null===t||void 0===t?void 0:t.streaming_limit_reached,isStorageLimitReached:null===t||void 0===t?void 0:t.recording_limit_reached}}},83218:(e,t,n)=>{n.d(t,{W:()=>d});var r=n(86013),o=n(88767),i=n(24185),a=n(1320),s=n(97012),l=n(11909),c=n(49326),u=n(21809),d=function(){var e,t=(0,s.wh)().currentUser,n=(0,u.p)(),d=n.error,m=n.success,f=(0,i.k6)(),p=(0,o.useQuery)(c.av.liveStreams.liveNow({params:{per_page:1}})),v=p.data,h=p.remove,b=null===v||void 0===v||null===(e=v.records)||void 0===e?void 0:e[0],g=(0,o.useMutation)((function(){return a.Qk.endStream({id:null===b||void 0===b?void 0:b.id})}),{onSuccess:function(){m((0,r.t)("live_streams.room.".concat((0,l.vX)(b),".end_success"))),h()},onError:function(){return d((0,r.t)("live_streams.room.".concat((0,l.vX)(b),".end_error")))}});return{room:b,canManage:null===b||void 0===b?void 0:b.can_manage,handleNavigateToRoom:function(){if(b){var e=c.dE.room({roomSlug:b.slug});t||((0,l.L6)(b)?e=c.dE.publicRoom({roomSlug:b.slug}):window.location.href=c.dE.room({roomSlug:b.slug})),f.push(e)}},handleEndStream:function(e){e.stopPropagation(),g.mutate()}}}},56789:(e,t,n)=>{n.d(t,{h:()=>a});var r=n(67294);function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var a=function(){var e=o((0,r.useState)(),2),t=e[0];return{setRecordingEnabled:e[1],recordingEnabled:t}}},63082:(e,t,n)=>{n.d(t,{T:()=>_});var r=n(67294),o=n(94184),i=n.n(o),a=n(95172),s=n(72675),l=n(79329),c=n(30887),u=n(32918),d=n(16743),m=n(5295),f=n(53448),p=n(85893),v=function(e){var t=e.direction,n=void 0===t?"right":t,r=e.onClick;return(0,p.jsx)("button",{type:"button",className:"bg-primary focus-visible:!outline-secondary flex h-12 w-12 items-center justify-center rounded-full shadow focus-visible:!outline focus-visible:!outline-2 focus-visible:!outline-offset-2",onClick:r,children:(0,p.jsx)(c.JO,{size:20,type:"20-arrow-left",className:"right"==n?"rotate-180":""})})};function h(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return b(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return b(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var g=function(e){var t=e.attachments,n=void 0===t?[]:t,o=e.startIndex,b=void 0===o?0:o,g=h((0,r.useState)(b),2),y=g[0],_=g[1],j=h((0,r.useState)(!1),2),x=j[0],w=j[1],O=(0,s.dd)();(0,r.useEffect)((function(){}));var S=y<n.length-1,P=y>0,C=function(){return S&&_(y+1)},k=function(){return P&&_(y-1)},I=n[y],N=I.image_variants||{},A=u.$.isPDF(I.content_type),E=u.$.isImage(I.content_type);return(0,a.y1)("left",k,{enabled:P},[P,y,n]),(0,a.y1)("right",C,{enabled:S},[S,y,n]),(0,r.useEffect)((function(){E&&x&&w(!1)}),[I]),(0,p.jsxs)(f.u_,{isOpen:O.visible,onClose:function(){return O.remove()},title:I.filename,children:[(0,p.jsx)(f.u_.Overlay,{}),(0,p.jsxs)(f.u_.Content,{size:"full",children:[(0,p.jsxs)(f.u_.Header,{children:[(0,p.jsx)(d.Z.LabelMd,{weight:"medium",children:I.filename}),(0,p.jsxs)(f.u_.HeaderActions,{className:"items-center",children:[(0,p.jsx)("a",{className:"ml-2 focus:outline-none",href:I.url,download:!0,target:"_blank",rel:"noreferrer",children:(0,p.jsx)(c.JO,{className:"text-dark fill-current",type:"download"})}),(0,p.jsx)(f.u_.CloseButton,{onClick:O.remove})]})]}),(0,p.jsxs)(f.u_.Body,{className:"flex items-center justify-between",children:[(0,p.jsx)("div",{className:"w-16",children:P&&(0,p.jsx)(v,{direction:"left",onClick:k})}),(0,p.jsxs)("div",{className:"flex max-h-full flex-1 select-none justify-center",children:[A&&(0,p.jsx)(l.X,{src:I.url}),E&&(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("img",{loading:"eager",alt:"",className:i()("object-contain",{hidden:!x}),src:N.large||I.url,onLoad:function(){return w(!0)},onError:function(){return w(!0)}}),!x&&(0,p.jsx)(m.a,{center:!0})]})]}),(0,p.jsx)("div",{className:"w-16",children:S&&(0,p.jsx)(v,{direction:"right",onClick:C})})]})]})]})},y=s.gk.create((function(e){var t=e.startIndex,n=e.attachments;return(0,p.jsx)(g,{startIndex:t,attachments:n})})),_=function(){return(0,s.dd)(y)}},33552:(e,t,n)=>{n.d(t,{h:()=>x});var r=n(96486),o=n(72675),i=n(86013),a=n(43548),s=n(68375),l=n(55675),c=n(61926),u=n(78270),d=n(16743),m=n(85893),f=function(e){var t=e.post,n=e.spaces,r=e.isOpen,o=e.isLoading,f=e.isSubmitting,p=e.onSubmit,v=e.onClose;return o?null:(0,m.jsx)(u.u,{title:(0,i.t)("duplicate_post"),variant:"default",show:r,onClose:v,overflowVisible:!0,children:(0,m.jsxs)(c.l,{defaultValues:{space_id:t.space_id,send_notifications:!1},onSubmit:function(e){return p(e)},children:[(0,m.jsx)(c.l.Item,{name:"space_id",label:(0,i.t)("space"),description:(0,i.t)("duplicate_post_to_space"),rules:{required:(0,i.t)("events.create.form.space_required_error")},hideBorder:!0,fullWidth:!0,children:(0,m.jsx)(a.M,{name:"space_id",variant:"form-input",containerClassname:"mt-2",spaces:n})}),(0,s.Hz)(t)&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(d.Z.LabelXs,{color:"text-light",children:(0,i.t)("comments_wont_be_duplicated")}),(0,m.jsx)(c.l.Item,{name:"send_notifications",label:(0,i.t)("duplicate_post_send_notifications"),hideDescription:!0,inlineReverse:!0,hideBorder:!0,fullWidth:!0,children:(0,m.jsx)(c.l.ToggleSwitch,{name:"send_notifications",variant:"small"})})]}),(0,m.jsx)("div",{className:"mt-4",children:(0,m.jsx)(l.z,{type:"submit",variant:"primary",disabled:f,children:f?(0,i.t)("duplicating"):(0,i.t)("duplicate")})})]})})},p=n(88767),v=n(3917),h=n(21809),b=n(97012);function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var _=function(e){var t=e.post,n=e.onSuccess,a=(0,o.dd)(),s=(0,b.nT)(),l=s.isLoading,c=s.helpers,u=function(e){var t=e.post,n=e.onSuccess,o=(0,h.p)(),a=o.success,s=o.error,l=(0,p.useMutation)((function(e){return(0,v.gX)({spaceId:t.space_id,postSlug:t.slug,payload:{post:{space_id:e.space_id,send_notifications:e.send_notifications}}})}),{onSuccess:function(e){a((0,i.t)("duplicated_successfully")),(0,r.isFunction)(n)&&n(e)},onError:function(){s((0,i.t)("duplication_failed"))}});return{duplicate:l.mutate,isDuplicating:l.isLoading}}({post:t,onSuccess:function(e){(0,r.isFunction)(n)&&n(e),a.remove()}}),d=u.duplicate,g=u.isDuplicating;return(0,m.jsx)(f,{post:t,spaces:c.imageSpacesWithPostCreationAllowed(),isOpen:a.visible,isLoading:l,isSubmitting:g,onSubmit:d,onClose:a.remove})},j=o.gk.create((function(e){return(0,m.jsx)(_,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){y(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e))})),x=function(){return(0,o.dd)(j)}},24885:(e,t,n)=>{n.d(t,{Z:()=>c});var r=n(36658),o=n(72675),i=n(18919),a=n(85893),s=function(e){var t=e.event,n=e.defaultSection,s=e.locationType,l=(0,o.dd)(),c=l.visible,u=l.hide;return(0,a.jsx)(i.K,{children:(0,a.jsx)(r.G,{isOpen:c,onClose:u,event:t,locationType:s,initialSection:n})})},l=o.gk.create((function(e){var t=e.event,n=e.defaultSection,r=e.locationType;return(0,a.jsx)(s,{event:t,defaultSection:n,locationType:r})})),c=function(){return(0,o.dd)(l)}},66927:(e,t,n)=>{n.d(t,{e:()=>_n});var r,o=n(86013),i=n(96486),a=n(67294),s=n(55675),l=n(53448);function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var u="upload_images",d="adjust_images",m="create_post",f="square",p="landscape",v="portrait",h=(c(r={},f,1),c(r,p,16/9),c(r,v,.8),r),b=n(30270);function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){_(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function j(e){return function(e){if(Array.isArray(e))return x(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return x(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return x(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function x(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var w=function(e){return e.selectedFiles.forEach((function(e){return URL.revokeObjectURL(e.preview)})),{selectedFiles:[]}},O=(0,b.Ue)((function(e){return{currentStep:u,isSubmitting:!1,isFormDirty:!1,isImagesDirty:!1,isScheduledBarPortalRendered:!1,galleryAspectRatio:null,selectedFiles:[],uploadedImages:[],setCurrentStep:function(t){return e({currentStep:t})},setIsSubmitting:function(t){return e({isSubmitting:t})},setIsFormDirty:function(t){return e({isFormDirty:t})},setIsImagesDirty:function(t){return e({isImagesDirty:t})},setIsScheduledBarPortalRendered:function(t){return e({isScheduledBarPortalRendered:t})},updateImage:function(t){e((function(e){var n=e.selectedFiles.findIndex((function(e){return e.preview===t.preview}));return e.selectedFiles[n]=t,{selectedFiles:j(e.selectedFiles)}}))},addSelectedFiles:function(t){e((function(e){return{selectedFiles:[].concat(j(e.selectedFiles),j(t))}}))},setSelectedFiles:function(t){e({selectedFiles:t})},addUploadedImages:function(t){e((function(e){return{uploadedImages:[].concat(j(e.uploadedImages),j(t))}}))},setUploadedImages:function(t){e({uploadedImages:t})},setGalleryAspectRatio:function(t){e(t<(h.portrait+h.square)/2?{galleryAspectRatio:h.portrait}:t>(h.landscape+h.square)/2?{galleryAspectRatio:h.landscape}:{galleryAspectRatio:h.square})},resetSelectedFiles:function(){e(w)},reset:function(){e((function(e){return y(y({},w(e)),{},{currentStep:null,uploadedImages:[],galleryAspectRatio:null,isSubmitting:!1,isFormDirty:!1,isImagesDirty:!1,isScheduledBarPortalRendered:!1})}))}}})),S=n(94184),P=n.n(S),C=n(32070),k=n(16743),I=n(87958),N=n(20633),A=n(85893);function E(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return T(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return T(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function T(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var D=[{format:f,iconType:"16-image-square"},{format:v,iconType:"16-image-portrait"},{format:p,iconType:"16-image-landscape"}],R=function(){var e,t=O(),n=t.galleryAspectRatio,r=t.setGalleryAspectRatio,i=null===(e=Object.entries(h).find((function(e){return E(e,2)[1]===n})))||void 0===e?void 0:e[0],a="image_space.post_modal.steps.adjust_images.cropping_options";return(0,A.jsx)("div",{className:"text-default flex justify-between",children:D.map((function(e){var t=e.format,n=e.iconType;return(0,A.jsx)(I.T,{content:(0,o.t)("".concat(a,".").concat(t)),children:(0,A.jsx)(N.h,{onClick:function(){r(h[t])},className:P()({"bg-tertiary":i===t}),name:n,iconSize:16,buttonSize:28,iconClassName:P()({"!text-dark":i===t}),ariaLabel:(0,o.t)("".concat(a,".").concat(t))})},t)}))})},L=n(33275);function M(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function F(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?M(Object(n),!0).forEach((function(t){U(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):M(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function U(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function B(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return z(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return z(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function z(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var H=function(e){var t=e.currentImage,n=B((0,a.useState)(null),2),r=n[0],o=n[1],s=O(),l=s.updateImage,c=s.galleryAspectRatio,u=s.setGalleryAspectRatio;return(0,a.useEffect)((function(){var e=new Image;e.src=t.preview,e.onload=function(){o(e)}}),[t.preview]),(0,a.useEffect)((function(){if(!c&&r){var e=r.width,t=r.height;u(e/t)}}),[c,r]),r&&c?(0,A.jsx)("div",{className:"relative flex aspect-video max-w-full grow cursor-pointer",children:(0,A.jsx)(L.Z,{image:t.preview,crop:t.crop,aspect:c,zoom:t.zoom,onCropChange:function(e){e!==t.crop&&l(F(F({},(0,i.cloneDeep)(t)),{},{crop:e}))},onZoomChange:function(e){e!==t.zoom&&l(F(F({},(0,i.cloneDeep)(t)),{},{zoom:e}))},onCropComplete:function(e,n){l(F(F({},(0,i.cloneDeep)(t)),{},{croppedAreaPixels:n}))}})}):null},q=n(59675),Z=n(30887),V=n(66946),W=n(67254),Q=n(82991),$=n(26953),G=function(e){var t=e.onClick,n=e.index,r=e.currentImageIndex,i=(0,V.dw)().activeItem,a=Boolean(i),s=(0,$.en)();return(0,A.jsx)(N.h,{onClick:t,className:P()("bg-tertiary border-secondary outline-tertiary absolute -right-0.5 -top-0.5 z-10 hidden h-4 w-4 rounded-full border !p-0 outline outline-2",{"group-hover:!flex":!a},{"!flex":!s&&!a&&n===r}),buttonSize:16,iconClassName:"!text-dark",name:"16-close",ariaLabel:(0,o.t)("delete_image")})},J=function(e){var t,n=e.direction,r=e.scrollableContainerRef,o="left"===n?-200:200;null===r||void 0===r||null===(t=r.current)||void 0===t||t.scroll({left:(null===r||void 0===r?void 0:r.current.scrollLeft)+o,behavior:"smooth"})},K=function(e){var t=e.direction,n=e.scrollableContainerRef,r="left"===t,o="right"===t;return(0,A.jsxs)("div",{className:P()("absolute z-30 flex h-full items-center",{"-left-px":r,"-right-px":o}),children:[o&&(0,A.jsx)("div",{className:"from-primary h-full w-8 bg-gradient-to-l to-transparent"}),(0,A.jsx)("button",{type:"button",onClick:function(){return J({direction:t,scrollableContainerRef:n})},className:"bg-primary group flex h-full cursor-pointer items-center px-2 py-1",children:(0,A.jsx)(Z.JO,{size:16,className:P()({"-rotate-90":o,"rotate-90":r},"text-light group-hover:text-darkest"),type:"caret-down-bold"})}),r&&(0,A.jsx)("div",{className:"from-primary h-full w-8 bg-gradient-to-r to-transparent"})]})},Y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i.noop,t=O().addSelectedFiles;return{handleFileSelection:function(n){n=n.map((function(e){return{file:e,preview:URL.createObjectURL(e),crop:{x:0,y:0},zoom:1}})),t(n),e()}}},X=n(41389),ee=n(21809),te=function(e){var t=e.handleFileSelection,n=e.selectedFiles,r=e.uploadedFilesCount,i=(0,ee.p)(),a="image_space.post_modal.steps.upload_images.errors",s=10-r,l=function(e){e.reduce((function(e,t){var n=t.errors[0].code;return e.includes(n)||e.push(n),e}),[]).forEach((function(e){var t={shouldShowCloseButton:!0,shouldUseProgress:!1};switch(e){case"file-invalid-type":return i.error((0,o.t)("".concat(a,".file_invalid_type")),t);case"file-too-large":return i.error((0,o.t)("".concat(a,".file_too_large")),t);case"too-many-files":return i.error((0,o.t)("".concat(a,".too_many_files"),{max_images:10}),t);default:return i.error((0,o.t)("".concat(a,".something_went_wrong")),t)}}))},c=(0,X.uI)({onDrop:function(e,r){r.length>0?l(r):parseInt(n.length)+parseInt(e.length)>s?l([{errors:[{code:"too-many-files"}]}]):t(e)},noClick:!0,accept:{"image/*":[".jpg",".jpeg",".png"]},maxFiles:s,maxSize:2e7,multiple:!0}),u=c.getRootProps,d=c.getInputProps,m=c.isDragAccept,f=c.isDragReject;return{getRootProps:u,getInputProps:d,isDragActive:m||f,open:c.open}},ne=function(e){var t=e.fileStates,n=e.index;return(0,A.jsx)("div",{className:"shrink-0 p-1",children:(0,A.jsxs)("div",{className:"bg-tertiary flex h-12 w-12 items-center justify-center rounded-md",children:["completed"===t[n].status&&(0,A.jsx)(Z.JO,{type:"20-checkmark-circle-fill",size:20,className:"text-default"}),"uploading"===t[n].status&&(0,A.jsx)(C.D,{percentage:t[n].progress,size:18,strokeWidth:1.5}),"error"===t[n].status&&(0,A.jsx)(k.Z.LabelXs,{color:"text-default",children:(0,o.t)("image_space.post_modal.steps.adjust_images.file_error")})]})})},re=function(e){var t=e.image,n=e.index,r=e.setCurrentImageIndex,o=e.currentImageIndex;return(0,A.jsx)("button",{type:"button",onClick:function(){return r(n)},className:P()("shrink-0 cursor-pointer touch-none select-none rounded-lg border-2 border-transparent p-0.5",{"border-secondary":n===o}),children:(0,A.jsx)("img",{loading:"eager",src:t.preview,className:"h-12 w-12 rounded-md object-cover",alt:t.file.name})},t.preview)},oe=function(e){var t=e.isOverlay,n=void 0!==t&&t,r=(0,V.dI)().item;return(0,A.jsx)("div",{className:P()("rounded-lg border-2 border-transparent p-0.5 opacity-50",{"!opacity-100":n}),children:(0,A.jsx)("img",{loading:"eager",src:r.preview,className:"h-12 w-12 rounded-md object-cover",alt:r.file.name})})};function ie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ae(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ie(Object(n),!0).forEach((function(t){se(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ie(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function se(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function le(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return ce(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ce(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ce(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ue=function(e){var t=e.selectedFiles,n=e.setCurrentImageIndex,r=e.currentImageIndex,o=e.status,i=e.fileStates,s=e.editingImageSignedId,c=e.onDeleteAllImages,u=(0,a.useRef)(null),d=le((0,q.A)(),2),m=d[0],f=d[1],p=le((0,q.A)(),2),v=p[0],h=p[1],b=(0,l.UV)().contentPortalElement,g=O(),y=g.uploadedImages,_=g.setSelectedFiles,j=Y((function(){setTimeout((function(){return J({direction:"right",scrollableContainerRef:u})}),200)})).handleFileSelection,x=te({handleFileSelection:j,selectedFiles:t,uploadedFilesCount:y.length}),w=x.getInputProps,S=x.open,P=function(){var e=O(),t=e.setSelectedFiles,n=e.selectedFiles;return{removeImage:function(e){var r=n.filter((function(t){return t!==e}));t(r)}}}(),C=P.removeImage,k=t.map((function(e){return ae(ae({},e),{},{id:e.preview})})),I=k[r],N=!s&&t.length+y.length<10;return(0,A.jsxs)("div",{className:"relative mt-5 flex",children:[!f&&(0,A.jsx)(K,{direction:"left",scrollableContainerRef:u}),(0,A.jsxs)(V.cm,{shouldUseKeyboardSensor:!1,distance:10,items:k,onSort:function(e){var t=e.indexOf(I);t!==r&&n(t),_(e.map((function(e){return ae(ae({},e),{},{id:void 0})})))},restrictToParentElement:!0,children:[(0,A.jsx)(V.Fo,{children:(0,A.jsxs)("div",{className:"scrollbar-hide m-auto !flex items-center overflow-x-scroll px-1 pt-1",ref:u,"data-testid":"thumbnails-list",children:[(0,A.jsx)("div",{className:"h-px w-px",ref:m}),t.map((function(e,a){return"uploading"===o||"completed"===o?(0,A.jsx)(ne,{fileStates:i,index:a},e.preview):(0,A.jsxs)(Q.c,{tabIndex:-1,item:k[a],disabled:1===y.length,placeholder:oe,className:"group relative !w-auto shrink-0",dataTestId:"thumbnail-item",children:[(0,A.jsx)(G,{onClick:function(){C(e),1===t.length&&c()},index:a,currentImageIndex:r}),(0,A.jsx)(re,{image:e,index:a,setCurrentImageIndex:n,currentImageIndex:r})]},e.preview)})),N&&(0,A.jsxs)("button",{type:"button",className:"hover:bg-secondary text-default ml-1 flex h-12 w-12 shrink-0 cursor-pointer items-center justify-center rounded-md border border-dashed",onClick:function(){return"uploading"!==o&&S()},children:[(0,A.jsx)("input",ae(ae({},w()),{},{"data-testid":"upload_more_images"})),(0,A.jsx)(Z.JO,{type:"20-add-lg",size:20})]}),(0,A.jsx)("div",{className:"h-px w-px",ref:v})]})}),(0,A.jsx)(W.y,{portalTo:b,children:(0,A.jsx)(oe,{isOverlay:!0})})]}),!h&&(0,A.jsx)(K,{direction:"right",scrollableContainerRef:u})]})},de=n(27728);function me(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return fe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return fe(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function fe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function pe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ve(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pe(Object(n),!0).forEach((function(t){he(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function he(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var be=function(e){var t=e.currentImage,n=O().updateImage;return(0,A.jsxs)("div",{className:"text-light flex items-center justify-between",children:[(0,A.jsx)(N.h,{name:"16-zoom-out",onClick:function(){var e=ve(ve({},(0,i.cloneDeep)(t)),{},{zoom:t.zoom-.1});e.zoom>=1&&n(e)},className:"mr-3",iconSize:16,buttonSize:28,ariaLabel:(0,o.t)("zoom_out")}),(0,A.jsx)("div",{className:"flex h-4 w-32 items-center",children:(0,A.jsxs)(de.i.Root,{value:[Math.round(10*t.zoom)/10],max:5,min:1,step:.1,onValueChange:function(e){var r=me(e,1)[0];r!==t.zoom&&n(ve(ve({},(0,i.cloneDeep)(t)),{},{zoom:r}))},children:[(0,A.jsx)(de.i.Track,{children:(0,A.jsx)(de.i.Range,{className:"!bg-badge"})}),(0,A.jsx)(de.i.Thumb,{className:"before:!bg-badge"})]})}),(0,A.jsx)(N.h,{onClick:function(){var e=ve(ve({},(0,i.cloneDeep)(t)),{},{zoom:t.zoom+.1});e.zoom<=5&&n(e)},className:"ml-3",name:"16-zoom-in",iconSize:16,buttonSize:28,ariaLabel:(0,o.t)("zoom_in")})]})};function ge(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return ye(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ye(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ye(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var _e=function(e){var t=e.status,n=e.overallProgress,r=e.fileStates,i=e.editingImageSignedId,s=e.onDeleteAllImages,l=ge((0,a.useState)(0),2),c=l[0],u=l[1],d=O(),m=d.selectedFiles,f=d.uploadedImages,p=m[c],v=(0,a.useRef)(m.length),h=v.current,b=m.length;return b>0&&c>b-1?u(m.length-1):b>h&&u(h),v.current=b,p?(0,A.jsxs)(A.Fragment,{children:[(0,A.jsxs)("div",{className:P()("border-primary flex grow flex-col overflow-hidden rounded-md border",{"bg-tertiary":"uploading"===t}),children:["idle"===t&&(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(H,{currentImage:p}),(0,A.jsxs)("div",{className:"border-primary flex justify-between border-t px-4 py-3",children:[0===f.length&&(0,A.jsx)(R,{}),(0,A.jsx)(be,{currentImage:p})]})]}),("uploading"===t||"completed"===t)&&(0,A.jsxs)("div",{className:"mb-12 mt-1 flex aspect-video flex-col items-center justify-center gap-4",children:[(0,A.jsx)(C.D,{percentage:n,size:22,strokeWidth:1.75}),(0,A.jsx)(k.Z.LabelMd,{color:"text-default",children:(0,o.t)("image_space.post_modal.steps.adjust_images.uploading")})]}),"error"===t&&(0,A.jsx)("div",{className:"mb-12 mt-1 flex aspect-video flex-col items-center justify-center gap-4",children:(0,A.jsx)(k.Z.LabelMd,{color:"text-default",children:(0,o.t)("image_space.post_modal.steps.adjust_images.files_error")})})]}),(0,A.jsx)(ue,{currentImageIndex:c,selectedFiles:m,setCurrentImageIndex:u,fileStates:r,status:t,editingImageSignedId:i,onDeleteAllImages:s})]}):null},je=n(79292),xe=n(49326);function we(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Oe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?we(Object(n),!0).forEach((function(t){Se(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):we(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Se(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Pe(e){return function(e){if(Array.isArray(e))return Ie(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||ke(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ce(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||ke(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ke(e,t){if(e){if("string"===typeof e)return Ie(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ie(e,t):void 0}}function Ie(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ae(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ne(Object(n),!0).forEach((function(t){Ee(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ne(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ee(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Te=function(e,t){var n,r,o,i;return e.width/e.height>t?(o=Math.round(e.height*t),i=e.height,n=Math.round((e.width-o)/2),r=0):(o=e.width,i=Math.round(e.width/t),n=0,r=Math.round((e.height-i)/2)),{x:n,y:r,width:o,height:i}},De=function(){var e=O(),t=e.selectedFiles,n=e.setSelectedFiles,r=e.galleryAspectRatio,o=e.setUploadedImages,i=e.addUploadedImages,s=e.uploadedImages,l=e.setIsImagesDirty,c=function(){var e=Ce((0,a.useState)([]),2),t=e[0],n=e[1],r=Ce((0,a.useState)(0),2),o=r[0],i=r[1];return(0,a.useEffect)((function(){var e=t.reduce((function(e,t){return e+t.progress}),0);i(t.length?e/t.length:0)}),[t]),{status:t.some((function(e){return"error"===e.status}))?"error":t.every((function(e){return"idle"===e.status}))?"idle":t.every((function(e){return"completed"===e.status}))?"completed":"uploading",fileStates:t,overallProgress:o,reset:function(){n([]),i(0)},uploadFiles:function(e){var t=e.map((function(){return{progress:0,status:"idle"}}));n(t),e.forEach((function(e,t){new je.DirectUpload(e,(0,xe.hq)(),{directUploadWillStoreFileWithXHR:function(e){e.upload.addEventListener("loadstart",(function(){n((function(e){var n=Pe(e);return n[t]=Oe(Oe({},n[t]),{},{status:"uploading"}),n}))})),e.upload.addEventListener("progress",(function(e){n((function(n){var r=Pe(n);return r[t]=Oe(Oe({},r[t]),{},{progress:e.loaded/e.total*100}),r}))}))}}).create((function(e,r){if(e)throw n((function(e){var n=Pe(e);return n[t]=Oe(Oe({},n[t]),{},{status:"error"}),n})),new Error("Direct upload failed: ".concat(null===e||void 0===e?void 0:e.message));n((function(e){var n=Pe(e);return n[t]=Oe(Oe({},n[t]),{},{status:"completed",progress:100,response:Oe({blob_url:(0,xe.Gd)({signed_id:r.signed_id,filename:encodeURIComponent(r.filename)})},r)}),n}))}))}))}}}(),u=c.status,d=c.overallProgress,m=c.reset,f=c.fileStates,p=c.uploadFiles;return{uploadImages:function(){if(!r)throw new Error("Gallery aspect ratio not set");var e=t.map((function(e){return function(e,t){return new Promise((function(n,r){var o=new Image,i=document.createElement("canvas"),a=i.getContext("2d");if(e.croppedAreaPixels){var s=e.croppedAreaPixels,l=s.width,c=s.height;parseFloat((l/c).toFixed(2))!==parseFloat(t.toFixed(2))&&(e.croppedAreaPixels=void 0)}o.src=URL.createObjectURL(e.file),o.onload=function(){var r=e.croppedAreaPixels||Te(o,t);i.width=r.width,i.height=r.height,null===a||void 0===a||a.drawImage(o,r.x,r.y,r.width,r.height,0,0,r.width,r.height),i.toBlob((function(t){if(t){var o=new File([t],e.file.name,{type:"image/jpeg",lastModified:(new Date).getTime()});n({croppedImage:o,croppedArea:r})}}),"image/jpeg")},o.onerror=function(e){r(e)}}))}(e,r)}));Promise.all(e).then((function(e){n(t.map((function(t,n){return Ae(Ae({},t),{},{croppedAreaPixels:e[n].croppedArea})}))),p(e.map((function(e){return e.croppedImage})))})).catch((function(e){throw new Error("Error processing images: ".concat(e))}))},overallProgress:d,resetUploads:m,status:u,fileStates:f,updateStoredImages:function(e){if(e){var n=t[0],r={signed_id:f[0].response.signed_id,url:f[0].response.blob_url,original_url:f[0].response.blob_url,filename:f[0].response.filename,width:n.croppedAreaPixels.width,height:n.croppedAreaPixels.height};o(s.map((function(t){return t.signed_id===e?Ae(Ae({},t),r):t})))}else i(f.map((function(e,n){return{signed_id:e.response.signed_id,url:e.response.blob_url,original_url:e.response.blob_url,filename:e.response.filename,width:t[n].croppedAreaPixels.width,height:t[n].croppedAreaPixels.height}})));l(!0)}}},Re=function(e){var t=e.onClose,n=e.onCompleted,r=void 0===n?i.noop:n,c=e.isOnTop,d=void 0!==c&&c,f=e.editingImageSignedId,p=O(),v=p.setCurrentStep,h=p.resetSelectedFiles,b=De(),g=b.uploadImages,y=b.overallProgress,_=b.resetUploads,j=b.status,x=b.fileStates,w=b.updateStoredImages,S=function(){h(),d?t():v(u)};return(0,a.useEffect)((function(){"completed"===j?(w(f),_(),h(),v(m),r(),d&&t()):"error"===j&&_()}),[d,j]),(0,A.jsxs)(l.u_,{isOpen:!0,onClose:function(){h(),t()},contentPortalId:"adjust-images-modal-portal",children:[(0,A.jsx)(l.u_.Overlay,{}),(0,A.jsxs)(l.u_.Content,{size:"xl",children:[(0,A.jsxs)(l.u_.Header,{children:[(0,A.jsx)(l.u_.Title,{size:"sm",children:(0,o.t)("image_space.post_modal.steps.adjust_images.title")}),(0,A.jsxs)(l.u_.HeaderActions,{className:"!gap-3",children:[(0,A.jsx)(s.z,{type:"button",variant:"secondary",onClick:S,children:(0,o.t)("cancel")}),(0,A.jsx)(s.z,{type:"submit",variant:"circle",disabled:"uploading"===j,onClick:function(){return g()},children:d?(0,o.t)("save"):(0,o.t)("next")})]})]}),(0,A.jsx)(l.u_.Body,{className:"flex flex-col pb-5 pt-4",children:(0,A.jsx)(_e,{status:j,fileStates:x,overallProgress:y,editingImageSignedId:f,onDeleteAllImages:S})})]})]})},Le=n(64687),Me=n.n(Le),Fe=n(88767),Ue=n(24185),Be=n(30658),ze=n(65998),He=n(3917);function qe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ze(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?qe(Object(n),!0).forEach((function(t){Ve(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ve(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var We=function(e){return(0,i.pick)(e,["tiptap_body","hide_meta_info","is_comments_disabled","is_comments_closed","is_liking_disabled","is_truncation_disabled","pin_to_top","pinned_at","hide_from_featured_areas","gallery.downloadable_images","slug","user_id","status","published_at","topics"])},Qe=function(e){var t=e.space,n=e.post,r=e.onSuccess,a=(0,ee.p)(),s=O(),l=s.setIsSubmitting,c=s.uploadedImages,u=!!n.slug,d={onSuccess:function(e){l(!1),r(e),a.success((0,o.t)(u?"quick_post.toasts.changes_saved":"quick_post.toasts.".concat(e.status,"_saved")))},onError:function(e){l(!1),a.error(e.errorDetails,{shouldShowCloseButton:!0,shouldUseProgress:!1})}},m=(0,Fe.useMutation)((function(e){return n.slug?(0,He._u)({spaceId:t.id,postSlug:n.slug,payload:e}):(0,He.x6)({spaceId:t.id,payload:e})}),d).mutate;return{onSubmit:function(e){l(!0),m(function(e){var t=e.payload,n=e.space,r=e.uploadedImages;return{post:Ze(Ze({},(0,i.omit)(t,["gallery"])),{},{space_id:null===n||void 0===n?void 0:n.id,gallery_attributes:Ze(Ze({},t.gallery),{},{images_attributes:r.map((function(e){return{id:e.id,image:e.signed_id,width:e.width,height:e.height}}))})})}}({payload:e,space:t,uploadedImages:c}))}}},$e=n(68375),Ge=n(81217),Je=n(97012),Ke=n(61926),Ye=n(87536),Xe=n(67685),et=n(20405),tt=n(83489),nt=n(61345),rt=n(83088);function ot(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return it(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return it(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function it(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var at=function(e){var t=e.post,n=(0,Je.wh)().currentCommunitySettings,r=null===n||void 0===n?void 0:n.topics_enabled,s=ot((0,a.useState)(!1),2),l=s[0],c=s[1],u=(0,$.j)(),d=(0,Ye.Gc)(),m=d.watch,f=d.setValue,p=O(),v=p.isSubmitting,h=p.uploadedImages,b=p.isScheduledBarPortalRendered,g=(0,Je.L2)().data,y=m(),_=y.published_at,j=y.status,x=y.topics,w=r&&(null===g||void 0===g?void 0:g.require_topic_selection)&&Number(null===x||void 0===x?void 0:x.length)<=0,S=h.length>0&&!v&&!w,P=!(null===t||void 0===t||!t.id),C=(0,$e.Hz)(t),k="quick_post.scheduled_post_ui.".concat(v?"submitting_button":"submit_button"),N=[{icon:"16-download",label:(0,o.t)("".concat(k,".save_draft")),value:"draft"},{icon:"16-calendar",label:(0,o.t)("".concat(k,".schedule_post")),value:"scheduled"},{icon:"16-publish",label:(0,o.t)("".concat(k,".publish")),value:"published"}],E=(0,i.find)(N,{value:j||"published"}),T=function(e){"scheduled"===e.value?c(!0):(f("status",e.value),c(!1),D(null))},D=function(e){f("published_at",e)},R=function(){T(N[0])},L=g&&(0,nt.k8)(g)&&!C;return(0,A.jsxs)(A.Fragment,{children:[b&&(0,A.jsx)(tt.e,{publishedAt:_,revertToDraftState:R,status:j,updatePublishedAt:D,variant:u?"2-lines":"default"}),(0,A.jsx)(Xe.M,{datePickerVisible:l,onCancel:function(e){e&&e.preventDefault(),c(!1),"scheduled"===j&&R()},value:_,onSave:function(e){D(e),f("status","scheduled"),c(!1)},placement:"bottom-end",saveButtonVariant:"circle",children:L?(0,A.jsx)(I.T,{disabled:!w,content:(0,o.t)("quick_post_v2.error_messages.no_topics"),trigger:"mouseenter click focus focusin",placement:"bottom",children:(0,A.jsx)(rt.F,{type:"submit",disabled:!S,selectedAction:E,setSelectedAction:T,options:N,variant:"circle"})}):(0,A.jsx)(I.T,{disabled:!w,content:(0,o.t)("quick_post_v2.error_messages.no_topics"),trigger:"mouseenter click focus focusin",placement:"bottom",children:(0,A.jsx)(et.a,{isEdit:P,isDisabled:!S})})})]})},st=n(49834),lt=n(5295);function ct(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ut(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ct(Object(n),!0).forEach((function(t){dt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ct(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function dt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var mt=function(e){var t=e.isDragActive,n=e.getRootProps,r=e.getInputProps,i=e.open,a=e.className,s="image_space.post_modal.steps.upload_images";return(0,A.jsx)("div",ut(ut({},n()),{},{className:"group h-full w-full",children:(0,A.jsxs)("button",{type:"button",className:P()("flex h-full w-full flex-col items-center justify-center px-4 text-center",a),onClick:i,children:[(0,A.jsx)("input",ut(ut({},r()),{},{"data-testid":"upload_multi_image"})),(0,A.jsx)(Z.JO,{size:24,type:"24-circle-arrow-up",className:P()("text-default  !h-6 !w-6",{"group-hover:text-messaging-info-blue":!t})}),(0,A.jsx)("div",{className:"mb-1 mt-3",children:(0,A.jsxs)(k.Z.LabelMd,{weight:"semibold",color:P()("text-dark",{"group-hover:text-messaging-info-blue":!t}),children:[(0,o.t)("".concat(s,".drag_and_drop_up_to_n_images"),{max_images:10}),t&&" "+(0,o.t)("".concat(s,".here"))]})}),!t&&(0,A.jsx)(k.Z.LabelSm,{color:"text-default group-hover:text-messaging-info-blue",children:(0,o.t)("".concat(s,".recommendation"))})]})}))},ft=["isDragActive"];function pt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function vt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pt(Object(n),!0).forEach((function(t){ht(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ht(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function bt(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function gt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return yt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return yt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function yt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var _t=function(){var e=gt((0,a.useState)(!1),2),t=e[0],n=e[1],r=O(),o=r.selectedFiles,i=r.uploadedImages,s=Y((function(){return n(!0)})).handleFileSelection,l=te({handleFileSelection:s,selectedFiles:o,uploadedFilesCount:i.length}),c=l.isDragActive,u=bt(l,ft);return(0,A.jsxs)("div",{className:P()("flex h-full w-full flex-col items-center justify-center rounded-md px-4 text-center ",{"!bg-light-blue":c}),children:[(0,A.jsx)(mt,vt(vt({isDragActive:c},u),{},{className:"pb-0"})),t&&(0,A.jsx)(Re,{onClose:function(){return n(!1)},isOnTop:!0})]})},jt=n(1002),xt=n(32656),wt=function(){var e=O(),t=e.setUploadedImages,n=e.uploadedImages,r=e.setIsImagesDirty;return{removeImage:function(e){var o=n.filter((function(t){return t!==e}));t(o),r(!0)}}};function Ot(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return St(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return St(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function St(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Pt(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}function Ct(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){Pt(i,r,o,a,s,"next",e)}function s(e){Pt(i,r,o,a,s,"throw",e)}a(void 0)}))}}var kt=function(){var e=Ct(Me().mark((function e(t){var n,r,o,i,a;return Me().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.url,r=t.fileName,o=t.contentType,e.next=3,fetch(n);case 3:return i=e.sent,e.next=6,i.blob();case 6:return a=e.sent,e.abrupt("return",new File([a],r,{type:o,lastModified:(new Date).getTime()}));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),It=function(e){var t,n=e.currentImage,r=Ot((0,a.useState)(!1),2),i=r[0],s=r[1],l=wt().removeImage,c=Y((function(){return s(!0)})).handleFileSelection,u="image_space.post_modal.steps.create_post.image_options",d=[{value:(0,o.t)("".concat(u,".crop_image")),label:(0,o.t)("".concat(u,".crop_image")),icon:"16-crop",onClick:(t=Ct(Me().mark((function e(){var t;return Me().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,kt({url:n.original_url,fileName:n.filename,contentType:"image/jpeg"});case 2:t=e.sent,c([t]);case 4:case"end":return e.stop()}}),e)}))),function(){return t.apply(this,arguments)})},{value:(0,o.t)("".concat(u,".remove")),label:(0,o.t)("".concat(u,".remove")),icon:"16-trash-bin",onClick:function(){l(n)}}];return(0,A.jsxs)(A.Fragment,{children:[i&&(0,A.jsx)(Re,{onClose:function(){return s(!1)},isOnTop:!0,editingImageSignedId:n.signed_id}),(0,A.jsx)(jt.Lt,{direction:"bottom-end",className:"absolute right-4 top-4",button:(0,A.jsx)(N.h,{name:"16-menu-dots-horizontal",iconClassName:"!text-dark",className:"bg-primary border-primary rounded-full border",ariaLabel:(0,o.t)("".concat(u,".label"))}),children:(0,A.jsx)(xt.A,{options:d,linkType:"button"})})]})};function Nt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return At(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return At(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function At(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Et=function(e){var t,n=e.currentImageIndex,r=(0,a.useRef)(null),o=(0,a.useRef)(null),i=Nt((0,a.useState)(!0),2),s=i[0],l=i[1],c=Nt((0,a.useState)(),2),u=c[0],d=c[1],m=O(),f=m.uploadedImages,p=m.galleryAspectRatio,v=m.setGalleryAspectRatio,h=f[n];return(0,a.useEffect)((function(){if(!p&&h){var e=h.width/h.height;v(e)}}),[p,h,v]),(0,a.useEffect)((function(){if(!s&&o.current){var e=o.current.getBoundingClientRect(),t=e.width,n=e.height;d(t/n)}}),[s,o]),h?(p&&u&&(t=p>u?"w-full my-auto":p<u?"h-full":"h-full w-full"),(0,A.jsxs)("div",{className:"flex justify-center overflow-auto md:grow",ref:o,children:[s&&(0,A.jsx)(lt.a,{}),(0,A.jsxs)("div",{className:P()("relative",t),children:[(0,A.jsx)(It,{currentImage:h}),(0,A.jsx)("img",{loading:"eager",ref:r,src:h.url,alt:h.filename,onLoad:function(){return l(!1)},className:P()("rounded-md",{hidden:s},t)})]})]})):(0,A.jsx)(_t,{})};function Tt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return Dt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Dt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Dt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Rt=function(e){var t=e.image,n=e.index,r=e.currentImageIndex,o=e.onClick,i=Tt((0,a.useState)(!0),2),s=i[0],l=i[1];return(0,A.jsx)("button",{type:"button",onClick:function(){return o(n)},className:P()("cursor-pointer touch-none select-none rounded-lg border-2 border-transparent p-0.5",{"border-secondary":n===r&&!s,"bg-tertiary mx-1 h-12 w-12 animate-pulse":s}),children:(0,A.jsx)("img",{loading:"eager",src:t.url,className:P()("h-12 w-12 rounded-md object-cover",{hidden:s}),onLoad:function(){return l(!1)},alt:t.filename})})},Lt=function(e){var t=e.isOverlay,n=void 0!==t&&t,r=(0,V.dI)().item;return(0,A.jsx)("div",{className:P()("rounded-lg border-2 border-transparent p-0.5 opacity-50",{"!opacity-100":n}),children:(0,A.jsx)("img",{loading:"eager",src:r.url,className:"h-12 w-12 rounded-md object-cover",alt:r.filename})})};function Mt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ft(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Mt(Object(n),!0).forEach((function(t){Ut(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Mt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ut(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Bt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return zt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return zt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function zt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ht=function(e){var t=e.setCurrentImageIndex,n=e.currentImageIndex,r=Bt((0,a.useState)(!1),2),o=r[0],i=r[1],s=(0,a.useRef)(null),c=Bt((0,q.A)(),2),u=c[0],d=c[1],m=Bt((0,q.A)(),2),f=m[0],p=m[1],v=(0,l.UV)().contentPortalElement,h=O(),b=h.uploadedImages,g=h.setUploadedImages,y=h.selectedFiles,_=h.resetSelectedFiles,j=h.setIsImagesDirty,x=Y((function(){return i(!0)})).handleFileSelection,w=te({handleFileSelection:x,selectedFiles:y,uploadedFilesCount:b.length}),S=w.getInputProps,P=w.open,C=wt().removeImage,k=b.map((function(e){return Ft(Ft({},e),{},{id:e.signed_id,originalId:e.id})})),I=k[n];return(0,A.jsxs)("div",{className:"relative mt-5 flex",children:[!d&&(0,A.jsx)(K,{direction:"left",scrollableContainerRef:s}),(0,A.jsxs)(V.cm,{shouldUseKeyboardSensor:!1,distance:10,items:k,onSort:function(e){var r=e.indexOf(I);r!==n&&t(r),g(e.map((function(e){return Ft(Ft({},e),{},{id:e.originalId})}))),j(!0)},restrictToParentElement:!0,children:[(0,A.jsx)(V.Fo,{children:(0,A.jsxs)("div",{className:"scrollbar-hide m-auto !flex items-center overflow-x-scroll px-1 pt-1",ref:s,children:[(0,A.jsx)("div",{className:"h-px w-px",ref:u}),b.map((function(e,r){return(0,A.jsxs)(Q.c,{tabIndex:-1,item:k[r],disabled:1===b.length,placeholder:Lt,className:"group relative !w-auto shrink-0",dataTestId:"thumbnail-item",children:[(0,A.jsx)(G,{onClick:function(){return C(e)},index:r,currentImageIndex:n}),(0,A.jsx)(Rt,{image:e,index:r,currentImageIndex:n,onClick:t})]},e.signed_id)})),b.length<10&&(0,A.jsxs)(A.Fragment,{children:[(0,A.jsxs)("button",{type:"button",className:"hover:bg-secondary text-default ml-1 flex h-12 w-12 shrink-0 cursor-pointer items-center justify-center rounded-md border border-dashed",onClick:function(){_(),P()},children:[(0,A.jsx)("input",Ft({},S())),(0,A.jsx)(Z.JO,{type:"20-add-lg",size:20})]}),o&&(0,A.jsx)(Re,{onClose:function(){return i(!1)},onCompleted:function(){return setTimeout((function(){return J({direction:"right",scrollableContainerRef:s})}),200)},isOnTop:!0})]}),(0,A.jsx)("div",{className:"h-px w-px",ref:f})]})}),(0,A.jsx)(W.y,{portalTo:v,children:(0,A.jsx)(Lt,{isOverlay:!0})})]}),!p&&(0,A.jsx)(K,{direction:"right",scrollableContainerRef:s})]})};function qt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return Zt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Zt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Zt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Vt=function(){var e=qt((0,a.useState)(0),2),t=e[0],n=e[1],r=!(0,$.j)(),o=O(),i=o.uploadedImages,s=o.setIsScheduledBarPortalRendered,l=(0,a.useRef)(i.length),c=l.current,u=i.length;return u>0&&t>u-1?n(i.length-1):u>c&&n(c),l.current=u,(0,a.useEffect)((function(){r&&s(!0)}),[r,s]),(0,A.jsxs)("div",{className:"flex max-h-full w-full flex-col justify-center overflow-auto lg:h-full lg:w-3/4",children:[r&&(0,A.jsx)("div",{id:st.U}),(0,A.jsxs)("div",{className:"flex max-h-full min-h-[20rem] w-full flex-col overflow-auto p-6",children:[(0,A.jsx)(Et,{currentImageIndex:t}),i.length>0&&(0,A.jsx)(Ht,{currentImageIndex:t,setCurrentImageIndex:n})]})]})},Wt=n(49646),Qt=n(77616),$t=n(76234),Gt=n(41522),Jt=function(e){var t=e.editor,n=e.portalId;return t?(0,A.jsx)($t.Z,{container:function(){return document.getElementById(n)},children:(0,A.jsx)("div",{className:"flex items-center md:pt-2",children:(0,A.jsx)(Gt.c,{popoverPanelClassName:"md:!w-[21rem]",onEmojiSelect:function(e){return t.chain().focus().insertContent(e.emoji).run()},targetWrapperClassName:"!flex",target:(0,A.jsx)(N.h,{iconSize:20,buttonSize:28,iconClassName:"!text-dark !w-6 !h-6",name:"20-emoji",ariaLabel:(0,o.t)("emoji_picker")})})})}):null},Kt=["blockquote","poll","embeds","slash_commands","file","image","horizontal_rule","code_block","headings","cta"],Yt=function(e){var t,n=e.space,r=e.post,i=O().setIsFormDirty,s=(0,Ye.Gc)().formState.isDirty;return(0,a.useEffect)((function(){i(s)}),[s,i]),(0,A.jsxs)("div",{className:"border-b-primary border-y p-6 pb-4 lg:border-t-0",children:[(0,A.jsx)(k.Z.LabelMd,{weight:"semibold",children:(0,o.t)("image_space.post_modal.steps.create_post.caption_label")}),(0,A.jsx)(Qt.$,{placeholder:(0,o.t)("image_space.post_modal.steps.create_post.caption_placeholder"),name:"tiptap_body.body",sgidToObjectMap:(null===r||void 0===r||null===(t=r.tiptap_body)||void 0===t?void 0:t.sgids_to_object_map)||{},spaceId:null===n||void 0===n?void 0:n.id,editorClassName:"min-w-full h-40 overflow-y-scroll mt-3",disabledExtensions:Kt,shouldShowTextModifiersMenu:!1,toolbars:[{portalId:"create-image-post-toolbar",component:Jt}]}),(0,A.jsx)("div",{id:"create-image-post-toolbar"})]})},Xt=function(e){var t=e.space,n=!!t&&(0,nt.k8)(t);return(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(Ke.l.Item,{variant:"extra-bottom-margin",className:"!pt-3",hideBorder:!0,name:"slug",fullWidth:!0,translationRoot:"post",hidePlaceholder:!0,hideDescription:!0,tooltipText:(0,o.t)("post.slug_description"),children:(0,A.jsx)(Ke.l.Input,{name:"slug",autoComplete:"off"})}),n&&(0,A.jsx)(Ke.l.Item,{variant:"extra-bottom-margin",className:"!pt-4",hideBorder:!0,name:"user_id",translationRoot:"post",fullWidth:!0,hideDescription:!0,tooltipText:(0,o.t)("post.user_id_description"),children:(0,A.jsx)(Ke.l.CommunityMemberSelect,{name:"user_id",direction:"up",valueField:"user_id"})})]})},en=function(e){var t=e.space,n=(0,Be.m)().post,r={hide_meta_info:!0,is_comments_disabled:!0,is_comments_closed:!(0,(0,Ye.Gc)().watch)("is_comments_disabled"),is_liking_disabled:!0,is_truncation_disabled:!0,pin_to_top:Boolean(n.id)&&(0,$e.Hz)(n),hide_from_featured_areas:!(null!==t&&void 0!==t&&t.hide_from_featured_areas),"gallery.downloadable_images":!0},i=Object.keys(r).filter((function(e){return r[e]}));return(0,A.jsx)(A.Fragment,{children:i.map((function(e){return(0,A.jsx)(Ke.l.Item,{id:"post_".concat(e),name:e,label:(0,o.t)("post.".concat(e)),labelClassName:"!font-normal !p-0",className:"mb-3 !p-0",hideBorder:!0,hideDescription:!0,inlineReverse:!0,children:(0,A.jsx)(Ke.l.ToggleSwitch,{name:e,variant:"small"})},e)}))})};function tn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return nn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return nn(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function nn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var rn=function(e){var t=e.space,n=tn((0,a.useState)(!1),2),r=n[0],i=n[1];return(0,A.jsxs)("div",{className:"border-primary border-b",children:[(0,A.jsxs)("button",{type:"button",className:"flex w-full items-center justify-between px-6 py-5",onClick:function(){return i(!r)},"aria-expanded":r,children:[(0,A.jsx)(k.Z.LabelMd,{weight:"semibold",children:(0,o.t)("image_space.post_modal.steps.create_post.more_options_label")}),(0,A.jsx)(Z.JO,{type:r?"cheveron-up":"cheveron-down",size:20})]}),r&&(0,A.jsxs)("div",{className:"mb-5 px-6",children:[(0,A.jsx)(en,{space:t}),(0,A.jsx)(Xt,{space:t})]})]})},on=function(e){var t=e.post,n=e.space,r=(0,Je.wh)(),i=r.currentCommunitySettings,s=r.currentCommunityMember,l=null===i||void 0===i?void 0:i.topics_enabled,c=null===s||void 0===s?void 0:s.is_admin,u=O().setIsScheduledBarPortalRendered,d=(0,$.j)();return(0,a.useEffect)((function(){d&&u(!0)}),[d,u]),(0,A.jsxs)("div",{className:"border-primary w-full lg:h-full lg:w-1/4 lg:overflow-scroll lg:border-l",children:[d&&(0,A.jsx)("div",{id:st.U}),(0,A.jsx)(Yt,{space:n,post:t}),l&&(n.topics_count>0||c)&&(0,A.jsx)("div",{className:"border-primary border-b px-6 pb-2",children:(0,A.jsx)(Ke.l.Item,{name:"topics",hideDescription:!0,hideBorder:!0,label:(0,o.t)("image_space.post_modal.steps.create_post.topics_label"),labelClassName:"!mb-3",children:(0,A.jsx)(Wt.w,{containerClassName:"!p-0 -mx-1",name:"topics",spaceId:n.id,creatable:c})})}),(0,nt.Y_)(n)&&(0,A.jsx)(rn,{space:n})]})};function an(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}var sn=function(e){var t=e.onClose,n=e.onPostChange,r=e.shouldSkipRedirectAfterSubmit,i=(0,ze.T)().invalidatePostsApiQueries,a=(0,Be.m)().post,c=(0,Je.L2)().data,u=(0,Ue.k6)(),d=(0,Fe.useQueryClient)(),m=function(){var e,o=(e=Me().mark((function e(o){return Me().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n(a),e.next=3,d.invalidateQueries(Ge.j);case 3:return e.next=5,i();case 5:t(!0),r||u.push((0,$e.RG)({post:o}));case 7:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){an(i,r,o,a,s,"next",e)}function s(e){an(i,r,o,a,s,"throw",e)}a(void 0)}))});return function(e){return o.apply(this,arguments)}}(),f=Qe({space:c,post:a,onSuccess:m}).onSubmit;return(0,A.jsx)(l.u_,{isOpen:!0,onClose:t,contentPortalId:"create-post-modal-portal",children:(0,A.jsxs)(Ke.l,{onSubmit:f,defaultValues:We(a),formClassName:"fixed inset-0 z-[1060]",children:[(0,A.jsx)(l.u_.Overlay,{}),(0,A.jsxs)(l.u_.Content,{size:"full",className:"sm:!max-h-[836px] sm:!max-w-[1312px]",children:[(0,A.jsxs)(l.u_.Header,{className:"z-10 md:!py-4",children:[(0,A.jsx)(k.Z.TitleSm,{weight:"font-semibold",children:(0,o.t)("".concat("image_space.post_modal.steps.create_post",".").concat(a.id?"edit":"create","_title"))}),(0,A.jsxs)(l.u_.HeaderActions,{className:"!gap-3",children:[(0,A.jsx)(s.z,{type:"button",variant:"secondary",onClick:function(){return t(!1)},children:(0,o.t)("cancel")}),(0,A.jsx)(at,{post:a})]})]}),(0,A.jsxs)(l.u_.Body,{className:"md:border-primary flex flex-wrap content-start !p-0 md:border-t",children:[(0,A.jsx)(Vt,{}),(0,A.jsx)(on,{post:a,space:c})]})]})]})})},ln=["isDragActive"];function cn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function un(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?cn(Object(n),!0).forEach((function(t){dn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):cn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function dn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function mn(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var fn=function(e){var t=e.onClose,n=e.onSelection,r=O(),o=r.selectedFiles,i=r.uploadedImages,a=Y(n).handleFileSelection,s=te({handleFileSelection:a,selectedFiles:o,uploadedFilesCount:i.length}),c=s.isDragActive,u=mn(s,ln);return(0,A.jsxs)(l.u_,{isOpen:!0,onClose:t,contentPortalId:"upload-images-modal-portal",children:[(0,A.jsx)(l.u_.Overlay,{}),(0,A.jsxs)(l.u_.Content,{size:"xl",className:P()("aspect-square",{"!bg-light-blue":c}),children:[(0,A.jsxs)(l.u_.Header,{children:[(0,A.jsx)(l.u_.Title,{size:"sm",children:" "}),(0,A.jsx)(l.u_.HeaderActions,{children:(0,A.jsx)(l.u_.CloseButton,{onClick:t,className:P()({"!bg-light-blue":c})})})]}),(0,A.jsx)(l.u_.Body,{className:"flex cursor-pointer flex-col items-center justify-center !p-0",children:(0,A.jsx)(mt,un(un({isDragActive:c},u),{},{className:"pb-14"}))})]})]})},pn=n(72675),vn=n(98175);function hn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function bn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var gn=function(e){var t=e.spaceId,n=e.onClose,r=e.currentPost,s=e.onPostChange,l=void 0===s?i.noop:s,c=e.shouldSkipRedirectAfterSubmit,f=void 0!==c&&c,p=(0,pn.dd)(),v=O(),h=v.currentStep,b=v.setCurrentStep,g=v.reset,y=v.isFormDirty,_=v.isImagesDirty,j=function(){(arguments.length>0&&void 0!==arguments[0]&&arguments[0]||!y&&!_||confirm((0,o.t)("quick_post_v2.accidental_leave_confirmation")))&&(g(),n())},x=function(e){var t=(0,Ge.t)({spaceId:null===e||void 0===e?void 0:e.space_id,postSlug:null===e||void 0===e?void 0:e.slug,disabled:e&&"gallery"in e}),n=t.post;return t.isLoading?null:n||e||{id:null,gallery:null}}(r);return function(e){var t=O(),n=t.setCurrentStep,r=t.setUploadedImages;(0,a.useEffect)((function(){n(null!==e&&void 0!==e&&e.gallery?m:u),null!==e&&void 0!==e&&e.gallery&&r(e.gallery.images)}),[null===e||void 0===e?void 0:e.gallery,n,r])}(x),p&&p.visible&&x?(0,A.jsx)(Je.mE,{spaceId:t,children:(0,A.jsx)(vn._x,{perPagePostIds:[[x.id]],children:(0,A.jsxs)(Je.DW,{post:x,children:[h===u&&(0,A.jsx)(fn,{onClose:j,onSelection:function(){return b(d)}}),h===d&&(0,A.jsx)(Re,{onClose:j}),h!==u&&h!==d&&(0,A.jsx)(sn,{onClose:j,onPostChange:l,shouldSkipRedirectAfterSubmit:f})]})})}):null},yn=pn.gk.create((function(e){return(0,A.jsx)(gn,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?hn(Object(n),!0).forEach((function(t){bn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):hn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e))})),_n=function(){return(0,pn.dd)(yn)}},53691:(e,t,n)=>{n.d(t,{C:()=>P});var r=n(64687),o=n.n(r),i=n(86013),a=n(72675),s=n(77761),l=n(71032),c=n(46367),u=n(67294),d=n(88767),m=n(55734);function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){v(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function h(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}function b(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return g(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var y=function(e){var t=e.event,n=e.onChange,r=b((0,u.useState)(c.HA.ALL),2),i=r[0],a=r[1],s=(0,d.useQueryClient)(),l=(0,m.K)({event:t}).onRecurringUnRsvpSubmit,f=function(){var e,r=(e=o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l(i);case 2:return n(p(p({},t),{},{rsvped_event:!1})),e.next=5,s.invalidateQueries("posts");case 5:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){h(i,r,o,a,s,"next",e)}function s(e){h(i,r,o,a,s,"throw",e)}a(void 0)}))});return function(){return r.apply(this,arguments)}}();return{setEditMode:a,onUnRsvpConfirm:f}},_=n(85893);function j(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function x(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function w(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}var O=function(e){var t=e.event,n=e.onChange,r="events.un_rsvp.recurring_modal",u=(0,a.dd)(),d=y({event:t,onChange:n}),m=d.setEditMode,f=d.onUnRsvpConfirm,p=function(){var e,t=(e=o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f();case 2:return e.next=4,u.hide();case 4:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){w(i,r,o,a,s,"next",e)}function s(e){w(i,r,o,a,s,"throw",e)}a(void 0)}))});return function(){return t.apply(this,arguments)}}();return(0,_.jsx)(l.c,{title:(0,i.t)("".concat(r,".not_going")),isOpen:u.visible,confirmText:(0,i.t)("".concat(r,".save")),cancelText:(0,i.t)("".concat(r,".cancel")),onClose:u.hide,onCancel:u.hide,onConfirm:p,size:"sm",children:(0,_.jsx)("div",{className:"mt-6",children:(0,_.jsx)(s.S,{defaultChecked:c.HA.CURRENT,name:"recurring_event_settings.frequency_edit",options:[{label:(0,i.t)("events.edit.recurring_event_modal.this_event"),value:c.HA.CURRENT},{label:(0,i.t)("events.edit.recurring_event_modal.this_and_following"),value:c.HA.REMAINING},{label:(0,i.t)("events.edit.recurring_event_modal.all_events"),value:c.HA.ALL}],size:"sm",onChange:function(e){return m(e)}})})})},S=a.gk.create((function(e){return(0,_.jsx)(O,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?j(Object(n),!0).forEach((function(t){x(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):j(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e))})),P=function(){return(0,a.dd)(S)}},649:(e,t,n)=>{n.d(t,{EW:()=>l,LG:()=>c,Mz:()=>u,Bj:()=>d,Y9:()=>m});var r=n(86013),o=n(61666);function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var l=function(e){return Math.min(Number(e)||1,1e3)},c=function(e){return parseInt(String(e||"0").replace(/[^\d\\-]/g,""))},u=function(e){return parseFloat(String(e||"0").replace(/[^\d\\.\\-]/g,""))},d=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=a(a({},{amountInCents:!0}),t);return function(t){var r;if(r=n.amountInCents?c(t):u(t),!isNaN(r)){var i=e.max_charge_amount;return n.amountInCents||(i=Math.round(i/100)),r=Math.min(r,i),(0,o.I)(e,r,{amountInCents:n.amountInCents,includeCurrencyCode:!1,forceMaxFractionDigits:!0})}}},m=function(e,t,n,i){var a=(0,o.I)(e,i);return t?(a+=" / ",a+=(0,r.t)("settings.paywall_prices.interval_labels.".concat(t),{count:n})):"".concat(a," ").concat((0,r.t)("settings.paywall_prices.onetime_price_text"))}},86478:(e,t,n)=>{n.d(t,{S:()=>b});var r=n(94184),o=n.n(r),i=n(97932),a=n(30414),s=n(97012),l=n(25067),c=n(86013),u=n(6038),d=n(30887),m=n(46324),f=n(85893),p=function(e){var t=e.post,n=e.comments_count,r=e.className,i=e.showCount,a=void 0===i||i,s=e.onCommentsClick,l=e.iconClassName,p=void 0===l?"!text-default":l;return(0,f.jsx)("div",{className:o()("col-span-1",r),children:(0,f.jsxs)(m.s,{post:t,allComments:!0,ariaLabel:(0,c.t)("cap_comment_aria_label",{title:(null===t||void 0===t?void 0:t.name)||(0,c.t)("this_post")}),className:"action-item action-comment !flex !items-center !justify-center !text-center",onClick:s,children:[(0,f.jsx)("span",{className:"action__icon !inline-flex align-text-top",children:(0,f.jsx)(d.JO,{"aria-hidden":!0,type:"message",className:p,useWithFillCurrentColor:!0})}),a&&(0,f.jsx)("span",{className:"count !text-dark",children:(0,u.H)(n)})]})})};function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var h=function(e){var t,n=e.name,r=e.onLikeToggle,i=e.is_liked_by_current_user,a=e.user_likes_count,l=e.isOrCanBeCommunityMember,m=e.className,p=e.iconClassName,h=void 0===p?"!text-default":p,b=e.likedSpanClassName,g=e.showCount,y=void 0===g||g,_=(0,s.wh)().isViewOnlyMasquerading;return(0,f.jsx)("div",{className:o()("col-span-1",m),children:(0,f.jsxs)("button",{type:"button",onClick:r,"aria-label":(0,c.t)("like_post_aria_label",{name:null!==n&&void 0!==n?n:""}),className:o()("action-item action-link action-like post__actions--like text-default !flex !items-center !justify-center !text-center",{liked:i,disabled:!l||_}),children:[(0,f.jsx)("span",{className:o()("action__icon !inline-flex align-text-top",i&&b),children:(0,f.jsx)(d.JO,{type:"like",className:o()((t={},v(t,h,!i),v(t,"!text-brand",i),t)),useWithFillCurrentColor:!i,"aria-hidden":!0})}),y&&(0,f.jsx)("span",{className:o()("count",{"!text-dark":!i}),children:(0,u.H)(a)})]})})},b=function(e){var t=e.type,n=void 0===t?"list":t,r=e.wrapperClassName,c=e.commentButtonClassName,u=e.commentIconClassName,d=e.likeButtonClassName,m=e.likeIconClassName,v=e.likedSpanClassName,b=e.showCommentsCount,g=void 0===b||b,y=e.showLikesCount,_=void 0===y||y,j=e.onCommentsClick,x=(0,i.m)(),w=x.post,O=x.showEngagementActions,S=x.onLikeToggle,P=w.user_likes_count,C=w.is_liking_enabled,k=w.is_comments_enabled,I=w.is_liked_by_current_user,N=w.comments_count,A=w.post_details_loaded,E=w.display_title,T=(0,s.EU)();return O&&(C||k)?A?(0,f.jsxs)("div",{className:o()("post--".concat(n,"__actions post--").concat(n,"__actions-visible"),r),children:[(0,f.jsx)(a.T,{children:C&&(0,f.jsx)(h,{name:E,onLikeToggle:function(){null===S||void 0===S||S(void 0)},isOrCanBeCommunityMember:T,user_likes_count:P,is_liked_by_current_user:I,className:d,iconClassName:m,likedSpanClassName:v,showCount:_})}),k&&(0,f.jsx)(p,{comments_count:N,post:w,className:c,iconClassName:u,showCount:g,onCommentsClick:j})]}):(0,f.jsxs)("div",{className:o()("post--".concat(n,"__actions post--").concat(n,"__actions-visible"),r),children:[(0,f.jsx)("div",{className:o()("action-item action-link action-like post__actions--like",d),children:(0,f.jsx)("span",{className:"action__icon",children:(0,f.jsx)(l.gi,{variant:"row",lg:!0,short:!0})})}),(0,f.jsx)("div",{className:o()("action-item action-comment",c),children:(0,f.jsx)("span",{className:"action__icon",children:(0,f.jsx)(l.gi,{variant:"row",lg:!0,short:!0})})})]}):null}},18485:(e,t,n)=>{n.d(t,{Y:()=>be});var r=n(67294),o=n(86254),i=n(7568),a=n(97012),s=n(85893),l=function(){var e=(0,a.Zh)().record,t=(0,r.useRef)(null),n=(0,r.useRef)(null);return(0,r.useEffect)((function(){if(t.current&&null!==e&&void 0!==e&&e.is_comments_enabled){var n=new o.do((function(){var e=document.documentElement.scrollHeight;window.parent.postMessage(["setHeight",e],"*")}));return n.observe(t.current),function(){return n.disconnect()}}}),[null===e||void 0===e?void 0:e.is_comments_enabled]),null!==e&&void 0!==e&&e.is_comments_enabled?(0,s.jsx)("div",{ref:t,className:"post",children:(0,s.jsx)(i.o,{commentsFormRef:n,autofocusReplyForm:!1})}):null},c=n(36464),u=n.n(c),d=n(63001),m=n(31714),f=n(68375),p=n(36187),v=n(46324),h=n(29458),b=n(44130),g=n(37109),y=n(94184),_=n.n(y),j=n(86013),x=n(96486),w=n(30887),O=n(6038),S=n(25067),P=function(e){var t=e.shouldOpenInNewTab,n=(0,a.wh)().isViewOnlyMasquerading,r=(0,d.r)().hide,o=(0,a.Zh)(),i=o.record,l=o.onLikeToggle,c=i.comments_count,u=i.is_comments_enabled,m=i.is_liked_by_current_user,f=i.is_liking_enabled,p=i.user_likes_count,h=i.post_details_loaded,b=(0,a.EU)();return(0,s.jsxs)("div",{className:"profile-posts__post__actions",children:[f&&(0,s.jsx)("a",{href:"#like-post",onClick:n?x.noop:l,className:_()("profile-posts__post__like",{"text-default":!m,liked:m,disabled:!b||!h}),children:h?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(w.JO,{type:"like"}),(0,s.jsx)("span",{className:"profile-posts__post__like-count",children:(0,O.H)(p)})]}):(0,s.jsx)(S.gi,{variant:"row",lg:!0,short:!0})}),u&&(0,s.jsxs)(v.s,{post:i,allComments:!0,className:"profile-posts__post__comments-count",onClick:r,target:t&&"_blank",children:[h&&(0,j.t)("post.comments",{count:c,formatted_count:(0,O.H)(c)}),!h&&(0,s.jsx)(S.gi,{variant:"row",lg:!0,long:!0})]})]})};function C(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function k(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?C(Object(n),!0).forEach((function(t){I(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function I(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var N=function(e){var t=e.onPostChange,n=e.shouldOpenInNewTab,r=(0,d.r)().hide,o=(0,a.Zh)(),i=o.record,l=o.helpers,c=l.isTiptapPost,y=l.isTrixPost;if(!i||!i.id)return null;var _=i.name,j=i.community_member,x=i.created_at,w=i.body_trix_content,O=i.tiptap_body,S=i.updated_at;return(0,s.jsxs)("div",{className:"profile-posts__post",children:[(0,s.jsx)(p.H,{onClick:r,post:i}),(0,s.jsxs)("div",{className:"profile-posts__post__meta",children:[(0,s.jsx)("div",{className:"profile-posts__post__author",children:null===j||void 0===j?void 0:j.name}),(0,s.jsx)("div",{className:"profile-posts__post__time",children:u()(x)})]}),(0,s.jsx)(v.s,{onClick:r,post:i,target:n&&"_blank",children:(0,s.jsx)("div",{className:"profile-posts__post__title",children:_})}),(0,s.jsx)(b.X,{seeMoreClassName:"!text-default hover:!text-dark",children:(0,s.jsxs)("div",{className:"profile-posts__post__body",children:[(0,f.Fr)(i)&&(0,s.jsx)(m.l,{}),y&&w&&(0,s.jsx)(h.P,{content:w}),c&&O&&(0,s.jsx)(g.R,{readOnly:!0,value:O.body,sgidToObjectMap:O.sgids_to_object_map,inlineAttachments:O.inline_attachments,disabledExtensions:["cta"]})]})}),(0,s.jsx)(P,{onChange:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t(k(k({},i),e))},shouldOpenInNewTab:n})]},S)},A=["post"];function E(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function T(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function D(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function R(e){var t=e.post,n=D(e,A);return(0,s.jsx)(N,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?E(Object(n),!0).forEach((function(t){T(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):E(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({post:t},n))}var L=n(82275),M=n(11178),F=n(61345),U=n(62456),B=n(25401),z=n(20695),H=n(32224),q=n(74238),Z=n(66154),V=n(38870),W=n(86478),Q=function(){return(0,s.jsx)(W.S,{type:"card"})};function $(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function G(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$(Object(n),!0).forEach((function(t){J(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function J(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var K=function(e){var t=e.onPostChange,n=e.onPostDestroy,r=e.refetchPosts,o=(0,a.Zh)().record,i=(0,q.TC)().isDarkAppearance;if(!o)return null;var l=o.flagged_for_approval_at,c=o.cardview_thumbnail_url,u=o.community_member,d=o.hide_meta_info,m=o.display_title,f=o.is_liking_enabled,p=o.is_comments_enabled,h=o.cover_image_url,b=_()("post--card post--parent !border-primary !bg-primary",{"flagged-for-approval":l,"has-engagement":f||p}),g=c||h,y=(0,H.O)({public_uid:u.public_uid,params:{show_back_link:!0}});return(0,s.jsxs)("div",{className:b,children:[(0,s.jsxs)("div",{className:"post--card__post text-dark",children:[(0,s.jsx)(v.s,{post:o,className:"post--card__cover",style:function(){if(g)return{backgroundImage:"url(".concat(g,")")};var e=i?(0,z.aP)("dark-mode-cover-thumbnail-2x.png"):(0,z.aP)("light-mode-cover-thumbnail-2x.png");return{backgroundImage:"url(".concat(e,")")}}()}),(0,s.jsx)(Z.If,{condition:!d,children:(0,s.jsx)("div",{className:"post--card__user has-cover",children:(0,s.jsx)("div",{className:"post__avatar",children:(0,s.jsx)("a",G(G({className:"user__avatar"},y),{},{children:(0,s.jsx)(V.s,{src:u.avatar_url,name:u.name,size:"10"})}))})})}),(0,s.jsx)("div",{className:_()("post--card__body",{"post-meta--hidden":d}),children:(0,s.jsxs)("div",{className:"post--card__content",children:[(0,s.jsx)("div",{className:"post--card__header",children:(0,s.jsxs)("h2",{children:[(0,s.jsx)(v.s,{post:o,children:(0,x.truncate)(m,{length:60})}),(0,s.jsx)(Z.If,{condition:!!l,children:(0,s.jsx)("span",{className:"post--card__headline-tag",children:(0,j.t)("in_review")})})]})}),(0,s.jsx)(Z.If,{condition:!d,children:(0,s.jsx)("div",{className:"post--card__meta",children:(0,s.jsx)(Y,{post:o})})})]})})]}),(0,s.jsx)(Q,{}),(0,s.jsx)("div",{className:"post--card__actions-wrapper",children:(0,s.jsx)(U.p,{onPostDestroy:n,refetchPosts:r,onChange:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t(G(G({},o),e),n)}})})]})},Y=function(e){var t=e.post,n=t.last_replied_or_posted;return t.post_details_loaded?n?(0,s.jsxs)(v.s,{post:t,children:[(0,s.jsx)(Z.If,{condition:"replied"===n.type,children:(0,s.jsx)(w.JO,{type:"arrow-solid-bottom-right"})}),(0,s.jsx)("span",{className:"meta-person-action",children:"".concat(n.user_name," ").concat(n.type," ")}),(0,s.jsx)("span",{className:"ago post--card__timestamp",children:(0,B._z)(new Date(n.created_at))})]}):null:(0,s.jsx)(S.gi,{variant:"row",lg:!0,almostFull:!0})};function X(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ee(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var te=function(e){return(0,s.jsx)(K,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?X(Object(n),!0).forEach((function(t){ee(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):X(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e))},ne=n(26953),re=function(e){var t=e.post,n=t.last_replied_or_posted;return t.post_details_loaded?n?(0,s.jsxs)(v.s,{post:t,children:["replied"===n.type&&(0,s.jsx)(w.JO,{type:"arrow-solid-bottom-right"}),(0,s.jsx)("span",{className:"meta-person-action",children:"".concat(n.user_name," ").concat(n.type," ")}),(0,s.jsx)("span",{className:"ago post--list__timestamp",children:(0,B._z)(new Date(n.created_at))})]}):null:(0,s.jsx)(S.gi,{variant:"row",lg:!0,half:!0})};function oe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ie(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?oe(Object(n),!0).forEach((function(t){ae(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):oe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ae(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var se=function(e){var t=e.onPostChange,n=e.onPostDestroy,r=e.refetchPosts,o=e.hideTitle,i=void 0!==o&&o,l=(0,a.Zh)().record,c=(0,ne.kK)(),u=l.flagged_for_approval_at,d=l.community_member,m=l.hide_meta_info,f=l.display_title,p=_()("post--list post--parent !border-primary",{"flagged-for-approval":u}),h=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t(ie(ie({},l),e),n)},b=(0,H.O)({public_uid:d.public_uid,params:{show_back_link:!0}});return c?(0,s.jsx)("div",{className:p,children:(0,s.jsx)("div",{className:"post--list__post text-dark gap-3",children:(0,s.jsxs)("div",{className:"post--list__body w-full",children:[(0,s.jsx)("div",{className:"post--list__content w-full gap-2 !pr-0 md:gap-0",children:!i&&(0,s.jsxs)("div",{className:_()("post--list__header flex w-full items-start justify-between",{"post-meta--hidden":m}),children:[(0,s.jsxs)("h2",{className:"mr-2",children:[(0,s.jsx)(v.s,{post:l,children:(0,x.truncate)(f,{length:110})}),!!u&&(0,s.jsx)("span",{className:"post--list__headline-tag",children:(0,j.t)("in_review")})]}),(0,s.jsx)(U.p,{onPostDestroy:n,refetchPosts:r,onChange:h})]})}),!m&&(0,s.jsxs)("div",{className:"flex items-start justify-start space-x-2",children:[(0,s.jsx)("div",{className:"post--list__user",children:(0,s.jsx)("a",ie(ie({},b),{},{children:(0,s.jsx)(V.s,{src:d.avatar_url,name:d.name,size:"6"})}))}),(0,s.jsxs)("div",{className:"post--list__meta flex w-full items-center justify-between",children:[(0,s.jsx)(re,{post:l}),(0,s.jsx)("div",{className:"post--list__actions-wrapper gap-2 self-start md:gap-0",children:(0,s.jsx)(W.S,{})})]})]})]})})}):(0,s.jsx)("div",{className:p,children:(0,s.jsxs)("div",{className:"post--list__post text-dark gap-3",children:[!m&&(0,s.jsx)("div",{className:"post--list__user",children:(0,s.jsx)("a",ie(ie({},b),{},{children:(0,s.jsx)(V.s,{src:d.avatar_url,name:d.name,size:"10"})}))}),(0,s.jsxs)("div",{className:"post--list__body",children:[(0,s.jsxs)("div",{className:"post--list__content",children:[!i&&(0,s.jsx)("div",{className:_()("post--list__header",{"post-meta--hidden":m}),children:(0,s.jsxs)("h2",{children:[(0,s.jsx)(v.s,{post:l,children:(0,x.truncate)(f,{length:110})}),!!u&&(0,s.jsx)("span",{className:"post--list__headline-tag",children:(0,j.t)("in_review")})]})}),!m&&(0,s.jsx)("div",{className:"post--list__meta",children:(0,s.jsx)(re,{post:l})})]}),(0,s.jsxs)("div",{className:"post--list__actions-wrapper",children:[(0,s.jsx)(W.S,{}),(0,s.jsx)(U.p,{onPostDestroy:n,refetchPosts:r,onChange:h})]})]})]})})};function le(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ce(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ue=function(e){return(0,s.jsx)(se,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?le(Object(n),!0).forEach((function(t){ce(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):le(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e))},de=n(43114),me=["space","post","isFirst","forcePostView","forceSimplifiedView","forceIframeView","usedIn"];function fe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function pe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fe(Object(n),!0).forEach((function(t){ve(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ve(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function he(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var be=function(e){var t=e.space,n=void 0===t?{}:t,r=e.post,o=e.isFirst,i=void 0!==o&&o,c=e.forcePostView,u=void 0!==c&&c,d=e.forceSimplifiedView,m=void 0!==d&&d,f=e.forceIframeView,p=void 0!==f&&f,v=e.usedIn,h=he(e,me),b=Boolean(r.pinned_at_top_of_space),g=(0,F.AU)(n),y=(0,F.G6)(n),_=de.D;return(0,F.fq)(n)?_=de.D:(0,F.wk)(n)?_=M.p:(0,F.HO)(n)?_=L.d:m?_=R:p?_=l:u||b&&i?_=de.D:g?_=te:y&&(_=ue),(0,s.jsx)(a.DW,{post:r,usedIn:v,children:(0,s.jsx)(_,pe({post:r},h))})}},7568:(e,t,n)=>{n.d(t,{o:()=>Rt});var r=n(67294),o=n(86013),i=n.n(o),a=n(86078),s=n(96486),l=n(97012),c=n(71032),u=n(94184),d=n.n(u),m=n(87536),f=n(95172),p=n(78163),v=n(77616),h=n(48885),b=n(56868),g=n(55675),y=n(85893);function _(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function j(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_(Object(n),!0).forEach((function(t){x(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function x(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function w(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return O(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return O(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function O(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var S=function(e){var t=e.spaceId,n=e.postId,i=e.communityMemberForReply,a=e.autoFocus,c=e.editorRef,u=e.parentCommentId,d=e.isEdit,_=e.initialSgidToObjectMap,O=void 0===_?{}:_,S=(0,l.wh)().currentCommunityMember,P=w((0,r.useState)(O),2),C=P[0],k=P[1],I=w((0,r.useState)(!1),2),N=I[0],A=I[1],E=w((0,r.useState)(0),2),T=E[0],D=E[1],R=(0,m.Gc)(),L=R.watch,M=R.reset,F=R.formState,U=F.isSubmitting,B=F.isSubmitSuccessful,z=L("tiptap_body"),H=!(0,p.NU)(z)||U,q=N&&!H;(0,f.y1)("cmd+enter, ctrl+enter",(function(){"triggerFormSubmit"in R&&R.triggerFormSubmit()}),{enableOnContentEditable:!0,enabled:q},[R,q]),(0,r.useEffect)((function(){B&&(M(),D((function(e){return e+1})))}),[B,M]),(0,r.useEffect)((function(){i&&i.id!==(null===S||void 0===S?void 0:S.id)&&(k(j(j({},C),{},x({},i.rich_text_field_sgid,i))),(0,s.defer)((function(){var e,t;null===c||void 0===c||null===(e=c.current)||void 0===e||null===(t=e.chain)||void 0===t||t.call(e).focus("start").insertContent([(0,h.F_)({sgid:i.rich_text_field_sgid}),(0,h.$U)({text:" "})]).run()})))}),[i,S,c]),(0,r.useEffect)((function(){(0,s.defer)((function(){var e,t,n;a&&(null===c||void 0===c||null===(e=c.current)||void 0===e||null===(t=e.commands)||void 0===t||null===(n=t.focus)||void 0===n||n.call(t,"end"))}))}),[]);var Z=["post",n,d?"edit":"create",u,"comment-form-toolbar"].filter(Boolean).join("-");return(0,y.jsxs)("div",{className:"border-primary space-y-3 rounded-lg border px-4 py-3",children:[(0,y.jsx)(v.$,{editorRef:c,placeholder:(0,o.t)("write_a_comment"),name:"tiptap_body.body",onFocusChange:A,toolbars:[{portalId:Z,component:b.o}],className:"h-full max-h-[400px] overflow-y-auto",editorClassName:"h-full",spaceId:t,sgidToObjectMap:C,disabledExtensions:["poll","ai_copilot","cta"]}),(0,y.jsxs)("div",{className:"flex items-center justify-between",children:[(0,y.jsx)("div",{id:Z}),(0,y.jsx)(g.z,{variant:"primary",type:"submit",disabled:H,small:!0,className:"!px-4",children:d?U?(0,o.t)("comments.create.actions.saving"):(0,o.t)("comments.create.actions.save"):U?(0,o.t)("comments.create.actions.submitting"):(0,o.t)("comments.create.actions.submit")})]})]},T)},P=n(38870),C=n(61926),k=n(88767),I=n(34128),N=n(49326),A=n(21809);function E(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function T(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?E(Object(n),!0).forEach((function(t){D(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):E(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function D(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var R=function(e){var t=e.spaceId,n=e.postId,r=e.parentCommentId,i=e.communityMemberForReply,a=e.autoFocus,s=void 0!==a&&a,c=e.onCreate,u=e.bodyInputRef,m=(0,l.N3)(),f="full-post-modal"!==(0,l.Zh)().usedIn,p=function(e){var t=e.postId,n=e.parentCommentId,r=e.onCreate,i=(0,A.p)().error;return{createComment:(0,k.useMutation)((function(e){return(0,I.Cu)(N.av.comments.create({postId:t}),{comment:T({parent_comment_id:n},e)})}),{onSuccess:r,onError:function(){return i((0,o.t)("comments.create.alerts.failure"))}}).mutateAsync}}({postId:n,parentCommentId:r,onCreate:c}),v=p.createComment;return(0,y.jsxs)("div",{className:d()("post__reply items-start gap-3",{"reply-to-parent":r,"reply-to-post":!r}),children:[f&&(0,y.jsx)(P.s,{src:m.avatar_url,name:m.name,size:"10"}),(0,y.jsx)(C.l,{className:"relative w-full",onSubmit:function(e){return v(e)},children:(0,y.jsx)(S,{spaceId:t,postId:n,communityMemberForReply:i,autoFocus:s,editorRef:u,isEdit:!1,parentCommentId:r})})]})},L=n(93404),M=n(24185),F=function(){var e=(0,M.TH)().hash.split(L.q)[1];return{commentId:e&&parseInt(e,10)||null}};function U(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return B(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return B(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function B(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var z=function(e){var t=e.enabled,n=void 0===t||t,o=U((0,r.useState)(!1),2),i=o[0],a=o[1],s=F().commentId;(0,r.useEffect)((function(){if(n&&s&&!i){var e=setTimeout((function(){a(!0);var e=document.querySelector("".concat(L.q).concat(s));e&&e.scrollIntoView()}),500);return function(){return clearTimeout(e)}}}),[n,s,i])},H=n(92789),q=function(e){var t=e.space,n=e.post,r=e.parentCommentId,o=e.preloaded,s=void 0!==o&&o,c=e.preloadedComments,u=void 0===c?[]:c,d=e.preloadedCommentsTotalCount,m=void 0===d?0:d,f=e.showReplyForm,p=void 0!==f&&f,v=e.autofocusReplyForm,h=void 0!==v&&v,b=e.communityMemberForReply,g=e.onCommentReplyClick,_=e.onCommentCreate,j=e.onCommentDelete,x=e.formRef,w=(0,l.N3)(),O=(0,H.w)({postId:n.id,parentCommentId:r,preloaded:s,preloadedComments:u,preloadedCommentsTotalCount:m,postCommentsClosed:n.is_comments_closed}),S=O.comments,P=O.isLoading,C=O.isFetchingNextPage,k=O.hasNextPage,I=O.fetchNextPage,N=O.addCommentToList,A=O.updateCommentInList,E=O.removeCommentFromList;z({enabled:!P&&!r});var T=function(e){E(e),j(e)},D=P||C,L=w&&t&&p&&(!D||S.length>0);return(0,y.jsxs)(y.Fragment,{children:[S.map((function(e){return(0,y.jsx)(vt,{space:t,post:n,comment:e,autofocusReplyForm:!0,onReplyClick:g,onUpdate:A,onDelete:T,onReplyCreate:_,onReplyDelete:j},e.id)})),D&&(0,y.jsx)(a.m,{}),!D&&k&&(0,y.jsx)("div",{className:"load-more",children:(0,y.jsx)("button",{type:"button",onClick:function(e){e.preventDefault(),I()},className:r?"load-more__replies text-brand":"btn btn-secondary load-more__comments",children:i().t(r?"comments.list.show_more_replies":"comments.list.show_more_comments")})}),L&&(0,y.jsx)(R,{spaceId:t.id,spaceIsPrivate:t.is_private,postId:n.id,parentCommentId:r,communityMemberForReply:b,autoFocus:h,onCreate:function(e){N(e),_(e)},bodyInputRef:x})]})},Z=n(84702),V=n(37903),W=n(20633),Q=n(1002);function $(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function G(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$(Object(n),!0).forEach((function(t){J(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function J(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var K=function(e){var t=e.comment,n=e.canReport,r=e.canReview,i=e.canEdit,a=e.canDestroy,s=e.canBookmark,l=e.isReply,c=e.onReportClick,u=e.onEditClick,m=e.onDeleteClick,f=e.onUpdate,p=(0,Z.I)(),v=[];return n&&v.push({key:"report",label:(0,o.t)("comments.action_menu.report.label"),href:"#",onClick:function(){c()}}),r&&v.push(G({key:"review",label:(0,o.t)("comments.action_menu.review.label"),to:N.sC.index()},p?{target:"_blank",rel:"noreferrer"}:{})),i&&v.push({key:"edit",label:(0,o.t)("comments.action_menu.edit.label"),onClick:function(){u()}}),a&&v.push({key:"delete",label:(0,o.t)("comments.action_menu.delete.label"),hasDanger:!0,onClick:function(){m()}}),0!==v.length||s?(0,y.jsx)("div",{className:d()("post__actions--comment",{"post__actions--reply":l}),"data-testid":"post-comment-actions",children:(0,y.jsxs)(Q.Lt,{button:(0,y.jsx)(W.h,{dataTestId:"action-more",name:"16-menu-dots-horizontal"}),children:[(0,y.jsx)(V.e,{variant:"dropdown",bookmarkType:"comment",record:t,onSuccess:function(e){var n=G(G({},t),{},{bookmark_id:e});f(n)}}),v.map((function(e){return(0,y.jsx)(Q.Lt.ItemWithLink,G(G({},e),{},{children:e.label}),e.key)}))]})}):null},Y=n(36464),X=n.n(Y),ee=n(31889),te=n(32224),ne=n(26953),re=n(65289),oe=n(54754),ie=n(37109),ae=function(e){var t=e.tiptapBody;return"post"===(null===t||void 0===t?void 0:t.format)?(0,y.jsx)(ie.R,{readOnly:!0,value:t.body,sgidToObjectMap:t.sgids_to_object_map,inlineAttachments:t.inline_attachments,openInternalLinksInCurrentTab:!0,disabledExtensions:["cta"]}):(0,y.jsx)(oe.T,{type:"comment",editable:!1,rich_text_body:t,openInternalLinksInCurrentTab:!0})},se=n(95071),le=n(29458),ce=n(44130),ue=function(e){var t=e.comment,n=t.body_trix_content,r=t.editor,o=t.tiptap_body,i=t.updated_at,a="tiptap"===r;return(0,y.jsx)("div",{className:"post__body","data-testid":"comment-body",children:(0,y.jsx)("div",{className:d()("post__inside text-dark !line-clamp-none",{"!overflow-auto":(0,se.G6)()}),"data-testid":"comment-body-inside",children:(0,y.jsx)(ce.X,{lines:8,children:a?(0,y.jsx)(ae,{tiptapBody:o}):(0,y.jsx)(le.P,{content:n})})},i)})};function de(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function me(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?de(Object(n),!0).forEach((function(t){fe(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):de(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function fe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var pe=function(e){var t,n=e.post,i=e.comment,a=i.id,c=i.community_member,u=i.member_tags,m=i.flagged_for_approval_at,f=i.created_at,p=(0,te.O)({public_uid:null!==(t=c.public_uid)&&void 0!==t?t:"",params:{show_back_link:!0}}),v=(0,Z.I)(),h=(0,r.useRef)(null),b=(0,l.wh)().currentCommunityMember,g=(0,ee.vb)(b),_=Boolean(c.admin),j=null===u||void 0===u?void 0:u.filter((function(e){var t;return(null===e||void 0===e?void 0:e.is_public)&&(null===e||void 0===e||null===(t=e.display_locations)||void 0===t?void 0:t.post_bio)})),x=(null===j||void 0===j?void 0:j.length)>0||_,w=(0,ne.kK)()?g:x,O=me({href:(0,N.LM)({spaceSlug:n.space_slug,slug:n.slug,hash:"".concat(L.q).concat(a)})},v?{target:"_blank",rel:"noreferrer"}:{}),S=(0,s.truncate)(c.headline,{length:160});return(0,y.jsxs)("div",{className:d()("post__user !items-start"),ref:h,children:[(0,y.jsx)("div",{className:"post__avatar",children:(0,y.jsx)("a",me(me({className:"user__avatar"},p),{},{children:(0,y.jsx)(P.s,{src:c.avatar_url||"",name:c.name||"",size:"10"})}))}),(0,y.jsxs)("div",{className:"post__bio",children:[(0,y.jsxs)("div",{className:d()("author",{"no-headline":!c.headline}),children:[(0,y.jsx)("div",{className:"author__name",children:(0,y.jsx)("a",me(me({},p),{},{children:c.name}))}),x&&w&&(0,y.jsx)("div",{className:"author__tags member-tags",children:(0,y.jsx)(re.m,{memberTags:j,isAdmin:_})}),(0,y.jsx)("div",{className:"author__time",children:(0,y.jsx)("a",me(me({},O),{},{children:X()(f)}))}),m&&(0,y.jsx)("span",{className:d()("author__in-review",{"!ml-0 !mt-1 md:!ml-2":!x}),children:(0,o.t)("comments.in_review")})]}),S&&(0,y.jsx)("div",{className:"post__meta",children:(0,y.jsx)("div",{className:"author__credentials text-dark",children:S})}),(0,y.jsx)(ue,{comment:i})]})]})},ve=n(42241),he=function(e){var t,n,r=e.comment,i=e.updateComment,a="post"===(null===r||void 0===r||null===(t=r.tiptap_body)||void 0===t?void 0:t.format);return(0,y.jsx)("div",{className:"text-dark mb-1 whitespace-pre-line text-sm font-normal",children:a?(0,y.jsx)(ve.l,{onSubmit:i,defaultValues:{tiptap_body:r.tiptap_body},children:(0,y.jsx)(S,{isEdit:!0,postId:r.post_id,spaceId:r.space_id,autoFocus:!0,initialSgidToObjectMap:null===r||void 0===r||null===(n=r.tiptap_body)||void 0===n?void 0:n.sgids_to_object_map})}):(0,y.jsx)(oe.T,{autofocus:!0,editable:!0,type:"comment",hardBreakOnEnter:!0,submitOnEnter:!1,submitOnModEnter:!0,rich_text_body:r.tiptap_body,onSubmit:function(e){var t=e.body,n=e.attachments;return i({tiptap_body:{body:t,attachments:n}})},isUpdate:!0,placeholder:(0,o.t)("write_a_comment"),menubarProps:{submitButtonLabel:(0,o.t)("comments.create.actions.save"),submittingLabel:(0,o.t)("comments.create.actions.saving")}})})},be=n(72675),ge=n(53448),ye=function(e){var t=e.comment,n=e.updateComment,r=(0,be.dd)();return(0,f.y1)("esc",(function(){return r.remove()}),{enableOnContentEditable:!0},[]),(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(ge.u_.Overlay,{}),(0,y.jsxs)(ge.u_.Content,{size:"lg",children:[(0,y.jsxs)(ge.u_.Header,{children:[(0,y.jsx)(ge.u_.Title,{size:"sm",children:(0,o.t)("comments.edit.form.title")}),(0,y.jsx)(ge.u_.HeaderActions,{children:(0,y.jsx)(ge.u_.CloseButton,{onClick:r.remove})})]}),(0,y.jsx)(ge.u_.Body,{className:"pb-6",children:(0,y.jsx)(he,{comment:t,updateComment:n})})]})]})},_e=n(99834),je=n(61989),xe=function(e){var t=e.spaceId,n=e.spaceIsPrivate,r=e.onClose,i=(0,m.Gc)(),a=i.watch,s=i.formState,l=s.isDirty,c=s.isSubmitting,u=s.isSubmitSuccessful,d=c||u,f=!!a().body&&!d;(0,_e.M)({enabled:f});var p=function(){l&&!confirm((0,o.t)("prevent_accidental_leave_message"))||r()};return(0,y.jsxs)(ge.u_.Content,{size:"lg",wrapperClassName:"!h-full",className:"!transform-none !overflow-visible",children:[(0,y.jsxs)(ge.u_.Header,{children:[(0,y.jsx)(ge.u_.Title,{children:(0,o.t)("comments.edit.form.title")}),(0,y.jsx)(ge.u_.HeaderActions,{children:(0,y.jsx)(ge.u_.CloseButton,{onClick:p})})]}),(0,y.jsx)(ge.u_.Body,{className:"comment__edit-modal-content-body trix-v2 max-h-[calc(100dvh-82px-65px)] !overflow-visible md:max-h-none",children:(0,y.jsx)(je.O,{id:"comment-edit-body",name:"body",placeholder:(0,o.t)("comments.form.fields.body_placeholder"),space_id:t,is_private_space:n})}),(0,y.jsxs)(ge.u_.Footer,{className:"bottom-0 flex justify-end space-x-4",children:[(0,y.jsx)(g.z,{type:"button",variant:"secondary",onClick:p,children:(0,o.t)("cancel")}),(0,y.jsx)(g.z,{type:"submit",variant:"primary",disabled:!f,children:d?(0,o.t)("saving_changes"):(0,o.t)("save_changes")})]})]})},we=function(e){var t=e.space,n=e.comment,r=e.onUpdate,i=t.id,a=t.is_private,l=(0,be.dd)(),c="tiptap"===n.editor,u=function(e){var t=e.comment,n=e.onUpdate,r=t.id,i=t.post_id,a=t.body_for_editor,s=(0,A.p)(),l=s.success,c=s.error;return{defaultValues:{body:a},updateComment:(0,k.useMutation)((function(e){return(0,I.gN)(N.av.comments.update({postId:i,id:r}),{comment:e})}),{onSuccess:function(e){n(e),l((0,o.t)("comments.edit.alerts.success"))},onError:function(){return c((0,o.t)("comments.edit.alerts.failure"))}}).mutateAsync}}({comment:n,onUpdate:function(e){r(e),l.hide()}}),d=u.defaultValues,m=u.updateComment;return(0,y.jsx)(ge.u_,{title:(0,o.t)("comments.edit.form.title"),isOpen:l.visible,onClose:s.noop,children:c?(0,y.jsx)(ye,{comment:n,updateComment:m}):(0,y.jsxs)(C.l,{defaultValues:d,onSubmit:m,className:"h-full",formClassName:"h-full",children:[(0,y.jsx)(ge.u_.Overlay,{}),(0,y.jsx)(xe,{spaceId:i,spaceIsPrivate:a,onClose:l.hide})]})})},Oe=be.gk.create((function(e){var t=e.space,n=e.comment,r=e.onUpdate;return(0,y.jsx)(we,{space:t,comment:n,onUpdate:r})})),Se=n(74238),Pe=["label","onClick","disabled","isLiked","className"];function Ce(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ke(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ce(Object(n),!0).forEach((function(t){Ie(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ce(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ie(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ne(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var Ae=function(e){var t=e.label,n=e.onClick,r=e.disabled,o=void 0!==r&&r,i=e.isLiked,a=void 0!==i&&i,s=e.className,l=Ne(e,Pe),c=(0,Se.TC)().isDarkAppearance;return(0,y.jsx)("div",{children:(0,y.jsx)("button",ke(ke({type:"button",className:s,onClick:function(e){e.preventDefault(),o||n()},"aria-disabled":o},l),{},{children:(0,y.jsx)("span",{"aria-checked":a,className:d()("text-sm font-medium",{"font-bold":a,"text-default":!a,"!text-darkest":c&&a}),children:t})}))})},Ee=n(6038),Te=function(e){var t=e.likesCount,n=e.onClick,r=(0,Se.TC)().isDarkAppearance;return(0,y.jsx)("div",{className:"w-full",children:(0,y.jsx)("button",{type:"submit",className:d()("text-default float-right text-sm font-medium",{"text-darkest":r}),"data-testid":"like-count",onClick:n,children:(0,o.t)("comments.likes",{count:t,formatted_count:(0,Ee.H)(t)})})})},De=function(e){var t=e.canLike,n=e.canReply,r=e.canSeeLikes,i=e.isLiked,a=e.isLikeDisabled,s=e.likesCount,c=e.onLikeClick,u=e.onLikesCountClick,m=e.onReplyClick,f=(0,l.wh)().currentUser,p=r&&s>0&&(f||t&&n);return(0,y.jsxs)("div",{className:"post__actions post__actions-visible",children:[t&&(0,y.jsx)(Ae,{className:d()("post__actions--like",{liked:i}),label:(0,o.t)("comments.engagement_actions.".concat(i?"liked":"like")),onClick:c,disabled:a,isLiked:i}),n&&(0,y.jsx)(Ae,{className:"post__actions--reply",label:(0,o.t)("comments.engagement_actions.reply"),onClick:m}),p&&(0,y.jsx)(Te,{likesCount:s,onClick:u})]})},Re=n(58533),Le=n(5295),Me=n(16743),Fe=["onClick"];function Ue(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Be(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ue(Object(n),!0).forEach((function(t){ze(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ue(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ze(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function He(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var qe=function(e){var t,n,r=e.communityMember,o=e.hideModal,i=(0,te.O)({public_uid:null!==(t=r.public_uid)&&void 0!==t?t:""}),a=i.onClick,s=He(i,Fe);return(0,y.jsxs)("button",Be(Be({type:"button",className:"flex w-full items-center gap-3 text-left",onClick:function(e){o(),null===a||void 0===a||a(e)}},s),{},{children:[(0,y.jsx)("div",{className:"mt-0",children:(0,y.jsx)(P.s,{name:null!==(n=r.name)&&void 0!==n?n:"",src:r.avatar_url,size:"10"})}),(0,y.jsx)(Me.Z.LabelSm,{weight:"medium",children:r.name})]}))},Ze=n(85564),Ve=n.n(Ze),We=n(10928),Qe=n.n(We),$e=n(45578),Ge=n.n($e),Je=n(13521),Ke=function(e){var t=e.id,n=e.placeholderLikesCount,r=(0,be.dd)(),i=function(e){var t=e.id,n=e.isQueryEnabled,r=e.placeholderLikesCount,o=(0,Je.m)(N.av.comments.userLikes({id:t,params:{per_page:15}}),{enabled:n}),i=o.data,a=o.isLoading,s=o.hasNextPage,l=o.fetchNextPage,c=o.mapPages;return{likedByMembers:Ge()(Ve()(c((function(e){return e.records}))),"id"),totalLikesCount:i?Qe()(i.pages).count:r,isLoading:a,hasNextPage:s,fetchNextPage:l}}({id:t,isQueryEnabled:r.visible,placeholderLikesCount:n}),s=i.likedByMembers,l=i.totalLikesCount,c=i.isLoading,u=i.hasNextPage,d=i.fetchNextPage;return(0,y.jsxs)(ge.u_,{title:(0,o.t)("comments.likes"),isOpen:r.visible,onClose:r.hide,children:[(0,y.jsx)(ge.u_.Overlay,{}),(0,y.jsxs)(ge.u_.Content,{children:[(0,y.jsxs)(ge.u_.Header,{children:[(0,y.jsx)(ge.u_.Title,{size:"sm",children:(0,y.jsx)(Me.Z.LabelLg,{weight:"semibold",children:(0,o.t)("comments.likes",{count:l,formatted_count:(0,Ee.H)(l)})})}),(0,y.jsx)(ge.u_.HeaderActions,{children:(0,y.jsx)(ge.u_.CloseButton,{onClick:r.hide})})]}),(0,y.jsx)(ge.u_.Body,{className:"py-4",children:c?(0,y.jsx)(a.m,{}):(0,y.jsx)("div",{id:"comment-likes-modal-".concat(t),className:"max-h-[calc(100dvh-62px-40px)] overflow-auto sm:max-h-80",children:(0,y.jsx)(Re.Z,{scrollThreshold:.75,next:d,hasMore:u||!1,loader:(0,y.jsx)(Le.a,{}),scrollableTarget:"comment-likes-modal-".concat(t),dataLength:s.length,className:"flex flex-col space-y-4",children:s.map((function(e){return(0,y.jsx)(qe,{communityMember:e,hideModal:r.hide},e.id)}))})})})]})]})},Ye=be.gk.create((function(e){var t=e.id,n=e.placeholderLikesCount;return(0,y.jsx)(Ke,{id:t,placeholderLikesCount:n})})),Xe=n(78270),et=["harassment","spam","incorrect_location","against_guidelines","other"],tt=function(e){var t=e.show,n=e.onClose,r=e.onReportSubmit,i=(0,l.Zh)().usedIn,a=et.map((function(e){return{value:e,label:(0,o.t)("flagged_contents.report_reasons.".concat(e))}}));return(0,y.jsx)(Xe.u,{show:t,onClose:n,title:(0,o.t)("comments.report.form.title"),containerClassName:"full-post-modal"===i&&"!z-[1061]",children:(0,y.jsxs)(C.l,{onSubmit:r,children:[(0,y.jsx)(C.l.Item,{name:"reported_reason_type",label:(0,o.t)("flagged_contents.form.reported_reason_type"),description:(0,o.t)("flagged_contents.form.reported_reason_type_description"),hideBorder:!0,children:(0,y.jsx)(C.l.SelectNative,{options:a})}),(0,y.jsx)(C.l.Item,{name:"reported_reason_body",label:(0,o.t)("flagged_contents.form.reported_reason_body"),description:(0,o.t)("flagged_contents.form.reported_reason_body_description"),hideBorder:!0,fullWidth:!0,children:(0,y.jsx)(C.l.TextArea,{})}),(0,y.jsx)(g.z,{type:"submit",variant:"primary",formButton:!0,children:(0,o.t)("report")})]})})};function nt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return rt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return rt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function rt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ot=n(1320);function it(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return at(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return at(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function at(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var st="Comment";function lt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return ct(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ct(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ct(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ut(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function dt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ut(Object(n),!0).forEach((function(t){mt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ut(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function mt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ft(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return pt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return pt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function pt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var vt=function(e){var t=e.space,n=e.post,i=e.comment,a=e.showReplyForm,u=void 0!==a&&a,d=e.autofocusReplyForm,m=void 0!==d&&d,f=e.onReplyClick,p=e.onUpdate,v=e.onDelete,h=e.onReplyCreate,b=e.onReplyDelete,g=(0,l.wh)().isViewOnlyMasquerading,_=i.id,j=i.parent_comment_id,x=i.community_member,w=i.replies,O=i.replies_count,S=i.flagged_for_approval_at,P=i.policies,C=!!S,E=!!j,T=P.can_report&&!C,D=P.can_manage&&C,R=P.can_edit,L=P.can_destroy,M=P.can_bookmark,F=(0,r.useRef)(),U=function(e){var t=e.comment,n=e.showReplyForm,i=e.replyFormRef,a=t.is_replying_enabled,s=(0,l.xJ)(),c=(0,l.EU)(),u=(0,Z.I)(),d=lt((0,r.useState)(n),2),m=d[0],f=d[1],p=lt((0,r.useState)(null),2),v=p[0],h=p[1];return{openReplyForm:function(e){var t=e.communityMember;if(s){var n,r;h(t),f(!0),i.current&&(null===(n=i.current.commands)||void 0===n||null===(r=n.focus)||void 0===r||r.call(n,"end"))}else{var a=(0,N.j)({params:{notice:(0,o.t)("comments.log_in_to_add_a_comment"),post_login_redirect:window.location.href}});u?window.open(a,"_blank","noreferrer"):window.location.href=a}},shouldShowReplyForm:m,communityMemberForReply:v,canReply:a&&c}}({comment:i,showReplyForm:u,replyFormRef:F}),B=U.openReplyForm,z=U.shouldShowReplyForm,H=U.communityMemberForReply,V=U.canReply,W=function(e){var t=e.comment,n=t.id,i=t.is_liking_enabled,a=t.is_liked,s=t.likes_count,c=(0,l.xJ)(),u=(0,l.EU)(),d=(0,Z.I)(),m=it((0,r.useState)(a),2),f=m[0],p=m[1],v=it((0,r.useState)(s),2),h=v[0],b=v[1],g=(0,k.useMutation)((function(){return ot.Qd.create({userLikeableId:n,userLikableType:st,forReactQuery:!0})})),y=g.mutate,_=g.isLoading,j=(0,k.useMutation)((function(){return ot.Qd.destroy({userLikeableId:n,userLikableType:st,forReactQuery:!0})})),x=j.mutate,w=j.isLoading;return{toggleLike:function(){if(c)_||w||(f?(p(!1),b((function(e){return e-1})),x()):(p(!0),b((function(e){return e+1})),y()));else{var e=(0,N.j)({params:{notice:(0,o.t)("comments.log_in_to_like_comments"),post_login_redirect:window.location.href}});d?window.open(e,"_blank","noreferrer"):window.location.href=e}},isLiked:f,likesCount:h,canLike:i&&u,canSeeLikes:i,isLoading:_||w}}({comment:i}),Q=W.toggleLike,$=W.isLiked,G=W.likesCount,J=W.canLike,Y=W.canSeeLikes,X=W.isLoading,ee=(0,be.dd)(Ye),te=(0,be.dd)(Oe),ne=function(e){var t=e.comment.id,n=(0,A.p)(),i=n.success,a=n.error,s=ft((0,r.useState)(!1),2),l=s[0],c=s[1],u=function(){return c(!1)},d=(0,k.useMutation)((function(e){return(0,I.Cu)(N.av.flaggedContent.create(),{flagged_content:dt(dt({},e),{},{flagged_contentable_id:t,flagged_contentable_type:"Comment"})})}),{onSuccess:function(){i((0,o.t)("comments.report.alerts.success"),{duration:"short",shouldUseProgress:!1}),u()},onError:function(){a((0,o.t)("comments.report.alerts.failure"))}}).mutate;return{isReportModalOpen:l,openReportModal:function(){return c(!0)},closeReportModal:u,submitReport:d}}({comment:i}),re=ne.isReportModalOpen,oe=ne.openReportModal,ie=ne.closeReportModal,ae=ne.submitReport,se=function(e){var t=e.comment,n=e.onDelete,i=t.id,a=t.post_id,s=(0,A.p)(),l=s.success,c=s.error,u=nt((0,r.useState)(!1),2),d=u[0],m=u[1],f=function(){return m(!1)},p=(0,k.useMutation)((function(){return(0,I.pC)(N.av.comments.destroy({postId:a,id:i}))}),{onSuccess:function(){l((0,o.t)("comments.delete.alerts.success"),{duration:"short",shouldUseProgress:!1}),f(),n({id:i})},onError:function(){c((0,o.t)("comments.delete.alerts.failure")),f()}}),v=p.mutate,h=p.isLoading;return{isDeleteConfirmModalOpen:d,openDeleteConfirmModal:function(){return m(!0)},closeDeleteConfirmModal:f,deleteComment:v,isDeletingComment:h}}({comment:i,onDelete:v}),le=se.isDeleteConfirmModalOpen,ce=se.openDeleteConfirmModal,ue=se.closeDeleteConfirmModal,de=se.deleteComment,me=se.isDeletingComment,fe=f||B;return(0,y.jsxs)("div",{className:"post--comment",id:"comment_wrapper_".concat(_),children:[(0,y.jsx)("div",{className:"text-dark",children:(0,y.jsxs)("div",{className:"post__content",children:[(0,y.jsx)(pe,{post:n,comment:i}),(0,y.jsx)(De,{canReply:V,canLike:J,canSeeLikes:Y,isLiked:$,likesCount:G,isLikeDisabled:X,onReplyClick:g?s.noop:function(){return fe({communityMember:x})},onLikeClick:g?s.noop:Q,onLikesCountClick:g?s.noop:function(){return ee.show({id:_,placeholderLikesCount:G})}}),(0,y.jsx)(K,{comment:i,canReport:T,canReview:D,canEdit:R,canDestroy:L,canBookmark:M,isReply:E,onReportClick:g?s.noop:oe,onEditClick:g?s.noop:function(){return te.show({space:t,comment:i,onUpdate:p})},onDeleteClick:g?s.noop:ce,onUpdate:p}),T&&(0,y.jsx)(tt,{show:re,onClose:ie,onReportSubmit:ae}),L&&(0,y.jsx)(c.c,{isOpen:le,onClose:ue,onConfirm:de,confirmText:me?(0,o.t)("deleting"):(0,o.t)("delete"),confirmVariant:"danger",title:(0,o.t)("comments.delete.confirm.title"),disabled:me,children:(0,o.t)("comments.delete.confirm.description")})]})}),!E&&(0,y.jsx)("div",{className:"post__replies",children:(0,y.jsx)(q,{space:t,post:n,parentCommentId:_,preloaded:!0,preloadedComments:w,preloadedCommentsTotalCount:O,showReplyForm:z,autofocusReplyForm:m,communityMemberForReply:H,onCommentReplyClick:B,onCommentCreate:h,onCommentDelete:b,formRef:F})})]})},ht=n(5827);const bt=function(e){var t=e.space,n=e.post,o=e.id,s=e.showReplyForm,l=void 0!==s&&s,c=e.autofocusReplyForm,u=void 0!==c&&c,d=e.onCommentDelete,m=e.onReplyCreate,f=e.onReplyDelete,p=(0,ht.E)({postId:n.id,id:o,postCommentsClosed:n.is_comments_closed}),v=p.comment,h=p.isLoading,b=p.updateQueryData;return(0,r.useEffect)((function(){h||window.initialiseTippy()}),[h]),z({enabled:!h}),h?(0,y.jsx)(a.m,{}):v?(0,y.jsx)(vt,{space:t,post:n,comment:v,showReplyForm:l,autofocusReplyForm:u,onUpdate:b,onDelete:d,onReplyCreate:m,onReplyDelete:f}):(0,y.jsx)("div",{className:"post__comment-not-found alert alert-warning !ml-0",children:i().t("comments.hierarchy.not_found")})},gt=q;var yt=n(97932),_t=n(68375),jt=n(30887),xt=function(e){var t=e.className;return(0,y.jsx)("div",{className:t,children:(0,y.jsxs)("div",{className:"bg-tertiary flex items-center justify-center gap-2 rounded-md p-3 text-center",children:[(0,y.jsx)(jt.JO,{size:16,type:"lock-v2",className:"text-dark"}),(0,y.jsx)(Me.Z.LabelSm,{children:(0,o.t)("post.comments_section.comments_closed")})]})})},wt=n(98929),Ot=n(61345);function St(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Pt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?St(Object(n),!0).forEach((function(t){Ct(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):St(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ct(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var kt=function(e){var t=e.isIframeEmbed,n=e.containerClassNames,r=e.currentCommunity,i=t?{target:"_blank",rel:"noreferrer"}:{},a=(0,wt.fs)(r);return(0,y.jsxs)("div",{className:n,children:[(0,y.jsx)("div",{className:"mb-3",children:(0,y.jsx)(Me.Z.LabelLg,{weight:"semibold",children:(0,o.t)("login_to_comment")})}),(0,y.jsxs)("div",{className:"flex items-center justify-center gap-4",children:[(0,y.jsx)("a",Pt(Pt({className:"btn btn-secondary",href:(0,N.j)({params:{post_login_redirect:window.location.href}})},i),{},{children:(0,o.t)("log_in")})),a&&(0,y.jsx)("a",Pt(Pt({className:"btn btn-primary signup-link",href:(0,wt.pn)(r)},i),{},{children:(0,o.t)("sign_up")}))]})]})},It=n(66007),Nt=function(e){var t=e.lockedPostCtaContent,n=e.containerClassNames;return(0,y.jsxs)("div",{className:n,children:[(0,y.jsx)("div",{children:(0,y.jsx)(Me.Z.TitleSm,{weight:"semibold",children:t.heading})}),(0,y.jsx)("div",{className:"mt-4",children:t.body&&(0,y.jsx)(Me.Z.BodyMd,{children:(0,y.jsx)(It.Z,{html:t.body})})}),(0,y.jsx)("div",{className:"mt-6",children:(0,y.jsx)(g.z,{onClick:function(){return window.location.href=t.buttonLink},children:t.buttonLabel})}),(0,y.jsxs)("div",{className:"already-member mt-4",children:[(0,y.jsx)(Me.Z.LabelSm,{children:(0,o.t)("already_a_member")}),(0,y.jsx)("a",{className:"signup-link text-brand ml-1 text-sm font-medium",href:(0,N.j)({params:{post_login_redirect:window.location.href}}),children:(0,o.t)("log_in")})]})]})},At=function(e){var t=e.post,n=e.space,r=(0,l.wh)(),i=r.currentCommunity,a=r.currentUser,s=(0,yt.m)(),c=s.isSharedPostWithTeaserLayout,u=s.showGatedCommentSectionAtBottom,m=s.showGatedCommentSectionAtTop,f=(0,Z.I)(),p={heading:i.locked_post_cta_heading||(0,o.t)("login_to_comment"),body:i.locked_post_cta_body,buttonLabel:i.locked_post_cta_button_text||(0,o.t)("log_in"),buttonLink:i.locked_post_cta_button_url||(0,N.j)({params:{post_login_redirect:window.location.href}})},v=!!!a&&c,h=(0,wt.v)(i),b=d()("gated-post gated-post--custom-cta",{post__logged_out_comments:!h,post__bottom_border:m,post__top_border:u,"gated-post--standard-layout":!t.minimal_layout,"gated-post--no-gradient":!v,"gated-post--gradient":v});return(h||(0,Ot.WB)(n))&&i.custom_cta_for_share_links?(0,y.jsx)(Nt,{containerClassNames:b,lockedPostCtaContent:p}):t.is_comments_enabled?(0,y.jsx)(kt,{containerClassNames:b,isIframeEmbed:f,currentCommunity:i}):void 0},Et=function(e){var t=e.post||{},n=t.slug,r=t.space_slug;return(0,y.jsx)("div",{className:"border-primary flex items-center justify-center gap-4 border-t p-12",children:(0,y.jsx)("a",{className:"btn btn-secondary",href:(0,N.LM)({spaceSlug:r,slug:n}),children:(0,o.t)("leave_a_comment")})})};function Tt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return Dt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Dt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Dt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Rt=function(e){var t=e.autofocusReplyForm,n=e.commentsFormRef,i=(0,yt.m)(),a=i.post,s=i.showGatedCommentSectionAtBottom,c=i.showGatedCommentSectionAtTop,u=i.shouldShowLeaveCommentButton,d=i.shouldHideCommentsListForSpace,m=i.refetchPostDetails,f=i.updatePostDetailsQueryCache,p=F().commentId,v=Tt((0,r.useState)(p),2),h=v[0],b=v[1],g=Tt((0,r.useState)(p&&a.comments_count>10),2),_=g[0],j=g[1],x=(0,l.L2)().data,w=(0,l.wh)().currentCommunityMember,O=a.is_comments_closed,S=function(){m&&m()},P=function(){f&&f({comments_count:a.comments_count+1})},C=function(){j(!1),b(null),window.location.hash="#all_comments"},k=d({space:x});(0,r.useEffect)((function(){b(p)}),[p]);var I=!(u||(0,_t.HZ)(a));return(0,y.jsxs)("div",{className:"post__comments trix-v2","data-controller":"comments",id:"all_comments","data-post-id":a.id,children:[O&&(0,y.jsx)(xt,{className:"m-4"}),u&&(0,y.jsx)(Et,{post:a}),I&&c&&(0,y.jsx)(At,{post:a,space:x}),!k&&_&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("div",{className:"show-all-comments__wrapper mx-[26px] mb-4 mt-[26px] !p-0",children:(0,y.jsxs)("a",{className:"show-all-comments__link btn btn-secondary",href:"#all_comments",onClick:function(e){e.preventDefault(),C()},children:[(0,y.jsx)(jt.JO,{type:"arrow-solid-top-left"}),(0,o.t)("post.comments_section.show_all_count_comments",{count:a.comments_count,formatted_count:(0,Ee.H)(a.comments_count)})]})}),(0,y.jsx)(bt,{communityMember:w,space:x,post:a,id:h,showReplyForm:!O,autofocusReplyForm:t,onCommentDelete:function(){S(),C()},onReplyCreate:P,onReplyDelete:S})]}),!k&&!_&&(0,y.jsx)(gt,{communityMember:w,space:x,post:a,showReplyForm:!O,autofocusReplyForm:t,formRef:n,onCommentCreate:P,onCommentDelete:S}),I&&s&&(0,y.jsx)(At,{post:a,space:x})]})}},59473:(e,t,n)=>{n.d(t,{N:()=>s});var r=n(32224),o=n(38870),i=n(16743),a=n(85893),s=function(e){var t=e.member,n=e.hideModal,s=t.name,l=t.avatar_url,c=t.public_uid,u=(0,r.O)({public_uid:c}),d=u.onClick,m=u["aria-label"],f=u.href,p=u.rel,v=u.target;return(0,a.jsxs)("a",{className:"flex items-center gap-3",onClick:function(e){n(),d&&d(e)},"aria-label":m,href:f,rel:p,target:v,children:[(0,a.jsx)("div",{className:"mt-0",children:(0,a.jsx)(o.s,{name:s,src:l,size:"10"})}),(0,a.jsx)(i.Z.LabelSm,{weight:"medium",children:s})]})}},62704:(e,t,n)=>{n.d(t,{Z:()=>b});var r=n(86013),o=n(88767),i=n(24185),a=n(43548),s=n(97012),l=n(34128),c=n(68375),u=n(49326),d=n(55675),m=n(61926),f=n(78270),p=n(21809),v=n(16743),h=n(85893),b=function(e){var t=e.spaceId,n=e.postId,b=e.postSlug,g=e.postTitle,y=e.hasNoteAboutExceptions,_=void 0===y||y,j=e.isOpen,x=void 0!==j&&j,w=e.onClose,O=e.onDuplicateSuccess,S=(0,i.k6)(),P=(0,p.p)(),C=P.success,k=P.error,I=(0,s.nT)(),N=I.isLoading,A=(0,I.helpers.basicSpacesWithPostCreationAllowed)(),E=(0,o.useMutation)((function(e){return(0,l.aU)(u.av.posts.duplicate({spaceId:t,postSlug:b}),{post:{post_id:n,space_id:e.space_id,send_notifications:e.send_notifications}})}),{onSuccess:function(e){C((0,r.t)("duplicated_successfully")),w(),S.push((0,c.RG)({post:e,editMode:!0})),O&&O(e)},onError:function(){k((0,r.t)("duplication_failed"))}}),T=E.mutate,D=E.isLoading;return N?null:(0,h.jsx)(f.u,{overflowVisible:!0,title:(0,r.t)("duplicate_post_title",{post_title:g||(0,r.t)("duplicate_post_title_untitled")}),show:x,onClose:w,children:(0,h.jsxs)(m.l,{onSubmit:T,defaultValues:{space_id:t,send_notifications:!1},children:[(0,h.jsx)(m.l.Item,{name:"space_id",hideBorder:!0,fullWidth:!0,label:(0,r.t)("space"),description:(0,r.t)("duplicate_post_to_space"),rules:{required:(0,r.t)("events.create.form.space_required_error")},children:(0,h.jsx)(a.M,{spaces:A,name:"space_id",variant:"form-input",defaultValue:t,containerClassname:"mt-2"})}),_&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(v.Z.LabelXs,{color:"text-light",children:(0,r.t)("comments_wont_be_duplicated")}),(0,h.jsx)(m.l.Item,{name:"send_notifications",hideBorder:!0,fullWidth:!0,label:(0,r.t)("duplicate_post_send_notifications"),hideDescription:!0,inlineReverse:!0,children:(0,h.jsx)(m.l.ToggleSwitch,{variant:"small",name:"send_notifications"})})]}),(0,h.jsx)("div",{className:"mt-4",children:(0,h.jsx)(d.z,{type:"submit",variant:"primary",disabled:D,children:D?(0,r.t)("duplicating"):(0,r.t)("duplicate")})})]})})}},88896:(e,t,n)=>{n.d(t,{u:()=>l});var r=n(81217),o=n(94812),i=n(97012),a=n(5295),s=n(85893),l=function(e){var t=e.show,n=e.closeModal,l=e.post,c=e.shouldSkipRedirectAfterSubmit,u=void 0!==c&&c,d=e.onChange,m=e.onSubmitSuccess;if(!t)return null;var f=(0,r.t)({spaceId:l.space_id,postSlug:l.slug,context:"edit-post-modal"}),p=f.isLoading,v=f.post,h=f.remove;if(p)return(0,s.jsx)(a.a,{variant:"fullscreen"});return(0,s.jsx)(i.DW,{post:v,onPostChange:d,children:(0,s.jsx)(o.Y,{show:t,closeModal:function(){n&&n(),h()},shouldSkipRedirectAfterSubmit:u,onSubmitSuccess:m})})}},62456:(e,t,n)=>{n.d(t,{p:()=>fe});var r=n(97932),o=n(97012),i=n(86013),a=n(88767),s=n(1320),l=n(82621),c=n(31389),u=n(62711),d=n(64850),m=n(34729),f=n(94997),p=n(1061),v=n(24885),h=n(26953),b=n(63099),g=n(37903),y=n(30887),_=n(71032),j=n(1002),x=n(21809),w=n(85893);function O(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return S(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return S(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var P=function(e){var t=e.onChange,n=e.onPostDestroy,S=(0,r.m)(),P=S.post,C=S.canUpdatePost,k=S.canDuplicatePost,I=S.canDestroyPost,N=S.canManagePost,A=S.refetchPostDetails,E=(0,v.Z)(),T=(0,x.p)(),D=T.success,R=T.error,L=(0,o.L2)().refetch,M=O((0,b.k)(),2),F=M[0],U=M[1],B=O((0,b.k)(!1),2),z=B[0],H=B[1],q=O((0,b.k)(),2),Z=q[0],V=q[1],W=(0,c.f0)(P),Q=(0,o.wh)().isViewOnlyMasquerading,$=(0,h.kK)(),G=(0,a.useMutation)((function(e){return s.S1.destroy({event:P,params:{delete_mode:e}})}),{onSuccess:function(){n(P.id),D(W?I18n.t("events.recurring_deletion_successful"):I18n.t("event_dropdown_actions.delete_successful")),null===L||void 0===L||L()},onError:function(){return R(I18n.t("event_dropdown_actions.delete_failed"))}});return C||k||I?Q?(0,w.jsx)(y.JO,{type:"menu-dots","aria-label":I18n.t("events.event_actions"),className:"cursor-not-allowed"}):(0,w.jsxs)(w.Fragment,{children:[(0,w.jsxs)(j.Lt,{direction:"bottom-end",button:(0,w.jsx)(j.Lt.MenuButton,{children:(0,w.jsx)("div",{"data-testid":"action-more",children:(0,w.jsx)(y.JO,{type:"menu-dots","aria-label":I18n.t("events.event_actions")})})}),transitionWrapperClassName:"z-50",size:"large",appendTo:document.body,children:[$&&(0,w.jsx)(m.i,{onChange:t,className:"w-full",buttonClassName:"w-full",button:(0,w.jsx)(j.Lt.ItemLink,{children:(0,i.t)("events.event_actions_dropdown.share_event")})}),(0,w.jsx)(g.e,{variant:"dropdown",bookmarkType:"event",record:P,onSuccess:A}),C&&(0,w.jsx)(j.Lt.ItemLink,{onClick:function(){return E.show({event:P})},forceClose:!0,children:(0,i.t)("edit_event")}),k&&(0,w.jsx)(j.Lt.ItemLink,{onClick:H,children:(0,i.t)("duplicate_event")}),I&&(0,w.jsx)(j.Lt.ItemLink,{onClick:function(){(0,p.H3)(P)?V(!0):U(!0)},forceClose:!0,children:(0,w.jsx)("span",{className:"text-v2-danger",children:(0,i.t)("delete_event")})}),N&&(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(j.Lt.Separator,{}),(0,w.jsx)(d.E,{event:P,canEdit:C})]})]}),(0,w.jsx)(_.c,{isOpen:F,title:(0,i.t)("delete_event_confirmation"),onClose:U,onCancel:U,onConfirm:G.mutate,confirmVariant:"danger",disabled:G.isLoading,confirmText:G.isLoading?(0,i.t)("deleting"):(0,i.t)("confirm"),children:(0,i.t)("delete_event_descriptor")}),(0,w.jsx)(u.D,{event:P,show:z,onClose:H}),!(0,f.yl)(P)&&(0,w.jsx)(l.t,{show:Z,onConfirm:G.mutate,onCloseModal:function(){return V(!1)}})]}):null},C=n(96486),k=n(24185),I=n(66927),N=n(68375),A=n(61345),E=n(33552),T=n(25388),D=n(98929),R=n(31889),L=n(49326),M=n(20633),F=n(53448),U=n(64622),B=n(34128),z=n(97646),H=function(e){var t=e.post,n=e.handleClose,o=void 0===n?C.noop:n,s=(0,x.p)(),l=s.success,c=s.error,u=!!t.post_follower_id,d=(0,r.m)().onPostFollow,m=(0,a.useMutation)(u?function(){return(0,B.pC)(L.av.postFollowers.destroy({postId:t.id,postFollowerId:t.post_follower_id}))}:function(){return(0,B.Cu)(L.av.postFollowers.create({postId:t.id}))},{onSuccess:function(e){var t;d({post_follower_id:u?null:null===e||void 0===e||null===(t=e.post_follower)||void 0===t?void 0:t.id}),o(),l(I18n.t(u?"post_unfollow.success":"post_follow.success"))},onError:function(){return c(I18n.t(u?"post_unfollow.error":"post_follow.error"))}});return(0,w.jsx)(j.Lt.ItemLink,{onClick:function(){m.mutate()},children:(0,w.jsx)(z.sI,{label:(0,i.t)("follow_post"),field:"follow_post",value:u,variant:"small"})})},q=n(64687),Z=n.n(q);function V(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}var W=function(e){var t,n,r=e.post,o=e.onChange,l=e.refetchPosts,c=e.handleClose,u=void 0===c?C.noop:c,d=(0,x.p)(),m=d.success,f=d.error,p=r.pinned_at_top_of_space,v=(0,a.useMutation)((function(){return s.Fv.pin({post:r,formData:{is_pinned:!p,pin_to_top:!0}})}),{onSuccess:(t=Z().mark((function e(t){return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o(t,{refetch:!1}),!(0,C.isFunction)(l)){e.next=4;break}return e.next=4,l();case 4:m(I18n.t(p?"post_unpinned":"post_pinned"));case 5:case"end":return e.stop()}}),e)})),n=function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(e){V(i,r,o,a,s,"next",e)}function s(e){V(i,r,o,a,s,"throw",e)}a(void 0)}))},function(e){return n.apply(this,arguments)}),onError:function(){f(I18n.t(p?"post_unpinned_error":"post_pinned_error"))},onSettled:u});return(0,w.jsx)(j.Lt.ItemLink,{onClick:v.mutate,children:(0,w.jsx)(z.sI,{label:(0,i.t)("pin_to_top"),field:"pin_to_top",value:p,variant:"small"})})},Q=n(70905);function $(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function G(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$(Object(n),!0).forEach((function(t){J(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function J(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var K=function(e){var t=e.post,n=void 0===t?{}:t,r=e.handleClose,o=e.onChange,l=!!n.pinned_at,c=(0,a.useQueryClient)(),u=(0,x.p)(),d=u.success,m=u.error,f=(0,Q.P)().refetch,p=(0,a.useMutation)((function(){return s.Fv.pin({post:n,formData:G(G({},n),{},{is_pinned:!l,pin_to_top:!1})})}),{onSuccess:function(e){o(e,{refetch:!1}),f(),c.invalidateQueries("posts"),d(I18n.t(l?"post_unpinned_from_sidebar":"post_pinned_to_sidebar"))},onError:function(){m(I18n.t(l?"post_unpinned_error":"post_pinned_error"))},onSettled:r});return(0,w.jsx)(j.Lt.ItemLink,{onClick:p.mutate,children:(0,w.jsx)(z.sI,{label:(0,i.t)("pin_post"),field:"pin_post",value:l,variant:"small"})})},Y=function(e){var t=e.post,n=e.handleClose,r=e.onChange,o=t.is_comments_disabled,s=o?"post.enable_comments":"post.disable_comments",l=(0,x.p)(),c=l.success,u=l.error,d=(0,a.useMutation)((function(){return(0,B.gN)(L.av.posts.update({spaceId:t.space_id,postSlug:t.slug}),{post:{space_id:t.space_id,is_comments_disabled:!o}})}),{onSuccess:function(e){r(e,{refetch:!1}),c((0,i.t)("".concat(s,".alerts.success")))},onError:function(){u((0,i.t)("".concat(s,".alerts.failure")))},onSettled:n}).mutate;return(0,w.jsx)(j.Lt.ItemLink,{onClick:d,children:(0,w.jsx)(z.sI,{label:(0,i.t)("post.action_menu.disable_comments"),field:"disable_comments",value:o,variant:"small"})})},X=function(e){var t=e.post,n=e.handleClose,r=e.onChange,o=t.is_comments_closed,s=o?"post.open_comments":"post.close_comments",l=(0,x.p)(),c=l.success,u=l.error,d=(0,a.useMutation)((function(){return(0,B.gN)(L.av.posts.update({spaceId:t.space_id,postSlug:t.slug}),{post:{space_id:t.space_id,is_comments_closed:!o}})}),{onSuccess:function(e){r(e,{refetch:!1}),c((0,i.t)("".concat(s,".alerts.success")))},onError:function(){u((0,i.t)("".concat(s,".alerts.failure")))},onSettled:n}).mutate;return(0,w.jsx)(j.Lt.ItemLink,{onClick:d,children:(0,w.jsx)(z.sI,{label:(0,i.t)("post.action_menu.close_comments"),field:"close_comments",value:o,variant:"small"})})};function ee(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}var te=function(e){var t,n,r=e.post,o=e.handleClose,l=void 0===o?C.noop:o,c=e.onChange,u=e.refetchPosts,d=r.hide_from_featured_areas,m=(0,x.p)(),f=m.success,p=m.error,v=(0,a.useMutation)((function(){return d?s.Fv.showInFeaturedAreas({post:r}):s.Fv.hideFromFeaturedAreas({post:r})}),{onSuccess:(t=Z().mark((function e(t){return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c(t,{refetch:!1}),!(0,C.isFunction)(u)){e.next=4;break}return e.next=4,u();case 4:f(I18n.t(d?"post.marked_unhidden":"post.marked_hidden"));case 5:case"end":return e.stop()}}),e)})),n=function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(e){ee(i,r,o,a,s,"next",e)}function s(e){ee(i,r,o,a,s,"throw",e)}a(void 0)}))},function(e){return n.apply(this,arguments)}),onError:function(){p(I18n.t("something_went_wrong"))}});return(0,w.jsx)(j.Lt.ItemLink,{onClick:function(){l(),v.mutate()},children:(0,w.jsx)(z.sI,{label:(0,i.t)("post.hide_from_featured_areas"),field:"hide_from_featured_areas",value:d,variant:"small"})})},ne=n(62704),re=n(88896),oe=n(55675),ie=n(61926),ae=n(78270),se=["harassment","spam","incorrect_location","against_guidelines","other"],le=function(e){var t=e.onClose,n=e.show,r=e.post,s=(0,o.Zh)().usedIn,l=(0,x.p)(),c=(0,a.useMutation)((function(e){return(0,B.t5)(L.av.flaggedContent.create(),{method:"POST",forReactQuery:!0,body:JSON.stringify({flagged_content:e})})}),{onSuccess:function(){l.success((0,i.t)("report_post_success")),t()},onError:function(){l.error((0,i.t)("something_went_wrong"))}}),u=se.map((function(e){return{value:e,label:(0,i.t)("flagged_contents.report_reasons.".concat(e))}}));return(0,w.jsx)(ae.u,{show:n,onClose:t,title:(0,i.t)("flagged_contents.form.report_post"),containerClassName:"full-post-modal"===s&&"!z-[1061]",children:(0,w.jsxs)(ie.l,{defaultValues:{flagged_contentable_id:r.id,flagged_contentable_type:"Post"},onSubmit:c.mutate,children:[(0,w.jsx)(ie.l.Item,{name:"reported_reason_type",label:(0,i.t)("flagged_contents.form.reported_reason_type"),description:(0,i.t)("flagged_contents.form.reported_reason_type_description"),hideBorder:!0,children:(0,w.jsx)(ie.l.SelectNative,{options:u})}),(0,w.jsx)(ie.l.Item,{name:"reported_reason_body",label:(0,i.t)("flagged_contents.form.reported_reason_body"),description:(0,i.t)("flagged_contents.form.reported_reason_body_description"),hideBorder:!0,fullWidth:!0,children:(0,w.jsx)(ie.l.TextArea,{})}),(0,w.jsx)(oe.z,{type:"submit",variant:"primary","data-testid":"report_post_submit",formButton:!0,children:I18n.t("report")})]})})};function ce(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return ue(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ue(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ue(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var de=function(e){var t=e.refetchPosts,n=e.currentCommunity,l=e.onPostDestroy,c=e.onChange,u=(0,k.k6)(),d=(0,r.m)(),m=d.post,f=d.showModerationInActionsDropdown,p=d.canManagePost,v=d.canUpdatePost,y=d.canDestroyPost,O=d.canDuplicatePost,S=d.canReportPost,P=d.refetchPostDetails,B=d.showShareOnWebOptions,z=(0,o.Zh)().usedIn,q=ce((0,b.k)(!1),2),Z=q[0],V=q[1],Q=ce((0,b.k)(!1),2),$=Q[0],G=Q[1],J=ce((0,b.k)(!1),2),ee=J[0],oe=J[1],ie=ce((0,b.k)(!1),2),ae=ie[0],se=ie[1],ue=(0,o.wh)(),de=ue.currentCommunitySettings,me=ue.isViewOnlyMasquerading,fe=ue.currentCommunityMember,pe=null===de||void 0===de?void 0:de.quick_post_v2_enabled,ve=(0,T.L)().show,he=(0,I.e)(),be=(0,E.h)(),ge=(0,h.kK)(),ye=(0,N.Fr)(m),_e=(0,N.hm)(m),je=(0,F.UV)(),xe=je.contentPortalElement,we=je.onClose,Oe=(0,x.p)(),Se=Oe.success,Pe=Oe.error,Ce=(0,o.L2)(),ke=Ce.data,Ie=Ce.refetch,Ne=(null===de||void 0===de?void 0:de.show_posts_editor_toggle_enabled)&&(0,R.vb)(fe),Ae=_e&&Boolean(!(null!==ke&&void 0!==ke&&ke.hide_right_sidebar))&&!(0,A.AU)(ke),Ee=(0,a.useMutation)((function(){return s.Fv.destroy({post:m})}),{onSuccess:function(){l(m.id),Se((0,i.t)("post_dropdown_actions.delete_successful")),Ie()},onError:function(){return Pe((0,i.t)("post_dropdown_actions.delete_failed"))}}),Te=(0,a.useMutation)((function(){return s.Fv.toggleEditorType({post:m})}),{onSuccess:function(){Se((0,i.t)("post_dropdown_actions.toggle_editor_successful"))},onError:function(){return Pe((0,i.t)("post_dropdown_actions.toggle_editor_failed"))}}),De=(0,a.useMutation)((function(){return s.Fv.updateKnowledgeBasePost({post:m})}),{onSuccess:function(){Se((0,i.t)("post_dropdown_actions.update_knowledge_base_post_successful"))},onError:function(){return Pe((0,i.t)("post_dropdown_actions.update_knowledge_base_post_failed"))}}),Re=function(e){return u.push((0,N.RG)({post:e}))};return me?(0,w.jsx)(M.h,{name:"16-menu-dots-horizontal",iconClassName:"!text-dark cursor-not-allowed","aria-label":(0,i.t)("post_actions"),dataTestId:"action-more",disabled:!0}):(0,w.jsxs)(w.Fragment,{children:[(0,w.jsxs)(j.Lt,{direction:"bottom-end",button:(0,w.jsx)(M.h,{name:"16-menu-dots-horizontal",iconClassName:"!text-dark","aria-label":(0,i.t)("post_actions"),dataTestId:"action-more"}),className:"z-10 ml-0 md:ml-1",transitionWrapperClassName:"z-50",size:"large",buttonLabel:(0,i.t)("post_actions"),appendTo:null!==xe&&void 0!==xe?xe:document.body,children:[(0,w.jsx)(g.e,{variant:"dropdown",bookmarkType:"post",record:m,onSuccess:P}),v&&_e&&(0,w.jsx)(j.Lt.ItemLink,{onClick:function(){me?(0,C.noop)():pe?ve({post:m,onPostChange:c}):V()},children:(0,i.t)("edit_post")}),v&&ye&&(0,w.jsx)(j.Lt.ItemLink,{onClick:function(){he.show({spaceId:ke.id,onClose:function(){return he.remove()},onPostChange:c,currentPost:m,shouldSkipRedirectAfterSubmit:"full-post-modal"===z})},children:(0,i.t)("edit_post")}),B&&(ge||"full-post-modal"===z)&&(0,w.jsx)(U.P,{onChange:c,className:"w-full",buttonClassName:"w-full",button:(0,w.jsx)(j.Lt.ItemLink,{children:(0,i.t)("post.share.title")}),shouldRenderCustomMenuButton:ge||"full-post-modal"===z}),_e&&O&&(0,w.jsx)(j.Lt.ItemLink,{onClick:G,children:(0,i.t)("duplicate_post")}),ye&&O&&(0,w.jsx)(j.Lt.ItemLink,{onClick:function(){"full-post-modal"===z&&we(),be.show({post:m,onSuccess:Re})},children:(0,i.t)("duplicate_post")}),S&&(0,w.jsx)(j.Lt.ItemLink,{onClick:me?C.noop:oe,children:(0,i.t)("report_post")}),f&&(0,w.jsx)(j.Lt.ItemWithLink,{to:L.sC.index(),children:(0,i.t)("flagged_contents.review")}),y&&(0,w.jsx)(j.Lt.ItemLink,{onClick:me?C.noop:se,children:(0,w.jsx)("span",{className:"text-v2-danger",children:(0,i.t)("delete_post")})}),Ne&&(0,w.jsx)(j.Lt.ItemLink,{onClick:function(){Te.mutate()},children:(0,i.t)("post_dropdown_actions.toggle_editor_dropdown_label",{editor_type:"trix"===m.editor?"tiptap":"trix"})}),Ne&&(0,w.jsx)(j.Lt.ItemLink,{onClick:function(){De.mutate()},children:(0,i.t)("post_dropdown_actions.update_knowledge_base_post_dropdown_label")}),(v||O||S||f||y)&&(0,w.jsx)(j.Lt.Separator,{}),(0,w.jsx)(H,{post:m,onChange:c}),p&&(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(W,{post:m,onChange:c,refetchPosts:t}),Ae&&(0,w.jsx)(K,{post:m,onChange:c,refetchPosts:t}),(0,w.jsx)(Y,{post:m,onChange:c}),m.is_comments_enabled&&(0,w.jsx)(X,{post:m,onChange:c}),(0,D.Nf)(n)&&(0,w.jsx)(te,{post:m,community:n,onChange:c,refetchPosts:t})]})]}),(0,w.jsx)(re.u,{show:Z,closeModal:V,post:m,onChange:c}),(0,w.jsx)(ne.Z,{spaceId:m.space_id,postId:m.id,postSlug:m.slug,postTitle:m.name,isOpen:$,onClose:G}),(0,w.jsx)(le,{post:m,show:ee,onClose:oe}),(0,w.jsx)(_.c,{isOpen:ae,title:(0,i.t)("delete_post_confirmation"),onClose:se,onCancel:se,onConfirm:Ee.mutate,confirmVariant:"danger",disabled:Ee.isLoading,confirmText:Ee.isLoading?(0,i.t)("deleting"):(0,i.t)("confirm"),children:(0,i.t)("delete_post_descriptor")})]})},me=function(e){var t=e.onChange,n=e.onPostDestroy,o=e.refetchPosts,i=e.currentCommunity,a=(0,r.m)(),s=a.isBasicPost,l=a.isEventPost,c=a.isImagePost;return(0,w.jsxs)(w.Fragment,{children:[(s||c)&&(0,w.jsx)(de,{onChange:t,onPostDestroy:n,refetchPosts:o,currentCommunity:i}),l&&(0,w.jsx)(P,{onChange:t,onPostDestroy:n})]})},fe=function(e){var t=e.onChange,n=e.onPostDestroy,i=e.refetchPosts,a=(0,r.m)(),s=a.showPostActions,l=a.canUpdatePost,c=a.canDestroyPost,u=a.isEventPost,d=(0,o.wh)().currentCommunity;return s&&(!u||l||c)?(0,w.jsx)(me,{onChange:t,onPostDestroy:n,refetchPosts:i,currentCommunity:d}):null}},36187:(e,t,n)=>{n.d(t,{H:()=>m});var r=n(28053),o=n(97012),i=n(46324),a=n(85893),s=["post"];function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var m=function(e){var t,n=e.post,l=d(e,s),u=(0,o.wh)().currentCommunitySettings,m=u.optimize_active_storage_images_enabled,f=u.progressive_image_loading_enabled,p=m?null===(t=n.cover_image_variants)||void 0===t?void 0:t.large:n.cover_image_url;return p?(0,a.jsx)("div",{className:"px-5 pt-5 md:p-0",children:(0,a.jsx)(i.s,c(c({post:n,className:"post__cover"},l),{},{children:f&&m?(0,a.jsx)(r.Q,{src:n.cover_image_url,srcVariants:n.cover_image_variants,alt:I18n.t("post.cover_image_alt")},n.cover_image_url):(0,a.jsx)("img",{loading:"lazy",src:p,alt:I18n.t("post.cover_image_alt")},p)}))}):null}},64622:(e,t,n)=>{n.d(t,{P:()=>P});var r=n(94184),o=n.n(r),i=n(86013),a=n(85751),s=n(97012),l=n(30887),c=n(55675),u=n(1002),d=n(97646),m=n(16743),f=n(67294),p=n(20640),v=n.n(p),h=n(49326),b=n(21809);function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){_(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function j(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return x(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return x(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function x(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var w=n(85893),O=function(e){var t=e.getSharePostLink,n=e.post,r=e.sharePostData,p=function(e){var t=e.post,n=e.getSharePostLink,r=e.sharePostData,o=(0,b.p)().success,a=(0,s.wh)().currentCommunity,l=(0,s.L2)().data,c=j((0,f.useState)({post:{show_post_teaser:!(null===t||void 0===t||!t.show_post_teaser),share_to_web:!(null===t||void 0===t||!t.share_post_enabled),share_post_enabled:!(null===t||void 0===t||!t.share_post_enabled),minimal_layout:!(null===t||void 0===t||!t.minimal_layout)}}),2),u=c[0],d=c[1],m=(0,h.LM)({spaceSlug:null===t||void 0===t?void 0:t.space_slug,slug:null===t||void 0===t?void 0:t.slug});return(0,f.useEffect)((function(){t.share_post_enabled&&!r&&n({postId:null===t||void 0===t?void 0:t.id,body:u})}),[null===t||void 0===t?void 0:t.share_post_enabled,r,u,n,null===t||void 0===t?void 0:t.id]),{onClickCopyLink:function(e){v()(e||window.location.origin+m),o((0,i.t)("post.share.link_copied"),{duration:"short",shouldUseProgress:!1})},onChange:function(e){d((function(r){var o={post:y(y({},r.post),e)};return n({postId:null===t||void 0===t?void 0:t.id,body:o}),o}))},formData:u,currentCommunity:a,currentSpace:l}}({post:n,getSharePostLink:t,sharePostData:r}),g=p.onClickCopyLink,_=p.onChange,x=p.formData,O=p.currentCommunity,S=p.currentSpace,P=(0,s.wh)().isViewOnlyMasquerading;return O.is_private||null!==S&&void 0!==S&&S.is_private?(0,w.jsxs)("div",{children:[(0,w.jsx)(u.Lt.ItemLink,{disabled:P,onClick:function(){_({share_to_web:!x.post.share_to_web})},children:(0,w.jsx)(d.sI,{label:(0,i.t)("post.share.share_to_web"),tooltipText:(0,i.t)("post.share.share_to_web_on_description"),field:"share_to_web",value:x.post.share_to_web,variant:"small",disabled:P,className:o()({"cursor-not-allowed":P})})}),x.post.share_to_web&&(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)("div",{className:"flex flex-row items-center",children:(0,w.jsx)("div",{className:"mb-4 mt-1 flex-1 px-5",children:(0,w.jsx)(a.I,{disabled:!0,value:null===r||void 0===r?void 0:r.share_post_link,rightAddon:(0,w.jsx)("button",{type:"submit",onClick:function(){return g(null===r||void 0===r?void 0:r.share_post_link)},children:(0,w.jsx)(l.JO,{type:"20-copy"})})})})}),(0,w.jsx)(u.Lt.ItemLink,{onClick:function(){_({show_post_teaser:!x.post.show_post_teaser})},children:(0,w.jsx)(d.sI,{label:(0,i.t)("post.share.show_teaser"),tooltipText:(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)("p",{children:(0,i.t)("post.share.show_teaser_description_title")}),(0,w.jsx)("a",{href:"/settings#field-custom_cta_for_share_links",children:(0,i.t)("post.share.show_teaser_description_link")})]}),field:"show_post_teaser",value:x.post.show_post_teaser,variant:"small"})}),!(null!==O&&void 0!==O&&O.is_private)&&(0,w.jsx)(u.Lt.ItemLink,{onClick:function(){return _({minimal_layout:!x.post.minimal_layout})},children:(0,w.jsx)(d.sI,{label:(0,i.t)("post.share.minimal_layout"),tooltipText:(0,i.t)("post.share.minimal_layout_description"),field:"minimal_layout",value:x.post.minimal_layout,variant:"small"})})]})]}):(0,w.jsxs)("div",{className:"flex flex-row items-center px-4 py-2",children:[(0,w.jsxs)("div",{className:"flex flex-1 flex-col",children:[(0,w.jsx)(m.Z.LabelMd,{weight:"bold",children:(0,i.t)("post.share.share_to_web")}),(0,w.jsx)(m.Z.LabelSm,{children:(0,i.t)("post.share.post_is_public")})]}),(0,w.jsx)("div",{children:(0,w.jsx)(c.z,{variant:"secondary",onClick:function(){return g()},children:(0,i.t)("copy_link")})})]})},S=n(97932),P=function(e){var t=e.onChange,n=e.button,r=e.shouldRenderCustomMenuButton,a=(0,S.m)({onChangeSharePost:t}),c=a.showShareOnWebOptions,d=a.post,f=a.getSharePostLink,p=a.sharePostData,v=(0,s.L2)().data,h=n||(0,w.jsx)(l.JO,{type:"16-share",size:20});return c(v)?(0,w.jsx)(u.Lt,{size:"extra-large",direction:"bottom-end",className:o()("z-10 w-full md:w-auto",{"ml-1":!r}),buttonClassName:o()("w-full md:w-auto",{"md:!w-full":r}),button:r?h:(0,w.jsx)(u.Lt.MenuButton,{className:"!pt-0",children:(0,w.jsx)(m.Z.LabelSm,{weight:"medium",color:"text-dark hover:text-default",children:(0,i.t)("post.share.title")})}),children:(0,w.jsx)(O,{post:d,getSharePostLink:f,sharePostData:p})}):null}},46324:(e,t,n)=>{n.d(t,{s:()=>h});var r=n(24185),o=n(40160),i=n(93404),a=n(68375),s=n(49326),l=n(84702),c=n(53448),u=n(85893),d=["post","ariaLabel","allComments","forwardedRef","onClick","children"];function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){p(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function v(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var h=function(e){var t=e.post,n=e.ariaLabel,m=e.allComments,p=void 0!==m&&m,h=e.forwardedRef,b=e.onClick,g=e.children,y=v(e,d),_=(0,r.UO)().postSlug,j=(0,l.I)(),x=(0,c.UV)(),w=x.isInsideModal,O=x.onClose,S=(0,s.LM)({spaceSlug:t.space_slug,slug:t.slug,hash:p?i.Q:""});return j?(0,u.jsx)("a",f(f(f({href:S,target:"_blank",rel:"noreferrer","aria-label":n},y),h&&{ref:h}),{},{children:g})):(0,a.Sb)(t,{postSlugInUrl:_})?(0,u.jsx)("a",f(f(f({href:S,"aria-label":n},y),h&&{ref:h}),{},{children:g})):(0,u.jsx)(o.rU,f(f(f({to:S,"aria-label":n},y),h&&{ref:h}),{},{onClick:w?O:b,children:g}))}},43114:(e,t,n)=>{n.d(t,{D:()=>Le});var r=n(67294),o=n(94184),i=n.n(o),a=n(24185),s=n(31714),l=n(90195),c=n(7568),u=n(97932),d=n(30414),m=n(86013),f=n(97012),p=n(30887),v=n(6038),h=n(25067),b=n(85893),g=function(e){var t=e.count,n=e.toggleComment;return e.hasPostDetailsLoaded?(0,b.jsx)("button",{type:"button",className:"hover:!text-dark focus-visible:!text-dark transition-colors duration-150 ease-in-out",onClick:n,children:(0,m.t)("post.comments",{count:t,formatted_count:(0,v.H)(t)})}):(0,b.jsx)(h.gi,{variant:"row",lg:!0,long:!0})},y=function(e){var t,n=e.shouldOpenCommentPage,r=e.showCommentAndFocusCommentForm,o=e.toggleComment,a=(0,f.EU)(),s=(0,u.m)().post,l=s.is_comments_closed,c=s.is_comments_enabled,d=s.comments_count,v=void 0===d?0:d,h=s.post_details_loaded;return c&&!n?(0,b.jsxs)(b.Fragment,{children:[!l&&a&&(0,b.jsxs)("button",{type:"button",onClick:r,"aria-label":(0,m.t)("cap_comment_aria_label",{title:null!==(t=null===s||void 0===s?void 0:s.name)&&void 0!==t?t:(0,m.t)("this_post")}),className:i()("action-comment text-default hover:!text-dark focus-visible:!text-dark transition-colors duration-150 ease-in-out"),children:[(0,b.jsx)("span",{className:"action__icon",children:(0,b.jsx)(p.JO,{useWithFillCurrentColor:!0,type:"message"})}),(0,b.jsx)("span",{className:i()("action__label"),children:(0,m.t)("cap_comment")})]}),(0,b.jsx)("div",{className:"engagement__comments",children:(0,b.jsx)(g,{count:v,toggleComment:o,hasPostDetailsLoaded:h})})]}):null},_=n(46324),j=function(e){var t=e.shouldOpenCommentPage,n=e.toggleComment,r=(0,u.m)().post,o=r.is_comments_enabled,i=r.comments_count,a=void 0===i?0:i,s=r.post_details_loaded;return o&&t?(0,b.jsxs)(_.s,{post:r,allComments:!0,className:"flex w-full !items-center !justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center",children:[(0,b.jsx)("span",{className:"action__icon",children:(0,b.jsx)(p.JO,{type:"message",className:"!text-dark",useWithFillCurrentColor:!0})}),(0,b.jsx)("span",{className:"count !text-dark",children:(0,m.t)("cap_comment")})]}),(0,b.jsx)("div",{className:"flex items-center",children:(0,b.jsx)(g,{count:a,toggleComment:n,hasPostDetailsLoaded:s})})]}):null},x=n(96486),w=["post"];function O(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var S=function(){var e,t=(0,f.EU)(),n=(0,u.m)(),r=n.post,o=O(n,w),a=r.is_liking_enabled,s=r.is_liked_by_current_user,l=r.post_details_loaded;return a&&t?(0,b.jsxs)("button",{type:"button","aria-label":(0,m.t)("like_post_aria_label",{name:null!==(e=null===r||void 0===r?void 0:r.name)&&void 0!==e?e:""}),onClick:function(e){(0,x.isFunction)(null===o||void 0===o?void 0:o.onLikeToggle)&&o.onLikeToggle(e)},className:i()("action-link post__actions--like hover:!text-dark focus-visible:!text-dark transition-colors duration-150 ease-in-out",{liked:s,"cursor-not-allowed":!l,"text-default":!s}),children:[(0,b.jsx)("span",{className:"action__icon",children:(0,b.jsx)(p.JO,{useWithFillCurrentColor:!0,type:"like"})}),(0,b.jsx)("span",{"aria-checked":s,className:i()("action__label"),children:(0,m.t)(s?"liked":"like")})]}):null},P=n(67142),C=n(68375),k=n(28175),I=function(e){var t=e.firstCommunityMemberToLike,n=e.secondCommunityMemberToLike,r=e.likesCount;if(e.isLoading)return(0,b.jsx)(h.gi,{variant:"row",lg:!0,extraLong:!0});if(!t)return null;var o="";return 1===r?o=(0,m.t)("liked_by_name",{name:t.first_name,count:r,formatted_count:(0,v.H)(r)}):2===r?o=(0,m.t)("liked_by_two_names",{first:t.first_name,second:n.first_name}):r>2&&(o=(0,m.t)("liked_by_name",{name:t.first_name,count:r-1,formatted_count:(0,v.H)(r)})),(0,b.jsx)("span",{children:o})},N=n(58533),A=n(72675),E=n(86078),T=n(49326),D=n(13521),R=n(53448),L=n(59473),M=function(e){var t,n=e.post,o=(0,A.dd)(),i=(0,D.m)(T.av.posts.userLikesList({postId:String(n.id),params:{per_page:15}}),{enabled:!(null===n||void 0===n||!n.id)},["post-likes-modal",null===n||void 0===n?void 0:n.id]),a=i.data,s=i.isLoading,l=i.fetchNextPage,c=i.hasNextPage,u=i.mapPages,d=(0,r.useMemo)((function(){return(0,x.flatten)(u((function(e){return e.records})))}),[u]),f=null===a||void 0===a||null===(t=a.pages[0])||void 0===t?void 0:t.count;return(0,b.jsxs)(R.u_,{title:(0,m.t)("like_modal_title"),isOpen:o.visible,onClose:o.hide,children:[(0,b.jsx)(R.u_.Overlay,{}),(0,b.jsxs)(R.u_.Content,{children:[(0,b.jsxs)(R.u_.Header,{children:[(0,b.jsx)(R.u_.Title,{size:"sm",children:f?(0,b.jsxs)(b.Fragment,{children:[(0,v.H)(f)," ",1===f?(0,m.t)("like"):(0,m.t)("likes")]}):(0,m.t)("likes")}),(0,b.jsx)(R.u_.HeaderActions,{children:(0,b.jsx)(R.u_.CloseButton,{onClick:o.hide})})]}),(0,b.jsx)(R.u_.Body,{className:"py-4",children:s?(0,b.jsx)(E.m,{}):(0,b.jsx)("div",{id:"post-likes-modal-".concat(n.id),className:"max-h-[calc(100dvh-62px-40px)] overflow-auto sm:max-h-80",children:(0,b.jsx)(N.Z,{scrollThreshold:.75,next:l,hasMore:c||!1,loader:(0,b.jsx)(E.m,{}),scrollableTarget:"post-likes-modal-".concat(n.id),dataLength:d.length,className:"flex flex-col space-y-4",children:d.map((function(e){return(0,b.jsx)(L.N,{member:e,hideModal:o.hide},e.id)}))})})})]})]})},F=A.gk.create((function(e){var t=e.post;return(0,b.jsx)(M,{post:t})})),U=function(){var e=(0,u.m)(),t=e.post,n=e.isPostBodyEmpty,r=(0,k.I)().isV3Enabled,o=t.user_likes_count,a=t.is_liking_enabled,s=t.sample_user_likes_community_members,l=void 0===s?[]:s,c=t.post_details_loaded,d=(0,A.dd)(F);if(!c)return(0,b.jsx)("div",{className:i()("post__engagement",{"!pt-5":(0,C.Fr)(t)&&n}),children:(0,b.jsx)(h.gi,{variant:"members-avatar-row"})});if(!a||!o||!l.length)return null;return(0,b.jsx)("button",{type:"button",onClick:function(){return d.show({post:t})},className:i()("post__engagement",{"!pt-5":(0,C.Fr)(t)&&n}),children:(0,b.jsxs)("div",{className:"engagement__likes",children:[(0,b.jsx)("div",{className:"engagement__members border-tertiary",children:(0,b.jsx)(P.pB,{users:l.slice(0,3).map((function(e){return{src:e.avatar_url,name:e.name}})),isFullRounded:r})}),(0,b.jsx)("div",{className:"engagement__members--descriptor","data-testid":"post-engagement",children:(0,b.jsx)(I,{firstCommunityMemberToLike:l[0],secondCommunityMemberToLike:l[1],likesCount:o,isLoading:!c})})]})})},B=function(e){var t=e.toggleComment,n=e.showCommentAndFocusCommentForm,r=e.shouldOpenCommentPage,o=void 0!==r&&r;return(0,u.m)().showEngagementActions?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(U,{}),(0,b.jsxs)("div",{className:"post__actions post__actions-visible !border-primary !border-t",children:[(0,b.jsx)(d.T,{children:(0,b.jsx)(S,{})}),(0,b.jsx)(y,{shouldOpenCommentPage:o,showCommentAndFocusCommentForm:n,toggleComment:t}),(0,b.jsx)(j,{shouldOpenCommentPage:o,toggleComment:t})]})]}):null},z=n(26953),H=n(95220),q=n(87863),Z=n(37903),V=n(16743),W=function(e){var t=e.post,n=(0,z.kK)();return t.pinned_at_top_of_space?n&&(0,C.hm)(t)?(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(p.JO,{size:20,type:"20-pinned-post",className:"text-dark"}),(0,b.jsx)(V.Z.LabelXxs,{weight:"font-semibold",children:(0,m.t)("post.pinned_post")})]}):(0,b.jsx)("div",{className:"post__pin post__pin--pinned",children:(0,b.jsx)(p.JO,{type:"pin"})}):null},Q=n(62456),$=n(64622),G=function(e){var t=e.post,n=e.onChange,r=e.onPostDestroy,o=e.refetchPosts,a=e.hideShareLink,s=e.hidePinnedToTopIcon,l=e.hideBookmarkButton,c=(0,u.m)().refetchPostDetails,d=(0,z.kK)(),m=(0,C.Fr)(t),f=(0,C.hm)(t),p=m||f;return d&&p?(0,b.jsx)("div",{className:i()("post-actions",{"flex flex-col gap-2":t.pinned_at_top_of_space,"float-right":!t.pinned_at_top_of_space}),children:(0,b.jsxs)("div",{className:i()("px-5 pt-5",{"flex w-full flex-row justify-between":t.pinned_at_top_of_space}),children:[!s&&(0,b.jsx)(W,{post:t}),(0,b.jsx)("div",{className:"flex flex-row gap-1",children:(0,b.jsx)(Q.p,{onChange:n,onPostDestroy:r,refetchPosts:o})})]})}):(0,b.jsxs)("div",{className:"post__actions-container text-dark items-center justify-center","data-testid":"post-header-actions",children:[!s&&(0,b.jsx)(W,{post:t}),(0,b.jsx)(Q.p,{onChange:n,onPostDestroy:r,refetchPosts:o}),!a&&(0,b.jsx)($.P,{onChange:n}),!l&&(0,b.jsx)("span",{className:i()({"z-10 mb-0.5":p,"mt-0.5":!p}),children:(0,b.jsx)(Z.e,{bookmarkType:p?"post":"event",record:t,onSuccess:c})})]})},J=n(66007),K=n(95071),Y=n(29458),X=n(44130),ee=n(37109),te=n(88767),ne=n(87588),re=n(95764),oe=n(19300),ie=n(62268);function ae(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return se(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return se(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function se(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var le=function(e){var t=e.post,n=ae((0,r.useState)(null),2),o=n[0],i=n[1],a=ae((0,r.useState)(!1),2),s=a[0],l=a[1],c=(0,te.useMutation)((function(e){var t=e.postId,n=e.value;return ne.R.createPostFeedback({postId:t,helpful:n})})).mutate;return(0,b.jsxs)("div",{className:"mx-auto w-full pt-4",children:[(0,b.jsx)("div",{className:"mb-4",children:(0,b.jsx)(oe.Di,{weight:"semibold",children:(0,m.t)("support_widget.was_this_article_helpful")})}),(0,b.jsx)("div",{className:"mb-6 flex justify-center gap-4",children:(0,b.jsx)(ie.O,{value:o,handleFeedback:function(e){s||(i(e),c({postId:t.id,value:e}),l(!0))},isFeedbackGiven:s})}),(0,b.jsx)("div",{children:(o||!1===o)&&(0,b.jsx)("div",{className:"mb-2",children:(0,b.jsx)(re.p,{children:(0,m.t)("support_widget.thank_you_for_article_feedback")})})})]})},ce=function(e){var t=e.enableTruncation,n=void 0!==t&&t,o=e.noPadding,a=void 0!==o&&o,s=e.className,l=void 0===s?"":s,c=(0,u.m)(),d=c.post,m=c.isSharedPostWithTeaserLayout,f=c.isSharedPostViewWithMinimalLayout,p=c.isTiptapPost,v=c.isTrixPost,h=c.isBasicPost,g=c.isPostBodyEmpty,y=["help","help-en"].includes(d.community_slug)&&h,_=!n,j=f&&m,w=m,O=d.body_trix_content,S=d.tiptap_body,P=d.internal_custom_html,k=d.pinned_at_top_of_space,I=d.updated_at;if((0,r.useEffect)((function(){var e;P&&(0,x.isFunction)(null===(e=window)||void 0===e?void 0:e.loadOembed)&&window.loadOembed()}),[P]),g)return null;var N=8;return k?N=2:j&&(N=4),(0,b.jsx)("div",{className:i()("post__body",{"!p-0":a,"!pt-5":f&&(0,C.Fr)(d)},l),"data-testid":"post-body",children:(0,b.jsx)("div",{className:i()("post__inside trix-v2 !line-clamp-none w-full",{"!overflow-auto":(0,K.G6)()}),"data-testid":"post-body-inside",children:(0,b.jsxs)(X.X,{lines:N,disabled:_,hideToggle:w,children:[v&&O&&(0,b.jsx)(Y.P,{content:O,contentParentPath:T.xu.show({slug:d.slug,spaceSlug:d.space_slug})}),p&&S&&(0,b.jsx)(ee.R,{readOnly:!0,value:S.body,sgidToObjectMap:S.sgids_to_object_map,inlineAttachments:S.inline_attachments,disabledExtensions:["cta"]}),P&&(0,b.jsx)(J.Z,{html:P},"internal_custom_html"),y&&(0,b.jsx)(le,{post:d})]})})},I)},ue=n(36187),de=n(36464),me=n.n(de),fe=n(32224),pe=n(65289),ve=(0,r.forwardRef)((function(e,t){var n=e.headline,r=e.post,o=r.community_member,a=r.name,s=r.flagged_for_approval_at,l=r.created_at;return(0,z.kK)()?(0,b.jsxs)("div",{className:"post__meta",children:[!a&&s?(0,b.jsx)("span",{className:"post__headline-tag !ml-0",children:(0,m.t)("in_review")}):o&&n&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("span",{className:i()("author__credentials !text-dark",{"is-admin":!!o.is_admin}),children:n}),(0,b.jsx)("span",{className:"bg-badge mx-2 inline-block h-[0.15rem] w-[0.15rem] rounded-full align-middle"})]}),(0,b.jsx)("div",{className:"author__time inline-block",children:(0,b.jsx)(_.s,{post:r,className:"ago !text-dark",forwardedRef:t,children:me()(l)})})]}):(0,b.jsx)("div",{className:"post__meta",children:!a&&s?(0,b.jsx)("span",{className:"post__headline-tag !ml-0",children:(0,m.t)("in_review")}):o&&(0,b.jsx)("span",{className:i()("author__credentials !text-dark",{"is-admin":!!o.is_admin}),children:n})})}));ve.displayName="AuthorHeadline";var he=n(38870);function be(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ge(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?be(Object(n),!0).forEach((function(t){ye(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):be(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ye(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var _e=function(e){var t,n,r=e.post.community_member,o=(0,fe.O)({public_uid:null!==(t=r.public_uid)&&void 0!==t?t:"",params:{show_back_link:!0},name:r.name});return(0,b.jsx)("div",{className:"post__avatar",children:(0,b.jsx)("a",ge(ge({},o),{},{children:(0,b.jsx)("div",{className:"mr-[14px]","data-testid":"post-avatar",children:(0,b.jsx)(he.s,{src:r.avatar_url,name:null!==(n=r.name)&&void 0!==n?n:"",size:"10"})})}))})},je=(0,r.forwardRef)((function(e,t){var n=e.doesPostHaveCoverImage,r=void 0!==n&&n,o=e.className,a=e.children,s=(0,z.kK)();return(0,b.jsx)("div",{className:i()("post__user !items-start",{"!mb-0 !px-5 !pt-5 md:!mb-2 md:!mt-1":s&&r,"!mt-0 !px-5 !pt-5":s&&!r},o),ref:t,children:a})}));function xe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function we(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?xe(Object(n),!0).forEach((function(t){Oe(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Oe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}je.displayName="PostViewListItemWrapper";var Se=function(e){var t=e.isRenderedOutsideTheSpace,n=e.space,o=e.doesPostHaveCoverImage,a=void 0!==o&&o,s=e.tagsLimit,l=e.tagsShowMoreLabelVariant,c=e.wrapperClassName,d=e.hideAuthorHeadline,f=(0,u.m)(),p=f.post,v=f.isSharedPostView,h=p.community_member,g=p.hide_meta_info,y=p.member_tags,j=(0,fe.O)({public_uid:h.public_uid,params:{show_back_link:!0}}),w=null===y||void 0===y?void 0:y.filter((function(e){var t;return(null===e||void 0===e?void 0:e.is_public)&&(null===e||void 0===e||null===(t=e.display_locations)||void 0===t?void 0:t.post_bio)})),O=(0,r.useMemo)((function(){return h.id&&(null===w||void 0===w?void 0:w.length)>0}),[h.id,w]),S=(0,z.kK)(),P=(0,r.useRef)(null),C=(0,r.useRef)(null);if(g||!n)return null;var k=(0,x.truncate)(h.headline,{length:160}),I=t?"".concat((0,m.t)("post.posted_in")," ").concat(n.name):k,N=Boolean(h.admin);return S?(0,b.jsxs)(je,{doesPostHaveCoverImage:a,ref:P,children:[(0,b.jsx)(_e,{post:p}),(0,b.jsxs)("button",{type:"button",className:"post__bio text-left",onClick:function(e){e.target instanceof HTMLAnchorElement||C.current&&C.current.click()},children:[(0,b.jsxs)("div",{className:i()("author",{"no-headline":!h.headline&&p.name,"has-tags":O}),children:[(0,b.jsx)("div",{className:"author__name",children:(0,b.jsx)("a",we(we({},j),{},{className:"!text-dark",children:h.name}))}),!v&&(O||N)&&(0,b.jsx)("div",{className:"author__tags member-tags !m-0",children:(0,b.jsx)(pe.m,{memberTags:w,isAdmin:N,limit:s,showMoreLabelVariant:l})})]}),!d&&(0,b.jsx)(ve,{headline:I,post:p,ref:C})]})]}):(0,b.jsxs)(je,{doesPostHaveCoverImage:a,ref:P,className:c,children:[(0,b.jsx)(_e,{post:p}),(0,b.jsxs)("button",{type:"button",className:"post__bio text-left",onClick:function(e){e.target instanceof HTMLAnchorElement||C.current&&C.current.click()},children:[(0,b.jsxs)("div",{className:i()("author",{"no-headline":!h.headline&&p.name,"has-tags":O}),children:[(0,b.jsx)("div",{className:"author__name",children:(0,b.jsx)("a",we(we({},j),{},{className:"!text-dark",children:h.name}))}),!v&&(O||N)&&(0,b.jsx)("div",{className:"author__tags member-tags",children:(0,b.jsx)(pe.m,{memberTags:w,isAdmin:N,limit:s,showMoreLabelVariant:l})}),(0,b.jsx)("div",{className:"author__time",children:(0,b.jsx)(_.s,{post:p,className:"ago !text-dark",forwardedRef:C,children:me()(p.created_at)})})]}),!d&&(0,b.jsx)(ve,{headline:I,post:p})]})]})},Pe=n(47653),Ce=function(){var e=(0,u.m)(),t=e.post,n=e.canManagePost;if(!t.name)return null;var r=(t||{}).event_setting_attributes||{},o=r.starts_at,a=r.ends_at,s=i()("post__header",{"post-meta--hidden":t.hide_meta_info});return(0,b.jsxs)("div",{className:s,children:[o&&a&&(0,b.jsx)(Pe.A,{startsAt:o,endsAt:a,status:null===t||void 0===t?void 0:t.status}),(0,b.jsx)("h1",{className:i()("post__title text-2xl",{"with-admin-actions":n}),children:(0,b.jsxs)(_.s,{post:t,children:[t.name,t.flagged_for_approval_at&&(0,b.jsx)("span",{className:"post__headline-tag",children:I18n.t("in_review")})]})})]})};function ke(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ie(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ke(Object(n),!0).forEach((function(t){Ne(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ke(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ne(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ae(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return Ee(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ee(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ee(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Te=function(e){var t,n=e.autofocusReplyForm,o=void 0!==n&&n,d=e.className,m=e.defaultShowComment,p=void 0!==m&&m,v=e.hideAuthorHeadline,h=void 0!==v&&v,g=e.hideBookmarkButton,y=void 0!==g&&g,_=e.hidePinnedToTopIcon,j=void 0!==_&&_,x=e.hideShareLink,w=void 0!==x&&x,O=e.isRenderedOutsideTheSpace,S=void 0!==O&&O,P=e.metaInfoWrapperClassName,k=e.onPostChange,I=e.onPostDestroy,N=e.pageSupportsContentTruncation,A=void 0===N||N,E=e.refetchPosts,T=e.shouldOpenCommentPage,D=void 0!==T&&T,R=e.tagsLimit,L=e.tagsShowMoreLabelVariant,M=(0,r.useRef)(null),F=(0,f.Zh)(),U=F.record,Z=F.usedIn,V=(0,u.m)(),W=V.isPostBodyEmpty,Q=V.isPostMetaHidden,$=(0,f.L2)().data,J=Ae((0,r.useState)(p),2),K=J[0],Y=J[1],X=Ae((0,r.useState)(o),2),ee=X[0],te=X[1],ne=(0,z.kK)(),re=null===(t=(0,a.$B)("/home"))||void 0===t?void 0:t.isExact,oe=U.name,ie=U.is_truncation_disabled,ae=U.is_comments_enabled,se=U.flagged_for_approval_at,le=U.hide_meta_info,de=U.pinned_at_top_of_space,me=U.post_details_loaded,fe=U.event_setting_attributes,pe=null===fe||void 0===fe?void 0:fe.live_stream_room_setting_attributes,ve=null===pe||void 0===pe?void 0:pe.recording_url,he=null===pe||void 0===pe?void 0:pe.recording_transcript_id,be=null===pe||void 0===pe?void 0:pe.recording_thumbnail,ge=null===pe||void 0===pe?void 0:pe.auto_post_recording_enabled,ye=null===U||void 0===U?void 0:U.cover_image_url,_e=!ie,je=(0,f.wh)(),xe=je.currentUser,we=je.currentCommunitySettings,Oe=null===we||void 0===we?void 0:we.reactified_comments_enabled,Pe=(0,u.m)(),ke=Pe.isSharedPostView,Ne=Pe.isSharedPostWithTeaserLayout,Ee=A&&_e||Ne,Te=W&&!re&&!Q&&!(0,C.Fr)(U);if(!U||!U.id)return null;var De=function(){setTimeout((function(){var e=document.querySelector('[input="comment-body-'.concat(U.id,'"]'));e&&e instanceof HTMLElement&&(e.focus(),e.scrollIntoView({behavior:"smooth",block:"center"}))}),500)},Re=(0,r.useCallback)((function(){return(0,H.p)(M.current)&&M.current.focus()}),[M]);(0,r.useEffect)((function(){ee&&Re()}),[Re]);var Le=i()("post post--parent !bg-primary !border-primary",{"post--shared":ke,"post--shared__truncated":Ne&&!xe,"is-truncation-disabled":!Ee,"flagged-for-approval":se,"post-name--empty":!oe,"post-meta--hidden":le,"is-pinned":de,"!shadow-none !rounded-none !border-0 !border-b":"full-post-modal"===Z},d),Me=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};k(Ie(Ie({},U),e),t)},Fe=(0,r.useCallback)((function(){var e,t;(Y(!0),Oe)?(te(!0),M.current&&((0,H.p)(M.current)?(0,H.p)(M.current)&&M.current.focus():null===(e=M.current.commands)||void 0===e||null===(t=e.focus)||void 0===t||t.call(e,"end"))):De()}),[Oe,De]),Ue=(0,C.HZ)(U);return(0,b.jsxs)("div",{className:Le,children:[(0,b.jsx)(ue.H,{post:U}),(0,b.jsxs)("div",{className:i()("post__post",{"!border-x-0":ke,"!border-b":!xe&&ke&&Ue,"!border-primary !rounded-t-lg":ke&&!(null!==U&&void 0!==U&&U.cover_image_url)}),children:[(0,b.jsx)(G,{post:U,onChange:Me,refetchPosts:E,onPostDestroy:I,hideShareLink:w,hidePinnedToTopIcon:j,hideBookmarkButton:y}),(0,b.jsxs)("div",{className:i()("post__content text-dark",{"pb-5":Te}),children:[S||ne?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(Se,{isRenderedOutsideTheSpace:S,space:$,doesPostHaveCoverImage:ye}),(0,b.jsx)(Ce,{})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(Ce,{}),(0,b.jsx)(Se,{isRenderedOutsideTheSpace:S,doesPostHaveCoverImage:ye,space:$,tagsLimit:R,tagsShowMoreLabelVariant:L,wrapperClassName:P,hideAuthorHeadline:h})]}),Ue&&(0,b.jsx)(l.Y,{onChange:Me,insidePost:!0}),ve&&ge&&(0,b.jsx)("div",{className:"px-6 py-4",children:(0,b.jsx)(q.T,{src:ve,type:"video/mp4",mediaTranscriptId:he,poster:be})}),(0,C.Fr)(U)&&"full-post-modal"!==Z&&(0,b.jsx)(s.l,{onPostChange:k,onPostDestroy:I}),(0,b.jsx)(ce,{enableTruncation:Ee})]})]}),(0,b.jsx)("div",{className:"mt-auto",children:(0,b.jsx)(B,{toggleComment:function(){te(!1),Y((function(e){return!e}))},showCommentAndFocusCommentForm:Fe,shouldOpenCommentPage:D})}),me&&ae&&K&&(0,b.jsx)(c.o,{commentsFormRef:M,autofocusReplyForm:ee})]})};function De(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Re(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Le=function(e){return(0,b.jsx)(Te,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?De(Object(n),!0).forEach((function(t){Re(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):De(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e))}},97932:(e,t,n)=>{n.d(t,{m:()=>b});var r=n(88767),o=n(24185),i=n(34128),a=n(97012),s=n(98929),l=n(31889),c=n(68375),u=n(61345),d=n(84702),m=["record"];function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){v(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function h(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var b=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).onChangeSharePost,t=(0,o.UO)().postSlug,n=(0,d.I)(),f=(0,a.Zh)(),v=f.record,b=h(f,m),g=(0,a.wh)(),y=g.currentUser,_=g.currentCommunity,j=g.currentCommunityMember,x=c.Sb(v,{postSlugInUrl:t}),w=x&&v.minimal_layout,O=x&&v.show_post_teaser,S=!n&&c.GT(v,{currentUser:y,postSlugInUrl:t}),P=c.ou(v),C=c.sN(v),k=c.Vr(v),I=c.$2(v),N=c.KX(v),A=w,E=!y&&v.is_comments_enabled&&!v.is_comments_closed||O,T=E&&v.comments_count>5,D=E&&v.comments_count<=5,R=v.flagged_for_approval_at&&P,L=c.hm(v),M=c.HZ(v),F=c.Fr(v),U=c.s8(v),B=c.Iz(v),z=c.Vt(v),H=c.A8(v),q=!w&&(v.is_liking_enabled||v.is_comments_enabled),Z=w&&j,V=(0,r.useMutation)((function(e){var t=e.postId,n=e.body;return(0,i.aU)("/posts/".concat(t,"/share"),n)}),{onSuccess:function(t){e&&e(p(p({},v),t),{refetch:!1})}}),W=V.mutate,Q=V.data,$=V.isLoading;return p(p({post:v},b),{},{canManagePost:P,canDuplicatePost:k,canDestroyPost:I,canUpdatePost:C,canReportPost:N,isSharedPostView:x,showPostActions:S,showEngagementActions:q,showGatedCommentSection:E,showGatedCommentSectionAtTop:T,showGatedCommentSectionAtBottom:D,showModerationInActionsDropdown:R,isBasicPost:L,isEventPost:M,isImagePost:F,showSpaceName:A,isSharedPostViewWithMinimalLayout:w,isSharedPostWithTeaserLayout:O,isTiptapPost:U,isTrixPost:B,getSharePostLink:W,sharePostData:Q,isLoadingSharePostData:$,showShareOnWebOptions:function(e){return!x&&!n&&(0,c.Pu)(v,_,e)},shouldHideCommentsListForSpace:function(e){var t=e.space,n=(0,s.aF)(_)||j,r=(0,u.fL)(t)||(0,u.J$)(t)||(0,l.vb)(j);return!(n&&r)||w||O},isPostBodyEmpty:z,isPostMetaHidden:H,shouldShowLeaveCommentButton:Z})}},88044:(e,t,n)=>{n.d(t,{e:()=>f});var r=n(67294),o=n(86013),i=n(88767),a=n(87588),s=n(95764),l=n(19300),c=n(62268),u=n(85893);function d(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return m(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return m(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var f=function(e){var t=e.post,n=d((0,r.useState)(null),2),m=n[0],f=n[1],p=d((0,r.useState)(!1),2),v=p[0],h=p[1],b=(0,i.useMutation)((function(e){var t=e.postId,n=e.value;return a.R.createPostFeedback({postId:t,helpful:n})})).mutate;return(0,u.jsxs)("div",{className:"mx-auto w-full pt-4",children:[(0,u.jsx)("div",{className:"mb-4",children:(0,u.jsx)(l.Di,{weight:"semibold",children:(0,o.t)("support_widget.was_this_article_helpful")})}),(0,u.jsx)("div",{className:"mb-6 flex justify-center gap-4",children:(0,u.jsx)(c.O,{value:m,handleFeedback:function(e){v||(f(e),b({postId:t.id,value:e}),h(!0))},isFeedbackGiven:v})}),(0,u.jsx)("div",{children:(m||!1===m)&&(0,u.jsx)("div",{className:"mb-2",children:(0,u.jsx)(s.p,{children:(0,o.t)("support_widget.thank_you_for_article_feedback")})})})]})}},36189:(e,t,n)=>{n.d(t,{S:()=>y});var r=n(94184),o=n.n(r),i=n(96486),a=n(30658),s=n(30414),l=n(97012),c=n(25067),u=n(86013),d=n(6038),m=n(68375),f=n(30887),p=n(87958),v=n(40518),h=n(85893),b=function(e){var t=e.post,n=e.comments_count,r=e.className,i=e.showCount,a=void 0===i||i,s=e.onCommentsClick,l=e.iconClassName,c=void 0===l?"text-default":l;return(0,h.jsx)("div",{className:o()("col-span-1",r),children:(0,h.jsx)(p.T,{placement:"bottom",content:(0,u.t)("post.comment_description"),interactive:!1,children:(0,h.jsxs)(v.s,{post:t,allComments:!0,ariaLabel:(0,u.t)("post.comment_description"),className:o()("action-item action-comment text-default focus-visible:outline-secondary group flex items-center justify-center rounded-md text-center focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",{"hover:bg-tertiary p-1":!(0,m.Fr)(t)}),onClick:s,children:[(0,h.jsx)("span",{className:"action__icon inline-flex align-text-top",children:(0,h.jsx)(f.JO,{"aria-hidden":!0,type:"message",className:o()("group-hover:text-dark mr-1",c),useWithFillCurrentColor:!0})}),a&&(0,h.jsx)("span",{className:"count text-default group-hover:text-dark text-base",children:(0,d.H)(n)})]})})})},g=function(e){var t,n,r=e.name,i=e.onLikeToggle,a=e.is_liked_by_current_user,s=e.user_likes_count,c=e.isOrCanBeCommunityMember,v=e.className,b=e.iconClassName,g=void 0===b?"":b,y=e.likedSpanClassName,_=e.showCount,j=void 0===_||_,x=(0,l.wh)().isViewOnlyMasquerading,w=(0,l.Zh)().record;return(0,h.jsx)("div",{className:o()("col-span-1",v),children:(0,h.jsx)(p.T,{placement:"bottom",content:(t=a,n=t?"post.unlike_description":"post.like_description",(0,u.t)(n,{name:null!==r&&void 0!==r?r:""})),interactive:!1,children:(0,h.jsxs)("button",{type:"button",onClick:i,"aria-label":(0,u.t)("like_post_aria_label",{name:null!==r&&void 0!==r?r:""}),className:o()("action-item action-link action-like post__actions--like text-default focus-visible:outline-secondary group flex items-center justify-center rounded-md text-center focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",{liked:a,disabled:!c||x,"hover:text-dark":!a,"hover:bg-tertiary min-w-[2.5rem] p-1":!(0,m.Fr)(w)}),children:[(0,h.jsx)("span",{className:o()("action__icon inline-flex align-text-top",a&&y),children:(0,h.jsx)(f.JO,{type:"like",className:o()("mr-1",{"!text-brand":a},g),useWithFillCurrentColor:!0})}),j&&(0,h.jsx)("span",{className:o()("count text-base",{"!text-brand":a}),children:(0,d.H)(s)})]})})})},y=function(e){var t=e.type,n=void 0===t?"list":t,r=e.wrapperClassName,u=e.commentButtonClassName,d=e.commentIconClassName,m=e.likeButtonClassName,f=e.likeIconClassName,p=e.likedSpanClassName,v=e.showCommentsCount,y=void 0===v||v,_=e.showLikesCount,j=void 0===_||_,x=e.onCommentsClick,w=void 0===x?i.noop:x,O=(0,a.m)(),S=O.post,P=O.showEngagementActions,C=O.onLikeToggle,k=S.user_likes_count,I=S.is_liking_enabled,N=S.is_comments_enabled,A=S.is_liked_by_current_user,E=S.comments_count,T=S.post_details_loaded,D=S.display_title,R=(0,l.EU)();return P&&(I||N)?T?(0,h.jsxs)("div",{className:o()("post--".concat(n,"__actions post--").concat(n,"__actions-visible"),{"flex items-center gap-1 text-sm":"list"===n},{"absolute bottom-4 left-4 flex items-center gap-2":"card"===n},r),children:[(0,h.jsx)(s.T,{children:I&&(0,h.jsx)(g,{name:D,onLikeToggle:function(e){null===C||void 0===C||C(e)},isOrCanBeCommunityMember:R,user_likes_count:k,is_liked_by_current_user:A,className:m,iconClassName:f,likedSpanClassName:p,showCount:j})}),N&&(0,h.jsx)(b,{comments_count:E,post:S,className:u,iconClassName:d,showCount:y,onCommentsClick:w})]}):(0,h.jsxs)("div",{className:o()("post--".concat(n,"__actions post--").concat(n,"__actions-visible"),{"flex items-center":"list"===n},{"absolute bottom-4 left-4 flex items-center gap-2":"card"===n},r),children:[(0,h.jsx)("div",{className:o()("action-item action-link action-like post__actions--like p-1",m),children:(0,h.jsx)("span",{className:"action__icon",children:(0,h.jsx)(c.gi,{variant:"row",lg:!0,short:!0})})}),(0,h.jsx)("div",{className:o()("action-item action-comment p-1",u),children:(0,h.jsx)("span",{className:"action__icon",children:(0,h.jsx)(c.gi,{variant:"row",lg:!0,short:!0})})})]}):null}},92452:(e,t,n)=>{n.d(t,{Y:()=>je});var r=n(67294),o=n(86254),i=n(94184),a=n.n(i),s=n(95585),l=n(97012),c=n(85893),u=function(){var e=(0,l.Zh)().record,t=(0,r.useRef)(null),n=(0,r.useRef)(null),i=(0,l.wh)().currentCommunityMember;return(0,r.useEffect)((function(){if(t.current&&null!==e&&void 0!==e&&e.is_comments_enabled){var n=new o.do((function(){var e=document.documentElement.scrollHeight;window.parent.postMessage(["setHeight",e],"*")}));return n.observe(t.current),function(){return n.disconnect()}}}),[null===e||void 0===e?void 0:e.is_comments_enabled]),null!==e&&void 0!==e&&e.is_comments_enabled?(0,c.jsx)("div",{ref:t,className:a()("post bg-primary border-primary border md:mb-6 md:rounded-lg",{"pb-1 pt-2.5":!!i}),children:(0,c.jsx)(s.o,{commentsFormRef:n,autofocusReplyForm:!1})}):null},d=n(31714),m=n(68375),f=n(30658),p=n(29458),v=n(44130),h=n(37109),b=function(){var e=(0,l.Zh)(),t=e.record,n=e.helpers,r=t.body_trix_content,o=t.tiptap_body,i=n,a=i.isTiptapPost,s=i.isTrixPost,u=(0,f.m)().isPostBodyEmpty;return(0,c.jsxs)(c.Fragment,{children:[!u&&(0,c.jsx)(v.X,{seeMoreClassName:"text-default hover:text-dark",children:(0,c.jsxs)("div",{className:"profile-posts__post__body",children:[s&&r&&(0,c.jsx)(p.P,{content:r}),a&&o&&(0,c.jsx)(h.R,{readOnly:!0,value:o.body,sgidToObjectMap:o.sgids_to_object_map,inlineAttachments:o.inline_attachments,disabledExtensions:["cta"]})]})}),(0,m.Fr)(t)&&(0,c.jsx)(d.l,{className:"!py-2"})]})},g=n(86013),y=n(96486),_=n(63001),j=n(40518),x=n(30887),w=n(6038),O=n(87958),S=n(25067),P=function(e){var t=e.shouldOpenInNewTab,n=(0,l.wh)().isViewOnlyMasquerading,r=(0,_.r)().hide,o=(0,l.Zh)(),i=o.record,s=o.onLikeToggle,u=i.comments_count,d=i.is_comments_enabled,m=i.is_liked_by_current_user,f=i.is_liking_enabled,p=i.user_likes_count,v=i.post_details_loaded,h=(0,l.EU)();return d||f?(0,c.jsxs)("div",{className:a()("profile-posts__post__actions flex items-center",{"justify-between":f,"justify-end":!f}),children:[f&&(0,c.jsx)(O.T,{interactive:!1,content:m?(0,g.t)("profile_tabs.post.unlike_description"):(0,g.t)("profile_tabs.post.like_description"),placement:"bottom",disabled:!h||!v,children:(0,c.jsx)("button",{type:"button",onClick:n?y.noop:s,className:a()("profile-posts__post__like focus-visible:outline-secondary hover:bg-tertiary active:text-default flex space-x-1 rounded-md p-1 text-sm focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",{"text-default focus:text-default":!m,"liked text-brand focus:text-brand":m,disabled:!h||!v}),children:v?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(x.JO,{type:"like"}),(0,c.jsx)("span",{className:"profile-posts__post__like-count",children:(0,w.H)(p)})]}):(0,c.jsx)(S.gi,{variant:"row",lg:!0,short:!0})})}),d&&(0,c.jsx)(O.T,{interactive:!1,content:(0,g.t)("profile_tabs.post.comment_description"),placement:"bottom",disabled:!v,children:(0,c.jsxs)(j.s,{post:i,allComments:!0,className:"profile-posts__post__comments-count text-default focus-visible:outline-secondary focus-visible:text-dark hover:text-dark inline-block rounded-md p-1 text-sm focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",onClick:r,target:t&&"_blank",children:[v&&(0,g.t)("post.comments",{count:u,formatted_count:(0,w.H)(u)}),!v&&(0,c.jsx)(S.gi,{variant:"row",lg:!0,long:!0})]})})]}):null},C=n(49326),k=n(71710),I=n(95071),N=n(25401),A=function(e){var t=e.shouldOpenInNewTab,n=void 0!==t&&t,r=(0,_.r)().hide,o=(0,l.Zh)().record,i=function(e){return!(0,I.n2)(e)&&r()},a=o.name,s=o.created_at,u=o.space_name,d=o.space_slug;return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(k.H,{onClick:i,post:o,className:"!rounded-lg",wrapperClassName:"!p-0"}),(0,c.jsxs)("div",{className:"profile-posts__post__meta  w-full space-x-2",children:[(0,c.jsxs)("span",{className:"profile-posts__post__author text-default text-sm",children:[(0,g.t)("profile_tabs.post.posted_in")," ",(0,c.jsx)("a",{className:"focus-visible:outline-secondary focus-visible:text-dark text-dark hover:text-darkest font-medium focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",href:C.RZ.show({spaceSlug:d}),children:u})]}),(0,c.jsx)("span",{className:"bg-badge inline-block h-1 w-1 rounded-full align-middle"}),(0,c.jsx)(O.T,{interactive:!1,content:(0,m.s4)(s),children:(0,c.jsx)(j.s,{onClick:i,post:o,target:n?"_blank":"_self",className:"text-dark focus-visible:outline-secondary focus-visible:text-dark group inline-flex focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",children:(0,c.jsx)("span",{className:"profile-posts__post__time text-default group-hover:text-dark text-sm",children:(0,N.TF)(s,{format:N.lc.short})})})})]}),!!a&&(0,c.jsx)(j.s,{onClick:i,post:o,target:n?"_blank":"_self",className:"text-dark focus-visible:outline-secondary focus-visible:text-dark focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",children:(0,c.jsx)("div",{className:"profile-posts__post__title text-darkest break-all text-xl font-semibold leading-7",children:a})})]})};function E(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function T(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?E(Object(n),!0).forEach((function(t){D(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):E(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function D(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var R=function(e){var t=e.onPostChange,n=e.shouldOpenInNewTab,r=(0,l.Zh)().record;if(!r||!r.id)return null;var o=r.updated_at;return(0,c.jsxs)("div",{className:"profile-posts__post bg-primary flex flex-col space-y-3 p-5 md:px-6",children:[(0,c.jsx)(A,{}),(0,c.jsx)(b,{}),(0,c.jsx)(P,{onChange:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t(T(T({},r),e))},shouldOpenInNewTab:n})]},o)},L=["post"];function M(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function F(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function U(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function B(e){var t=e.post,n=U(e,L);return(0,c.jsx)(R,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?M(Object(n),!0).forEach((function(t){F(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):M(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({post:t},n))}var z=n(82275),H=n(11178),q=n(61345),Z=n(93619),V=n(20695),W=n(32224),Q=n(74238),$=n(39834),G=n(38870),J=function(e){var t=e.post,n=t.last_replied_or_posted,r=t.post_details_loaded,o="replied"===(null===n||void 0===n?void 0:n.type);return r?n?(0,c.jsxs)(j.s,{post:t,className:"!text-default focus-visible:outline-secondary focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",children:[o&&(0,c.jsx)(x.JO,{type:"arrow-solid-bottom-right",useWithFillCurrentColor:!0,className:"mr-1 !w-3.5",size:14}),(0,c.jsxs)(O.T,{interactive:!1,content:(0,m.s4)(n.created_at),className:"inline-flex items-center gap-1",children:[(0,c.jsx)("span",{className:"meta-person-action text-sm",children:"".concat(n.user_name," ").concat(n.type," ")}),(0,c.jsx)("span",{className:"ago post--card__timestamp text-sm",children:(0,N.TF)(n.created_at)})]})]}):null:(0,c.jsx)(S.gi,{variant:"row",lg:!0,almostFull:!0})},K=n(36189),Y=function(){return(0,c.jsx)(K.S,{type:"card"})};function X(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ee(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?X(Object(n),!0).forEach((function(t){te(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):X(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function te(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ne=function(e){var t=e.onPostChange,n=e.onPostDestroy,r=e.refetchPosts,o=(0,l.Zh)().record,i=(0,Q.TC)().isDarkAppearance;if(!o)return null;var s=o.flagged_for_approval_at,u=o.cardview_thumbnail_url,d=o.community_member,m=o.hide_meta_info,f=o.display_title,p=o.is_liking_enabled,v=o.is_comments_enabled,h=o.cover_image_url,b=p||v,_=a()("post--card post--parent border-primary bg-primary rounded-lg border relative",{"flagged-for-approval":s,"has-engagement pb-10":b}),x=u||h,w=(0,W.O)({public_uid:d.public_uid,params:{show_back_link:!0}});return(0,c.jsxs)("div",{className:_,children:[(0,c.jsxs)("div",{className:"post--card__post text-dark",children:[(0,c.jsx)(j.s,{post:o,className:"post--card__cover text-dark bg-primary focus-visible:outline-secondary focus-visible:text-dark block aspect-[2] rounded-t-lg bg-cover bg-center bg-no-repeat focus-visible:rounded-t-lg focus-visible:outline focus-visible:outline-2",style:function(){if(x)return{backgroundImage:"url(".concat(x,")")};var e=i?(0,V.aP)("dark-mode-cover-thumbnail-2x.png"):(0,V.aP)("light-mode-cover-thumbnail-2x.png");return{backgroundImage:"url(".concat(e,")")}}()}),!m&&(0,c.jsx)("div",{className:"post--card__user has-cover -mt-5 px-5",children:(0,c.jsx)("div",{className:"post__avatar",children:(0,c.jsx)("a",ee(ee({className:"user__avatar focus-visible:outline-secondary focus-visible:text-dark focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2"},w),{},{children:(0,c.jsx)(G.s,{src:d.avatar_url,name:d.name,size:"10"})}))})}),(0,c.jsx)("div",{className:a()("post--card__body p-5",{"post-meta--hidden":m}),children:(0,c.jsxs)("div",{className:"post--card__content",children:[(0,c.jsx)("div",{className:"post--card__header",children:(0,c.jsxs)("h2",{className:"space-x-2 break-words text-base font-semibold",children:[(0,c.jsx)(j.s,{post:o,className:"!text-darkest focus-visible:outline-secondary focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",children:(0,y.truncate)(f,{length:60})}),!!s&&(0,c.jsx)($.g,{className:"post--card__headline-tag !bg-author-in-review border-0 align-text-top uppercase text-white",label:(0,g.t)("in_review")})]})}),!m&&(0,c.jsx)("div",{className:"post--card__meta",children:(0,c.jsx)(J,{post:o})})]})})]}),(0,c.jsx)(Y,{}),(0,c.jsx)("div",{className:"post--card__actions-wrapper absolute right-4 top-4",children:(0,c.jsx)(Z.p,{onPostDestroy:n,refetchPosts:r,onChange:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t(ee(ee({},o),e),n)}})})]})};function re(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function oe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ie=function(e){return(0,c.jsx)(ne,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?re(Object(n),!0).forEach((function(t){oe(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):re(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e))},ae=n(26953),se=function(e){var t=e.post,n=t.last_replied_or_posted;return t.post_details_loaded?n?(0,c.jsxs)(j.s,{post:t,className:"!text-default focus-visible:outline-secondary inline-flex items-center gap-1 focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",children:["replied"===n.type&&(0,c.jsx)(x.JO,{useWithFillCurrentColor:!0,type:"arrow-solid-bottom-right",className:"text-default !w-3.5",size:14}),(0,c.jsxs)(O.T,{interactive:!1,content:(0,m.s4)(n.created_at),className:"inline-flex items-center gap-1",children:[(0,c.jsx)("span",{className:"meta-person-action text-xs",children:"".concat(n.user_name," ").concat(n.type," ")}),(0,c.jsx)("span",{className:"ago post--list__timestamp text-xs",children:(0,N.TF)(n.created_at)})]})]}):null:(0,c.jsx)(S.gi,{variant:"row",lg:!0,half:!0})};function le(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ce(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?le(Object(n),!0).forEach((function(t){ue(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):le(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ue(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var de=function(e){var t=e.onPostChange,n=e.onPostDestroy,r=e.refetchPosts,o=e.hideTitle,i=void 0!==o&&o,s=(0,l.Zh)().record,u=(0,ae.kK)(),d=s.flagged_for_approval_at,m=s.community_member,f=s.hide_meta_info,p=s.display_title,v=a()("post--list post--parent border-t border-primary px-5 py-3 md:py-4 bg-primary border-b-none first:md:rounded-t-lg last:md:rounded-b-lg last:border-b md:border-x",{"flagged-for-approval":d}),h=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t(ce(ce({},s),e),n)},b=(0,W.O)({public_uid:m.public_uid,params:{show_back_link:!0}});return u?(0,c.jsx)("div",{className:v,children:(0,c.jsx)("div",{className:"post--list__post text-dark flex gap-3",children:(0,c.jsxs)("div",{className:"post--list__body flex w-full flex-col gap-2",children:[(0,c.jsx)("div",{className:"post--list__content w-full gap-2 !pr-0 md:gap-0",children:!i&&(0,c.jsxs)("div",{className:a()("post--list__header flex w-full items-start justify-between",{"post-meta--hidden":f}),children:[(0,c.jsxs)("h2",{className:"mr-4 space-x-2 break-words text-base font-medium leading-5",children:[(0,c.jsx)(j.s,{post:s,className:"!text-dark focus-visible:outline-secondary focus-visible:text-dark focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",children:(0,y.truncate)(p,{length:110})}),!!d&&(0,c.jsx)($.g,{className:"post--list__headline-tag !bg-author-in-review w-full max-w-fit max-w-fit border-0 align-text-top uppercase text-white",label:(0,g.t)("in_review")})]}),(0,c.jsx)(Z.p,{onPostDestroy:n,refetchPosts:r,onChange:h})]})}),!f&&(0,c.jsxs)("div",{className:"flex items-start justify-start space-x-2",children:[(0,c.jsx)("div",{className:"post--list__user",children:(0,c.jsx)("a",ce(ce({},b),{},{className:"focus-visible:outline-secondary focus-visible:text-dark focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",children:(0,c.jsx)(G.s,{src:m.avatar_url,name:m.name,size:"6"})}))}),(0,c.jsxs)("div",{className:"post--list__meta flex w-full items-center justify-between",children:[(0,c.jsx)(se,{post:s}),(0,c.jsx)("div",{className:"post--list__actions-wrapper gap-2 self-start md:gap-0",children:(0,c.jsx)(K.S,{})})]})]})]})})}):(0,c.jsx)("div",{className:v,children:(0,c.jsxs)("div",{className:"post--list__post text-dark flex gap-3",children:[!f&&(0,c.jsx)("div",{className:"post--list__user",children:(0,c.jsx)("a",ce(ce({},b),{},{className:"focus-visible:outline-secondary focus-visible:text-dark focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",children:(0,c.jsx)(G.s,{src:m.avatar_url,name:m.name,size:"10"})}))}),(0,c.jsxs)("div",{className:"post--list__body flex w-full items-center justify-between",children:[(0,c.jsxs)("div",{className:a()("post--list__content flex flex-col",{"justify-center":f,"justify-start gap-1":!f}),children:[!i&&(0,c.jsx)("div",{className:a()("post--list__header",{"post-meta--hidden":f}),children:(0,c.jsxs)("h2",{className:"mr-4 flex space-x-2 break-words text-base font-medium leading-5",children:[(0,c.jsx)(j.s,{post:s,className:"!text-dark focus-visible:outline-secondary focus-visible:text-dark line-clamp-1 focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",children:p}),!!d&&(0,c.jsx)($.g,{className:"post--list__headline-tag !bg-author-in-review w-full max-w-fit max-w-fit shrink-0 border-0 align-text-top uppercase text-white",label:(0,g.t)("in_review")})]})}),!f&&(0,c.jsx)("div",{className:"post--list__meta inline-flex",children:(0,c.jsx)(se,{post:s})})]}),(0,c.jsxs)("div",{className:"post--list__actions-wrapper flex items-baseline gap-1",children:[(0,c.jsx)(K.S,{}),(0,c.jsx)(Z.p,{onPostDestroy:n,refetchPosts:r,onChange:h})]})]})]})})};function me(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function fe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var pe=function(e){return(0,c.jsx)(de,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?me(Object(n),!0).forEach((function(t){fe(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):me(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e))},ve=n(39103),he=["space","post","isFirst","forcePostView","forceSimplifiedView","forceIframeView","usedIn"];function be(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ge(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?be(Object(n),!0).forEach((function(t){ye(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):be(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ye(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _e(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var je=function(e){var t=e.space,n=void 0===t?{}:t,r=e.post,o=e.isFirst,i=void 0!==o&&o,a=e.forcePostView,s=void 0!==a&&a,d=e.forceSimplifiedView,m=void 0!==d&&d,f=e.forceIframeView,p=void 0!==f&&f,v=e.usedIn,h=_e(e,he),b=Boolean(r.pinned_at_top_of_space),g=(0,q.AU)(n),y=(0,q.G6)(n),_=ve.D;return(0,q.fq)(n)?_=ve.D:(0,q.wk)(n)?_=H.p:(0,q.HO)(n)?_=z.d:m?_=B:p?_=u:s||b&&i?_=ve.D:g?_=ie:y&&(_=pe),(0,c.jsx)(l.DW,{post:r,usedIn:v,children:(0,c.jsx)(_,ge({post:r},h))})}},95585:(e,t,n)=>{n.d(t,{o:()=>Bt});var r=n(67294),o=n(94184),i=n.n(o),a=n(86013),s=n(97012),l=n(86078),c=n(96486),u=n(71032),d=n(24185),m=n(87536),f=n(95172),p=n(78163),v=n(77616),h=n(48885),b=n(56868),g=n(55675),y=n(85893);function _(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function j(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_(Object(n),!0).forEach((function(t){x(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function x(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function w(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return O(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return O(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function O(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var S=function(e){var t=e.spaceId,n=e.postId,o=e.communityMemberForReply,l=e.autoFocus,u=e.editorRef,d=e.parentCommentId,_=e.isEdit,O=e.initialSgidToObjectMap,S=void 0===O?{}:O,P=e.placeholder,C=void 0===P?(0,a.t)("comments.form.fields.body_placeholder"):P,k=e.usedIn,I=(0,s.wh)().currentCommunityMember,N=w((0,r.useState)(S),2),A=N[0],E=N[1],T=w((0,r.useState)(!1),2),D=T[0],R=T[1],L=w((0,r.useState)(0),2),M=L[0],F=L[1],U=(0,m.Gc)(),B=U.watch,z=U.reset,H=U.formState,q=H.isSubmitting,Z=H.isSubmitSuccessful,V=B("tiptap_body"),W=!(0,p.NU)(V)||q,Q=D&&!W;(0,f.y1)("cmd+enter, ctrl+enter",(function(){"triggerFormSubmit"in U&&U.triggerFormSubmit()}),{enableOnContentEditable:!0,enabled:Q},[U,Q]),(0,r.useEffect)((function(){Z&&(z(),F((function(e){return e+1})))}),[Z,z]),(0,r.useEffect)((function(){o&&o.id!==(null===I||void 0===I?void 0:I.id)&&(E(j(j({},A),{},x({},o.rich_text_field_sgid,o))),(0,c.defer)((function(){var e,t;null===u||void 0===u||null===(e=u.current)||void 0===e||null===(t=e.chain)||void 0===t||t.call(e).focus("start").insertContent([(0,h.F_)({sgid:o.rich_text_field_sgid}),(0,h.$U)({text:" "})]).run()})))}),[o,I,u]),(0,r.useEffect)((function(){(0,c.defer)((function(){var e,t,n;l&&(null===u||void 0===u||null===(e=u.current)||void 0===e||null===(t=e.commands)||void 0===t||null===(n=t.focus)||void 0===n||n.call(t,"end"))}))}),[]);var $=["post",n,_?"edit":"create",d,"comment-form-toolbar",k].filter(Boolean).join("-");return(0,y.jsxs)("div",{className:i()("border-primary focus-within:border-light active:border-light space-y-3 rounded-lg border px-4 py-3 transition-colors",{"pointer-events-none opacity-50":q}),children:[(0,y.jsx)(v.$,{editorRef:u,placeholder:C,name:"tiptap_body.body",onFocusChange:R,toolbars:[{portalId:$,component:b.o}],className:"h-full max-h-[400px] overflow-y-auto",editorClassName:"h-full",spaceId:t,sgidToObjectMap:A,disabledExtensions:["poll","ai_copilot","cta"]}),(0,y.jsxs)("div",{className:"flex items-end justify-between",children:[(0,y.jsx)("div",{id:$}),(0,y.jsx)(g.z,{variant:"primary",type:"submit",disabled:W,className:"!px-4",children:_?q?(0,a.t)("comments.create.actions.saving"):(0,a.t)("comments.create.actions.save"):q?(0,a.t)("comments.create.actions.submitting"):(0,a.t)("comments.create.actions.submit")})]})]},M)},P=n(38870),C=n(61926),k=n(88767),I=n(34128),N=n(49326),A=n(21809);function E(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function T(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?E(Object(n),!0).forEach((function(t){D(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):E(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function D(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var R=function(e){var t=e.spaceId,n=e.postId,r=e.parentCommentId,o=e.communityMemberForReply,l=e.autoFocus,c=void 0!==l&&l,u=e.onCreate,d=e.bodyInputRef,m=(0,s.N3)(),f=(0,s.Zh)(),p=f.usedIn,v=f.isUsedInMinimalTipTapViewModal,h="full-post-modal"!==p,b=o?(0,a.t)("comments.form.fields.body_reply_placeholder",{name:o.name}):(0,a.t)("comments.form.fields.body_placeholder"),g=function(e){var t=e.postId,n=e.parentCommentId,r=e.onCreate,o=(0,A.p)().error;return{createComment:(0,k.useMutation)((function(e){return(0,I.Cu)(N.av.comments.create({postId:t}),{comment:T({parent_comment_id:n},e)})}),{onSuccess:r,onError:function(){return o((0,a.t)("comments.create.alerts.failure"))}}).mutateAsync}}({postId:n,parentCommentId:r,onCreate:u}),_=g.createComment;return(0,y.jsxs)("div",{className:i()("post__reply flex items-start gap-3 py-2.5 md:py-5",{"bg-primary absolute bottom-0 left-0 w-full !px-5 !py-4 md:!px-8":v&&!r,"md:px-6":"minimal-post-modal"!==p,"reply-to-parent -ml-8 py-2.5 md:ml-0":r&&"full-post-modal"!==p,"reply-to-parent -ml-8 md:ml-[-3.125rem]":r&&"full-post-modal"===p,"reply-to-post px-5":!r}),children:[h&&(0,y.jsx)(P.s,{src:m.avatar_url,name:m.name,size:"10"}),(0,y.jsx)(C.l,{className:"relative w-full",onSubmit:function(e){return _(e)},children:(0,y.jsx)(S,{spaceId:t,postId:n,placeholder:b,communityMemberForReply:o,autoFocus:c,editorRef:d,isEdit:!1,parentCommentId:r,usedIn:p})})]})},L=n(86747),M=function(){var e=(0,d.TH)().hash.split(L.q)[1];return{commentId:e&&parseInt(e,10)||null}};function F(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return U(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return U(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function U(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var B=function(e){var t=e.enabled,n=void 0===t||t,o=F((0,r.useState)(!1),2),i=o[0],a=o[1],s=M().commentId;(0,r.useEffect)((function(){if(n&&s&&!i){var e=setTimeout((function(){a(!0);var e=document.querySelector("".concat(L.q).concat(s));e&&e.scrollIntoView()}),500);return function(){return clearTimeout(e)}}}),[n,s,i])},z=n(64209),H=function(e){var t=e.space,n=e.post,o=e.parentCommentId,c=e.preloaded,u=void 0!==c&&c,m=e.preloadedComments,f=void 0===m?[]:m,p=e.preloadedCommentsTotalCount,v=void 0===p?0:p,h=e.showReplyForm,b=void 0!==h&&h,g=e.autofocusReplyForm,_=void 0!==g&&g,j=e.communityMemberForReply,x=e.onCommentReplyClick,w=e.onCommentCreate,O=e.onCommentDelete,S=e.formRef,P=(0,s.N3)(),C=(0,s.Zh)(),k=C.usedIn,I=C.isUsedInMinimalTipTapViewModal,N=(0,d.TH)().state,A=null===N||void 0===N?void 0:N.shouldFocusOnCommentsSection,E=(0,z.wS)({postId:n.id,parentCommentId:o,preloaded:u,preloadedComments:f,preloadedCommentsTotalCount:v,postCommentsClosed:n.is_comments_closed,postLikingDisabled:n.is_liking_disabled,usedIn:k}),T=E.comments,D=E.isLoading,L=E.isFetchingNextPage,M=E.hasNextPage,F=E.fetchNextPage,U=E.addCommentToList,H=E.updateCommentInList,q=E.removeCommentFromList;B({enabled:!D&&!o});var Z=function(e){q(e),O(e)},V=D||L;(0,r.useEffect)((function(){if(!V&&A){var e=document.getElementById("all_comments");null===e||void 0===e||e.scrollIntoView({behavior:"smooth"})}}),[V,A]);var W=P&&t&&b&&(!V||T.length>0);return(0,y.jsxs)("div",{className:i()({"my-3":!W&&!o}),children:[T.map((function(e){return(0,y.jsx)(jt,{space:t,post:n,comment:e,autofocusReplyForm:!0,onReplyClick:x,onUpdate:H,onDelete:Z,onReplyCreate:w,onReplyDelete:O},e.id)})),V&&(0,y.jsx)(l.m,{}),!V&&M&&(0,y.jsx)("div",{className:i()("load-more",{"py-5 text-center":!o,"mb-4 mt-2 pl-5 text-left text-sm font-medium md:pl-6":o}),children:(0,y.jsx)("button",{type:"button",onClick:function(e){e.preventDefault(),F()},className:i()("focus-visible:outline-secondary focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",{"load-more__replies text-brand":o,"load-more__comments border-hover bg-primary text-dark hover:text-darkest focus-visible:text-darkest inline-block rounded-md border px-6 py-2 text-sm font-semibold leading-normal transition-colors duration-150":!o}),children:(0,a.t)(o?"comments.list.show_more_replies":"comments.list.show_more_comments")})}),V&&I&&(0,y.jsx)("div",{className:"bg-primary absolute bottom-0 left-0 w-full !px-5 !py-4 md:!px-8",children:(0,y.jsxs)("div",{className:"flex gap-4",children:[(0,y.jsx)("div",{className:"bg-tertiary h-10 w-10 animate-pulse rounded-md"}),(0,y.jsx)("div",{className:"border-primary h-18 w-full rounded-lg border p-px"})]})}),W&&(0,y.jsx)(R,{post:n,spaceId:t.id,spaceIsPrivate:t.is_private,postId:n.id,parentCommentId:o,communityMemberForReply:j,autoFocus:_,onCreate:function(e){U(e),w(e);var t=document.getElementById("comment_wrapper_".concat(e.id));I&&t&&t.scrollIntoView({behavior:"smooth",block:"center"})},bodyInputRef:S})]})},q=n(84702),Z=n(37903),V=n(20633),W=n(1002);function Q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function $(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Q(Object(n),!0).forEach((function(t){G(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Q(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function G(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var J=function(e){var t=e.comment,n=e.canReport,r=e.canReview,o=e.canEdit,s=e.canDestroy,l=e.canBookmark,c=e.isReply,u=e.onReportClick,d=e.onEditClick,m=e.onDeleteClick,f=e.onUpdate,p=(0,q.I)(),v=[];return n&&v.push({key:"report",label:(0,a.t)("comments.action_menu.report.label"),href:"#",onClick:function(){u()}}),r&&v.push($({key:"review",label:(0,a.t)("comments.action_menu.review.label"),to:N.sC.index()},p?{target:"_blank",rel:"noreferrer"}:{})),o&&v.push({key:"edit",label:(0,a.t)("comments.action_menu.edit.label"),onClick:function(){d()}}),s&&v.push({key:"delete",label:(0,a.t)("comments.action_menu.delete.label"),hasDanger:!0,onClick:function(){m()}}),0!==v.length||l?(0,y.jsx)("div",{className:i()("post__actions--comment ml-2 md:ml-4",{"post__actions--reply":c}),"data-testid":"post-comment-actions",children:(0,y.jsxs)(W.Lt,{menuButtonEl:"div",button:(0,y.jsx)(V.h,{name:"20-menu-dots-horizontal",iconClassName:"!text-default group-hover:!text-dark !w-5 !h-5",className:"group",variant:"secondary",iconSize:20,buttonSize:28,dataTestId:"action-more",ariaLabel:(0,a.t)("comments.actions")}),children:[(0,y.jsx)(Z.e,{variant:"dropdown",bookmarkType:"comment",record:t,onSuccess:function(e){var n=$($({},t),{},{bookmark_id:e});f(n)}}),v.map((function(e){return(0,y.jsx)(W.Lt.ItemWithLink,$($({},e),{},{children:e.label}),e.key)}))]})}):null},K=n(71542),Y=n(29458),X=n(44130),ee=function(e){var t=e.comment,n=t.body_trix_content,r=t.editor,o=t.tiptap_body,i=t.updated_at,a="tiptap"===r;return(0,y.jsx)("div",{className:"post__body text-base","data-testid":"comment-body",children:(0,y.jsx)("div",{className:"post__inside text-dark","data-testid":"comment-body-inside",children:(0,y.jsx)(X.X,{lines:8,children:a?(0,y.jsx)(K.G,{tiptapBody:o}):(0,y.jsx)(Y.P,{content:n})})},i)})},te=n(42241),ne=n(54754),re=function(e){var t,n,r=e.comment,o=e.updateComment,i="post"===(null===r||void 0===r||null===(t=r.tiptap_body)||void 0===t?void 0:t.format);return(0,y.jsx)("div",{className:"text-dark mb-1 whitespace-pre-line text-sm font-normal",children:i?(0,y.jsx)(te.l,{onSubmit:o,defaultValues:{tiptap_body:r.tiptap_body},children:(0,y.jsx)(S,{isEdit:!0,postId:r.post_id,spaceId:r.space_id,autoFocus:!0,initialSgidToObjectMap:null===r||void 0===r||null===(n=r.tiptap_body)||void 0===n?void 0:n.sgids_to_object_map})}):(0,y.jsx)(ne.T,{autofocus:!0,editable:!0,type:"comment",hardBreakOnEnter:!0,submitOnEnter:!1,submitOnModEnter:!0,rich_text_body:r.tiptap_body,onSubmit:function(e){var t=e.body,n=e.attachments;return o({tiptap_body:{body:t,attachments:n}})},isUpdate:!0,placeholder:(0,a.t)("write_a_comment"),menubarProps:{submitButtonLabel:(0,a.t)("comments.create.actions.save"),submittingLabel:(0,a.t)("comments.create.actions.saving")}})})},oe=n(72675),ie=n(53448),ae=function(e){var t=e.comment,n=e.updateComment,r=(0,oe.dd)();return(0,f.y1)("esc",(function(){return r.remove()}),{enableOnContentEditable:!0},[]),(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(ie.u_.Overlay,{}),(0,y.jsxs)(ie.u_.Content,{size:"lg",className:"!overflow-visible",children:[(0,y.jsxs)(ie.u_.Header,{children:[(0,y.jsx)(ie.u_.Title,{size:"sm",children:(0,a.t)("comments.edit.form.title")}),(0,y.jsx)(ie.u_.HeaderActions,{children:(0,y.jsx)(ie.u_.CloseButton,{onClick:r.remove})})]}),(0,y.jsx)(ie.u_.Body,{className:"!overflow-y-visible pb-6",children:(0,y.jsx)(re,{comment:t,updateComment:n})})]})]})},se=n(99834),le=n(61989),ce=function(e){var t=e.spaceId,n=e.spaceIsPrivate,r=e.onClose,o=(0,m.Gc)(),i=o.watch,s=o.formState,l=s.isDirty,c=s.isSubmitting,u=s.isSubmitSuccessful,d=c||u,f=!!i().body&&!d;(0,se.M)({enabled:f});var p=function(){l&&!confirm((0,a.t)("prevent_accidental_leave_message"))||r()};return(0,y.jsxs)(ie.u_.Content,{size:"lg",wrapperClassName:"!h-full",className:"!transform-none !overflow-visible",children:[(0,y.jsxs)(ie.u_.Header,{children:[(0,y.jsx)(ie.u_.Title,{children:(0,a.t)("comments.edit.form.title")}),(0,y.jsx)(ie.u_.HeaderActions,{children:(0,y.jsx)(ie.u_.CloseButton,{onClick:p})})]}),(0,y.jsx)(ie.u_.Body,{className:"comment__edit-modal-content-body trix-v2 max-h-[calc(100dvh-82px-65px)] !overflow-visible md:max-h-none",children:(0,y.jsx)(le.O,{id:"comment-edit-body",name:"body",placeholder:(0,a.t)("comments.form.fields.body_placeholder"),className:"h-full",editorContainerClassName:"flex flex-col h-full",textboxClassName:"overflow-auto rounded-md py-4 sm:max-h-[40vh]",space_id:t,is_private_space:n})}),(0,y.jsxs)(ie.u_.Footer,{className:"bottom-0 flex justify-end space-x-4",children:[(0,y.jsx)(g.z,{type:"button",variant:"secondary",onClick:p,children:(0,a.t)("cancel")}),(0,y.jsx)(g.z,{type:"submit",variant:"primary",disabled:!f,children:d?(0,a.t)("saving_changes"):(0,a.t)("save_changes")})]})]})},ue=function(e){var t=e.space,n=e.comment,r=e.onUpdate,o=t.id,i=t.is_private,s=(0,oe.dd)(),l="tiptap"===n.editor,u=function(e){var t=e.comment,n=e.onUpdate,r=t.id,o=t.post_id,i=t.body_for_editor,s=(0,A.p)(),l=s.success,c=s.error;return{defaultValues:{body:i},updateComment:(0,k.useMutation)((function(e){return(0,I.gN)(N.av.comments.update({postId:o,id:r}),{comment:e})}),{onSuccess:function(e){n(e),l((0,a.t)("comments.edit.alerts.success"))},onError:function(){return c((0,a.t)("comments.edit.alerts.failure"))}}).mutateAsync}}({comment:n,onUpdate:function(e){r(e),s.hide()}}),d=u.defaultValues,m=u.updateComment;return(0,y.jsx)(ie.u_,{title:(0,a.t)("comments.edit.form.title"),isOpen:s.visible,onClose:c.noop,children:l?(0,y.jsx)(ae,{comment:n,updateComment:m}):(0,y.jsxs)(C.l,{defaultValues:d,onSubmit:m,className:"h-full",formClassName:"h-full",children:[(0,y.jsx)(ie.u_.Overlay,{}),(0,y.jsx)(ce,{spaceId:o,spaceIsPrivate:i,onClose:s.hide})]})})},de=oe.gk.create((function(e){var t=e.space,n=e.comment,r=e.onUpdate;return(0,y.jsx)(ue,{space:t,comment:n,onUpdate:r})})),me=["label","onClick","disabled","isLiked","className"];function fe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function pe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fe(Object(n),!0).forEach((function(t){ve(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ve(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function he(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var be=function(e){var t=e.label,n=e.onClick,r=e.disabled,o=void 0!==r&&r,a=e.isLiked,s=void 0!==a&&a,l=e.className,c=he(e,me);return(0,y.jsx)("button",pe(pe({type:"button",className:i()("focus-visible:outline-secondary focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",l),onClick:function(e){e.preventDefault(),o||n()},"aria-disabled":o},c),{},{children:(0,y.jsx)("span",{"aria-checked":s,className:i()("hover:text-dark text-sm",{"text-brand font-semibold":s,"text-default font-medium":!s}),children:t})}))},ge=n(6038),ye=function(e){var t=e.likesCount,n=e.onClick;return(0,y.jsx)("button",{type:"submit",className:"text-default hover:text-dark group ml-auto mr-0 text-sm font-medium","data-testid":"like-count",onClick:n,children:(0,y.jsx)("span",{className:"group-focus-visible:outline-secondary group-focus-visible:rounded-sm group-focus-visible:outline group-focus-visible:outline-2 group-focus-visible:outline-offset-2",children:(0,a.t)("comments.likes",{count:t,formatted_count:(0,ge.H)(t)})})})},_e=function(e){var t=e.canLike,n=e.canReply,r=e.canSeeLikes,o=e.isLiked,l=e.isLikeDisabled,c=e.likesCount,u=e.onLikeClick,d=e.onLikesCountClick,m=e.onReplyClick,f=(0,s.wh)().currentUser,p=r&&c>0&&(f||t&&n);return(0,y.jsxs)("div",{className:"post__actions post__actions-visible mt-1 flex pl-[3.25rem]",children:[t&&(0,y.jsx)(be,{className:i()("post__actions--like mr-2",{liked:o}),label:(0,a.t)("comments.engagement_actions.".concat(o?"liked":"like")),onClick:u,disabled:l,isLiked:o}),n&&(0,y.jsx)(be,{className:"post__actions--reply",label:(0,a.t)("comments.engagement_actions.reply"),onClick:m}),p&&(0,y.jsx)(ye,{likesCount:c,onClick:d})]})},je=n(58533),xe=n(5295),we=n(16743),Oe=n(32224),Se=["onClick"];function Pe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ce(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Pe(Object(n),!0).forEach((function(t){ke(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Pe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ke(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ie(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var Ne=function(e){var t,n,r=e.communityMember,o=e.hideModal,i=(0,Oe.O)({public_uid:null!==(t=r.public_uid)&&void 0!==t?t:""}),a=i.onClick,s=Ie(i,Se);return(0,y.jsxs)("button",Ce(Ce({type:"button",className:"flex w-full items-center gap-3 text-left",onClick:function(e){o(),null===a||void 0===a||a(e)}},s),{},{children:[(0,y.jsx)("div",{className:"mt-0",children:(0,y.jsx)(P.s,{name:null!==(n=r.name)&&void 0!==n?n:"",src:r.avatar_url,size:"10"})}),(0,y.jsx)(we.Z.LabelSm,{weight:"medium",children:r.name})]}))},Ae=n(85564),Ee=n.n(Ae),Te=n(10928),De=n.n(Te),Re=n(45578),Le=n.n(Re),Me=n(13521),Fe=function(e){var t=e.id,n=e.placeholderLikesCount,r=(0,oe.dd)(),o=function(e){var t=e.id,n=e.isQueryEnabled,r=e.placeholderLikesCount,o=(0,Me.m)(N.av.comments.userLikes({id:t,params:{per_page:15}}),{enabled:n}),i=o.data,a=o.isLoading,s=o.hasNextPage,l=o.fetchNextPage,c=o.mapPages;return{likedByMembers:Le()(Ee()(c((function(e){return e.records}))),"id"),totalLikesCount:i?De()(i.pages).count:r,isLoading:a,hasNextPage:s,fetchNextPage:l}}({id:t,isQueryEnabled:r.visible,placeholderLikesCount:n}),i=o.likedByMembers,s=o.totalLikesCount,c=o.isLoading,u=o.hasNextPage,d=o.fetchNextPage;return(0,y.jsxs)(ie.u_,{title:(0,a.t)("comments.likes",{count:s}),isOpen:r.visible,onClose:r.hide,children:[(0,y.jsx)(ie.u_.Overlay,{}),(0,y.jsxs)(ie.u_.Content,{children:[(0,y.jsxs)(ie.u_.Header,{children:[(0,y.jsx)(ie.u_.Title,{size:"sm",children:(0,y.jsx)(we.Z.LabelLg,{weight:"semibold",children:(0,a.t)("comments.likes",{count:s,formatted_count:(0,ge.H)(s)})})}),(0,y.jsx)(ie.u_.HeaderActions,{children:(0,y.jsx)(ie.u_.CloseButton,{onClick:r.hide})})]}),(0,y.jsx)(ie.u_.Body,{className:"pb-6 pt-4",children:c?(0,y.jsx)(l.m,{}):(0,y.jsx)("div",{id:"comment-likes-modal-".concat(t),className:"max-h-[calc(100dvh-62px-44px-24px)] overflow-auto sm:max-h-80",children:(0,y.jsx)(je.Z,{scrollThreshold:.75,next:d,hasMore:u||!1,loader:(0,y.jsx)(xe.a,{}),scrollableTarget:"comment-likes-modal-".concat(t),dataLength:i.length,className:"flex flex-col space-y-4",children:i.map((function(e){return(0,y.jsx)(Ne,{communityMember:e,hideModal:r.hide},e.id)}))})})})]})]})};Fe.displayName="LikesModalComponent";var Ue=oe.gk.create((function(e){var t=e.id,n=e.placeholderLikesCount;return(0,y.jsx)(Fe,{id:t,placeholderLikesCount:n})}));Ue.displayName="LikesModal";function Be(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ze(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Be(Object(n),!0).forEach((function(t){He(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Be(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function He(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var qe=function(e){var t,n,r,o=e.comment.community_member,i=(0,Oe.O)({public_uid:null!==(t=o.public_uid)&&void 0!==t?t:"",params:{show_back_link:!0}});return(0,y.jsx)("div",{className:"post__user flex items-start",children:(0,y.jsx)("div",{className:"post__avatar mr-3",children:(0,y.jsx)("a",ze(ze({className:"user__avatar focus-visible:outline-secondary focus-visible:text-dark block h-10 w-10 focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2"},i),{},{children:(0,y.jsx)(P.s,{src:null!==(n=o.avatar_url)&&void 0!==n?n:"",name:null!==(r=o.name)&&void 0!==r?r:"",size:"10"})}))})})},Ze=n(31889),Ve=n(25401),We=n(68375),Qe=n(26953),$e=n(87958),Ge=n(39834),Je=n(65289);function Ke(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ye(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ke(Object(n),!0).forEach((function(t){Xe(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ke(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Xe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var et=function(e){var t=e.comment,n=e.commentLinkProps,r=t.community_member,o=t.created_at,l=(0,Qe.kK)(),u="full-post-modal"===(0,s.Zh)().usedIn,d=l||u?(0,c.truncate)(r.headline,{length:60}):r.headline;return d||l||u?(0,y.jsx)("div",{className:"post__meta flex w-full",children:(0,y.jsx)($e.T,{content:r.headline,shouldUseSpanWrapper:!1,interactive:!1,disabled:!d,children:(0,y.jsx)("button",{type:"button",className:"author__credentials text-default focus-visible:outline-secondary focus-visible:text-dark mt-1 w-full w-full text-left text-xs leading-4 focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",children:(0,y.jsxs)("span",{children:[d&&(0,y.jsx)("span",{className:i()("overflow-anywhere mr-2",{"md:line-clamp-1":!u}),children:d}),(l||u)&&!!d&&(0,y.jsx)("span",{className:"bg-badge mr-2 inline-block h-[0.15rem] w-[0.15rem] rounded-full align-middle"}),(l||u)&&(0,y.jsx)("a",Ye(Ye({className:i()("text-default hover:text-dark text-xs leading-5","focus-visible:outline-secondary focus-visible:text-dark mr-2 focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2")},n),{},{children:(0,y.jsx)($e.T,{content:(0,We.s4)(o),className:"inline-flex",interactive:!1,children:(0,Ve.TF)(o,{format:Ve.lc.short})})})),(l||u)&&t.flagged_for_approval_at&&(0,y.jsx)(Ge.g,{className:"authour__in-review !bg-author-in-review border-0 uppercase text-white",label:(0,a.t)("comments.in_review")})]})})})}):null};function tt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function nt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?tt(Object(n),!0).forEach((function(t){rt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):tt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function rt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ot=function(e){var t,n=e.post,r=e.comment,o=r.id,l=r.community_member,c=r.member_tags,u=r.flagged_for_approval_at,d=r.created_at,m=r.parent_comment_id,f=(0,s.wh)().currentCommunityMember,p="full-post-modal"===(0,s.Zh)().usedIn,v=Boolean(l.admin),h=null===c||void 0===c?void 0:c.filter((function(e){var t;return(null===e||void 0===e?void 0:e.is_public)&&(null===e||void 0===e||null===(t=e.display_locations)||void 0===t?void 0:t.post_bio)})),b=(0,q.I)(),g=(0,Ze.vb)(f),_=(null===h||void 0===h?void 0:h.length)>0||v,j=(0,Qe.kK)(),x=j?g:_,w=(0,Oe.O)({public_uid:null!==(t=l.public_uid)&&void 0!==t?t:"",params:{show_back_link:!0}}),O=nt({href:(0,N.LM)({spaceSlug:n.space_slug,slug:n.slug,hash:"".concat(L.q).concat(o)})},b?{target:"_blank",rel:"noreferrer"}:{}),S=j||p||!!m;return(0,y.jsxs)("div",{className:"post__bio mb-1.5 w-full",children:[(0,y.jsxs)("div",{className:i()("author text-darkest flex flex-wrap items-center gap-x-2",{"no-headline":!l.headline}),children:[(0,y.jsx)("div",{className:"author__name flex",children:(0,y.jsx)("a",nt(nt({className:"text-dark hover:text-darkest focus-visible:outline-secondary focus-visible:text-dark overflow-anywhere text-sm font-semibold focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2"},w),{},{children:l.name}))}),_&&x&&(0,y.jsx)("div",{className:"author__tags member-tags",children:(0,y.jsx)(Je.m,{memberTags:h,isAdmin:v,limit:S?1:2,showMoreLabelVariant:"numbers"})}),!j&&!p&&(0,y.jsx)("div",{className:"author__time flex",children:(0,y.jsx)("a",nt(nt({className:i()("text-default hover:text-dark text-xs","focus-visible:outline-secondary focus-visible:text-dark focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2")},O),{},{children:(0,y.jsx)($e.T,{content:(0,We.s4)(d),className:"inline-flex",interactive:!1,children:(0,Ve.TF)(d,{format:Ve.lc.short})})}))}),!j&&!p&&u&&(0,y.jsx)(Ge.g,{className:"authour__in-review !bg-author-in-review border-0 uppercase text-white",label:(0,a.t)("comments.in_review")})]}),(0,y.jsx)(et,{comment:r,commentLinkProps:O})]})},it=n(78270),at=["harassment","spam","incorrect_location","against_guidelines","other"],st=function(e){var t=e.show,n=e.onClose,r=e.onReportSubmit,o=(0,s.Zh)().usedIn,i=at.map((function(e){return{value:e,label:(0,a.t)("flagged_contents.report_reasons.".concat(e))}}));return(0,y.jsx)(it.u,{show:t,onClose:n,title:(0,a.t)("comments.report.form.title"),containerClassName:"full-post-modal"===o&&"!z-[1061]",children:(0,y.jsxs)(C.l,{onSubmit:r,children:[(0,y.jsx)(C.l.Item,{name:"reported_reason_type",label:(0,a.t)("flagged_contents.form.reported_reason_type"),description:(0,a.t)("flagged_contents.form.reported_reason_type_description"),hideBorder:!0,children:(0,y.jsx)(C.l.SelectNative,{options:i})}),(0,y.jsx)(C.l.Item,{name:"reported_reason_body",label:(0,a.t)("flagged_contents.form.reported_reason_body"),description:(0,a.t)("flagged_contents.form.reported_reason_body_description"),hideBorder:!0,fullWidth:!0,children:(0,y.jsx)(C.l.TextArea,{})}),(0,y.jsx)(g.z,{type:"submit",variant:"primary",formButton:!0,children:(0,a.t)("report")})]})})};function lt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return ct(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ct(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ct(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ut=n(1320);function dt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return mt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return mt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function mt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ft="Comment";function pt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return vt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return vt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function vt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ht(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function bt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ht(Object(n),!0).forEach((function(t){gt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ht(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function gt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function yt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return _t(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _t(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var jt=function(e){var t=e.space,n=e.post,o=e.comment,l=e.showReplyForm,d=void 0!==l&&l,m=e.autofocusReplyForm,f=void 0!==m&&m,p=e.onReplyClick,v=e.onUpdate,h=e.onDelete,b=e.onReplyCreate,g=e.onReplyDelete,_=(0,s.wh)().isViewOnlyMasquerading,j=(0,s.Zh)().isUsedInMinimalTipTapViewModal,x=o.id,w=o.parent_comment_id,O=o.community_member,S=o.replies,P=o.replies_count,C=o.flagged_for_approval_at,E=o.policies,T=!!C,D=!!w,R=E.can_report&&!T,L=E.can_manage&&T,M=E.can_edit,F=E.can_destroy,U=E.can_bookmark,B=(0,r.useRef)(),z=function(e){var t=e.comment,n=e.showReplyForm,o=e.replyFormRef,i=t.is_replying_enabled,l=(0,s.xJ)(),c=(0,s.EU)(),u=(0,q.I)(),d=pt((0,r.useState)(n),2),m=d[0],f=d[1],p=pt((0,r.useState)(null),2),v=p[0],h=p[1];return{openReplyForm:function(e){var t=e.communityMember;if(l){var n,r;h(t),f(!0),o.current&&(null===(n=o.current.commands)||void 0===n||null===(r=n.focus)||void 0===r||r.call(n,"end"))}else{var i=(0,N.j)({params:{notice:(0,a.t)("comments.log_in_to_add_a_comment"),post_login_redirect:window.location.href}});u?window.open(i,"_blank","noreferrer"):window.location.href=i}},shouldShowReplyForm:m,communityMemberForReply:v,canReply:i&&c}}({comment:o,showReplyForm:d,replyFormRef:B}),Z=z.openReplyForm,V=z.shouldShowReplyForm,W=z.communityMemberForReply,Q=z.canReply,$=function(e){var t=e.comment,n=t.id,o=t.is_liking_enabled,i=t.is_liked,l=t.likes_count,c=(0,s.xJ)(),u=(0,s.EU)(),d=(0,q.I)(),m=dt((0,r.useState)(i),2),f=m[0],p=m[1],v=dt((0,r.useState)(l),2),h=v[0],b=v[1],g=(0,k.useMutation)((function(){return ut.Qd.create({userLikeableId:n,userLikableType:ft,forReactQuery:!0})})),y=g.mutate,_=g.isLoading,j=(0,k.useMutation)((function(){return ut.Qd.destroy({userLikeableId:n,userLikableType:ft,forReactQuery:!0})})),x=j.mutate,w=j.isLoading;return{toggleLike:function(){if(c)_||w||(f?(p(!1),b((function(e){return e-1})),x()):(p(!0),b((function(e){return e+1})),y()));else{var e=(0,N.j)({params:{notice:(0,a.t)("comments.log_in_to_like_comments"),post_login_redirect:window.location.href}});d?window.open(e,"_blank","noreferrer"):window.location.href=e}},isLiked:f,likesCount:h,canLike:o&&u,canSeeLikes:o,isLoading:_||w}}({comment:o}),G=$.toggleLike,K=$.isLiked,Y=$.likesCount,X=$.canLike,te=$.canSeeLikes,ne=$.isLoading,re=(0,oe.dd)(Ue),ie=(0,oe.dd)(de),ae=function(e){var t=e.comment.id,n=(0,A.p)(),o=n.success,i=n.error,s=yt((0,r.useState)(!1),2),l=s[0],c=s[1],u=function(){return c(!1)},d=(0,k.useMutation)((function(e){return(0,I.Cu)(N.av.flaggedContent.create(),{flagged_content:bt(bt({},e),{},{flagged_contentable_id:t,flagged_contentable_type:"Comment"})})}),{onSuccess:function(){o((0,a.t)("comments.report.alerts.success"),{duration:"short",shouldUseProgress:!1}),u()},onError:function(){i((0,a.t)("comments.report.alerts.failure"))}}).mutate;return{isReportModalOpen:l,openReportModal:function(){return c(!0)},closeReportModal:u,submitReport:d}}({comment:o}),se=ae.isReportModalOpen,le=ae.openReportModal,ce=ae.closeReportModal,ue=ae.submitReport,me=function(e){var t=e.comment,n=e.onDelete,o=t.id,i=t.post_id,s=(0,A.p)(),l=s.success,c=s.error,u=lt((0,r.useState)(!1),2),d=u[0],m=u[1],f=function(){return m(!1)},p=(0,k.useMutation)((function(){return(0,I.pC)(N.av.comments.destroy({postId:i,id:o}))}),{onSuccess:function(){l((0,a.t)("comments.delete.alerts.success"),{duration:"short",shouldUseProgress:!1}),f(),n({id:o})},onError:function(){c((0,a.t)("comments.delete.alerts.failure")),f()}}),v=p.mutate,h=p.isLoading;return{isDeleteConfirmModalOpen:d,openDeleteConfirmModal:function(){return m(!0)},closeDeleteConfirmModal:f,deleteComment:v,isDeletingComment:h}}({comment:o,onDelete:h}),fe=me.isDeleteConfirmModalOpen,pe=me.openDeleteConfirmModal,ve=me.closeDeleteConfirmModal,he=me.deleteComment,be=me.isDeletingComment,ge=p||Z;return(0,y.jsxs)("div",{className:i()("post--comment text-dark md:px-0",{"px-5":!D&&!j,"pl-5":D&&!j}),id:"comment_wrapper_".concat(x),children:[(0,y.jsxs)("div",{className:i()("post__content py-2.5",{"md:px-6":!j}),children:[(0,y.jsxs)("div",{className:"flex w-full justify-between",children:[(0,y.jsxs)("div",{className:"flex w-full pt-1",children:[(0,y.jsx)(qe,{comment:o}),(0,y.jsxs)("div",{className:"flex w-full flex-col",children:[(0,y.jsx)(ot,{post:n,comment:o}),(0,y.jsx)(ee,{comment:o})]})]}),(0,y.jsx)(J,{comment:o,canReport:R,canReview:L,canEdit:M,canDestroy:F,canBookmark:U,isReply:D,onReportClick:_?c.noop:le,onEditClick:_?c.noop:function(){return ie.show({space:t,comment:o,onUpdate:v})},onDeleteClick:_?c.noop:pe,onUpdate:v})]}),(0,y.jsx)(_e,{canReply:Q,canLike:X,canSeeLikes:te,isLiked:K,likesCount:Y,isLikeDisabled:ne,onReplyClick:_?c.noop:function(){return ge({communityMember:O})},onLikeClick:_?c.noop:G,onLikesCountClick:_?c.noop:function(){return re.show({id:x,placeholderLikesCount:Y})}}),R&&(0,y.jsx)(st,{show:se,onClose:ce,onReportSubmit:ue}),F&&(0,y.jsx)(u.c,{isOpen:fe,onClose:ve,onConfirm:he,confirmText:be?(0,a.t)("deleting"):(0,a.t)("delete"),confirmVariant:"danger",title:(0,a.t)("comments.delete.confirm.title"),disabled:be,children:(0,a.t)("comments.delete.confirm.description")})]}),!D&&(0,y.jsx)("div",{className:i()("post__replies md:ml-[3.125rem]",{"ml-8":!j,"ml-12":j}),children:(0,y.jsx)(H,{space:t,post:n,parentCommentId:x,preloaded:!0,preloadedComments:S,preloadedCommentsTotalCount:P,showReplyForm:V,autofocusReplyForm:f,communityMemberForReply:W,onCommentReplyClick:Z,onCommentCreate:b,onCommentDelete:g,formRef:B})})]})},xt=n(42602);const wt=function(e){var t=e.space,n=e.post,o=e.id,i=e.showReplyForm,c=void 0!==i&&i,u=e.autofocusReplyForm,d=void 0!==u&&u,m=e.onCommentDelete,f=e.onReplyCreate,p=e.onReplyDelete,v=(0,s.Zh)().usedIn,h=(0,xt.E)({postId:n.id,id:o,postCommentsClosed:n.is_comments_closed,postLikingDisabled:n.is_liking_disabled,usedIn:v}),b=h.comment,g=h.isLoading,_=h.updateQueryData;return(0,r.useEffect)((function(){g||window.initialiseTippy()}),[g]),B({enabled:!g}),g?(0,y.jsx)(l.m,{}):b?(0,y.jsx)(jt,{space:t,post:n,comment:b,showReplyForm:c,autofocusReplyForm:d,onUpdate:_,onDelete:m,onReplyCreate:f,onReplyDelete:p}):(0,y.jsx)("div",{className:"post__comment-not-found border-primary text-dark dark:text-lightest bg-v2-warning-100 rounded-b-lg border-t p-2.5 py-4 text-base md:p-5",children:(0,a.t)("comments.hierarchy.not_found")})},Ot=H;var St=n(30658),Pt=n(30887),Ct=function(e){var t=e.className;return(0,y.jsx)("div",{className:t,children:(0,y.jsxs)("div",{className:"bg-tertiary flex items-center justify-center gap-2 rounded-md p-3 text-center",children:[(0,y.jsx)(Pt.JO,{size:16,type:"lock-v2",className:"text-dark"}),(0,y.jsx)(we.Z.LabelSm,{children:(0,a.t)("post.comments_section.comments_closed")})]})})},kt=n(98929),It=n(61345);function Nt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function At(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Nt(Object(n),!0).forEach((function(t){Et(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Nt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Et(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Tt=function(e){var t=e.isIframeEmbed,n=e.containerClassNames,r=e.currentCommunity,o=t?{target:"_blank",rel:"noreferrer"}:{},i=Boolean(null===r||void 0===r?void 0:r.private_sign_up_url),s=(0,kt.fs)(r)||i,l=i?r.private_sign_up_url:(0,kt.pn)(r);return(0,y.jsxs)("div",{className:n,children:[(0,y.jsx)("div",{className:"mb-3 text-center",children:(0,y.jsx)(we.Z.LabelLg,{weight:"semibold",children:(0,a.t)("login_to_comment")})}),(0,y.jsxs)("div",{className:"flex items-center justify-center gap-4",children:[(0,y.jsx)("a",At(At({className:"focus-visible:outline-secondary border-hover bg-primary text-dark hover:text-darkest focus-visible:text-darkest rounded-md border px-[18px] py-[6px] text-sm font-semibold transition-colors duration-150 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",href:(0,N.j)({params:{post_login_redirect:window.location.href}})},o),{},{children:(0,a.t)("log_in")})),s&&(0,y.jsx)("a",At(At({className:"signup-link btn btn-primary focus-visible:!outline-secondary !bg-brand !text-brand-button !h-auto !rounded-md !px-[18px] !py-[6px] !text-sm !font-bold !leading-5 !transition-colors !duration-150 hover:!opacity-90 focus-visible:!outline focus-visible:!outline-2 focus-visible:!outline-offset-2",href:l},o),{},{children:i?r.private_sign_up_label:(0,a.t)("sign_up")}))]})]})},Dt=n(66007),Rt=function(e){var t=e.lockedPostCtaContent,n=e.containerClassNames;return(0,y.jsxs)("div",{className:n,children:[(0,y.jsx)("div",{children:(0,y.jsx)(we.Z.TitleSm,{weight:"semibold",children:t.heading})}),(0,y.jsx)("div",{className:"mt-4",children:t.body&&(0,y.jsx)(we.Z.BodyMd,{children:(0,y.jsx)(Dt.Z,{html:t.body})})}),(0,y.jsx)("div",{className:"mt-6",children:(0,y.jsx)(g.z,{onClick:function(){return window.location.href=t.buttonLink},children:t.buttonLabel})}),(0,y.jsxs)("div",{className:"already-member mt-4",children:[(0,y.jsx)(we.Z.LabelSm,{children:(0,a.t)("already_a_member")}),(0,y.jsx)("a",{className:"signup-link text-brand ml-1 text-sm font-medium",href:(0,N.j)({params:{post_login_redirect:window.location.href}}),children:(0,a.t)("log_in")})]})]})},Lt=function(e){var t=e.post,n=e.space,r=(0,s.wh)(),o=r.currentCommunity,l=r.currentUser,c=(0,St.m)(),u=c.isSharedPostWithTeaserLayout,d=c.showGatedCommentSectionAtBottom,m=c.showGatedCommentSectionAtTop,f=c.isSharedPostViewWithMinimalLayout,p=(0,q.I)(),v={heading:o.locked_post_cta_heading||(0,a.t)("login_to_comment"),body:o.locked_post_cta_body,buttonLabel:o.locked_post_cta_button_text||(0,a.t)("log_in"),buttonLink:o.locked_post_cta_button_url||(0,N.j)({params:{post_login_redirect:window.location.href}})},h=!!l,b=!h&&u,g=(0,kt.v)(o),_=i()("gated-post gated-post--custom-cta py-10 px-7 text-center",{"border-t border-primary":f,post__logged_out_comments:!g,"post__bottom_border border-b border-primary":m&&!f,"post__top_border border-t border-primary":d&&!f,"gated-post--standard-layout":!t.minimal_layout,"gated-post--no-gradient":!b,"gated-post--gradient":b});return(g||(0,It.WB)(n))&&o.custom_cta_for_share_links?(0,y.jsx)(Rt,{containerClassNames:_,lockedPostCtaContent:v}):t.is_comments_enabled&&!h?(0,y.jsx)(Tt,{containerClassNames:_,isIframeEmbed:p,currentCommunity:o}):null},Mt=function(e){var t=e.post||{},n=t.slug,r=t.space_slug;return(0,y.jsx)("div",{className:"border-primary flex items-center justify-center gap-4 border-t p-12",children:(0,y.jsx)("a",{className:"btn btn-secondary",href:(0,N.LM)({spaceSlug:r,slug:n}),children:(0,a.t)("leave_a_comment")})})};function Ft(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return Ut(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ut(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ut(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Bt=function(e){var t=e.autofocusReplyForm,n=e.commentsFormRef,o=e.className,l=void 0===o?"":o,c=(0,St.m)(),u=c.post,d=c.showGatedCommentSectionAtBottom,m=c.showGatedCommentSectionAtTop,f=c.shouldShowLeaveCommentButton,p=c.shouldHideCommentsListForSpace,v=c.refetchPostDetails,h=c.updatePostDetailsQueryCache,b=M().commentId,g=Ft((0,r.useState)(b),2),_=g[0],j=g[1],x=Ft((0,r.useState)(b&&u.comments_count>10),2),w=x[0],O=x[1],S=(0,s.L2)().data,P=(0,s.wh)().currentCommunityMember,C=(0,s.Zh)().isUsedInMinimalTipTapViewModal,k=u.is_comments_closed,I=function(){v&&v()},N=function(){h&&h({comments_count:u.comments_count+1})},A=function(){O(!1),j(null),window.location.hash="#all_comments"},E=p({space:S});(0,r.useEffect)((function(){j(b)}),[b]);var T=!(f||(0,We.HZ)(u));return(0,y.jsxs)("div",{className:i()("post__comments trix-v2",{"mb-32":C&&!k},l),"data-controller":"comments",id:"all_comments","data-post-id":u.id,children:[k&&(0,y.jsx)(Ct,{className:"m-4"}),f&&(0,y.jsx)(Mt,{post:u}),T&&m&&(0,y.jsx)(Lt,{post:u,space:S}),!E&&w&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("div",{className:"show-all-comments__wrapper px-2.5 py-4 md:p-6",children:(0,y.jsxs)("a",{className:"show-all-comments__link focus-visible:outline-secondary border-hover bg-primary text-dark hover:text-darkest focus-visible:text-darkest inline-flex items-center gap-2 rounded-md border px-4 py-2 text-sm font-semibold leading-normal transition-colors duration-150 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",href:"#all_comments",onClick:function(e){e.preventDefault(),A()},children:[(0,y.jsx)(Pt.JO,{type:"arrow-solid-top-left"}),(0,a.t)("post.comments_section.show_all_count_comments",{count:u.comments_count,formatted_count:(0,ge.H)(u.comments_count)})]})}),(0,y.jsx)(wt,{communityMember:P,space:S,post:u,id:_,showReplyForm:!k,autofocusReplyForm:t,onCommentDelete:function(){I(),A()},onReplyCreate:N,onReplyDelete:I})]}),!E&&!w&&(0,y.jsx)(Ot,{communityMember:P,space:S,post:u,showReplyForm:!k,autofocusReplyForm:t,formRef:n,onCommentCreate:N,onCommentDelete:I}),T&&d&&(0,y.jsx)(Lt,{post:u,space:S})]})}},99338:(e,t,n)=>{n.d(t,{S:()=>H});var r=n(94184),o=n.n(r),i=n(30658),a=n(30414),s=n(86013),l=n(24185),c=n(97012),u=n(49326),d=n(28175),m=n(30887),f=n(6038),p=n(25067),v=n(85893),h=function(e){var t=e.count,n=e.toggleComment,r=e.hasPostDetailsLoaded,o=(0,i.m)().post,a=(0,d.I)().isV3Enabled,c=(0,l.k6)(),m=(0,l.TH)();return r?(0,v.jsx)("button",{type:"button",className:"hover:!text-dark focus-visible:outline-secondary text-default px-2 py-1.5 text-sm font-medium transition-colors duration-150 ease-in-out focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",onClick:function(){a?c.push({pathname:u.xu.show({slug:o.slug,spaceSlug:o.space_slug}),state:{prevLocation:m,shouldFocusOnCommentsSection:!0}}):n()},children:(0,s.t)("post.comments",{count:t,formatted_count:(0,f.H)(t)})}):(0,v.jsx)(p.gi,{variant:"row",lg:!0,long:!0})},b=function(e){var t,n=e.shouldOpenCommentPage,r=e.showCommentAndFocusCommentForm,a=e.toggleComment,f=(0,c.EU)(),p=(0,d.I)().isV3Enabled,b=(0,l.k6)(),g=(0,l.TH)(),y=(0,i.m)().post,_=y.is_comments_closed,j=y.is_comments_enabled,x=y.comments_count,w=void 0===x?0:x,O=y.post_details_loaded;return j&&!n?(0,v.jsxs)(v.Fragment,{children:[!_&&f&&(0,v.jsx)("button",{type:"button",onClick:function(){p?b.push({pathname:u.xu.show({slug:y.slug,spaceSlug:y.space_slug}),state:{prevLocation:g}}):r()},"aria-label":(0,s.t)("cap_comment_aria_label",{title:null!==(t=null===y||void 0===y?void 0:y.name)&&void 0!==t?t:(0,s.t)("this_post")}),className:o()("action-comment text-default hover:!text-dark focus-visible:outline-secondary flex items-center text-sm font-medium transition-colors duration-150 ease-in-out focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",p?"px-1 py-0.5":"px-2 py-1.5"),children:p?(0,v.jsx)("span",{className:"action__icon",children:(0,v.jsx)(m.JO,{type:"24-comment-v3"})}):(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("span",{className:"action__icon mr-1.5 inline-flex",children:(0,v.jsx)(m.JO,{useWithFillCurrentColor:!0,type:"message"})}),(0,v.jsx)("span",{className:o()("action__label"),children:(0,s.t)("cap_comment")})]})}),(0,v.jsx)("div",{className:"engagement__comments ml-auto mr-0",children:(0,v.jsx)(h,{count:w,toggleComment:a,hasPostDetailsLoaded:O})})]}):null},g=n(40518),y=function(e){var t=e.shouldOpenCommentPage,n=e.toggleComment,r=(0,i.m)().post,o=r.is_comments_enabled,a=r.comments_count,l=void 0===a?0:a,c=r.post_details_loaded;return o&&t?(0,v.jsxs)(g.s,{post:r,allComments:!0,className:"flex w-full !items-center !justify-between",children:[(0,v.jsxs)("div",{className:"flex items-center",children:[(0,v.jsx)("span",{className:"action__icon",children:(0,v.jsx)(m.JO,{type:"message",className:"!text-dark",useWithFillCurrentColor:!0})}),(0,v.jsx)("span",{className:"count !text-dark",children:(0,s.t)("cap_comment")})]}),(0,v.jsx)("div",{className:"flex items-center",children:(0,v.jsx)(h,{count:l,toggleComment:n,hasPostDetailsLoaded:c})})]}):null},_=n(67294),j=["post"];function x(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function w(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return O(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return O(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function O(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var S=function(){var e,t=w((0,_.useState)(!1),2),n=t[0],r=t[1],a=(0,d.I)().isV3Enabled,l=(0,c.EU)(),u=(0,i.m)(),f=u.post,p=x(u,j),h=f.is_liking_enabled,b=f.is_liked_by_current_user,g=f.post_details_loaded;return h&&l?(0,v.jsx)("button",{type:"button","aria-label":(0,s.t)("like_post_aria_label",{name:null!==(e=null===f||void 0===f?void 0:f.name)&&void 0!==e?e:""}),onClick:function(e){var t;r(!0),setTimeout((function(){r(!1)}),200),null===(t=p.onLikeToggle)||void 0===t||t.call(p,e)},className:o()("action-link post__actions--like hover:!text-dark focus-visible:outline-secondary flex items-center text-sm transition-all duration-200 ease-in-out focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",{"liked text-brand font-semibold":b,"text-default font-medium":!b,"cursor-not-allowed":!g},n?"scale-110":"scale-100",a?"px-1 py-0.5":"px-2 py-1.5"),children:a?(0,v.jsx)(m.JO,{type:b?"24-heart-red-fill":"24-heart-outline"}):(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("span",{className:"action__icon mr-1.5 inline-flex",children:(0,v.jsx)(m.JO,{type:"like"})}),(0,v.jsx)("span",{"aria-checked":b,className:o()("action__label"),children:(0,s.t)(b?"liked":"like")})]})}):null},P=n(67142),C=n(68375),k=function(e){var t=e.firstCommunityMemberToLike,n=e.secondCommunityMemberToLike,r=e.likesCount;if(e.isLoading)return(0,v.jsx)(p.gi,{variant:"row",lg:!0,extraLong:!0});if(!t)return null;var o="";return 1===r?o=(0,s.t)("liked_by_name",{name:t.first_name,count:r,formatted_count:(0,f.H)(r)}):2===r?o=(0,s.t)("liked_by_two_names",{first:t.first_name,second:n.first_name}):r>2&&(o=(0,s.t)("liked_by_name",{name:t.first_name,count:r-1,formatted_count:(0,f.H)(r-1)})),(0,v.jsx)("span",{className:"overflow-anywhere",children:o})},I=n(96486),N=n(58533),A=n(72675),E=n(86078),T=n(13521),D=n(53448),R=n(32224),L=n(38870),M=n(16743),F=function(e){var t=e.member,n=e.hideModal,r=t.name,o=t.avatar_url,i=t.public_uid,a=(0,R.O)({public_uid:i}),s=a.onClick,l=a["aria-label"],c=a.href,u=a.rel,d=a.target;return(0,v.jsxs)("a",{className:"flex items-center gap-3",onClick:function(e){n(),s&&s(e)},"aria-label":l,href:c,rel:u,target:d,children:[(0,v.jsx)("div",{className:"mt-0",children:(0,v.jsx)(L.s,{name:r,src:o,size:"10"})}),(0,v.jsx)(M.Z.LabelSm,{weight:"medium",children:r})]})},U=function(e){var t,n=e.post,r=(0,A.dd)(),o=(0,T.m)(u.av.posts.userLikesList({postId:String(n.id),params:{per_page:15}}),{enabled:!(null===n||void 0===n||!n.id)},["post-likes-modal",null===n||void 0===n?void 0:n.id]),i=o.data,a=o.isLoading,l=o.fetchNextPage,c=o.hasNextPage,d=o.mapPages,m=(0,_.useMemo)((function(){return(0,I.flatten)(d((function(e){return e.records})))}),[d]),p=null===i||void 0===i||null===(t=i.pages[0])||void 0===t?void 0:t.count;return(0,v.jsxs)(D.u_,{title:(0,s.t)("like_modal_title"),isOpen:r.visible,onClose:r.hide,children:[(0,v.jsx)(D.u_.Overlay,{}),(0,v.jsxs)(D.u_.Content,{children:[(0,v.jsxs)(D.u_.Header,{children:[(0,v.jsx)(D.u_.Title,{size:"sm",children:p?(0,v.jsxs)(v.Fragment,{children:[(0,f.H)(p)," ",1===p?(0,s.t)("like"):(0,s.t)("likes")]}):(0,s.t)("likes")}),(0,v.jsx)(D.u_.HeaderActions,{children:(0,v.jsx)(D.u_.CloseButton,{onClick:r.hide})})]}),(0,v.jsx)(D.u_.Body,{className:"pb-6 pt-4",children:a?(0,v.jsx)(E.m,{}):(0,v.jsx)("div",{id:"post-likes-modal-".concat(n.id),className:"max-h-[calc(100dvh-62px-44px-24px)] overflow-auto sm:max-h-80",children:(0,v.jsx)(N.Z,{scrollThreshold:.75,next:l,hasMore:c||!1,loader:(0,v.jsx)(E.m,{}),scrollableTarget:"post-likes-modal-".concat(n.id),dataLength:m.length,className:"flex flex-col space-y-4",children:m.map((function(e){return(0,v.jsx)(F,{member:e,hideModal:r.hide},e.id)}))})})})]})]})},B=A.gk.create((function(e){var t=e.post;return(0,v.jsx)(U,{post:t})})),z=function(){var e=(0,i.m)(),t=e.post,n=e.isPostBodyEmpty,r=(0,c.Zh)().usedIn,a=(0,d.I)().isV3Enabled,s=t.user_likes_count,l=t.is_liking_enabled,u=t.sample_user_likes_community_members,m=void 0===u?[]:u,f=t.post_details_loaded,h=(0,A.dd)(B);if(!f)return(0,v.jsx)("div",{className:o()("post__engagement mb-5",{"!pt-5":(0,C.Fr)(t)&&n,"mx-5 md:mx-6":"minimal-post-modal"!==r}),children:(0,v.jsx)(p.gi,{variant:"members-avatar-row"})});if(!l||!s||!m.length)return null;return(0,v.jsx)("button",{type:"button",onClick:function(){return h.show({post:t})},className:o()("post__engagement focus-visible:outline-secondary mb-5 focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",{"pt-5":(0,C.Fr)(t)&&"full-post-modal"!==r&&n,"mx-5 md:mx-6":"minimal-post-modal"!==r}),children:(0,v.jsxs)("div",{className:"engagement__likes flex items-center",children:[(0,v.jsx)("div",{className:"engagement__members border-tertiary mr-3",children:(0,v.jsx)(P.pB,{users:m.slice(0,3).map((function(e){return{src:e.avatar_url,name:e.name}})),isFullRounded:a})}),(0,v.jsx)("div",{className:"engagement__members--descriptor text-dark text-left text-sm","data-testid":"post-engagement",children:(0,v.jsx)(k,{firstCommunityMemberToLike:m[0],secondCommunityMemberToLike:m[1],likesCount:s,isLoading:!f})})]})})},H=function(e){var t=e.toggleComment,n=e.showCommentAndFocusCommentForm,r=e.shouldOpenCommentPage,s=void 0!==r&&r,l=e.className,c=void 0===l?"":l;return(0,i.m)().showEngagementActions?(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(z,{}),(0,v.jsxs)("div",{className:o()("post__actions post__actions-visible border-primary flex items-center gap-1 border-t px-3 py-2.5 md:px-4",c),children:[(0,v.jsx)(a.T,{children:(0,v.jsx)(S,{})}),(0,v.jsx)(b,{shouldOpenCommentPage:s,showCommentAndFocusCommentForm:n,toggleComment:t}),(0,v.jsx)(y,{shouldOpenCommentPage:s,toggleComment:t})]})]}):null}},83873:(e,t,n)=>{n.d(t,{c:()=>u});var r=n(94184),o=n.n(r),i=n(86013),a=n(26953),s=n(30887),l=n(16743),c=n(85893),u=function(e){var t=e.post,n=e.mobileWrapperClassName,r=void 0===n?"":n,u=(0,a.kK)();return t.pinned_at_top_of_space?u?(0,c.jsxs)("div",{className:o()("mx-5 mt-5 flex items-center gap-2",r),children:[(0,c.jsx)(s.JO,{size:20,type:"20-pinned-post",className:"text-dark"}),(0,c.jsx)(l.Z.LabelXxs,{weight:"font-semibold",children:(0,i.t)("post.pinned_post")})]}):(0,c.jsx)("div",{className:"post__pin post__pin--pinned inline-flex p-1",children:(0,c.jsx)(s.JO,{type:"20-pin-post",className:"text-default !h-5 !w-5",size:20,useWithStrokeCurrentColor:!0})}):null}},69943:(e,t,n)=>{n.d(t,{u:()=>l});var r=n(81217),o=n(94812),i=n(97012),a=n(5295),s=n(85893),l=function(e){var t=e.show,n=e.closeModal,l=e.post,c=e.shouldSkipRedirectAfterSubmit,u=void 0!==c&&c,d=e.onChange,m=e.onSubmitSuccess;if(!t)return null;var f=(0,r.t)({spaceId:l.space_id,postSlug:l.slug,context:"edit-post-modal"}),p=f.isLoading,v=f.post,h=f.remove;if(p)return(0,s.jsx)(a.a,{variant:"fullscreen"});return(0,s.jsx)(i.DW,{post:v,onPostChange:d,children:(0,s.jsx)(o.Y,{show:t,closeModal:function(){n&&n(),h()},shouldSkipRedirectAfterSubmit:u,onSubmitSuccess:m})})}},28665:(e,t,n)=>{n.d(t,{m:()=>C});var r=n(86013),o=n(88767),i=n(1320),a=n(82621),s=n(31389),l=n(62711),c=n(64850),u=n(34729),d=n(94997),m=n(1061),f=n(24885),p=n(30658),v=n(97012),h=n(26953),b=n(63099),g=n(37903),y=n(30887),_=n(71032),j=n(20633),x=n(1002),w=n(21809),O=n(85893);function S(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return P(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return P(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function P(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var C=function(e){var t=e.onChange,n=e.onPostDestroy,P=(0,p.m)(),C=P.post,k=P.canUpdatePost,I=P.canDuplicatePost,N=P.canDestroyPost,A=P.canManagePost,E=P.refetchPostDetails,T=(0,f.Z)(),D=(0,w.p)(),R=D.success,L=D.error,M=(0,v.L2)().refetch,F=(0,h.kK)(),U=S((0,b.k)(),2),B=U[0],z=U[1],H=S((0,b.k)(!1),2),q=H[0],Z=H[1],V=S((0,b.k)(),2),W=V[0],Q=V[1],$=(0,s.f0)(C),G=(0,v.wh)().isViewOnlyMasquerading,J=(0,o.useMutation)((function(e){return i.S1.destroy({event:C,params:{delete_mode:e}})}),{onSuccess:function(){n(C.id),R($?(0,r.t)("events.recurring_deletion_successful"):(0,r.t)("event_dropdown_actions.delete_successful")),null===M||void 0===M||M()},onError:function(){return L((0,r.t)("event_dropdown_actions.delete_failed"))}});return k||I||N?G?(0,O.jsx)(y.JO,{type:"menu-dots","aria-label":(0,r.t)("events.event_actions"),className:"cursor-not-allowed"}):(0,O.jsxs)(O.Fragment,{children:[(0,O.jsxs)(x.Lt,{direction:"bottom-end",menuButtonEl:"div",button:(0,O.jsx)(j.h,{name:"20-menu-dots-horizontal",iconClassName:"!text-default group-hover:!text-dark !w-5 !h-5",className:"group",variant:"secondary",iconSize:20,buttonSize:28,"aria-label":(0,r.t)("events.event_actions"),dataTestId:"action-more"}),transitionWrapperClassName:"z-50",size:"large",appendTo:document.body,children:[(0,O.jsx)(g.e,{variant:"dropdown",bookmarkType:"event",record:C,onSuccess:E}),F&&(0,O.jsx)(u.i,{onChange:t,className:"w-full",buttonClassName:"w-full",button:(0,O.jsx)(x.Lt.ItemLink,{children:(0,r.t)("events.event_actions_dropdown.share_event")})}),k&&(0,O.jsx)(x.Lt.ItemLink,{onClick:function(){return T.show({event:C})},forceClose:!0,children:(0,r.t)("edit_event")}),I&&(0,O.jsx)(x.Lt.ItemLink,{onClick:Z,children:(0,r.t)("duplicate_event")}),N&&(0,O.jsx)(x.Lt.ItemLink,{onClick:function(){(0,m.H3)(C)?Q(!0):z(!0)},forceClose:!0,children:(0,O.jsx)("span",{className:"text-v2-danger",children:(0,r.t)("delete_event")})}),A&&(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)(x.Lt.Separator,{}),(0,O.jsx)(c.E,{event:C,canEdit:k})]})]}),(0,O.jsx)(_.c,{isOpen:B,title:(0,r.t)("delete_event_confirmation"),onClose:z,onCancel:z,onConfirm:J.mutate,confirmVariant:"danger",disabled:J.isLoading,confirmText:J.isLoading?(0,r.t)("deleting"):(0,r.t)("confirm"),children:(0,r.t)("delete_event_descriptor")}),(0,O.jsx)(l.D,{event:C,show:q,onClose:Z}),!(0,d.yl)(C)&&(0,O.jsx)(a.t,{show:W,onConfirm:J.mutate,onCloseModal:function(){return Q(!1)}})]}):null}},93619:(e,t,n)=>{n.d(t,{p:()=>ie});var r=n(30658),o=n(97012),i=n(28665),a=n(86013),s=n(96486),l=n(88767),c=n(24185),u=n(66927),d=n(68375),m=n(61345),f=n(1320),p=n(33552),v=n(25388),h=n(98929),b=n(31889),g=n(49326),y=n(26953),_=n(63099),j=n(37903),x=n(71032),w=n(20633),O=n(1002),S=n(53448),P=n(21809),C=n(39099),k=n(34128),I=n(97646),N=n(85893),A=function(e){var t=e.post,n=e.handleClose,o=void 0===n?s.noop:n,i=(0,P.p)(),c=i.success,u=i.error,d=!!t.post_follower_id,m=(0,r.m)().onPostFollow,f=(0,l.useMutation)(d?function(){return(0,k.pC)(g.av.postFollowers.destroy({postId:t.id,postFollowerId:t.post_follower_id}))}:function(){return(0,k.Cu)(g.av.postFollowers.create({postId:t.id}))},{onSuccess:function(e){var t;m({post_follower_id:d?null:null===e||void 0===e||null===(t=e.post_follower)||void 0===t?void 0:t.id}),o(),c(I18n.t(d?"post_unfollow.success":"post_follow.success"))},onError:function(){return u(I18n.t(d?"post_unfollow.error":"post_follow.error"))}});return(0,N.jsx)(O.Lt.ItemLink,{onClick:function(){f.mutate()},children:(0,N.jsx)(I.sI,{label:(0,a.t)("follow_post"),field:"follow_post",value:d,variant:"small"})})},E=n(64687),T=n.n(E);function D(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}var R=function(e){var t,n,r=e.post,o=e.onChange,i=e.refetchPosts,c=e.handleClose,u=void 0===c?s.noop:c,d=(0,P.p)(),m=d.success,p=d.error,v=r.pinned_at_top_of_space,h=(0,l.useMutation)((function(){return f.Fv.pin({post:r,formData:{is_pinned:!v,pin_to_top:!0}})}),{onSuccess:(t=T().mark((function e(t){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o(t,{refetch:!1}),!(0,s.isFunction)(i)){e.next=4;break}return e.next=4,i();case 4:m(I18n.t(v?"post_unpinned":"post_pinned"));case 5:case"end":return e.stop()}}),e)})),n=function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(e){D(i,r,o,a,s,"next",e)}function s(e){D(i,r,o,a,s,"throw",e)}a(void 0)}))},function(e){return n.apply(this,arguments)}),onError:function(){p(I18n.t(v?"post_unpinned_error":"post_pinned_error"))},onSettled:u});return(0,N.jsx)(O.Lt.ItemLink,{onClick:h.mutate,children:(0,N.jsx)(I.sI,{label:(0,a.t)("pin_to_top"),field:"pin_to_top",value:v,variant:"small"})})},L=n(70905);function M(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function F(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?M(Object(n),!0).forEach((function(t){U(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):M(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function U(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var B=function(e){var t=e.post,n=void 0===t?{}:t,r=e.handleClose,o=e.onChange,i=!!n.pinned_at,s=(0,l.useQueryClient)(),c=(0,P.p)(),u=c.success,d=c.error,m=(0,L.P)().refetch,p=(0,l.useMutation)((function(){return f.Fv.pin({post:n,formData:F(F({},n),{},{is_pinned:!i,pin_to_top:!1})})}),{onSuccess:function(e){o(e,{refetch:!1}),m(),s.invalidateQueries("posts"),u(I18n.t(i?"post_unpinned_from_sidebar":"post_pinned_to_sidebar"))},onError:function(){d(I18n.t(i?"post_unpinned_error":"post_pinned_error"))},onSettled:r});return(0,N.jsx)(O.Lt.ItemLink,{onClick:p.mutate,children:(0,N.jsx)(I.sI,{label:(0,a.t)("pin_post"),field:"pin_post",value:i,variant:"small"})})},z=function(e){var t=e.post,n=e.handleClose,r=e.onChange,o=t.is_comments_disabled,i=o?"post.enable_comments":"post.disable_comments",s=(0,P.p)(),c=s.success,u=s.error,d=(0,l.useMutation)((function(){return(0,k.gN)(g.av.posts.update({spaceId:t.space_id,postSlug:t.slug}),{post:{space_id:t.space_id,is_comments_disabled:!o}})}),{onSuccess:function(e){r(e,{refetch:!1}),c((0,a.t)("".concat(i,".alerts.success")))},onError:function(){u((0,a.t)("".concat(i,".alerts.failure")))},onSettled:n}).mutate;return(0,N.jsx)(O.Lt.ItemLink,{onClick:d,children:(0,N.jsx)(I.sI,{label:(0,a.t)("post.action_menu.disable_comments"),field:"disable_comments",value:o,variant:"small"})})},H=function(e){var t=e.post,n=e.handleClose,r=e.onChange,o=t.is_comments_closed,i=o?"post.open_comments":"post.close_comments",s=(0,P.p)(),c=s.success,u=s.error,d=(0,l.useMutation)((function(){return(0,k.gN)(g.av.posts.update({spaceId:t.space_id,postSlug:t.slug}),{post:{space_id:t.space_id,is_comments_closed:!o}})}),{onSuccess:function(e){r(e,{refetch:!1}),c((0,a.t)("".concat(i,".alerts.success")))},onError:function(){u((0,a.t)("".concat(i,".alerts.failure")))},onSettled:n}).mutate;return(0,N.jsx)(O.Lt.ItemLink,{onClick:d,children:(0,N.jsx)(I.sI,{label:(0,a.t)("post.action_menu.close_comments"),field:"close_comments",value:o,variant:"small"})})};function q(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}var Z=function(e){var t,n,r=e.post,o=e.handleClose,i=void 0===o?s.noop:o,c=e.onChange,u=e.refetchPosts,d=r.hide_from_featured_areas,m=(0,P.p)(),p=m.success,v=m.error,h=(0,l.useMutation)((function(){return d?f.Fv.showInFeaturedAreas({post:r}):f.Fv.hideFromFeaturedAreas({post:r})}),{onSuccess:(t=T().mark((function e(t){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c(t,{refetch:!1}),!(0,s.isFunction)(u)){e.next=4;break}return e.next=4,u();case 4:p(I18n.t(d?"post.marked_unhidden":"post.marked_hidden"));case 5:case"end":return e.stop()}}),e)})),n=function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(e){q(i,r,o,a,s,"next",e)}function s(e){q(i,r,o,a,s,"throw",e)}a(void 0)}))},function(e){return n.apply(this,arguments)}),onError:function(){v(I18n.t("something_went_wrong"))}});return(0,N.jsx)(O.Lt.ItemLink,{onClick:function(){i(),h.mutate()},children:(0,N.jsx)(I.sI,{label:(0,a.t)("post.hide_from_featured_areas"),field:"hide_from_featured_areas",value:d,variant:"small"})})},V=function(e){var t=e.post,n=e.onChange,r=t.is_liking_disabled,o=r?"post.enable_liking":"post.disable_liking",i=(0,P.p)(),s=i.success,c=i.error,u=(0,l.useMutation)((function(){return(0,k.gN)(g.av.posts.update({spaceId:t.space_id,postSlug:t.slug}),{post:{space_id:t.space_id,is_liking_disabled:!r}})}),{onSuccess:function(e){n(e,{refetch:!1}),s((0,a.t)("".concat(o,".alerts.success")))},onError:function(){c((0,a.t)("".concat(o,".alerts.failure")))}}).mutate;return(0,N.jsx)(O.Lt.ItemLink,{onClick:function(){return u()},children:(0,N.jsx)(I.sI,{label:(0,a.t)("post.action_menu.disable_liking"),field:"disable_liking",value:r,variant:"small"})})},W=n(43548),Q=n(55675),$=n(61926),G=n(78270),J=n(16743),K=function(e){var t=e.spaceId,n=e.postId,r=e.postSlug,i=e.postTitle,s=e.hasNoteAboutExceptions,u=void 0===s||s,m=e.isOpen,f=void 0!==m&&m,p=e.onClose,v=e.onDuplicateSuccess,h=(0,c.k6)(),b=(0,P.p)(),y=b.success,_=b.error,j=(0,o.nT)(),x=j.isLoading,w=(0,j.helpers.basicSpacesWithPostCreationAllowed)(),O=(0,l.useMutation)((function(e){return(0,k.aU)(g.av.posts.duplicate({spaceId:t,postSlug:r}),{post:{post_id:n,space_id:e.space_id,send_notifications:e.send_notifications}})}),{onSuccess:function(e){y((0,a.t)("duplicated_successfully")),p(),h.push((0,d.RG)({post:e,editMode:!0})),v&&v(e)},onError:function(){_((0,a.t)("duplication_failed"))}}),S=O.mutate,C=O.isLoading;return x?null:(0,N.jsx)(G.u,{overflowVisible:!0,title:(0,a.t)("duplicate_post_title",{post_title:i||(0,a.t)("duplicate_post_title_untitled")}),show:f,onClose:p,children:(0,N.jsxs)($.l,{onSubmit:S,defaultValues:{space_id:t,send_notifications:!1},children:[(0,N.jsx)($.l.Item,{name:"space_id",hideBorder:!0,fullWidth:!0,label:(0,a.t)("space"),description:(0,a.t)("duplicate_post_to_space"),rules:{required:(0,a.t)("events.create.form.space_required_error")},children:(0,N.jsx)(W.M,{spaces:w,name:"space_id",variant:"form-input",defaultValue:t,containerClassname:"mt-2"})}),u&&(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(J.Z.LabelXs,{color:"text-light",children:(0,a.t)("comments_wont_be_duplicated")}),(0,N.jsx)($.l.Item,{name:"send_notifications",hideBorder:!0,fullWidth:!0,label:(0,a.t)("duplicate_post_send_notifications"),hideDescription:!0,inlineReverse:!0,children:(0,N.jsx)($.l.ToggleSwitch,{variant:"small",name:"send_notifications"})})]}),(0,N.jsx)("div",{className:"mt-4",children:(0,N.jsx)(Q.z,{type:"submit",variant:"primary",disabled:C,children:C?(0,a.t)("duplicating"):(0,a.t)("duplicate")})})]})})},Y=n(69943),X=["harassment","spam","incorrect_location","against_guidelines","other"],ee=function(e){var t=e.onClose,n=e.show,r=e.post,i=(0,o.Zh)().usedIn,s=(0,P.p)(),c=(0,l.useMutation)((function(e){return(0,k.t5)(g.av.flaggedContent.create(),{method:"POST",forReactQuery:!0,body:JSON.stringify({flagged_content:e})})}),{onSuccess:function(){s.success((0,a.t)("report_post_success")),t()},onError:function(){s.error((0,a.t)("something_went_wrong"))}}),u=X.map((function(e){return{value:e,label:(0,a.t)("flagged_contents.report_reasons.".concat(e))}}));return(0,N.jsx)(G.u,{show:n,onClose:t,title:(0,a.t)("flagged_contents.form.report_post"),containerClassName:"full-post-modal"===i&&"!z-[1061]",children:(0,N.jsxs)($.l,{defaultValues:{flagged_contentable_id:r.id,flagged_contentable_type:"Post"},onSubmit:c.mutate,children:[(0,N.jsx)($.l.Item,{name:"reported_reason_type",label:(0,a.t)("flagged_contents.form.reported_reason_type"),description:(0,a.t)("flagged_contents.form.reported_reason_type_description"),hideBorder:!0,children:(0,N.jsx)($.l.SelectNative,{options:u})}),(0,N.jsx)($.l.Item,{name:"reported_reason_body",label:(0,a.t)("flagged_contents.form.reported_reason_body"),description:(0,a.t)("flagged_contents.form.reported_reason_body_description"),hideBorder:!0,fullWidth:!0,children:(0,N.jsx)($.l.TextArea,{})}),(0,N.jsx)(Q.z,{type:"submit",variant:"primary","data-testid":"report_post_submit",formButton:!0,children:I18n.t("report")})]})})};function te(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return ne(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ne(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ne(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var re=function(e){var t=e.refetchPosts,n=e.currentCommunity,i=e.onPostDestroy,k=e.onChange,I=(0,c.k6)(),E=(0,r.m)(),T=E.post,D=E.showModerationInActionsDropdown,L=E.canManagePost,M=E.canUpdatePost,F=E.canDestroyPost,U=E.canDuplicatePost,q=E.canReportPost,W=E.refetchPostDetails,Q=E.showShareOnWebOptions,$=(0,o.Zh)().usedIn,G=te((0,_.k)(!1),2),J=G[0],X=G[1],ne=te((0,_.k)(!1),2),re=ne[0],oe=ne[1],ie=te((0,_.k)(!1),2),ae=ie[0],se=ie[1],le=te((0,_.k)(!1),2),ce=le[0],ue=le[1],de=(0,o.wh)(),me=de.currentCommunitySettings,fe=de.isViewOnlyMasquerading,pe=de.currentCommunityMember,ve=null===me||void 0===me?void 0:me.quick_post_v2_enabled,he=(0,v.L)().show,be=(0,u.e)(),ge=(0,p.h)(),ye=(0,y.kK)(),_e=(0,d.Fr)(T),je=(0,d.hm)(T),xe=(0,S.UV)(),we=xe.contentPortalElement,Oe=xe.onClose,Se=(0,P.p)(),Pe=Se.success,Ce=Se.error,ke=(0,o.L2)(),Ie=ke.data,Ne=ke.refetch,Ae=(null===me||void 0===me?void 0:me.show_posts_editor_toggle_enabled)&&(0,b.vb)(pe),Ee=je&&Boolean(!(null!==Ie&&void 0!==Ie&&Ie.hide_right_sidebar))&&!(0,m.AU)(Ie),Te=(0,m.AU)(Ie)||(0,m.G6)(Ie),De=Boolean((0,c.$B)("/c/:spaceSlug/:postSlug")),Re=T.pinned_at_top_of_space,Le=(ye||"full-post-modal"===$||!De&&!Re&&Te)&&Q(Ie),Me=(0,l.useMutation)((function(){return f.Fv.destroy({post:T})}),{onSuccess:function(){i(T.id),Pe((0,a.t)("post_dropdown_actions.delete_successful")),Ne()},onError:function(){return Ce((0,a.t)("post_dropdown_actions.delete_failed"))}}),Fe=(0,l.useMutation)((function(){return f.Fv.toggleEditorType({post:T})}),{onSuccess:function(){Pe((0,a.t)("post_dropdown_actions.toggle_editor_successful"))},onError:function(){return Ce((0,a.t)("post_dropdown_actions.toggle_editor_failed"))}}),Ue=function(e){return I.push((0,d.RG)({post:e}))};return fe?(0,N.jsx)(w.h,{name:"16-menu-dots-horizontal",iconClassName:"!text-dark cursor-not-allowed","aria-label":(0,a.t)("post_actions"),dataTestId:"action-more",disabled:!0}):(0,N.jsxs)(N.Fragment,{children:[(0,N.jsxs)(O.Lt,{direction:"bottom-end",menuButtonEl:"div",button:(0,N.jsx)(w.h,{name:"20-menu-dots-horizontal",iconClassName:"!text-default group-hover:!text-dark !w-5 !h-5",className:"group",variant:"secondary",iconSize:20,buttonSize:28,"aria-label":(0,a.t)("post_actions"),dataTestId:"action-more"}),className:"z-10",transitionWrapperClassName:"z-50",size:"large",buttonLabel:(0,a.t)("post_actions"),appendTo:null!==we&&void 0!==we?we:document.body,children:[(0,N.jsx)(j.e,{variant:"dropdown",bookmarkType:"post",record:T,onSuccess:W}),Le&&(0,N.jsx)(C.P,{onChange:k,className:"w-full",buttonClassName:"w-full",button:(0,N.jsx)(O.Lt.ItemLink,{children:(0,a.t)("post.share.share_post_actions_label")}),shouldRenderCustomMenuButton:!0}),M&&je&&(0,N.jsx)(O.Lt.ItemLink,{onClick:function(){fe?(0,s.noop)():ve?he({post:T,onPostChange:k}):X()},children:(0,a.t)("edit_post")}),M&&_e&&(0,N.jsx)(O.Lt.ItemLink,{onClick:function(){be.show({spaceId:Ie.id,onClose:function(){return be.remove()},onPostChange:k,currentPost:T,shouldSkipRedirectAfterSubmit:"full-post-modal"===$})},children:(0,a.t)("edit_post")}),je&&U&&(0,N.jsx)(O.Lt.ItemLink,{onClick:oe,children:(0,a.t)("duplicate_post")}),_e&&U&&(0,N.jsx)(O.Lt.ItemLink,{onClick:function(){"full-post-modal"===$&&Oe(),ge.show({post:T,onSuccess:Ue})},children:(0,a.t)("duplicate_post")}),q&&(0,N.jsx)(O.Lt.ItemLink,{onClick:fe?s.noop:se,children:(0,a.t)("report_post")}),D&&(0,N.jsx)(O.Lt.ItemWithLink,{to:g.sC.index(),children:(0,a.t)("flagged_contents.review")}),F&&(0,N.jsx)(O.Lt.ItemLink,{onClick:fe?s.noop:ue,children:(0,N.jsx)("span",{className:"text-v2-danger",children:(0,a.t)("delete_post")})}),Ae&&(0,N.jsx)(O.Lt.ItemLink,{onClick:function(){Fe.mutate()},children:(0,a.t)("post_dropdown_actions.toggle_editor_dropdown_label",{editor_type:"trix"===T.editor?"tiptap":"trix"})}),(M||U||q||D||F)&&(0,N.jsx)(O.Lt.Separator,{}),(0,N.jsx)(A,{post:T,onChange:k}),L&&(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(R,{post:T,onChange:k,refetchPosts:t}),Ee&&(0,N.jsx)(B,{post:T,onChange:k,refetchPosts:t}),(0,N.jsx)(V,{post:T,onChange:k}),(0,N.jsx)(z,{post:T,onChange:k}),T.is_comments_enabled&&(0,N.jsx)(H,{post:T,onChange:k}),(0,h.Nf)(n)&&(0,N.jsx)(Z,{post:T,community:n,onChange:k,refetchPosts:t})]})]}),(0,N.jsx)(Y.u,{show:J,closeModal:X,post:T,onChange:k}),(0,N.jsx)(K,{spaceId:T.space_id,postId:T.id,postSlug:T.slug,postTitle:T.name,isOpen:re,onClose:oe}),(0,N.jsx)(ee,{post:T,show:ae,onClose:se}),(0,N.jsx)(x.c,{isOpen:ce,title:(0,a.t)("delete_post_confirmation"),onClose:ue,onCancel:ue,onConfirm:Me.mutate,confirmVariant:"danger",disabled:Me.isLoading,confirmText:Me.isLoading?(0,a.t)("deleting"):(0,a.t)("confirm"),children:(0,a.t)("delete_post_descriptor")})]})},oe=function(e){var t=e.onChange,n=e.onPostDestroy,o=e.refetchPosts,a=e.currentCommunity,s=(0,r.m)(),l=s.isBasicPost,c=s.isEventPost,u=s.isImagePost;return(0,N.jsxs)(N.Fragment,{children:[(l||u)&&(0,N.jsx)(re,{onChange:t,onPostDestroy:n,refetchPosts:o,currentCommunity:a}),c&&(0,N.jsx)(i.m,{onChange:t,onPostDestroy:n})]})},ie=function(e){var t=e.onChange,n=e.onPostDestroy,i=e.refetchPosts,a=(0,r.m)(),s=a.showPostActions,l=a.canUpdatePost,c=a.canDestroyPost,u=a.isEventPost,d=(0,o.wh)().currentCommunity;return s&&(!u||l||c)?(0,N.jsx)(oe,{onChange:t,onPostDestroy:n,refetchPosts:i,currentCommunity:d}):null}},81593:(e,t,n)=>{n.d(t,{y:()=>g});var r=n(67294),o=n(94184),i=n.n(o),a=n(66007),s=n(96486),l=n(68375),c=n(49326),u=n(30658),d=n(97012),m=n(74238),f=n(29458),p=n(44130),v=n(37109),h=n(88044),b=n(85893),g=function(e){var t=e.enableTruncation,n=void 0!==t&&t,o=e.noPadding,g=void 0!==o&&o,y=(0,u.m)(),_=y.post,j=y.isSharedPostWithTeaserLayout,x=y.isSharedPostViewWithMinimalLayout,w=y.isTiptapPost,O=y.isTrixPost,S=y.isBasicPost,P=y.isPostBodyEmpty,C=(0,m.wC)().minimal_layout,k=(0,d.Zh)().usedIn,I=["help","help-en"].includes(_.community_slug)&&S,N=!n,A=x&&j,E=j,T=_.body_trix_content,D=_.tiptap_body,R=_.internal_custom_html,L=_.pinned_at_top_of_space,M=_.updated_at;if((0,r.useEffect)((function(){var e;R&&(0,s.isFunction)(null===(e=window)||void 0===e?void 0:e.loadOembed)&&window.loadOembed()}),[R]),P)return null;var F=8;return L?F=2:A&&(F=4),(0,b.jsx)("div",{className:i()("post__body",{"!p-0":g,"px-5 pb-5 md:px-6":(0,l.Fr)(_),"mt-5":"minimal-post-modal"===k}),"data-testid":"post-body",children:(0,b.jsx)("div",{className:"post__inside trix-v2 w-full","data-testid":"post-body-inside",children:(0,b.jsxs)(p.X,{lines:F,disabled:N,hideToggle:E,children:[O&&T&&(0,b.jsx)(f.P,{content:T,contentParentPath:c.xu.show({slug:_.slug,spaceSlug:_.space_slug})}),w&&D&&(0,b.jsx)(v.R,{readOnly:!0,disableMentionClicks:C,value:D.body,sgidToObjectMap:D.sgids_to_object_map,inlineAttachments:D.inline_attachments,disabledExtensions:["cta"]}),R&&(0,b.jsx)(a.Z,{html:R},"internal_custom_html"),I&&(0,b.jsx)(h.e,{post:_})]})})},M)}},71710:(e,t,n)=>{n.d(t,{H:()=>p});var r=n(94184),o=n.n(r),i=n(86013),a=n(28053),s=n(40518),l=n(85893),c=["post","className","wrapperClassName"];function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){m(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function f(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var p=function(e){var t,n,r=e.post,u=e.className,m=void 0===u?"":u,p=e.wrapperClassName,v=void 0===p?"":p,h=f(e,c);return(null!==(t=null===(n=r.cover_image_variants)||void 0===n?void 0:n.large)&&void 0!==t?t:r.cover_image_url)?(0,l.jsx)("div",{className:o()("px-5 pt-5 md:p-0",v),children:(0,l.jsx)(s.s,d(d({post:r,className:"post__cover focus-visible:outline-secondary focus-visible:text-dark block focus-visible:rounded-lg focus-visible:outline focus-visible:outline-2 focus-visible:md:rounded-b-none"},h),{},{children:(0,l.jsx)(a.Q,{src:r.cover_image_url,srcVariants:r.cover_image_variants,alt:(0,i.t)("post.cover_image_alt"),className:o()("w-full rounded-lg object-cover md:rounded-b-none",m)},r.cover_image_url)}))}):null}},54528:(e,t,n)=>{n.d(t,{m:()=>_});var r=n(94184),o=n.n(r),i=n(86013),a=n(24185),s=n(97012),l=n(26953),c=n(39834),u=n(30658),d=n(68375),m=n(37903),f=n(83873),p=n(93619),v=n(39099),h=n(85893),b=function(e){var t=e.post,n=e.onChange,r=e.onPostDestroy,i=e.refetchPosts,a=e.hideShareLink,s=e.hidePinnedToTopIcon,c=e.hideBookmarkButton,b=(0,u.m)(),g=b.refetchPostDetails,y=b.isSharedPostView,_=(0,l.kK)(),j=(0,d.Fr)(t),x=(0,d.hm)(t),w=j||x;return(0,h.jsxs)("div",{className:"post__actions-container text-dark flex items-center gap-0.5","data-testid":"post-header-actions",children:[!c&&!y&&!_&&(0,h.jsx)(m.e,{bookmarkType:w?"post":"event",record:t,onSuccess:g,className:o()("!text-default",{"group-hover:!text-dark":!t.bookmark_id})}),!a&&!_&&(0,h.jsx)(v.P,{onChange:n}),(0,h.jsx)(p.p,{onChange:n,onPostDestroy:r,refetchPosts:i}),!s&&!y&&!_&&(0,h.jsx)(f.c,{post:t})]})},g=n(3231),y=n(88684),_=function(e){var t,n=e.post,r=e.isRenderedOutsideTheSpace,u=e.onChange,d=e.refetchPosts,m=e.onPostDestroy,f=e.hideShareLink,p=e.hidePinnedToTopIcon,v=e.hideBookmarkButton,_=e.tagsLimit,j=e.tagsShowMoreLabelVariant,x=e.metaInfoWrapperClassName,w=e.hideAuthorHeadline,O=(0,s.L2)().data,S=(0,s.Zh)().usedIn,P=null===n||void 0===n?void 0:n.cover_image_url,C=(0,l.kK)(),k=null===(t=(0,a.$B)("/home"))||void 0===t?void 0:t.isExact,I=r||k||C||"minimal-post-modal"===S;return(0,h.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,h.jsxs)("div",{className:"flex grow flex-col items-start justify-between space-y-5",children:[(null===n||void 0===n?void 0:n.flagged_for_approval_at)&&(0,h.jsx)(c.g,{className:"!bg-author-in-review post__headline-tag align mt-1 border-0 align-middle uppercase text-white",label:(0,i.t)("in_review")}),I?(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(g.c,{isRenderedOutsideTheSpace:r,doesPostHaveCoverImage:P,space:O,tagsLimit:_,tagsShowMoreLabelVariant:j,wrapperClassName:o()("mt-1",x),hideAuthorHeadline:w}),(0,h.jsx)(y.p,{})]}):(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(y.p,{}),(0,h.jsx)(g.c,{isRenderedOutsideTheSpace:r,doesPostHaveCoverImage:P,space:O,tagsLimit:_,tagsShowMoreLabelVariant:j,wrapperClassName:o()("mt-1",x),hideAuthorHeadline:w})]})]}),(0,h.jsx)(b,{post:n,onChange:u,refetchPosts:d,onPostDestroy:m,hideShareLink:f,hidePinnedToTopIcon:p,hideBookmarkButton:v})]})}},3231:(e,t,n)=>{n.d(t,{c:()=>k});var r=n(67294),o=n(94184),i=n.n(o),a=n(86013),s=n(40518),l=n(30658),c=n(97012),u=n(95071),d=n(25401),m=n(68375),f=n(26953),p=n(87958),v=n(65289),h=n(96486),b=n(85893),g=(0,r.forwardRef)((function(e,t){var n=e.headline,r=e.post,o=r.community_member,a=r.created_at,l=(0,f.kK)(),u=(0,c.Zh)().usedIn,m=l||"full-post-modal"===u,v=m?(0,h.truncate)(n,{length:60}):n;return n||m?(0,b.jsx)("div",{className:"post__meta inline-flex flex-wrap items-center gap-x-2",children:(0,b.jsx)(p.T,{content:n,shouldUseSpanWrapper:!1,interactive:!1,disabled:!n,children:(0,b.jsx)("button",{type:"button",className:i()("author__credentials text-default focus-visible:outline-secondary focus-visible:text-dark text-left text-xs focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",{"is-admin":!!o.is_admin}),children:(0,b.jsxs)("span",{className:"space-x-2",children:[n&&(0,b.jsx)("span",{className:i()("overflow-anywhere",{"md:line-clamp-1":"full-post-modal"!==u}),children:v}),m&&!!n&&(0,b.jsx)("span",{className:"bg-badge inline-block h-[0.15rem] w-[0.15rem] rounded-full align-middle"}),m&&(0,b.jsx)("span",{className:"author__time",children:(0,b.jsx)(s.s,{post:r,className:"ago text-default hover:text-dark focus-visible:outline-secondary focus-visible:text-dark text-xs focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",forwardedRef:t,children:(0,d.TF)(a,{format:d.lc.short})})})]})})})}):null}));g.displayName="AuthorHeadline";var y=n(32224),_=n(74238);function j(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function x(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?j(Object(n),!0).forEach((function(t){w(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):j(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function w(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var O=function(e){var t,n=e.children,r=e.post,o=e.className,a=void 0===o?"":o,s=r.community_member,l=(0,_.wC)().minimal_layout,c=(0,y.O)({public_uid:null!==(t=s.public_uid)&&void 0!==t?t:"",params:{show_back_link:!0},name:s.name});return l?(0,b.jsx)("div",{className:a,children:n}):(0,b.jsx)("a",x(x({},c),{},{className:i()("focus-visible:outline-secondary hover:text-dark inline-block focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",a),"data-testid":"post-avatar",children:n}))},S=n(38870),P=function(e){var t,n=e.post,r=n.community_member;return(0,b.jsx)("div",{className:"post__avatar",children:(0,b.jsx)(O,{post:n,className:"mr-3",children:(0,b.jsx)(S.s,{src:r.avatar_url,name:null!==(t=r.name)&&void 0!==t?t:"",size:"10"})})})},C=(0,r.forwardRef)((function(e,t){var n=e.doesPostHaveCoverImage,r=void 0!==n&&n,o=e.className,a=e.children,s=(0,f.kK)();return(0,b.jsx)("div",{className:i()("post__user flex items-stretch",{"md:!mb-2 md:!mt-1":s&&r},o),ref:t,children:a})}));C.displayName="PostViewListItemWrapper";var k=function(e){var t=e.isRenderedOutsideTheSpace,n=e.space,o=e.doesPostHaveCoverImage,h=void 0!==o&&o,y=e.tagsLimit,_=e.tagsShowMoreLabelVariant,j=void 0===_?"numbers":_,x=e.wrapperClassName,w=e.hideAuthorHeadline,S=(0,l.m)(),k=S.post,I=S.isSharedPostView,N=(0,c.Zh)().usedIn,A=Boolean(null===k||void 0===k?void 0:k.hide_meta_info),E=null===k||void 0===k?void 0:k.community_member,T=(null===k||void 0===k?void 0:k.member_tags)||[],D=null===E||void 0===E?void 0:E.id,R=null===T||void 0===T?void 0:T.filter((function(e){var t;return Boolean((null===e||void 0===e?void 0:e.is_public)&&(null===e||void 0===e||null===(t=e.display_locations)||void 0===t?void 0:t.post_bio))})),L=(0,r.useMemo)((function(){return Boolean(D&&(null===R||void 0===R?void 0:R.length)>0)}),[D,R]),M=(0,f.kK)(),F=(0,r.useRef)(null),U=(0,r.useRef)(null);if(A||!n)return null;var B=t?"".concat((0,a.t)("post.posted_in")," ").concat(n.name):null===E||void 0===E?void 0:E.headline,z=Boolean(null===E||void 0===E?void 0:E.admin),H=!I&&(L||z);return M||"full-post-modal"===N?(0,b.jsxs)(C,{doesPostHaveCoverImage:h,ref:F,className:x,children:[(0,b.jsx)(P,{post:k}),(0,b.jsxs)("button",{type:"button",className:"post__bio focus-visible:outline-secondary flex flex-col justify-between gap-1 text-left focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",onClick:function(e){e.target instanceof HTMLAnchorElement||U.current&&U.current.click()},children:[(0,b.jsxs)("div",{className:i()("author flex flex-wrap items-center gap-x-2 gap-y-1",{"no-headline":!(null!==E&&void 0!==E&&E.headline)&&k.name,"has-tags":L}),children:[(0,b.jsx)("div",{className:"author__name inline-flex",children:(0,b.jsx)(O,{post:k,className:"!text-dark text-sm font-semibold leading-5",children:null===E||void 0===E?void 0:E.name})}),H&&(0,b.jsx)("div",{className:"author__tags member-tags !m-0",children:(0,b.jsx)(v.m,{memberTags:R,isAdmin:z,limit:y,showMoreLabelVariant:j})})]}),!w&&(0,b.jsx)(g,{headline:B,post:k,ref:U})]})]}):(0,b.jsxs)(C,{doesPostHaveCoverImage:h,ref:F,className:x,children:[(0,b.jsx)(P,{post:k}),(0,b.jsxs)("button",{type:"button",className:"post__bio focus-visible:outline-secondary flex flex-col justify-between text-left focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",onClick:function(e){if(!(e.target instanceof HTMLAnchorElement)&&U.current)if((0,u.n2)(e)){var t=U.current.href;window.open(t,"_blank","noreferrer"),e.preventDefault()}else U.current.click()},children:[(0,b.jsxs)("div",{className:i()("author flex flex-wrap items-center gap-x-2 gap-y-px",{"no-headline":!(null!==E&&void 0!==E&&E.headline)&&k.name,"has-tags":L}),children:[(0,b.jsx)("div",{className:"author__name inline-flex",children:(0,b.jsx)(O,{post:k,className:"!text-dark overflow-anywhere text-sm font-semibold leading-5",children:null===E||void 0===E?void 0:E.name})}),H&&(0,b.jsx)("div",{className:"author__tags member-tags",children:(0,b.jsx)(v.m,{memberTags:R,isAdmin:z,limit:M||(0,m.Fr)(k)?1:2,showMoreLabelVariant:j})}),(0,b.jsx)("div",{className:"author__time inline-flex",children:(0,b.jsx)(s.s,{post:k,className:"ago text-default hover:text-dark focus-visible:outline-secondary focus-visible:text-dark text-xs focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",forwardedRef:U,children:(0,b.jsx)(p.T,{interactive:!1,content:(0,m.s4)(k.created_at),children:(0,d.TF)(k.created_at,{format:d.lc.short})})})})]}),!w&&(0,b.jsx)(g,{headline:B,post:k})]})]})}},88684:(e,t,n)=>{n.d(t,{p:()=>u});var r=n(94184),o=n.n(r),i=n(47653),a=n(40518),s=n(30658),l=n(97012),c=n(85893),u=function(){var e=(0,s.m)(),t=e.post,n=e.canManagePost,r=(0,l.Zh)().usedIn;if(!t.name||"minimal-post-modal"===r)return null;var u=(t||{}).event_setting_attributes||{},d=u.starts_at,m=u.ends_at,f=o()("post__header",{"post-meta--hidden":t.hide_meta_info});return(0,c.jsxs)("div",{className:f,children:[d&&m&&(0,c.jsx)(i.A,{startsAt:d,endsAt:m,status:null===t||void 0===t?void 0:t.status}),(0,c.jsx)("h1",{className:o()("post__title break-words text-2xl font-bold leading-7",{"with-admin-actions":n}),children:(0,c.jsx)(a.s,{post:t,className:"!text-darkest focus-visible:outline-secondary focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",children:t.name})})]})}},39099:(e,t,n)=>{n.d(t,{P:()=>P});var r=n(94184),o=n.n(r),i=n(86013),a=n(85751),s=n(97012),l=n(30887),c=n(55675),u=n(97646),d=n(16743),m=n(1002),f=n(67294),p=n(20640),v=n.n(p),h=n(49326),b=n(21809);function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){_(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function j(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return x(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return x(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function x(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var w=n(85893),O=function(e){var t=e.getSharePostLink,n=e.post,r=e.sharePostData,p=function(e){var t=e.post,n=e.getSharePostLink,r=e.sharePostData,o=(0,b.p)().success,a=(0,s.wh)().currentCommunity,l=(0,s.L2)().data,c=j((0,f.useState)({post:{show_post_teaser:!(null===t||void 0===t||!t.show_post_teaser),share_to_web:!(null===t||void 0===t||!t.share_post_enabled),share_post_enabled:!(null===t||void 0===t||!t.share_post_enabled),minimal_layout:!(null===t||void 0===t||!t.minimal_layout)}}),2),u=c[0],d=c[1],m=(0,h.LM)({spaceSlug:null===t||void 0===t?void 0:t.space_slug,slug:null===t||void 0===t?void 0:t.slug});return(0,f.useEffect)((function(){t.share_post_enabled&&!r&&n({postId:null===t||void 0===t?void 0:t.id,body:u})}),[null===t||void 0===t?void 0:t.share_post_enabled,r,u,n,null===t||void 0===t?void 0:t.id]),{onClickCopyLink:function(e){v()(e||window.location.origin+m),o((0,i.t)("post.share.link_copied"),{duration:"short",shouldUseProgress:!1})},onChange:function(e){d((function(r){var o={post:y(y({},r.post),e)};return n({postId:null===t||void 0===t?void 0:t.id,body:o}),o}))},formData:u,currentCommunity:a,currentSpace:l}}({post:n,getSharePostLink:t,sharePostData:r}),g=p.onClickCopyLink,_=p.onChange,x=p.formData,O=p.currentCommunity,S=p.currentSpace,P=(0,s.wh)().isViewOnlyMasquerading;return O.is_private||null!==S&&void 0!==S&&S.is_private?(0,w.jsxs)("div",{children:[(0,w.jsx)(m.Lt.ItemLink,{disabled:P,onClick:function(){_({share_to_web:!x.post.share_to_web})},children:(0,w.jsx)(u.sI,{label:(0,i.t)("post.share.share_to_web"),tooltipText:(0,i.t)("post.share.share_to_web_on_description"),field:"share_to_web",value:x.post.share_to_web,variant:"small",disabled:P,className:o()({"cursor-not-allowed":P})})}),x.post.share_to_web&&(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)("div",{className:"flex flex-row items-center",children:(0,w.jsx)("div",{className:"mb-4 mt-1 flex-1 px-5",children:(0,w.jsx)(a.I,{disabled:!0,value:null===r||void 0===r?void 0:r.share_post_link,rightAddon:(0,w.jsx)("button",{type:"submit",onClick:function(){return g(null===r||void 0===r?void 0:r.share_post_link)},children:(0,w.jsx)(l.JO,{type:"20-copy"})})})})}),(0,w.jsx)(m.Lt.ItemLink,{onClick:function(){_({show_post_teaser:!x.post.show_post_teaser})},children:(0,w.jsx)(u.sI,{label:(0,i.t)("post.share.show_teaser"),tooltipText:(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)("p",{children:(0,i.t)("post.share.show_teaser_description_title")}),(0,w.jsx)("a",{href:"/settings#field-custom_cta_for_share_links",children:(0,i.t)("post.share.show_teaser_description_link")})]}),field:"show_post_teaser",value:x.post.show_post_teaser,variant:"small"})}),!(null!==O&&void 0!==O&&O.is_private)&&(0,w.jsx)(m.Lt.ItemLink,{onClick:function(){return _({minimal_layout:!x.post.minimal_layout})},children:(0,w.jsx)(u.sI,{label:(0,i.t)("post.share.minimal_layout"),tooltipText:(0,i.t)("post.share.minimal_layout_description"),field:"minimal_layout",value:x.post.minimal_layout,variant:"small"})})]})]}):(0,w.jsxs)("div",{className:"flex flex-row items-center px-4 py-2",children:[(0,w.jsxs)("div",{className:"flex flex-1 flex-col",children:[(0,w.jsx)(d.Z.LabelMd,{weight:"bold",children:(0,i.t)("post.share.share_to_web")}),(0,w.jsx)(d.Z.LabelSm,{children:(0,i.t)("post.share.post_is_public")})]}),(0,w.jsx)("div",{children:(0,w.jsx)(c.z,{variant:"secondary",onClick:function(){return g()},children:(0,i.t)("copy_link")})})]})},S=n(30658),P=function(e){var t=e.onChange,n=e.button,r=e.shouldRenderCustomMenuButton,a=e.menuButtonEl,c=void 0===a?"button":a,u=(0,S.m)({onChangeSharePost:t}),f=u.showShareOnWebOptions,p=u.post,v=u.getSharePostLink,h=u.sharePostData,b=(0,s.L2)().data,g=null!==n&&void 0!==n?n:(0,w.jsx)(l.JO,{type:"16-share",size:20});return f(b)?(0,w.jsx)(m.Lt,{size:"extra-large",direction:"bottom-end",menuButtonEl:c,className:"w-full",buttonClassName:o()("w-full focus-visible:outline-secondary focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-1",{"p-1 hover:bg-tertiary rounded group flex items-center":!r}),button:r?g:(0,w.jsx)(d.Z.LabelSm,{weight:"medium",color:"text-default group-hover:text-dark",children:(0,i.t)("post.share.title")}),children:(0,w.jsx)(O,{post:p,getSharePostLink:v,sharePostData:h})}):null}},40518:(e,t,n)=>{n.d(t,{s:()=>h});var r=n(24185),o=n(40160),i=n(86747),a=n(68375),s=n(49326),l=n(84702),c=n(53448),u=n(85893),d=["post","ariaLabel","allComments","forwardedRef","onClick","children"];function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){p(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function v(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var h=function(e){var t=e.post,n=e.ariaLabel,m=e.allComments,p=void 0!==m&&m,h=e.forwardedRef,b=e.onClick,g=e.children,y=v(e,d),_=(0,r.UO)().postSlug,j=(0,l.I)(),x=(0,c.UV)(),w=x.isInsideModal,O=x.onClose,S=(0,s.LM)({spaceSlug:t.space_slug,slug:t.slug,hash:p?i.Q:""});return j?(0,u.jsx)("a",f(f(f({href:S,target:"_blank",rel:"noreferrer","aria-label":n},y),h&&{ref:h}),{},{children:g})):(0,a.Sb)(t,{postSlugInUrl:_})?(0,u.jsx)("a",f(f(f({href:S,"aria-label":n},y),h&&{ref:h}),{},{children:g})):(0,u.jsx)(o.rU,f(f(f({to:S,"aria-label":n},y),h&&{ref:h}),{},{onClick:w?O:b,children:g}))}},39103:(e,t,n)=>{n.d(t,{D:()=>Q});var r=n(67294),o=n(94184),i=n.n(o),a=n(24185),s=n(31714),l=n(90195),c=n(95585),u=n(99338),d=n(83873),m=n(30658),f=n(97012),p=n(68375),v=n(28175),h=n(26953),b=n(95220),g=n(87863),y=n(96486),_=n(86013),j=n(49326),x=n(74238),w=n(37109),O=n(85893);function S(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return P(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return P(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function P(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var C=["image","file","embed","poll"],k=function(){var e=(0,m.m)(),t=e.isTiptapPost,n=e.post,o=(0,x.wC)().minimal_layout,i=S((0,r.useState)(null),2),s=i[0],l=i[1],c=n.tiptap_body,u=n.truncated_content,d=n.slug,f=n.space_slug,p=(0,a.TH)(),v=(0,a.k6)();(0,r.useEffect)((function(){if(t&&c&&c.body.content){var e=c.body.content,n=(0,y.replace)(u,/\n/g," "),r=g(e,n);l({type:"doc",content:r})}}),[t,c,u,l]);var h=function e(t,n){return(0,y.some)(t,(function(t){return!!n(t)||(r=t,!(!(0,y.has)(r,"content")||!(0,y.isArray)(r.content))&&e(t.content,n));var r}))},b=function(e){var t=null;return h(e,(function(e){return n=e,!!C.includes(n.type)&&(t=e,!0);var n})),t},g=function(e,t){var n=b(e),r=[];return t&&r.push({type:"paragraph",content:[{type:"text",text:t}]}),n&&r.push(n),r};return(0,O.jsxs)("div",{className:"flex w-full flex-col items-start justify-start gap-2",children:[(0,O.jsx)(w.R,{readOnly:!0,disableMentionClicks:o,sgidToObjectMap:c.sgids_to_object_map,inlineAttachments:c.inline_attachments,value:s,shouldRefetch:!0,className:"w-full"}),(0,O.jsx)("button",{type:"button",className:"text-default hover:text-dark text-base",onClick:function(){v.push({pathname:j.xu.show({slug:d,spaceSlug:f}),state:{prevLocation:p}})},children:(0,_.t)("see_more")})]})},I=n(66007),N=n(44130),A=n(29458),E=n(88044),T=function(){var e=(0,m.m)(),t=e.post,n=e.isTrixPost,r=e.isSharedPostWithTeaserLayout,o=e.isSharedPostViewWithMinimalLayout,i=t.body_trix_content,a=t.internal_custom_html,s=8;t.pinned_at_top_of_space?s=2:o&&r&&(s=4);var l=["help","help-en"].includes(t.community_slug)&&(0,p.hm)(t);return(0,O.jsxs)(N.X,{lines:s,children:[n&&i&&(0,O.jsx)(A.P,{content:i,contentParentPath:j.xu.show({slug:t.slug,spaceSlug:t.space_slug})}),a&&(0,O.jsx)(I.Z,{html:a},"internal_custom_html"),l&&(0,O.jsx)(E.e,{post:t})]})},D=function(e){var t=e.noPadding,n=void 0!==t&&t,o=(0,m.m)(),a=o.post,s=o.isTiptapPost,l=o.isPostBodyEmpty,c=a.tiptap_body,u=a.internal_custom_html,d=a.updated_at,f=a.truncated_content;return(0,r.useEffect)((function(){var e;u&&(0,y.isFunction)(null===(e=window)||void 0===e?void 0:e.loadOembed)&&window.loadOembed()}),[u,s,c,f]),l?null:(0,O.jsx)("div",{className:i()("post__body",{"!p-0":n,"px-5 pb-5 md:px-6":(0,p.Fr)(a)}),"data-testid":"post-body",children:(0,O.jsx)("div",{className:"post__inside trix-v2 w-full","data-testid":"post-body-inside",children:s&&c?(0,O.jsx)(k,{}):(0,O.jsx)(T,{})})},d)},R=n(81593),L=function(e){var t,n=e.children,r=(0,m.m)(),o=r.isImagePost,s=r.isPostBodyEmpty,l=r.isPostMetaHidden,c=r.isSharedPostWithTeaserLayout,u=(0,f.Zh)().usedIn,d=null===(t=(0,a.$B)("/home"))||void 0===t?void 0:t.isExact,p="full-post-modal"===u,v=s&&!d&&!l&&!o;return(0,O.jsx)("div",{className:i()("post__content text-dark",{"p-5 md:px-6":!o&&l,"px-5 pb-5 pt-4 md:px-6 md:py-5":!o&&!l,"pt-5":o&&!p&&l,"pt-4 md:pt-5":o&&!p&&!l,"py-5":o&&p,"!pb-0":o&&p&&!s,"pb-5":v,relative:c}),children:n})},M=n(71710),F=n(54528);function U(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function B(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?U(Object(n),!0).forEach((function(t){z(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):U(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function z(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function H(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return q(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return q(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function q(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Z=function(e){var t,n=e.autofocusReplyForm,o=void 0!==n&&n,y=e.className,_=e.defaultShowComment,j=void 0!==_&&_,x=e.hideAuthorHeadline,w=void 0!==x&&x,S=e.hideBookmarkButton,P=void 0!==S&&S,C=e.hidePinnedToTopIcon,k=void 0!==C&&C,I=e.hideShareLink,N=void 0!==I&&I,A=e.isRenderedOutsideTheSpace,E=void 0!==A&&A,T=e.metaInfoWrapperClassName,U=e.onPostChange,z=e.onPostDestroy,q=e.pageSupportsContentTruncation,Z=void 0===q||q,V=e.refetchPosts,W=e.shouldOpenCommentPage,Q=void 0!==W&&W,$=e.tagsLimit,G=void 0===$?3:$,J=e.tagsShowMoreLabelVariant,K=void 0===J?"numbers":J,Y=(0,r.useRef)(null),X=(0,f.Zh)(),ee=X.record,te=X.usedIn,ne=(0,m.m)(),re=ne.isPostBodyEmpty,oe=ne.showPostActions,ie=H((0,r.useState)(j),2),ae=ie[0],se=ie[1],le=H((0,r.useState)(o),2),ce=le[0],ue=le[1],de=(0,h.kK)(),me=ee.name,fe=ee.is_truncation_disabled,pe=ee.is_comments_enabled,ve=ee.flagged_for_approval_at,he=ee.hide_meta_info,be=ee.pinned_at_top_of_space,ge=ee.post_details_loaded,ye=ee.event_setting_attributes,_e=null===ye||void 0===ye?void 0:ye.live_stream_room_setting_attributes,je=null===_e||void 0===_e?void 0:_e.recording_url,xe=null===_e||void 0===_e?void 0:_e.recording_transcript_id,we=null===_e||void 0===_e?void 0:_e.recording_thumbnail,Oe=null===_e||void 0===_e?void 0:_e.auto_post_recording_enabled,Se=(0,v.I)().isV3Enabled,Pe=null===(t=(0,a.$B)("/c/:spaceSlug/:postSlug"))||void 0===t?void 0:t.isExact,Ce=(0,p.hm)(ee)&&Se&&!Pe,ke=!fe,Ie=(0,f.wh)(),Ne=Ie.currentUser,Ae=Ie.currentCommunitySettings,Ee=null===Ae||void 0===Ae?void 0:Ae.reactified_comments_enabled,Te=(0,m.m)(),De=Te.isSharedPostView,Re=Te.isSharedPostWithTeaserLayout,Le=Z&&ke||Re,Me=(0,p.Fr)(ee)||(0,p.hm)(ee),Fe="full-post-modal"===te,Ue=!oe&&"full-post-modal"===te&&he;if(!ee||!ee.id)return null;var Be=function(){setTimeout((function(){var e=document.querySelector('[input="comment-body-'.concat(ee.id,'"]'));e&&e instanceof HTMLElement&&(e.focus(),e.scrollIntoView({behavior:"smooth",block:"center"}))}),500)},ze=(0,r.useCallback)((function(){return(0,b.p)(Y.current)&&Y.current.focus()}),[Y]);(0,r.useEffect)((function(){ce&&ze()}),[ze]);var He=i()("post post--parent bg-primary border-primary mb-5 md:mb-6 rounded-none md:rounded-lg border first:mt-5 first:md:mt-0",{"post--shared":De,"post--shared__truncated":Re&&!Ne,"is-truncation-disabled":!Le,"flagged-for-approval":ve,"post-name--empty":!me,"post-meta--hidden":he,"is-pinned":be,"!shadow-none !rounded-none !border-0 !border-b":Fe},y),qe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};U(B(B({},ee),e),t)},Ze=(0,r.useCallback)((function(){var e,t;(se(!0),Ee)?(ue(!0),Y.current&&((0,b.p)(Y.current)?(0,b.p)(Y.current)&&Y.current.focus():null===(e=Y.current.commands)||void 0===e||null===(t=e.focus)||void 0===t||t.call(e,"end"))):Be()}),[Ee,Be]),Ve=(0,p.HZ)(ee);return(0,O.jsxs)("div",{className:He,children:[!k&&de&&Me&&(0,O.jsx)(d.c,{post:ee}),(0,O.jsx)(M.H,{post:ee}),(0,O.jsx)("div",{className:i()("post__post",{"!border-b":!Ne&&De&&Ve}),children:(0,O.jsxs)(L,{children:[(0,O.jsx)("div",{className:i()({"mb-5":!re,"px-5 md:px-6":(0,p.Fr)(ee),hidden:Ue}),children:(0,O.jsx)(F.m,{post:ee,isRenderedOutsideTheSpace:E,onChange:qe,refetchPosts:V,onPostDestroy:z,hideShareLink:N,hidePinnedToTopIcon:k,hideBookmarkButton:P,tagsLimit:de?1:G,tagsShowMoreLabelVariant:K,metaInfoWrapperClassName:T,hideAuthorHeadline:w})}),Ve&&(0,O.jsx)(l.Y,{onChange:qe,insidePost:!0}),je&&Oe&&(0,O.jsx)("div",{className:"px-6 py-4",children:(0,O.jsx)(g.T,{src:je,type:"video/mp4",mediaTranscriptId:xe,poster:we})}),(0,p.Fr)(ee)&&"full-post-modal"!==te&&(0,O.jsx)(s.l,{onPostChange:U,onPostDestroy:z}),Ce?(0,O.jsx)(D,{}):(0,O.jsx)(R.y,{enableTruncation:Le}),Re&&(0,O.jsx)("div",{className:"to-primary absolute bottom-0 left-0 z-10 h-1/2 w-full bg-gradient-to-b from-transparent"})]})}),(0,O.jsx)("div",{className:"mt-auto",children:(0,O.jsx)(u.S,{toggleComment:function(){ue(!1),se((function(e){return!e}))},showCommentAndFocusCommentForm:Ze,shouldOpenCommentPage:Q})}),ge&&pe&&ae&&(0,O.jsx)(c.o,{commentsFormRef:Y,autofocusReplyForm:ce})]})};function V(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function W(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Q=function(e){return(0,O.jsx)(Z,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?V(Object(n),!0).forEach((function(t){W(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):V(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e))}},30658:(e,t,n)=>{n.d(t,{m:()=>b});var r=n(88767),o=n(24185),i=n(34128),a=n(97012),s=n(98929),l=n(31889),c=n(68375),u=n(61345),d=n(84702),m=["record"];function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){v(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function h(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var b=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).onChangeSharePost,t=(0,o.UO)().postSlug,n=(0,d.I)(),f=(0,a.Zh)(),v=f.record,b=h(f,m),g=(0,a.wh)(),y=g.currentUser,_=g.currentCommunity,j=g.currentCommunityMember,x=c.Sb(v,{postSlugInUrl:t}),w=x&&v.minimal_layout,O=x&&v.show_post_teaser,S=!n&&c.GT(v,{currentUser:y,postSlugInUrl:t}),P=c.ou(v),C=c.sN(v),k=c.Vr(v),I=c.$2(v),N=c.KX(v),A=w,E=!y&&v.is_comments_enabled&&!v.is_comments_closed||O,T=E&&v.comments_count>5,D=E&&v.comments_count<=5,R=v.flagged_for_approval_at&&P,L=c.hm(v),M=c.HZ(v),F=c.Fr(v),U=c.s8(v),B=c.Iz(v),z=c.Vt(v),H=c.A8(v),q=!w&&(v.is_liking_enabled||v.is_comments_enabled),Z=w&&j,V=(0,r.useMutation)((function(e){var t=e.postId,n=e.body;return(0,i.aU)("/posts/".concat(t,"/share"),n)}),{onSuccess:function(t){e&&e(p(p({},v),t),{refetch:!1})}}),W=V.mutate,Q=V.data,$=V.isLoading;return p(p({post:v},b),{},{canManagePost:P,canDuplicatePost:k,canDestroyPost:I,canUpdatePost:C,canReportPost:N,isSharedPostView:x,showPostActions:S,showEngagementActions:q,showGatedCommentSection:E,showGatedCommentSectionAtTop:T,showGatedCommentSectionAtBottom:D,showModerationInActionsDropdown:R,isBasicPost:L,isEventPost:M,isImagePost:F,showSpaceName:A,isSharedPostViewWithMinimalLayout:w,isSharedPostWithTeaserLayout:O,isTiptapPost:U,isTrixPost:B,getSharePostLink:W,sharePostData:Q,isLoadingSharePostData:$,showShareOnWebOptions:function(e){return!x&&!n&&(0,c.Pu)(v,_,e)},shouldHideCommentsListForSpace:function(e){var t=e.space,n=(0,s.aF)(_)||j,r=(0,u.fL)(t)||(0,u.J$)(t)||(0,l.vb)(j);return!(n&&r)||w||O},isPostBodyEmpty:z,isPostMetaHidden:H,shouldShowLeaveCommentButton:Z})}},82487:(e,t,n)=>{n.d(t,{N:()=>$e});var r=n(94184),o=n.n(r),i=n(86013),a=n.n(i),s=n(97012),l=n(41457),c=n(17260),u=n(34974),d=n(93874),m=n(28772),f=n(25401),p=n(15130),v=n(7985),h=n(57956),b=n(26953),g=n(36843),y=n(15916),_=n(65289),j=n(16743),x=n(85893),w=function(e){var t=e.title,n=e.children,r=e.dataTestId;return(0,x.jsxs)("div",{className:"profile-drawer__about__section","data-testid":r,children:[t&&(0,x.jsx)("div",{className:"profile-drawer__about__heading",children:t}),n]})},O=function(e){var t=e.profileFields,n=t.visible,r=t.not_visible;return(0,x.jsxs)(w,{dataTestId:"profile-fields-section",children:[(0,x.jsx)(y.so,{fields:n}),(0,x.jsx)(y.so,{fields:r,isHidden:!0})]})},S=n(30887);function P(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function C(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?P(Object(n),!0).forEach((function(t){k(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):P(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function k(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var I=function(e){var t=e.iconType,n=e.iconProps,r=void 0===n?{}:n,o=e.info,i=e.dataTestId;return o?(0,x.jsxs)("div",{className:"profile-drawer__about__block whitespace-pre-line [word-break:break-word]","data-testid":i,children:[t?(0,x.jsx)(S.JO,C({useWithFillCurrentColor:!0,className:"text-dark",type:t},r)):null," ",(0,x.jsx)("p",{children:o})]}):null},N=n(29647),A=function(e){var t=e.link,n=e.iconType;return t?(0,x.jsx)(I,{iconType:n,info:(0,x.jsx)("a",{href:t,target:"_blank",rel:"noopener noreferrer",children:(0,N.B)(t)})}):null},E=function(e){var t,n=e.member,r=Object.prototype.hasOwnProperty.call(n,"email"),o=(0,y.aL)(),a=(0,y.R1)(),s=(0,h.rV)(),l=(0,v.V)(),c=(0,b.kK)(),u=null===(t=n.member_tags)||void 0===t?void 0:t.filter((function(e){var t;return(null===e||void 0===e?void 0:e.is_public)&&(null===e||void 0===e||null===(t=e.display_locations)||void 0===t?void 0:t.profile_page)})),S=(null===u||void 0===u?void 0:u.length)>0;return(0,x.jsxs)("div",{className:"profile-drawer__about",children:[!o&&n.bio&&(0,x.jsx)(w,{title:(0,i.t)("profile_drawer.biography"),children:(0,x.jsx)(I,{info:n.bio})}),(0,x.jsxs)(w,{dataTestId:"profile-info-section",children:[!l&&r&&(0,x.jsx)(I,{iconType:"at-symbol",info:n.email,dataTestId:"profile-member-email"}),!o&&(0,x.jsx)(I,{iconType:"map-pin",iconProps:{viewBox:"0 0 14 18"},info:n.location}),(0,x.jsx)(I,{iconType:"calendar",info:(0,i.t)("profile_drawer.member_since",{member_since:(0,m.ie)(n.created_at,{month:"long",year:"numeric",day:"numeric"})}),dataTestId:"profile-member-since"}),Boolean(n.last_seen_at)&&(0,x.jsx)(I,{iconType:"16-clock",info:(0,i.t)("profile_drawer.last_seen",{last_seen:(0,f.TF)(n.last_seen_at)}),iconProps:{viewBox:"0 0 18 18",className:"text-dark ml-0.5 mt-0.5"}})]}),s&&(0,x.jsx)(w,{children:(0,x.jsxs)("div",{className:"flex flex-col gap-y-3",children:[(0,x.jsx)(j.Z.LabelSm,{weight:"semibold",children:(0,i.t)("activity_score.activity_score_title")}),(0,x.jsx)(g.XR,{ids:[n.id],children:(0,x.jsx)(d.z4,{memberId:n.id})})]})}),S&&!c&&(0,x.jsx)(w,{title:(0,i.t)("profile_drawer.tags"),children:(0,x.jsx)("div",{className:"profile-drawer__about__tags",children:(0,x.jsx)(_.m,{limit:1/0,memberTags:u})})}),a&&(0,x.jsx)(w,{title:(0,i.t)("profile_fields.upgrade_flow.title"),children:(0,x.jsx)(y.IA,{})}),o&&(0,x.jsx)(O,{profileFields:n.profile_fields}),!o&&(0,p.sR)(n)&&(0,x.jsxs)(w,{title:(0,i.t)("profile_drawer.social"),children:[(0,x.jsx)(A,{iconType:"globe",link:n.website_url}),(0,x.jsx)(A,{iconType:"facebook",link:n.facebook_url}),(0,x.jsx)(A,{iconType:"twitter",link:n.twitter_url}),(0,x.jsx)(A,{iconType:"linkedin",link:n.linkedin_url}),(0,x.jsx)(A,{iconType:"instagram",link:n.instagram_url})]})]})},T=function(){return(0,x.jsx)("div",{className:"p-6",children:(0,x.jsx)(j.Z.LabelSm,{children:(0,i.t)("something_went_wrong")})})};function D(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function R(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?D(Object(n),!0).forEach((function(t){L(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function L(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var M=function(e){return(0,x.jsx)(u.S,{renderFunc:T,children:(0,x.jsx)(E,R({},e))})},F=n(58533),U=n(86078),B=n(67294),z=n(96486),H=n(88767),q=n(34128),Z=n(49326);function V(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function W(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?V(Object(n),!0).forEach((function(t){Q(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):V(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Q(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var $=function(e){var t=e.memberPublicId,n=e.params,r=void 0===n?{per_page:10}:n,o=["profile-comments",t],i=(0,H.useInfiniteQuery)(o,(function(e){var n,o=e.pageParam;return n=void 0===o?1:o,(0,q.UT)(Z.av.profile.comments({memberPublicId:t,params:W({page:n},r)}))}),{getNextPageParam:function(e){return e.has_next_page?e.page+1:void 0}}),a=(0,B.useMemo)((function(){return i.isLoading?[]:(0,z.uniqBy)((0,z.flatten)(i.data.pages.map((function(e){return e.records}))),"id")}),[i.data]);return W(W({},i),{},{comments:a})};function G(e){var t=e.title,n=e.subtitle;return(0,x.jsxs)("div",{className:"profile-drawer__empty",children:[(0,x.jsx)("div",{className:"profile-drawer__empty__title",children:t}),(0,x.jsx)("div",{className:"profile-drawer__empty__subtitle",children:n})]})}var J=n(40160),K=n(71542),Y=n(95071),X=n(68375),ee=n(87958),te=n(38870),ne=n(29458);function re(e){var t=e.comment,n=e.onClose,r=e.member,a=e.shouldOpenInNewTab,l="tiptap"===t.editor,c=(0,s.wh)().currentCommunitySettings,u=null===c||void 0===c?void 0:c.tailwind_posts_enabled;return(0,x.jsx)(J.rU,{to:(0,Z.LM)({slug:t.post_slug,spaceSlug:t.space_slug})+"#comment_wrapper_".concat(t.id),onClick:function(e){return!(0,Y.n2)(e)&&n()},className:"profile-comments__item bg-primary focus-visible:outline-secondary hover:outline-secondary flex items-start p-5 transition-colors duration-150 md:px-6",target:a&&"_blank",children:(0,x.jsxs)("div",{className:"profile-comments__content text-darkest flex w-full flex-col space-y-3 text-base",children:[(0,x.jsxs)("div",{className:"profile-comments__meta text-default flex flex-row space-x-3 text-sm font-normal",children:[!u&&(0,x.jsx)(te.s,{name:r.name,src:r.avatar_url,size:"10"}),(0,x.jsx)("div",{className:o()({"space-x-2":u}),children:u?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)("span",{className:"profile-comments__post-name text-default break-all",children:[(0,i.t)("profile_drawer.comments.commented_on")," ",(0,x.jsx)("span",{className:"text-dark font-medium",children:t.post_name||(0,z.unescape)(t.post_truncated_content)})]}),(0,x.jsx)("span",{className:"bg-badge inline-block h-1 w-1 rounded-full align-middle"}),(0,x.jsx)(ee.T,{interactive:!1,content:(0,X.s4)(t.created_at),className:"inline-flex",children:(0,x.jsx)("span",{children:(0,f.TF)(t.created_at,{format:f.lc.short})})})]}):(0,x.jsxs)(x.Fragment,{children:[(0,i.t)("profile_drawer.comments.commented_on"),(0,x.jsx)("span",{className:"profile-comments__post-name text-darkest mx-1",children:t.post_name||(0,z.unescape)(t.post_truncated_content)}),(0,x.jsx)("div",{children:(0,f._z)(new Date(t.created_at))})]})})]}),l?(0,x.jsx)(K.G,{tiptapBody:t.tiptap_body},t.updated_at):(0,x.jsx)(ne.P,{content:t.body_trix_content})]})})}var oe=function(e){var t=e.memberPublicId,n=e.member,r=e.onClose,o=e.shouldOpenInNewTab,i=e.scrollableTarget,s=void 0===i?"panel":i,l=$({memberPublicId:t}),c=l.fetchNextPage,u=l.comments,d=l.hasNextPage;return l.isLoading?(0,x.jsx)(U.m,{}):u.length<1?(0,x.jsx)(G,{title:a().t("profile_drawer.comments.empty_state.title"),subtitle:a().t("profile_drawer.comments.empty_state.subtitle")}):(0,x.jsx)("div",{className:"profile-comments bg-tertiary h-full overflow-auto",id:"profile-comments-scrollable-target",children:(0,x.jsx)(F.Z,{scrollThreshold:.5,next:c,hasMore:!!d,loader:(0,x.jsx)(U.m,{}),dataLength:u.length,scrollableTarget:s||"profile-comments-scrollable-target",className:"flex flex-col space-y-2",children:u.map((function(e){return(0,x.jsx)(re,{onClose:r,comment:e,member:n,shouldOpenInNewTab:o},e.id)}))})})},ie=n(18485),ae=n(92452),se=n(98175),le=n(64687),ce=n.n(le),ue=n(31023);function de(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}function me(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function fe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?me(Object(n),!0).forEach((function(t){pe(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):me(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function pe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ve=function(e){var t=e.memberPublicId,n=e.params,r=void 0===n?{per_page:10}:n,o=["profile-posts",t],i=(0,ue.d)().findAndReplaceRecord,a=(0,H.useQueryClient)(),s=function(){var e,t=(e=ce().mark((function e(t){var n;return ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.fetchQuery(Z.av.posts.show({spaceId:t.space_id,postSlug:t.slug}));case 2:return n=e.sent,e.abrupt("return",i(n,o));case 4:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){de(i,r,o,a,s,"next",e)}function s(e){de(i,r,o,a,s,"throw",e)}a(void 0)}))});return function(e){return t.apply(this,arguments)}}(),l=(0,H.useInfiniteQuery)(o,(function(e){var n,o=e.pageParam;return n=void 0===o?1:o,(0,q.UT)(Z.av.profile.posts({memberPublicId:t,params:fe({page:n},r)}))}),{getNextPageParam:function(e){return e.has_next_page?e.page+1:void 0}}),c=(0,B.useMemo)((function(){return l.isLoading?[]:(0,z.uniqBy)((0,z.flatten)(l.data.pages.map((function(e){return e.records}))),"id")}),[l.data]);return fe(fe({},l),{},{onPostChange:s,posts:c})},he=function(e){var t=e.memberPublicId,n=e.shouldOpenInNewTab,r=e.scrollableTarget,o=void 0===r?"panel":r,a=ve({memberPublicId:t}),l=a.fetchNextPage,c=a.posts,u=a.data,d=a.hasNextPage,m=a.isLoading,f=a.onPostChange,p=(0,s.wh)().currentCommunitySettings,v=(null===p||void 0===p?void 0:p.tailwind_posts_enabled)?ae.Y:ie.Y;if(m)return(0,x.jsx)(U.m,{});if(c.length<1)return(0,x.jsx)(G,{title:(0,i.t)("profile_drawer.posts.empty_state.title"),subtitle:(0,i.t)("profile_drawer.posts.empty_state.subtitle")});var h=null===u||void 0===u?void 0:u.pages.map((function(e){return e.records.map((function(e){return e.id}))}));return(0,x.jsx)(se._x,{perPagePostIds:h,children:(0,x.jsx)("div",{className:"profile-posts bg-tertiary h-full overflow-auto",id:"profile-posts-scrollable-target",children:(0,x.jsx)(F.Z,{style:{overflow:"initial"},scrollThreshold:.5,next:l,hasMore:!!d,loader:(0,x.jsx)(U.m,{}),dataLength:c.length,scrollableTarget:o||"profile-posts-scrollable-target",className:"space-y-2",children:c.map((function(e){return(0,x.jsx)(s.mE,{spaceId:e.space_id,children:(0,x.jsx)(v,{forceSimplifiedView:!0,onPostChange:f,post:e,shouldOpenInNewTab:n},e.id)},e.id)}))})})})},be=n(67142),ge=n(83216),ye=n(30414),_e=function(e){var t=e.member,n=function(e){return e.is_deleted?(0,i.t)("deactivated"):e.admin?(0,i.t)("admin"):e.moderator?(0,i.t)("moderator"):null}(t);return n?(0,x.jsx)("div",{className:o()("absolute bottom-[-6px] z-[2] m-0 inline-block select-none overflow-hidden rounded-2xl bg-clip-padding px-2 py-[2px] text-[9px] font-bold uppercase text-white",{"bg-[#ef4444]":t.is_deleted,"bg-brand":!t.is_deleted}),children:n}):null},je=n(20640),xe=n.n(je),we=n(21809),Oe=function(e){var t=e.member.public_uid,n=(0,we.p)().success,r=(0,Z.zd)({public_uid:t});return(0,x.jsx)(ee.T,{placement:"bottom",content:(0,i.t)("post.share.copy_link_to_profile"),interactive:!1,children:(0,x.jsx)("div",{children:(0,x.jsx)("a",{href:r,onClick:function(e){e.preventDefault(),xe()(window.location.origin+r),n((0,i.t)("post.share.link_copied"),{duration:"short",shouldUseProgress:!1})},className:"!text-dark focus-visible:!outline-secondary border-secondary bg-primary hover:bg-tertiary disabled:border-hover disabled:bg-primary disabled:text-light block rounded-md border px-[18px] py-[6px] text-sm font-medium leading-5 transition-colors duration-150 focus-visible:!outline focus-visible:!outline-2 focus-visible:!outline-offset-2 disabled:cursor-not-allowed","data-testid":"copy-link-profile",title:(0,i.t)("post.share.copy_link_to_profile"),children:(0,x.jsx)(S.JO,{type:"link",size:16,useWithFillCurrentColor:!0})})})})},Se=n(55675),Pe=function(e){var t=e.toggleDrawer,n=e.isFullPageProfile,r=e.memberId;return(0,x.jsx)(ee.T,{placement:"bottom",content:(0,i.t)("post.share.edit_profile"),interactive:!1,children:(0,x.jsx)(Se.z,{variant:"secondary",onClick:function(){n?window.location.href=Z.bf.edit({memberId:r}):t()},"aria-label":(0,i.t)("post.share.edit_profile"),children:(0,x.jsx)(S.JO,{type:"pencil",useWithFillCurrentColor:!0,size:16,"aria-hidden":!0})})})},Ce=n(24185),ke=n(59393),Ie=n(84495),Ne=n(68990);function Ae(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}var Ee=function(e){var t=e.member,n=e.onClose,r=e.isFullPageProfile,a=void 0!==r&&r,s=e.shouldHideMessageButton,l=void 0!==s&&s,c=(0,Ie.pB)().findOrCreateChatRoom,u=(0,Ce.k6)(),d=(0,Ne.w)({memberPublicId:t.public_id,member:t,isFullPageProfile:a,shouldHideMessageButton:l}),m=d.shouldShowEditProfileButton,f=d.onClickOpenEditProfileDrawer,v=d.handleCopyProfileLink,h=d.shouldShowMemberChatIcon,b=function(){var e,t=(e=ce().mark((function e(t){var r;return ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c({kind:ke.g8,community_member_ids:[t]});case 2:r=e.sent,u.push((0,Z.co)({url:(0,Z.so)({uuid:r})})),n();case 5:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){Ae(i,r,o,a,s,"next",e)}function s(e){Ae(i,r,o,a,s,"throw",e)}a(void 0)}))});return function(e){return t.apply(this,arguments)}}();return(0,x.jsxs)("div",{className:"flex flex-col items-center justify-center gap-4 p-6",children:[(0,x.jsx)(te.s,{name:null===t||void 0===t?void 0:t.name,size:"16",src:null===t||void 0===t?void 0:t.avatar_url}),(0,x.jsxs)("div",{children:[(0,x.jsx)(j.Z.TitleSm,{weight:"font-bold",textAlign:"text-center",children:null===t||void 0===t?void 0:t.name}),(0,x.jsx)(j.Z.BodySm,{textAlign:"text-center",children:null===t||void 0===t?void 0:t.headline})]}),(0,p.cT)(t)&&(0,x.jsx)(_.m,{limit:1/0,memberTags:t.member_tags}),h&&(0,x.jsx)(Se.z,{full:!0,variant:"circle",onClick:function(){return b(t.id)},children:(0,i.t)("message")}),a&&(0,x.jsxs)("div",{className:o()("grid gap-2",{"grid-cols-2":m}),children:[(0,x.jsx)(Se.z,{full:!0,variant:"secondary-light",onClick:v,children:(0,i.t)("profile_drawer.dropdown.copy_profile_link")}),m&&(0,x.jsx)(Se.z,{full:!0,variant:"secondary-light",onClick:f,children:(0,i.t)("profile_drawer.dropdown.edit_member_profile")})]})]})},Te=n(83749),De=function(e){var t=e.member;return(0,x.jsx)(ee.T,{placement:"bottom",content:(0,i.t)("post.share.view_as",{member_first_name:t.first_name}),interactive:!1,children:(0,x.jsx)(Se.z,{variant:"secondary",onClick:function(){return(0,Te.g)({entityId:t.id,entityType:"CommunityMember"}).then((function(e){return window.open(e.masquerade_url,"_self")})).catch((function(e){return console.error(e)}))},"aria-label":(0,i.t)("post.share.view_as",{member_first_name:t.first_name}),"data-testid":"view-as-masquerade",children:(0,x.jsx)(S.JO,{type:"16-eye-open",size:16,useWithStrokeCurrentColor:!0,"aria-hidden":!0})})})},Re=function(e){var t=e.member,n=e.onClose,r=e.isFullPageProfile,o=e.shouldHideMessageButton,i=e.shouldOpenInNewTab,a=(0,b.kK)(),s=(0,Ne.w)({memberPublicId:t.public_id,member:t,isFullPageProfile:r,shouldHideMessageButton:o}),l=s.shouldShowEditProfileButton,c=s.onClickOpenEditProfileDrawer,u=s.shouldShowMemberChatIcon,d=s.canEditProfile,m=s.canViewOnlyMasquerade;return a?(0,x.jsx)(Ee,{member:t,onClose:n,shouldHideMessageButton:o,isFullPageProfile:r}):(0,x.jsxs)("div",{className:"profile-drawer__header",children:[(0,x.jsxs)("div",{className:"relative",children:[(0,x.jsx)(be.gs,{size:"24",src:t.avatar_url,status:t.status,name:t.name}),(0,x.jsx)("div",{className:"absolute bottom-0 flex w-full justify-center",children:(0,x.jsx)(_e,{member:t})})]}),(0,x.jsxs)("div",{className:"profile-drawer__header__info",children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("h3",{className:"profile-drawer__header__name",children:t.name}),(0,x.jsx)("div",{className:"profile-drawer__header__headline",children:t.headline})]}),(0,x.jsx)(ye.T,{children:(0,x.jsxs)("div",{className:"profile-drawer__header__actions",children:[u&&(0,x.jsx)(ge.k,{communityMemberId:t.id,onClick:n,shouldOpenInNewTab:i,variant:m?"icon":"button"}),r?d&&(0,x.jsx)(Pe,{toggleDrawer:c,memberId:t.public_id}):(0,x.jsx)(Oe,{member:t}),m&&(0,x.jsx)(De,{member:t}),l&&(0,x.jsx)(Pe,{toggleDrawer:c,memberId:t.public_id})]})})]})]})};function Le(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Me(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Le(Object(n),!0).forEach((function(t){Fe(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Le(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Fe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ue=function(e){var t=e.memberPublicId,n=e.params,r=void 0===n?{per_page:12}:n,o=["PROFILE_SPACES",t,r],i=(0,H.useInfiniteQuery)(o,(function(e){var n,o=e.pageParam;return n=void 0===o?1:o,(0,q.UT)(Z.av.profile.spaces({memberPublicId:t,params:Me({page:n},r)}))}),{getNextPageParam:function(e){return e.has_next_page?e.page+1:void 0}}),a=(0,B.useMemo)((function(){return i.isLoading?[]:(0,z.uniqBy)((0,z.flatten)(i.data.pages.map((function(e){return e.spaces}))),"id")}),[i.data]);return Me(Me({},i),{},{spaces:a})},Be=n(74238),ze=n(2194),He=n(31889),qe=n(15218),Ze=function(e){var t=e.onClose,n=e.space,r=n.emoji,o=n.custom_emoji_url,a=n.custom_emoji_dark_url,l=n.hide_members_count,c=n.name,u=n.slug,d=n.member_count,m=n.is_private,f=n.show_lock_icon_for_non_members,p=n.is_space_member,v=e.shouldOpenInNewTab,h=(0,Be.TC)().currentAppearance,b=(0,s.wh)().currentCommunityMember,g=(0,He.vb)(b),y=(0,ze.$)({shouldShowLockIconForNonMembers:f&&!p,isPrivate:m,isAdmin:g});return(0,x.jsxs)(J.rU,{to:(0,Z._v)({spaceSlug:u}),onClick:function(e){return!(0,Y.n2)(e)&&t()},className:"profile-spaces__item",target:v&&"_blank",children:[(0,x.jsx)(qe.S,{wrapperClassName:"profile-spaces__emoji self-start",className:"gated-or-not with-emoji",emoji:r,customEmojiUrl:o,customEmojiDarkUrl:a,appearance:h,shouldUseLockIcon:y,lockIcon:(0,x.jsx)("span",{className:"gated-or-not",children:(0,x.jsx)(S.JO,{type:"lock",useWithFillCurrentColor:!0,className:"text-dark"})})}),(0,x.jsxs)("div",{className:"profile-spaces__details",children:[(0,x.jsx)("p",{className:"profile-spaces__title",children:c}),!l&&(0,x.jsx)("p",{className:"profile-spaces__members",children:(0,i.t)("profiles.members",{count:d})})]})]})},Ve=function(e){var t=e.memberPublicId,n=e.onClose,r=e.shouldOpenInNewTab,o=e.scrollableTarget,i=void 0===o?"panel":o,a=Ue({memberPublicId:t}),s=a.spaces,l=a.isLoading,c=a.fetchNextPage,u=a.hasNextPage;return l?(0,x.jsx)(U.m,{}):s.length<1?(0,x.jsx)(G,{title:I18n.t("profile_drawer.spaces.empty_state.title"),subtitle:I18n.t("profile_drawer.spaces.empty_state.subtitle")}):(0,x.jsx)("div",{className:"h-full overflow-auto",id:"profile-spaces-scrollable-target",children:(0,x.jsx)(F.Z,{scrollThreshold:.5,next:c,hasMore:u,loader:(0,x.jsx)(U.m,{}),dataLength:s.length,className:"profile-spaces",scrollableTarget:i||"profile-spaces-scrollable-target",children:s.map((function(e){return(0,x.jsx)(Ze,{onClose:n,space:e,shouldOpenInNewTab:r},e.id)}))})})},We={ABOUT:(0,i.t)("profile_tabs.about"),POSTS:(0,i.t)("profile_tabs.posts"),COMMENTS:(0,i.t)("profile_tabs.comments"),SPACES:(0,i.t)("profile_tabs.spaces")},Qe=Object.values(We).map((function(e){return{label:e}})),$e=function(e){var t=e.member,n=e.onClose,r=e.memberPublicId,i=e.isFullPageProfile,a=e.shouldOpenInNewTab,u=void 0!==a&&a,d=e.shouldHideMessageButton,m=void 0!==d&&d,f=e.shouldHideBadge,p=void 0!==f&&f,v=e.isRenderedOnRailBar,h=void 0!==v&&v,b=e.shouldFixTabsOnTop,g=void 0!==b&&b,y=t.comments_count,_=t.posts_count,j=t.spaces_count,w=(0,s.wh)().currentCommunitySettings,O=null===w||void 0===w?void 0:w.tailwind_posts_enabled,S=p?Qe:[{label:We.ABOUT},{label:We.POSTS,badge:{value:_}},{label:We.COMMENTS,badge:{value:y}},{label:We.SPACES,badge:{value:j}}],P=i?"panel":null;return(0,x.jsx)("div",{className:o()({"profile-full-page":i,"profile-drawer trix-v2":!i,"flex h-full":t.is_deleted}),children:t.is_deleted?(0,x.jsx)(l.d8,{}):(0,x.jsxs)(c.O.Group,{className:o()("flex  flex-col !overflow-hidden",{"!h-[calc(100vh-50px)] md:!h-[calc(100vh-60px)]":!i&&!h,"!h-[calc(100dvh-24px)] md:!h-[calc(100vh-2.5rem-64px)]":h&&!i}),children:[(0,x.jsxs)("div",{className:o()({"sticky top-0 z-30":g}),children:[(0,x.jsx)(Re,{member:t,onClose:n,isFullPageProfile:i,shouldHideMessageButton:m,shouldOpenInNewTab:u}),(0,x.jsx)("div",{className:"border-primary bg-primary border-b px-6",children:(0,x.jsx)(c.O.List,{children:Object.values(S).map((function(e){return(0,x.jsxs)(c.O,{className:"text-sm",children:[e.label,(0,x.jsx)(c.O.Counter,{children:e.badge&&e.badge.value>0&&e.badge.value})]},e.label)}))})})]}),(0,x.jsxs)(c.O.Panels,{className:o()({"h-full grow":!i,"post-v2":!O}),children:[(0,x.jsx)(c.O.Panel,{children:(0,x.jsx)(M,{member:t})}),(0,x.jsx)(c.O.Panel,{children:(0,x.jsx)(he,{memberPublicId:r,onClose:n,shouldOpenInNewTab:u,scrollableTarget:P})}),(0,x.jsx)(c.O.Panel,{children:(0,x.jsx)(oe,{memberPublicId:r,member:t,onClose:n,shouldOpenInNewTab:u,scrollableTarget:P})}),(0,x.jsx)(c.O.Panel,{children:(0,x.jsx)(Ve,{memberPublicId:r,onClose:n,shouldOpenInNewTab:u,scrollableTarget:P})})]})]})})};$e.displayName="Profile"},68990:(e,t,n)=>{n.d(t,{w:()=>u});var r=n(20640),o=n.n(r),i=n(86013),a=n(97012),s=n(49326),l=n(48656),c=n(21809),u=function(e){var t=e.member,n=e.memberPublicId,r=e.isFullPageProfile,u=void 0!==r&&r,d=e.shouldHideMessageButton,m=void 0!==d&&d,f=(0,c.p)().success,p=(0,s.zd)({public_uid:n}),v=(0,l.H)(),h=v.showOwnProfileEdit,b=v.showMemberProfileEdit,g=(0,a.wh)(),y=g.currentCommunityMember,_=g.currentCommunitySettings,j=(null===y||void 0===y?void 0:y.id)==(null===t||void 0===t?void 0:t.id),x=null===y||void 0===y?void 0:y.is_admin;return{shouldShowEditProfileButton:!u&&!(null!==t&&void 0!==t&&t.is_deleted)&&_.account_profile_drawer_enabled&&(j||x),onClickOpenEditProfileDrawer:function(){x?b({member:t}):j&&h()},handleCopyProfileLink:function(){o()(window.location.origin+p),f((0,i.t)("post.share.link_copied"),{duration:"short",shouldUseProgress:!1})},shouldShowMemberChatIcon:!m&&!(null!==t&&void 0!==t&&t.is_deleted)&&!j&&(null===y||void 0===y?void 0:y.messaging_enabled)&&(t.messaging_enabled||x&&!t.admin),canEditProfile:!(null!==t&&void 0!==t&&t.is_deleted)&&x,canViewOnlyMasquerade:x&&(null===y||void 0===y?void 0:y.id)!==t.id}}},67685:(e,t,n)=>{n.d(t,{M:()=>v});var r=n(67294),o=n(31736),i=n(96486),a=n(8804),s=n.n(a),l=n(22404),c=n(15953),u=n(30887),d=n(55675),m=n(85893);function f(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return p(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return p(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var v=function(e){var t=e.value,n=e.datePickerVisible,a=e.onCancel,p=e.onSave,v=e.children,h=e.className,b=e.minDate,g=void 0===b?new Date:b,y=e.placement,_=void 0===y?"top-end":y,j=e.saveButtonVariant,x=void 0===j?"primary":j,w=e.onClickOutside,O=void 0===w?i.noop:w,S=e.cancelButtonText,P=void 0===S?I18n.t("quick_post.scheduled_post_ui.cancel"):S,C=f((0,r.useState)(t),2),k=C[0],I=C[1];return(0,m.jsx)(o.ZP,{placement:_,className:h,onClickOutside:O,content:(0,m.jsxs)("div",{className:"bg-primary border-primary rounded-lg border shadow-xl",style:{maxWidth:"284px"},children:[(0,m.jsx)(c.Z,{options:{enableTime:!0,dateFormat:"F d, Y G:i K",disableMobile:"true",inline:!0,altInput:!0,altInputClass:"hidden",minDate:g,animate:!1,prevArrow:(0,l.renderToString)((0,m.jsx)(u.JO,{type:"20-chevron-left",size:20})),nextArrow:(0,l.renderToString)((0,m.jsx)(u.JO,{type:"20-chevron-right",size:20})),minuteIncrement:1},value:t,onValueUpdate:function(e){s()(e)&&I(e[0].toISOString())}}),(0,m.jsxs)("div",{className:"border-primary flex gap-3 border-t px-5 py-3",children:[(0,m.jsx)(d.z,{type:"button",variant:"secondary",onClick:a,full:!0,children:P}),(0,m.jsx)(d.z,{type:"button",variant:x,disabled:!k,onClick:function(e){e&&e.preventDefault(),p(k)},full:!0,children:I18n.t("quick_post.scheduled_post_ui.save")})]})]}),visible:n,allowHTML:!0,interactive:!0,duration:0,arrow:!1,delay:0,theme:"modal-footer-actions",appendTo:"parent",children:(0,m.jsx)("div",{children:v})})}},94812:(e,t,n)=>{n.d(t,{Y:()=>xe});var r=n(64687),o=n.n(r),i=n(86013),a=n(96486),s=n(24185),l=n(1320),c=n(59393),u=n(68375),d=n(22972),m=n(97012),f=n(61926),p=n(5295),v=n(21809),h=n(67294),b=n(87536),g=n(55675),y=n(85893),_=function(e){var t=e.submitDisabled,n=e.post,r=e.isSubmitting,o=!!n.id,a=["quick_post","scheduled_post_ui"];a.push(r?"submitting_button":"submit_button"),n.status!==u.lv?a.push("publish_post"):a.push(o?"save":"post");var s=(0,i.t)(a.join("."));return(0,y.jsx)(g.z,{type:"submit",variant:"primary",disabled:t,children:s})},j=n(61345),x=n(26953),w=n(94184),O=n.n(w),S=n(67685),P=n(63099),C=n(48895),k=n(30887),I=n(47402);function N(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return A(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return A(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function A(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var E=function(e){var t=e.publishedAt,n=e.updatePublishedAt,r=e.status,o=e.revertToDraftState,i=N((0,P.k)(!1),3),a=i[0],s=i[1],l=i[2],c=(0,h.useMemo)((function(){return t?(0,C.w)({dateTime:new Date(t),format:"date_time_with_short_timezone"}):null}),[t]);if(r!==u.W3)return null;return(0,y.jsx)(S.M,{value:t,datePickerVisible:a,onCancel:function(){event&&event.preventDefault(),l(!1)},onSave:function(e){n(e),l(!1)},children:(0,y.jsx)(I.C,{onButtonClick:function(e){e&&e.preventDefault(),s()},onClick:function(e){e&&e.preventDefault(),o(),l(!1)},children:(0,y.jsxs)("span",{className:"flex items-center gap-1.5",children:[(0,y.jsx)(k.JO,{type:"16-calendar",className:"text-default",size:16}),(0,y.jsx)("span",{className:"font-medium",children:c})]})})})},T=n(83088);function D(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return R(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return R(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function R(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var L=function(e){var t=e.submitDisabled,n=void 0!==t&&t,r=e.isSubmitting,o=void 0!==r&&r,s=e.datepickerPlacement,l=void 0===s?"top":s,c=function(e){var t=["quick_post","scheduled_post_ui"];return t.push(o?"submitting_button":"submit_button"),t.push(e),(0,i.t)(t.join("."))},u={icon:"16-download",label:c("save_draft"),value:"draft"},d={icon:"16-calendar",label:c("schedule_post"),value:"scheduled"},m={icon:"16-publish",label:c("publish_post"),value:"published"},f=[u,d,m],p=(0,b.Gc)(),v=p.watch,h=p.setValue,g=v(),_=g.published_at,j=g.status,x=D((0,P.k)(!1),3),w=x[0],C=x[2],k=(0,a.find)(f,{value:j}),I=function(e){h("published_at",e)},N=function(e){(null===e||void 0===e?void 0:e.value)===d.value?C(!0):(h("status",null===e||void 0===e?void 0:e.value),C(!1),I(null))},A=function(){N(u)};return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(E,{publishedAt:_,updatePublishedAt:I,status:j,revertToDraftState:A}),(0,y.jsx)(S.M,{datePickerVisible:w,onCancel:function(e){e&&e.preventDefault(),C(!1),j===d.value&&A()},value:_,onSave:function(e){I(e),h("status",d.value),C(!1)},className:O()({"-bottom-11":"top"===l,"-top-7":"bottom"===l}),children:w?(0,y.jsx)("span",{}):(0,y.jsx)(T.F,{type:"submit",disabled:n,selectedAction:k,setSelectedAction:N,options:f})})]})},M=function(e){var t=e.post,n=e.space,r=e.submitDisabled,o=e.isSubmitting,i=e.datepickerPlacement,a=!(0,x.Fs)()&&n&&(0,j.k8)(n)&&!(0,u.Hz)(t);return(0,y.jsx)(y.Fragment,{children:a?(0,y.jsx)(L,{submitDisabled:r,isSubmitting:o,datepickerPlacement:i}):(0,y.jsx)(_,{post:t,submitDisabled:r,isSubmitting:o})})},F=n(99834),U=n(39465),B=n(59492),z=n(66154),H=n(71570),q=n(43548),Z=n(38682),V=n(71299),W=n(61989),Q=n(18009),$=function(e){var t=e.space,n=e.showAddCoverBtn,r=(0,(0,b.Gc)().watch)("id")?void 0:(0,Q.k)();return(0,y.jsxs)("div",{className:"quickpost-modal__post-form",children:[(0,u.J4)(t)&&(0,y.jsx)("div",{className:"quickpost-modal__cover-image-container",children:(0,y.jsx)(V.D,{name:"cover_image",alt:"",showAddCoverBtn:n})}),(0,u.tp)(t)&&(0,y.jsx)("div",{className:"form-section__title-input",children:(0,y.jsx)(Z.D,{ref:r,name:"name",autoComplete:"title",placeholder:(0,i.t)("quick_post_v2.title_placeholder"),maxLength:"255",size:"255",type:"text",id:"post_name",tabIndex:0})}),(0,y.jsx)("div",{className:"trix-content trix-content--post",children:(0,y.jsx)(W.O,{ref:(0,u.tp)(t)?void 0:r,preventAccidentalLeave:!1,id:"post_body",name:"body",is_private_space:!1,space_id:t&&t.id,placeholder:(0,i.t)("quick_post_v2.body_placeholder"),tabIndex:0})})]})},G=n(30658),J=n(31889),K=n(24113),Y=n(71316),X=n(10029),ee=n(74442);function te(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ne(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?te(Object(n),!0).forEach((function(t){re(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):te(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function re(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var oe=(0,h.forwardRef)((function(e,t){return(0,y.jsx)("textarea",ne(ne({},e),{},{ref:t}))}));oe.displayName="TextArea";var ie=(0,h.forwardRef)((function(e,t){return(0,y.jsx)("input",ne(ne({},e),{},{ref:t}))}));ie.displayName="Input";var ae=function(e){var t=e.name,n=e.variant,r=void 0===n?"":n,o=e.label,i=void 0===o?"":o,a=e.description,s=void 0===a?"":a,l=e.autofocus,c=void 0!==l&&l,u=e.fullWidth,d=void 0!==u&&u;i=i||I18n.t("post.".concat(t)),s=s||I18n.t("post.".concat(t,"_description"));var m=(0,b.Gc)().register,f="post_".concat(t),p=ie;return"textarea"===r&&(p=oe),(0,y.jsxs)("div",{className:w("form-group",{"form-group--column":d}),children:[(0,y.jsx)(ee.Q,{field:f,label:i,description:s}),(0,y.jsx)("div",{className:"form-input",children:(0,y.jsx)(p,ne(ne({},m(t)),{},{id:f,className:"form-control placeholder:text-light placeholder:opacity-100",name:t,autofocus:c}))})]})},se=["meta_title","meta_description","opengraph_title","opengraph_description"],le=function(){return(0,y.jsxs)("div",{className:"form-section","data-controller":"toggle",children:[(0,y.jsx)("div",{className:"form-section__header has-toggle",children:(0,y.jsx)("button",{type:"button","data-action":"click->toggle#toggle","data-target":"toggle.toggleTrigger","data-open":"false",className:"block-toggle",children:(0,i.t)("meta_tag_attributes.meta_tags")})}),(0,y.jsxs)("div",{className:"form-section__content","data-target":"toggle.toggleable",children:[se.map((function(e){return(0,y.jsx)(ae,{id:e,label:(0,i.t)("meta_tag_attributes.".concat(e)),description:(0,i.t)("meta_tag_attributes.".concat(e,"_description"),{obj:"post"}),name:"meta_tag_attributes.".concat(e)},e)})),(0,y.jsxs)("div",{className:"form-group form-group--two-columns",children:[(0,y.jsx)(ee.Q,{field:"opengraph_image",label:(0,i.t)("meta_tag_attributes.open_graph_image")}),(0,y.jsx)(X.a,{name:"meta_tag_attributes.opengraph_image",aspectRatio:c.pI.OPEN_GRAPH})]})]})]})},ce=function(e){var t=e.name;return(0,y.jsx)(f.l.Item,{id:"post_".concat(t),name:t,label:(0,i.t)("post.".concat(t)),hideBorder:!0,hideDescription:!0,inlineReverse:!0,children:(0,y.jsx)(f.l.ToggleSwitch,{variant:"small"})})},ue=function(e){var t=e.space,n=(0,G.m)().post,r=(0,b.Gc)().watch,o=r("created_at"),a=r("is_comments_disabled"),s=!!(0,j.k8)(t||{}),l=(0,m.nT)().helpers.spacesWithPostCreationAllowed(),c=(0,m.wh)().currentCommunityMember,d=(new Date).toUTCString(),v=(0,K.k)({enabled:(0,J.vb)(c)}),h=v.data,g=void 0===h?{}:h,_=v.isLoading,x=Boolean(n.id)&&(0,u.Hz)(n);return _?(0,y.jsx)(p.a,{}):(0,y.jsx)("div",{className:"settings-menu__wrapper",children:(0,y.jsx)("div",{className:"form-wrapper quickpost-modal__form-settings",children:(0,y.jsxs)("div",{className:"form-content",children:[(0,y.jsxs)("div",{className:"-space-y-2",children:[(0,y.jsx)(ce,{name:"hide_meta_info"}),(0,y.jsx)(ce,{name:"is_comments_disabled"}),!a&&(0,y.jsx)(ce,{name:"is_comments_closed"}),(0,y.jsx)(ce,{name:"is_liking_disabled"}),(0,y.jsx)(ce,{name:"is_truncation_disabled"}),x&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(ce,{name:"pin_to_top"}),(0,y.jsx)(ce,{name:"pinned_at"})]}),!t.hide_from_featured_areas&&(0,y.jsx)(ce,{name:"hide_from_featured_areas"}),x&&(0,y.jsxs)("div",{className:"form-group form-group--column !mt-0",children:[(0,y.jsx)(ee.Q,{field:"created_at",label:(0,i.t)("publish_date"),description:(0,i.t)("publish_date_description")}),(0,y.jsx)(Y.W,{name:"created_at",maxDate:d})]})]}),(0,y.jsx)(z.If,{condition:(0,u.rq)(t),children:(0,y.jsxs)("div",{className:"form-group form-group--two-columns",children:[(0,y.jsx)(ee.Q,{field:"cardview_thumbnail",label:(0,i.t)("cardview_thumbnail")}),(0,y.jsx)(X.a,{name:"cardview_thumbnail",aspectRatio:2})]})}),(0,J.vb)(c)&&g.internal_custom_html_enabled&&(0,y.jsx)(ae,{name:"internal_custom_html",variant:"textarea",fullWidth:!0}),(0,y.jsx)(f.l.Item,{name:"space_id",translationRoot:"post",fullWidth:!0,children:(0,y.jsx)(q.M,{name:"space_id",variant:"form-input",spaces:l})}),(0,y.jsx)(ae,{name:"slug",fullWidth:!0}),(0,y.jsx)(z.If,{condition:s,children:(0,y.jsx)(f.l.Item,{name:"user_id",translationRoot:"post",fullWidth:!0,children:(0,y.jsx)(f.l.CommunityMemberSelect,{direction:"up",valueField:"user_id"})})}),(0,y.jsx)(z.If,{condition:!!o,children:(0,y.jsx)(le,{})})]})})})};function de(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return me(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return me(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function me(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var fe=function(e){var t=e.show,n=e.closeModal,r=de((0,h.useState)(!1),2),o=r[0],a=r[1],s=de((0,h.useState)(!1),2),l=s[0],u=s[1],f=de((0,h.useState)(),2),p=f[0],v=f[1],g=(0,m.nT)(),_=(0,m.Zh)().helpers.postForTrixEditor(),w=(0,x.kK)(),O=g.helpers.isDataLoaded()&&_,S=g.helpers.basicSpacesWithPostCreationAllowed(),P=(0,b.Gc)(),C=P.watch,I=P.formState,N=I.dirtyFields,A=I.errors,E=I.isSubmitting,T=I.isDirty,D=I.isSubmitSuccessful,R=C(),L=R.space_id,Z=R.name,V=R.body,W=R.id,Q=S.find((function(e){return e.id===L})),G=function(){a(!1)},J=!Z&&!V||E||D,K=function(){if(Object.keys(N).length>0){var e=(0,i.t)("post.errors.unsaved_post_warning");confirm(e)&&n()}else n()};(0,F.M)({enabled:!J}),function(e){(0,h.useEffect)((function(){var t="Are you sure you want to leave?",n=function(n){e&&(n.preventDefault(),n.returnValue=t)},r=function(n){e&&!confirm(t)&&n.preventDefault()};return window.addEventListener("beforeunload",n),document.addEventListener("turbolinks:before-visit",r),function(){window.removeEventListener("beforeunload",n),document.removeEventListener("turbolinks:before-visit",r)}}),[e])}(T&&!D);var Y=!!W,X=Y?"Edit Post":"Create Post",ee=W?"Save":"Post";(E||D)&&(ee=W?"Saving...":"Posting..."),(0,d.K)({cacheKey:c._7,fields:["name","body","space_id","cover_image"],enabled:!Y&&!D});return(0,y.jsxs)(H.Js,{show:t,onClose:K,fullscreen:!0,closeOnEscape:!o,trixMode:"quickpost-modal ".concat(l&&"quickpost-modal__fullpage"),children:[(0,y.jsxs)(H.Js.Header,{onClose:!o&&K,children:[(0,y.jsxs)("div",{className:"modal__header__inside",children:[(0,y.jsxs)("div",{className:"mr-4 flex items-center gap-4",children:[(0,y.jsxs)(z.If,{condition:!o,children:[(0,y.jsx)(z.If,{condition:!w,children:(0,y.jsx)("button",{type:"button",onClick:function(){return u(!l)},children:(0,y.jsx)(k.JO,{type:l?"shrink":"expand",size:16})})}),(0,y.jsx)(z.If,{condition:(0,j.Y_)(Q),children:(0,y.jsx)("button",{type:"button",onClick:function(){return a(!0)},children:(0,y.jsx)(k.JO,{type:"settings"})})})]}),(0,y.jsx)(z.If,{condition:!!o,children:(0,y.jsx)("button",{className:"flex",type:"button",onClick:G,children:(0,y.jsx)(k.JO,{type:"back-arrow-v2",size:16})})})]}),(0,y.jsxs)("div",{className:"modal__header--center",children:[(0,y.jsxs)("span",{className:"quickpost-modal__title",children:[(0,y.jsx)(z.If,{condition:o,children:(0,i.t)("post.post_settings")}),(0,y.jsxs)(z.If,{condition:!o,children:[X,(0,y.jsx)("span",{className:"title-separator",children:"/"})]})]}),(0,y.jsx)(z.If,{condition:!o,children:(0,y.jsx)(q.M,{spaces:S,name:"space_id",rules:{required:(0,i.t)("post.errors.space_is_required")}})})]}),(0,y.jsxs)("div",{className:"modal__header--right",children:[!o&&l&&O&&(0,y.jsx)("div",{className:"flex items-center justify-end gap-4",children:(0,y.jsx)(M,{post:_,space:Q,submitDisabled:J,isSubmitting:E||D,datepickerPlacement:"bottom"})}),(0,y.jsx)(z.If,{condition:o,children:(0,y.jsx)("button",{type:"submit",onClick:G,className:"btn modal__btn--save",children:(0,i.t)("post.done")})})]})]}),(0,y.jsx)(z.If,{condition:!o,children:(0,y.jsx)(B.X,{errors:A})})]}),(0,y.jsx)(H.Js.Body,{children:(0,y.jsx)("div",{className:"form-section form-section__topic-content trix-v2",children:(0,y.jsxs)("div",{className:"form-section__content",onMouseEnter:function(){return v(!0)},onMouseLeave:function(){return v(!1)},children:[Q&&(0,j.Y_)(Q)&&o&&(0,y.jsx)(ue,{space:Q,spaces:S}),(0,y.jsx)(U.L,{condition:!!o,children:(0,y.jsx)($,{space:Q,showAddCoverBtn:p})})]})})}),!o&&!l&&(0,y.jsx)("div",{className:"quickpost-modal__footer",children:(0,y.jsx)("div",{className:"quickpost-modal__footer--actions h-8 gap-4",children:(0,y.jsx)(M,{post:_,space:Q,submitDisabled:J,submitButtonText:ee,isSubmitting:E||D})})})]})},pe=n(68975),ve=function(e){var t=e.open,n=e.onClose,r=e.children,o=e.version,i=void 0===o?2:o,a=e.maxZIndexEnabled,s=void 0!==a&&a;return(0,y.jsx)(pe.V,{className:O()("z-150 standard-layout-modal fixed inset-0 md:overflow-y-auto",{"quick-post-wrapper--v2":2===i},{"z-2000":s}),open:t,onClose:n,children:(0,y.jsxs)("div",{className:"flex min-h-screen items-end justify-center px-4 pb-20 pt-4 text-center sm:block sm:p-0",children:[(0,y.jsx)(pe.V.Overlay,{className:"fixed inset-0 transition-opacity"}),(0,y.jsx)("span",{className:"hidden sm:inline-block sm:h-screen sm:align-middle","aria-hidden":"true",style:{content:"&#8203;"}}),(0,y.jsx)("div",{children:r})]})})},he=["maxZIndexEnabled","shouldSkipRedirectAfterSubmit","onSubmitSuccess"];function be(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ge(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?be(Object(n),!0).forEach((function(t){ye(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):be(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ye(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _e(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}function je(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var xe=function(e){var t=e.maxZIndexEnabled,n=void 0!==t&&t,r=e.shouldSkipRedirectAfterSubmit,h=void 0!==r&&r,b=e.onSubmitSuccess,g=je(e,he),_=g.show,j=g.closeModal,x=(0,m.nT)(),w=(0,m.Zh)(),O=w.helpers.postForTrixEditor(),S=x.helpers.isDataLoaded()&&w.record,P=(0,s.k6)(),C=(0,d.d)({cacheKey:c._7}).resetValues,k=(0,v.p)(),I=k.success,N=k.error,A=function(e){var t=e.responseData,n=(0,u.RG)({post:t});w.onPostChange(t),P?(t.status===O.status?I((0,i.t)("quick_post.toasts.changes_saved")):I((0,i.t)("quick_post.toasts.".concat(t.status,"_saved"))),j(),C(),h||P.push(n)):(j(),C(),h||(window.location.href=n)),b&&b(t)},E=function(){var e,t=(e=o().mark((function e(t){var n,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.Fv.createOrUpdate({post:ge(ge({},O),{},{space_id:O.space_id||t.space_id}),formData:t});case 2:if(!(n=e.sent).ok){e.next=9;break}return e.next=6,n.json();case 6:return r=e.sent,A({responseData:r}),e.abrupt("return",!0);case 9:return O.id?N((0,i.t)("quick_post.toasts.failed_to_update")):N((0,i.t)("quick_post.toasts.failed_to_create")),e.abrupt("return",Promise.reject(new Error("Failed to create or update the post")));case 11:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){_e(i,r,o,a,s,"next",e)}function s(e){_e(i,r,o,a,s,"throw",e)}a(void 0)}))});return function(e){return t.apply(this,arguments)}}(),T=ge({status:u.lv},O);return S?(0,y.jsx)("div",{children:(0,y.jsx)(ve,{open:_,onClose:a.noop,version:2,maxZIndexEnabled:n,children:(0,y.jsx)(f.l,{onSubmit:E,defaultValues:T,children:(0,y.jsx)(fe,ge({},g))})})}):(0,y.jsx)(p.a,{variant:"fullscreen"})}},20405:(e,t,n)=>{n.d(t,{a:()=>s});var r=n(86013),o=n(26636),i=n(55675),a=n(85893),s=function(e){var t=e.isDisabled,n=e.isEdit,s=(0,o.L)().isSubmitting;return(0,a.jsx)(i.z,{disabled:t,type:"submit",variant:"circle",children:(0,r.t)("quick_post.scheduled_post_ui.".concat(s?"submitting_button":"submit_button",".").concat(n?"save":"publish"))})}},83489:(e,t,n)=>{n.d(t,{e:()=>v});var r=n(67294),o=n(49546),i=n(86013),a=n(67685),s=n(49834),l=n(30887),c=n(20633),u=n(9946),d=n(16743),m=n(85893);function f(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return p(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return p(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var v=function(e){var t=e.publishedAt,n=e.updatePublishedAt,p=e.status,v=e.revertToDraftState,h=e.variant,b=void 0===h?"default":h,g=f((0,r.useState)(!1),2),y=g[0],_=g[1],j=function(){return _(!1)},x="MMM dd, yyyy 'at' HH:mm";return"scheduled"!==p?null:(0,m.jsx)(u.h,{selectorQuery:"#".concat(s.U),children:(0,m.jsx)(a.M,{value:t,datePickerVisible:y,onCancel:j,onSave:function(e){n(e),j()},placement:"bottom-end",saveButtonVariant:"circle",children:(0,m.jsxs)("div",{className:"border-primary bg-secondary -mt-px flex flex-col border-y px-5 py-3",children:[(0,m.jsxs)("div",{className:"flex items-center justify-between",children:[(0,m.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,m.jsx)(l.JO,{type:"16-clock",size:16}),(0,m.jsx)(d.Z.LabelSm,{weight:"2-lines"===b?"semibold":"medium",children:"default"===b?(0,i.t)("quick_post_v2.scheduled_for",{date:(0,o.default)(new Date(t),x)}):(0,i.t)("quick_post_v2.post_scheduled")})]}),(0,m.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,m.jsx)(c.h,{variant:"secondary",name:"16-edit",iconClassName:"!text-dark",onClick:function(){return _(!0)},ariaLabel:(0,i.t)("edit")}),(0,m.jsx)(c.h,{variant:"secondary",name:"16-trash-bin",iconClassName:"!text-dark",onClick:v,ariaLabel:(0,i.t)("delete")})]})]}),"2-lines"===b&&(0,m.jsx)("div",{className:"mt-1",children:(0,m.jsx)(d.Z.LabelSm,{weight:"normal",children:(0,o.default)(new Date(t),x)})})]})})})}},89649:(e,t,n)=>{n.d(t,{$:()=>N,F:()=>I});var r=n(76234),o=n(94184),i=n.n(o),a=n(86013),s=n(96486),l=n(67294),c=n(87536),u=n(67685),d=n(20405),m=n(83489),f=n(2806),p=n(26636),v=n(78163),h=n(97012),b=n(68375),g=n(61345),y=n(87958),_=n(83088),j=n(85893);function x(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return w(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return w(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var O=function(){var e,t=(0,h.wh)().currentCommunitySettings,n=null===t||void 0===t?void 0:t.tiptap_post_enabled,r=(0,c.Gc)(),o=r.watch,i=r.setValue,w=r.getValues,O=o(),S=O.published_at,P=O.status,C=x((0,l.useState)(!1),2),k=C[0],I=C[1],N=(0,p.L)().isSubmitting,A=w(),E=A.name,T=A.body,D=A.tiptap_body,R=A.space_id,L=A.topics,M=(0,h.Zh)(),F=M.record,U=M.helpers,B=M.isSubmitEnabled,z=Boolean(null===U||void 0===U?void 0:U.isTiptapPost),H=!(null===F||void 0===F||!F.id),q=(0,b.Hz)(F),Z=(H?z:n)?(0,v.NU)(D):(0,v.bG)(T),V="quick_post.scheduled_post_ui.".concat(N?"submitting_button":"submit_button"),W=[{icon:"16-download",label:(0,a.t)("".concat(V,".save_draft")),value:"draft"},{icon:"16-calendar",label:(0,a.t)("".concat(V,".schedule_post")),value:"scheduled"},{icon:"16-publish",label:(0,a.t)("".concat(V,".publish")),value:"published"}],Q=(0,s.find)(W,{value:P||"published"}),$=function(e){"scheduled"===e.value?I(!0):(i("status",e.value),I(!1),G(null))},G=function(e){i("published_at",e)},J=function(){$(W[0])},K=o("space_id"),Y=(0,h.nT)();(0,f.f)(Y)&&(e=Y.helpers.findById(K));var X=(0,l.useMemo)((function(){var t;return(0,v.r1)(E)||Z?R?null!==(t=e)&&void 0!==t&&t.require_topic_selection&&Number(null===L||void 0===L?void 0:L.length)<=0?(0,a.t)("quick_post_v2.error_messages.no_topics"):null:(0,a.t)("quick_post_v2.error_messages.no_space"):(0,a.t)("quick_post_v2.error_messages.no_title_or_body")}),[E,R,Z,L,e]),ee=!!X||N||!B,te=e&&(0,g.k8)(e)&&!q;return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(m.e,{publishedAt:S,revertToDraftState:J,status:P,updatePublishedAt:G}),(0,j.jsx)(u.M,{datePickerVisible:k,onCancel:function(e){e&&e.preventDefault(),I(!1),"scheduled"===P&&J()},value:S,onSave:function(e){G(e),i("status","scheduled"),I(!1)},className:"-bottom-11",saveButtonVariant:"circle",children:(0,j.jsx)(y.T,{disabled:!ee,content:X,trigger:"mouseenter click focus focusin",children:te?(0,j.jsx)(_.F,{type:"submit",disabled:ee,selectedAction:Q,setSelectedAction:$,options:W,variant:"circle"}):(0,j.jsx)(d.a,{isEdit:H,isDisabled:ee})})})]})},S=n(30887),P=n(43548),C=n(26953),k=n(16743),I=function(e){var t;return!(null===e||void 0===e||null===(t=e.helpers)||void 0===t||!t.basicSpacesWithPostCreationAllowed)},N=function(){var e=(0,C.Be)(),t=(0,h.nT)(),n=I(t)?t.helpers.basicSpacesWithPostCreationAllowed():[];return(0,j.jsxs)("footer",{className:"border-primary flex items-center justify-between border-t px-5 py-4 ","data-testid":"quick-post-footer",children:[(0,j.jsx)("nav",{"aria-label":(0,a.t)("quick_post_v2.footer_menu_aria_label"),id:"quick-post-v2-footer-toolbar"}),(0,j.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,j.jsx)(r.Z,{disablePortal:e,container:document.getElementById("space-select-for-mobile"),children:(0,j.jsx)(P.M,{dropdownClassName:e?"bottom-14":"bottom-32 right-1",spaces:n,containerClassname:i()("!max-w-full",{"border-t border-primary":!e}),name:"space_id",customButton:function(t){var n=t.toggleDropdown,r=t.selectedSpace,o=t.isOpen;return(0,j.jsxs)("button",{type:"button",className:i()("hover:bg-secondary focus-visible:bg-secondary flex w-full cursor-pointer items-center rounded-md",{"bg-secondary":o,"px-5 py-4":!e,"px-3 py-2":e}),onClick:n,children:[(0,j.jsx)("div",{className:i()("flex items-center space-x-1",{"flex-1":!e}),children:null!==r&&void 0!==r&&r.name?(0,j.jsxs)(j.Fragment,{children:[(0,j.jsxs)(k.Z.LabelSm,{weight:"medium",color:"text-default",children:[(0,a.t)("quick_post_v2.posting_in")," "]}),(0,j.jsx)(k.Z.LabelSm,{weight:"medium",color:"text-default",children:(0,j.jsx)("span",{className:"text-dark",title:r.name,children:(0,s.truncate)(r.name,{length:e?24:36})})})]}):(0,j.jsx)(k.Z.LabelSm,{weight:"medium",color:"text-default",children:(0,j.jsx)("span",{className:"text-light",children:(0,a.t)("quick_post_v2.choose_a_space")})})}),(0,j.jsx)(S.JO,{className:"!text-dark",type:"16-chevron-down",size:16})]})}})}),(0,j.jsx)(O,{})]})]})}},49646:(e,t,n)=>{n.d(t,{w:()=>u});var r=n(87536),o=n(93014),i=n(85893),a=["name","rules"];function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var u=function(e){var t=e.name,n=e.rules,u=c(e,a),d=(0,r.Gc)().control;return(0,i.jsx)(r.Qr,{control:d,name:t,rules:n,render:function(e){var t=e.field;return(0,i.jsx)(o.ap,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({value:t.value,onChange:t.onChange},u))}})}},93014:(e,t,n)=>{n.d(t,{tt:()=>ne,ap:()=>re});var r=n(67294),o=n(41727),i=n(45587),a=n(94789),s=n(94184),l=n.n(s),c=n(87360),u=n.n(c),d=n(73935),m=n(77294),f=n(86013),p=n(96486),v=n(30887),h=n(30171),b=n(85893),g=function(e){var t=e.filter,n=e.createTopicMutation;return(0,b.jsxs)(h.W,{option:"create",onClick:function(e){e.preventDefault(),e.stopPropagation(),n.isLoading||n.mutate(t)},className:"flex items-center",children:[(0,b.jsx)(v.JO,{className:"mr-1",size:16,type:n.isLoading?"loader":"plus-v2"}),(0,f.t)(n.isLoading?"quick_post_v2.topics.creating":"quick_post_v2.topics.create"),(0,b.jsx)("span",{className:"text-dark ml-1 font-semibold",children:(0,f.t)("quick_post_v2.topics.topic_quoted",{topic:t})})]},"create")},y=n(16743),_=function(){return(0,b.jsx)("div",{className:"px-5 py-1.5",children:(0,b.jsx)(y.Z.LabelSm,{color:"text-light",children:(0,f.t)("quick_post_v2.topics.loading")})})},j=n(43436),x=n(38984);function w(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function O(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?w(Object(n),!0).forEach((function(t){S(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function S(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var P=function(e){var t=e.shouldShowDropdown,n=e.popperElement,r=e.styles,o=e.attributes,i=e.isLoading,a=e.filter,s=e.filteredTopics,c=e.shouldShowCreateTopic,u=e.createTopicMutation;return(0,b.jsx)("div",O(O({className:l()("z-10 max-w-[min(90vw,288px)]",{invisible:!t}),ref:n,style:r.popper},o.popper),{},{children:(0,b.jsx)(j.E,{className:"!relative",dataTestId:"topics-options-list",children:(0,b.jsxs)(x.H,{children:[i&&(0,b.jsx)(_,{}),s.map((function(e){return(0,b.jsx)(h.W,{option:e.id,children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)(y.Z.LabelSm,{children:(0,p.truncate)(e.name,{length:20})}),e.admin_only&&(0,b.jsx)(y.Z.LabelXs,{color:"text-light",children:(0,f.t)("quick_post_v2.topics.admin_only")})]})},e.id)})),c&&(0,b.jsx)(g,{createTopicMutation:u,filter:a})]})})}))},C=function(e){var t=e.targetElement,n=e.filter,r=e.maxTopicsAllowed,o=e.setFilter,i=e.buttonElement,s=e.activeOption,l=e.createTopicMutation,c=e.resetSelectedTopics,u=e.removeLastTopic;return(0,b.jsx)(a.h.Input,{className:"min-w-[200px] flex-1 border-none bg-transparent p-0 px-1 py-[5px] text-sm focus:ring-0",ref:t,value:n,placeholder:(0,f.t)("quick_post_v2.topics.search",{count:r}),onChange:function(e){return o(e.target.value)},onFocus:function(){var e;return null===i||void 0===i||null===(e=i.current)||void 0===e?void 0:e.click()},onKeyDown:function(e){(e.ctrlKey||e.metaKey)&&"Backspace"===e.key&&c(),"Backspace"===e.key&&0===(null===n||void 0===n?void 0:n.length)&&u(),"Enter"===e.key&&null!==n&&void 0!==n&&n.trim()&&"create"===s&&(e.preventDefault(),l.isLoading||l.mutate(n))}})},k=n(97012),I=n(31889),N=n(87958),A=function(e){var t=e.topic,n=e.isDragOverlay,r=e.isDraggable,o=e.setActiveTopicIDs,i=(0,k.wh)().currentCommunityMember,a=(0,I.vb)(i)||(0,I.I$)(i),s=!a&&t.admin_only;return(0,b.jsx)(N.T,{placement:"top",content:(0,f.t)("quick_post_v2.topics.admin_only"),interactive:!1,disabled:!s,trigger:"mouseenter click focus focusin",children:(0,b.jsxs)("div",{className:l()("border-primary bg-primary text-dark inline-flex items-center justify-start gap-1.5 whitespace-nowrap rounded-[32px] border py-1.5 pr-2",n?"rotate-1 scale-[1.01] opacity-75 shadow-lg":r?"cursor-move":"cursor-default",s?"pl-2":"pl-3.5",{"pointer-events-none":s}),children:[(0,b.jsx)(y.Z.LabelXs,{weight:"medium",children:null===t||void 0===t?void 0:t.name}),(a||!t.admin_only)&&(0,b.jsx)(v.JO,{className:"cursor-pointer",onClick:function(){null===o||void 0===o||o((function(e){return e.filter((function(e){return e!==t.id}))}))},type:"12-close",size:12})]})})},E=n(64687),T=n.n(E),D=n(88767),R=n(34128),L=n(49326),M=n(21809);function F(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}var U=function(e){var t,n,r=e.onSuccess,o=e.spaceId,i=(0,M.p)();return(0,D.useMutation)({mutationFn:(t=T().mark((function e(t){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,R.Cu)(L.av.settings.topics.create(),{topic:{name:t,space_ids:[o]}}));case 1:case"end":return e.stop()}}),e)})),n=function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(e){F(i,r,o,a,s,"next",e)}function s(e){F(i,r,o,a,s,"throw",e)}a(void 0)}))},function(e){return n.apply(this,arguments)}),onSuccess:r,onError:function(e){"Name has already been taken"===e.errorDetails&&i.error("A topic with this name already exists. Add it to your space instead from the customize space screen.")}})},B=n(37292),z=function(e){var t=e.activeTopicIDs,n=e.topics,r=e.skipSort;return t.map((function(e){return null===n||void 0===n?void 0:n.records.find((function(t){return t.id===e}))})).filter((function(e){return!!e})).sort((function(e,t){return r?0:e.admin_only&&!t.admin_only?-1:!e.admin_only&&t.admin_only?1:0}))},H=n(63367),q=n(58905),Z=n(20633),V=n(24285),W=["topic"];function Q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function $(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Q(Object(n),!0).forEach((function(t){G(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Q(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function G(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function J(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var K=function(e){var t=e.topic,n=J(e,W),r=(0,i.nB)({id:(null===t||void 0===t?void 0:t.id)||""}),o=r.attributes,a=r.listeners,s=r.setNodeRef,l=r.transform,c=r.transition,u=r.isDragging,d={transform:V.ux.Translate.toString(l),transition:c,opacity:u?.33:1};return(0,b.jsx)("div",$($($({ref:s,style:d},o),a),{},{children:(0,b.jsx)(A,$({topic:t},n))}))};function Y(e){return function(e){if(Array.isArray(e))return te(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||ee(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function X(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||ee(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ee(e,t){if(e){if("string"===typeof e)return te(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?te(e,t):void 0}}function te(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ne=20,re=function(e){var t=e.value,n=void 0===t?[]:t,s=e.onChange,c=e.spaceId,f=e.maxTopicsAllowed,p=void 0===f?5:f,v=e.sortable,h=void 0!==v&&v,g=e.creatable,y=void 0!==g&&g,_=e.containerClassName,j=X((0,r.useState)(n),2),x=j[0],w=j[1],O=X((0,r.useState)(""),2),S=O[0],E=O[1],T=X((0,r.useState)(null),2),M=T[0],F=T[1],V=(0,k.wh)().currentCommunityMember,W=(0,r.useRef)(null),Q=(0,r.useRef)(null),$=(0,r.useRef)(null),G=(null===x||void 0===x?void 0:x.length)>0,J=(null===x||void 0===x?void 0:x.length)>=p,ee=function(e){var t=e.spaceId;return(0,D.useQuery)({queryKey:t?[B.J,t]:[B.J],queryFn:function(){return(0,R.UT)(t?L.av.topics.spaceTopics({spaceId:t}):L.av.settings.topics.index({params:{per_page:200}}))}})}({spaceId:c}),te=ee.data,re=ee.isLoading,oe=ee.refetch,ie=(0,o.Dy)((0,o.VT)(o.we,{activationConstraint:{distance:10}}),(0,o.VT)(o.Lg,{coordinateGetter:i.is})),ae=function(){return w((0,I.vb)(V)?[]:x.filter((function(e){var t=null===te||void 0===te?void 0:te.records.find((function(t){return t.id===e}));return null===t||void 0===t?void 0:t.admin_only})))},se=function(){return w((function(e){var t=h?e:function(e){var t=e.activeTopicIDs,n=e.topics;return t.sort((function(e,t){var r=null===n||void 0===n?void 0:n.records.find((function(t){return t.id===e})),o=null===n||void 0===n?void 0:n.records.find((function(e){return e.id===t}));return null===r||void 0===r||!r.admin_only||null!==o&&void 0!==o&&o.admin_only?null!==r&&void 0!==r&&r.admin_only||null===o||void 0===o||!o.admin_only?0:1:-1}))}({activeTopicIDs:e,topics:te}),n=null===te||void 0===te?void 0:te.records.find((function(e){return e.id===t[t.length-1]}));return!(0,I.vb)(V)&&null!==n&&void 0!==n&&n.admin_only?e:e.slice(0,-1)}))};(0,r.useEffect)((function(){te&&w((function(e){return e.filter((function(e){return null===te||void 0===te?void 0:te.records.some((function(t){return t.id===e}))}))}))}),[te]),(0,r.useEffect)((function(){null===s||void 0===s||s(x.filter((function(e){return!isNaN(Number(e))})))}),[s,x]);var le=(0,m.D)(W.current,Q.current,{placement:"top-start",strategy:"absolute",modifiers:[q.Z,{name:"offset",options:{offset:[0,2]}}]}),ce=le.styles,ue=le.attributes,de=le.forceUpdate,me=function(){E(""),W.current&&(W.current.value="")},fe=U({spaceId:c,onSuccess:function(e){me(),oe(),null===de||void 0===de||de(),w((function(t){return[].concat(Y(t),[e.id])}))}}),pe=((null===te||void 0===te?void 0:te.records)||[]).filter((function(e){return!e.admin_only||(0,I.vb)(V)||(0,I.I$)(V)})).filter((function(e){return!x.includes(e.id)})),ve=pe.map((function(e){return e.name})),he=u().go(S,ve,{limit:ne,all:!0}).map((function(e){return e.target})),be=pe.filter((function(e){return he.includes(e.name)})),ge=y&&(0,I.vb)(V)&&!J&&S.length>0&&!ve.includes(S);c&&(ge=ge&&Number(null===te||void 0===te?void 0:te.count)<ne);var ye=(re||be.length>0||ge)&&x.length<p;(0,r.useEffect)((function(){null===de||void 0===de||de()}),[de,x]);var _e=function(e){return F(e.active.id)},je=function(e){var t=e.active,n=e.over;t.id!==n.id&&w((function(e){return(0,i.Rp)(e,e.indexOf(t.id),e.indexOf(n.id))})),F(null)},xe=null===te||void 0===te?void 0:te.records.find((function(e){return e.id===M}));return null!==te&&void 0!==te&&te.records&&null!==te&&void 0!==te&&te.records.length||(0,I.vb)(V)?(0,b.jsx)(a.h,{value:x,onChange:function(e){w(e),me()},multiple:!0,nullable:!0,children:function(e){var t=e.activeOption;return(0,b.jsxs)("div",{className:l()("text-dark flex items-start justify-between p-2",_),children:[(0,b.jsxs)("div",{id:"quickpost-topics-picker-sortable",className:"w-full",children:[(0,b.jsx)(a.h.Button,{className:"hidden",ref:$}),(0,b.jsxs)(o.LB,{sensors:ie,collisionDetection:o.ey,onDragStart:_e,onDragEnd:je,children:[(0,b.jsx)(i.Fo,{items:x,strategy:i.U2,disabled:!h,children:(0,b.jsxs)("div",{className:"flex w-full flex-row flex-wrap items-center gap-2",children:[z({activeTopicIDs:x,topics:te,skipSort:h}).map((function(e){return(0,b.jsx)(K,{topic:e,isDraggable:h,setActiveTopicIDs:w},e.id)})),!J&&(0,b.jsx)(C,{buttonElement:$,filter:S,setFilter:E,maxTopicsAllowed:p,targetElement:W,activeOption:t,createTopicMutation:fe,resetSelectedTopics:ae,removeLastTopic:se})]})}),(0,d.createPortal)((0,b.jsx)(o.y9,{zIndex:99999,children:xe?(0,b.jsx)(A,{isDragOverlay:!0,topic:xe}):null}),document.body)]}),(0,b.jsx)(P,{shouldShowDropdown:ye,popperElement:Q,styles:ce,filter:S,attributes:ue,isLoading:re,filteredTopics:be,shouldShowCreateTopic:ge,createTopicMutation:fe})]}),G&&(0,b.jsx)(N.T,{content:(0,H.t)("quick_post_v2.topics.remove_all"),placement:"top-end",children:(0,b.jsx)(Z.h,{className:"h-7 w-7",iconClassName:"!text-dark",onClick:ae,name:"16-trash-bin-2",ariaLabel:(0,H.t)("quick_post_v2.topics.remove_all")})})]})}}):null}},49834:(e,t,n)=>{n.d(t,{V:()=>z,U:()=>B});var r=n(67294),o=n(87536),i=n(95172),a=n(26636),s=n(59393),l=n(97012),c=n(22972),u=n(94184),d=n.n(u),m=n(86013),f=n(24185),p=n(72892),v=n(20633),h=n(61345),b=n(26953),g=n(87958),y=n(16743),_=n(85893),j="quick-post-v2-thumbnail-button",x=function(){var e=(0,a.L)(),t=e.isFullscreen,n=e.toggleFullscreen,r=e.isDirty,i=(0,p.c)({shouldPrevent:r}),s=(0,f.k6)(),c=(0,l.Zh)().record,u=(0,l.nT)(),d=(0,o.Gc)().watch,x=!(null===c||void 0===c||!c.id),w=d("space_id"),O=u.helpers.findById(w),S=(0,b.kK)();return(0,_.jsxs)("header",{className:"border-primary flex items-center justify-between border-b px-5 py-4","data-testid":"quick-post-header",children:[(0,_.jsx)(y.Z.TitleSm,{weight:"semibold",children:(0,m.t)(x?"quick_post_v2.edit_title":"quick_post_v2.create_title")}),(0,_.jsxs)("ul",{className:"text-darkest flex list-none items-center space-x-2",children:[(0,_.jsx)("li",{id:j}),O&&(0,h.Y_)(O)&&(0,_.jsx)("li",{children:(0,_.jsx)(g.T,{placement:"bottom",content:(0,m.t)("quick_post_v2.header.settings"),children:(0,_.jsx)(v.h,{variant:"secondary",iconSize:20,iconClassName:"!text-dark",name:"20-settings",onClick:function(){return s.push("/settings")},ariaLabel:(0,m.t)("quick_post_v2.header.settings")})})}),!S&&(0,_.jsx)("li",{children:(0,_.jsx)(g.T,{placement:"bottom",content:(0,m.t)("quick_post_v2.header.fullscreen"),children:(0,_.jsx)(v.h,{variant:"secondary",iconSize:20,className:"hidden sm:flex",onClick:n,iconClassName:"!text-dark",name:t?"20-fullscreen-exit":"20-fullscreen",ariaLabel:(0,m.t)("quick_post_v2.header.fullscreen")})})}),(0,_.jsx)("li",{children:(0,_.jsx)(g.T,{placement:"bottom",content:(0,m.t)("quick_post_v2.header.close"),children:(0,_.jsx)(v.h,{variant:"secondary",iconSize:20,onClick:i,iconClassName:"!text-dark",name:"20-close",ariaLabel:(0,m.t)("quick_post_v2.header.close")})})})]})]})},w=n(49646),O=n(2806),S=n(25269),P=n(77616),C=n(68375),k=n(18009),I=n(71299),N=n(9946),A=n(61989),E=n(56868);function T(e){return function(e){if(Array.isArray(e))return D(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return D(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return D(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function D(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function R(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function L(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?R(Object(n),!0).forEach((function(t){M(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):R(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function M(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var F=function(){var e,t=(0,l.wh)(),n=t.currentCommunitySettings,r=t.currentCommunityMember,i=null===n||void 0===n?void 0:n.tiptap_post_enabled,a=null===n||void 0===n?void 0:n.topics_enabled,c=(0,o.Gc)(),u=c.watch,f=c.setValue,p=u("tiptap_body.sgids_to_object_map")||{},h=u("name"),b="tiptap_body.inline_attachments",y=u(b)||[],x=(0,l.Zh)(),D=x.record,R=x.helpers,M=Boolean(null===R||void 0===R?void 0:R.isTiptapPost),F=(0,k.k)(),U=D||{},B=U.id,z=U.tiptap_body,H=Boolean(B)?M:i,q=u("space_id"),Z=u("cover_image"),V=(0,l.nT)();(0,O.f)(V)&&(e=V.helpers.findById(q));var W=null===r||void 0===r?void 0:r.is_admin;return(0,_.jsx)("div",{className:"flex-1 overflow-auto px-5 py-4","data-ai-scrollable":!0,children:(0,_.jsxs)("div",{className:"trix-v2 mx-auto grid h-full max-w-3xl grid-rows-[auto,auto,1fr]",children:[(0,_.jsx)("div",{children:(0,C.J4)(e)&&(0,_.jsx)(I.D,{name:"cover_image",className:d()("relative",{"mb-2":Boolean(Z)}),showAddCoverBtn:!0,aspectRatio:s.pI.DEFAULT,changeImageText:(0,m.t)("replace"),customAddCoverBtn:(0,_.jsx)(N.h,{selectorQuery:"#".concat(j),children:(0,_.jsx)(g.T,{placement:"bottom",content:(0,m.t)("quick_post_v2.header.add_cover"),children:(0,_.jsx)(v.h,{variant:"secondary",iconSize:20,iconClassName:"!text-dark",name:"20-cover-image",ariaLabel:(0,m.t)("quick_post_v2.header.add_cover")})})})})}),(0,_.jsx)("div",{children:(0,C.tp)(e)&&(0,_.jsx)(S.n,{maxLength:255,draggable:!1,name:"name",autoFocus:!0,ref:F,placeholder:(0,m.t)("quick_post_v2.title_placeholder"),className:"bg-primary text-dark mb-2 block w-full resize-none border-none p-0 text-2xl font-bold focus:ring-0",rows:1,onKeyPress:function(e){"Enter"===e.key&&e.preventDefault()},tabIndex:0,"data-testid":"post_name"})}),(0,_.jsx)("div",{children:H?(0,_.jsx)(P.$,{placeholder:(0,m.t)("quick_post_v2.body_placeholder"),name:"tiptap_body.body",toolbars:[{portalId:"quick-post-v2-footer-toolbar",component:E.o}],className:"h-full",editorClassName:"h-full quick-post-modal--v2",spaceId:q,sgidToObjectMap:null===z||void 0===z?void 0:z.sgids_to_object_map,inlineAttachments:null===z||void 0===z?void 0:z.inline_attachments,onLocalSgidToObjectMapChange:function(e){var t=L(L({},p),e);f("tiptap_body.sgids_to_object_map",t)},onLocalAttachmentsChange:function(e){return f(b,[].concat(T(y),T(e)))},aiCopilotTitle:h,disabledExtensions:["cta"]}):(0,_.jsx)(A.O,{id:"post_body",name:"body",is_private_space:!1,space_id:q,placeholder:(0,m.t)("quick_post_v2.body_placeholder"),tabIndex:0,toolbarPortalId:"quick-post-v2-footer-toolbar"})}),a&&!!q&&(0,_.jsx)(N.h,{selectorQuery:"#topics-picker-portal",children:(0,_.jsx)(w.w,{containerClassName:"border-t border-primary",name:"topics",spaceId:q,creatable:W})})]})})},U=n(89649),B="scheduled-post-date-render-portal",z=function(){var e=(0,a.L)().setIsDirty,t=(0,o.Gc)(),n=t.formState,u=n.isDirty,d=n.isSubmitSuccessful,m=(0,l.Zh)().record,f=!(null===m||void 0===m||!m.id);return(0,r.useEffect)((function(){e(u)}),[e,u]),(0,c.K)({cacheKey:s._7,fields:["name","body","tiptap_body","space_id","cover_image"],enabled:!f&&!d}),(0,i.y1)("cmd+enter, ctrl+enter",(function(){"triggerFormSubmit"in t&&t.triggerFormSubmit()}),{enableOnContentEditable:!0,enableOnTags:["INPUT","TEXTAREA"]},[t]),(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(x,{}),(0,_.jsx)("div",{id:B}),(0,_.jsx)(F,{}),(0,_.jsx)("div",{id:"space-select-for-mobile"}),(0,_.jsx)("div",{id:"topics-picker-portal"}),(0,_.jsx)(U.$,{})]})}},25388:(e,t,n)=>{n.d(t,{L:()=>S});var r=n(96486),o=n(72675),i=n(53448),a=n(5295),s=n(85893),l=function(){return(0,s.jsx)(i.u_.Content,{className:"flex min-h-[400px] items-center justify-center",children:(0,s.jsx)(a.a,{})})},c=n(20744),u=n(97012),d=n(98175),m=n(81217),f=function(e){var t=e.post,n=e.onSubmitSuccess,r=e.onPostChange,o=e.shouldSkipRedirectAfterSubmit,i=(0,m.t)({spaceId:t.space_id,postSlug:t.slug,queryOptions:{cacheTime:0},context:"edit-post-modal"}),a=i.post,f=i.isLoading,p=(0,d.hD)(t.id).isLoading;return f||p?(0,s.jsx)(l,{}):(0,s.jsx)(u.DW,{post:a,onPostChange:r,children:(0,s.jsx)(c.H,{shouldSkipRedirectAfterSubmit:o,onSubmitSuccess:n})})},p=n(26636),v=n(80715),h=n(72892),b=n(16855),g=n(66443),y=n(35),_=n(76645);function j(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function x(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var w=function(e){var t=e.post,n=e.onSubmitSuccess,a=e.onPostChange,l=e.shouldSkipRedirectAfterSubmit,c=(0,o.dd)(),u=(0,p.L)().isDirty,m=(0,h.c)({shouldPrevent:u}),j=(0,y.Z)(),x=(0,_.d)(),w=(0,g.d)(),O=j.visible||x.visible||w.visible;return(0,v.u)({disabled:O,onClose:m}),(0,s.jsxs)(i.u_,{isOpen:c.visible,onClose:r.noop,className:"quick-post-v2-modal w-full max-w-3xl",children:[(0,s.jsx)(i.u_.Overlay,{onClick:m}),(0,s.jsx)(b.H,{children:(0,s.jsx)(d._x,{perPagePostIds:[[t.id]],queryOptions:{cacheTime:0},queryContext:"edit-post-modal",children:(0,s.jsx)(f,{post:t,onPostChange:a,onSubmitSuccess:n,shouldSkipRedirectAfterSubmit:l})})})]})},O=o.gk.create((function(e){return(0,s.jsx)(w,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?j(Object(n),!0).forEach((function(t){x(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):j(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e))})),S=function(){return(0,o.dd)(O)}},20744:(e,t,n)=>{n.d(t,{H:()=>E});var r=n(64687),o=n.n(r),i=n(67294),a=n(94184),s=n.n(a),l=n(86013),c=n(96486),u=n(88767),d=n(24185),m=n(1320),f=n(72675),p=n(49834),v=n(2806),h=n(20633),b=n(55675),g=n(16743),y=n(85893),_=function(){var e=(0,d.k6)(),t=function(){return e.push("/")};return(0,y.jsxs)("div",{className:"border-primary bg-primary sticky top-0 z-10 flex items-center justify-between border-b px-5 py-3.5 sm:rounded-t-2xl",children:[(0,y.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,y.jsx)(h.h,{name:"20-arrow-left",iconSize:20,className:"!p-0",iconClassName:"!h-5 !w-5",onClick:t,ariaLabel:(0,l.t)("previous")}),(0,y.jsx)(g.Z.TitleSm,{weight:"semibold",children:(0,l.t)("quick_post_v2.settings")})]}),(0,y.jsx)(b.z,{type:"button",onClick:t,variant:"circle",children:(0,l.t)("quick_post_v2.done")})]})},j=function(){return(0,y.jsxs)("div",{className:"h-full overflow-auto",children:[(0,y.jsx)(_,{}),(0,y.jsx)(v.l,{})]})},x=n(26636),w=n(78163),O=n(59393),S=n(97012),P=n(68375),C=n(22972),k=n(53448),I=n(61926),N=n(21809);function A(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}var E=function(e){var t,n,r=e.shouldSkipRedirectAfterSubmit,a=e.onSubmitSuccess,v=(0,f.dd)(),h=(0,x.L)(),b=h.isFullscreen,g=h.setIsSubmitting,_=(0,N.p)(),E=_.success,T=_.error,D=(0,d.k6)(),R=(0,S.wh)().currentCommunitySettings,L=null===R||void 0===R?void 0:R.tiptap_post_enabled,M=(0,S.Zh)(),F=M.onPostChange,U=M.helpers,B=null===U||void 0===U?void 0:U.postForTrixEditor,z=Boolean(null===U||void 0===U?void 0:U.isTiptapPost),H=B&&B(),q=!!H.id,Z=q?z:L,V=(0,C.d)({cacheKey:O._7}).resetValues,W=(0,u.useMutation)((function(e){return m.Fv.createOrUpdate({post:{id:H.id,slug:H.slug,space_id:H.space_id||e.space_id},formData:e})}),{onSuccess:(t=o().mark((function e(t){var n,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.json();case 2:n=e.sent,(0,c.isFunction)(F)&&F(n),(0,c.isFunction)(a)&&a(),q||V(),E((0,l.t)(q?"quick_post.toasts.changes_saved":"quick_post.toasts.".concat(n.status,"_saved"))),v.remove(),i=(0,P.RG)({post:n}),r||D.push(i);case 10:case"end":return e.stop()}}),e)})),n=function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(e){A(i,r,o,a,s,"next",e)}function s(e){A(i,r,o,a,s,"throw",e)}a(void 0)}))},function(e){return n.apply(this,arguments)}),onError:function(){return T((0,l.t)("quick_post.toasts.failed_to_create"))}});return(0,i.useEffect)((function(){g(W.isLoading)}),[W.isLoading,g]),(0,y.jsx)(I.l,{id:"quick-post-form",defaultValues:H,mode:"all",className:"h-full",formClassName:"h-full flex flex-col",onSubmit:function(e){return W.mutate(e)},validationSchema:Z?w.vY:w.gR,children:(0,y.jsx)(k.u_.Content,{size:b?"screen":"auto",className:s()("overflow-visible",{"max-h-none":b,"h-full max-h-full max-w-[720px] !rounded-t-none sm:h-full sm:!rounded-t-lg md:max-h-[80vh] lg:max-h-[550px]":!b}),animations:"fadeIn",children:(0,y.jsx)(d.VA,{children:(0,y.jsxs)(d.rs,{children:[(0,y.jsx)(d.AW,{component:p.V,path:"/",exact:!0}),(0,y.jsx)(d.AW,{component:j,path:"/settings"})]})})})})}},2806:(e,t,n)=>{n.d(t,{l:()=>S,f:()=>O});var r=n(87536),o=n(86013),i=n(97932),a=n(74442),s=n(43548),l=n(97012),c=n(31889),u=n(68375),d=n(61345),m=n(24113),f=n(71316),p=n(61926),v=n(10029),h=n(5295),b=n(85893),g=function(e){var t,n,r=e.space,g=(0,i.m)().post,y="object"===typeof(null===(t=r)||void 0===t?void 0:t.current_user_roles)&&!!(0,d.k8)(r),_=(0,l.nT)();(function(e){var t;return"function"===typeof(null===e||void 0===e||null===(t=e.helpers)||void 0===t?void 0:t.spacesWithPostCreationAllowed)})(_)&&(n=_.helpers.spacesWithPostCreationAllowed());var j,x=(0,l.wh)().currentCommunityMember,w=(new Date).toUTCString(),O=(0,m.k)({enabled:(0,c.vb)(x)}),S=O.data,P=void 0===S?{}:S,C=O.isLoading,k=void 0!==(null===(j=P)||void 0===j?void 0:j.internal_custom_html_enabled)&&P.internal_custom_html_enabled,I=Boolean(g.id)&&(0,u.Hz)(g);return C?(0,b.jsx)(h.a,{}):(0,b.jsxs)(b.Fragment,{children:[I&&(0,b.jsxs)("div",{className:"form-group form-group--column !mt-0",children:[(0,b.jsx)(a.Q,{field:"created_at",label:(0,o.t)("publish_date"),description:(0,o.t)("publish_date_description")}),(0,b.jsx)(f.W,{name:"created_at",maxDate:w})]}),(0,u.rq)(r)&&(0,b.jsxs)("div",{className:"form-group form-group--two-columns",children:[(0,b.jsx)(a.Q,{field:"cardview_thumbnail",label:(0,o.t)("cardview_thumbnail")}),(0,b.jsx)(v.a,{name:"cardview_thumbnail",aspectRatio:2,title:(0,o.t)("upload_a_cardview_thumbnail")})]}),(0,c.vb)(x)&&k&&(0,b.jsx)(p.l.Item,{hideBorder:!0,name:"internal_custom_html",fullWidth:!0,translationRoot:"post",hidePlaceholder:!0,variant:"extra-bottom-margin",children:(0,b.jsx)(p.l.TextArea,{name:"internal_custom_html"})}),(0,b.jsx)(p.l.Item,{variant:"extra-bottom-margin",hideBorder:!0,name:"space_id",translationRoot:"post",fullWidth:!0,children:(0,b.jsx)(s.M,{name:"space_id",variant:"form-input",spaces:n})}),(0,b.jsx)(p.l.Item,{variant:"extra-bottom-margin",hideBorder:!0,name:"slug",fullWidth:!0,translationRoot:"post",hidePlaceholder:!0,children:(0,b.jsx)(p.l.Input,{name:"slug"})}),y&&(0,b.jsx)(p.l.Item,{variant:"extra-bottom-margin",hideBorder:!0,name:"user_id",translationRoot:"post",fullWidth:!0,children:(0,b.jsx)(p.l.CommunityMemberSelect,{name:"user_id",direction:"up",valueField:"user_id"})})]})},y=n(59393),_=["meta_title","meta_description","opengraph_title","opengraph_description"],j=function(){return(0,b.jsx)("div",{className:"form-section",children:(0,b.jsxs)("div",{className:"form-section__content",children:[_.map((function(e){return(0,b.jsx)(p.l.Item,{label:(0,o.t)("meta_tag_attributes.".concat(e)),description:(0,o.t)("meta_tag_attributes.".concat(e,"_description"),{obj:"post"}),name:"meta_tag_attributes.".concat(e),hideBorder:!0,variant:"extra-bottom-margin",children:(0,b.jsx)(p.l.Input,{id:e,name:"meta_tag_attributes.".concat(e)},e)},e)})),(0,b.jsx)(p.l.Item,{name:"meta_tag_attributes.opengraph_image",label:(0,o.t)("meta_tag_attributes.opengraph_image"),hideBorder:!0,hideDescription:!0,variant:"extra-bottom-margin",children:(0,b.jsx)(v.a,{name:"meta_tag_attributes.opengraph_image",aspectRatio:y.pI.OPEN_GRAPH})})]})})},x=function(e){var t=e.name;return(0,b.jsx)(p.l.Item,{id:"post_".concat(t),name:t,label:(0,o.t)("post.".concat(t)),hideBorder:!0,hideDescription:!0,inlineReverse:!0,children:(0,b.jsx)(p.l.ToggleSwitch,{name:t,variant:"small"})})},w=function(e){var t=e.space,n=(0,i.m)().post,o=(0,(0,r.Gc)().watch)("is_comments_disabled"),a=Boolean(n.id)&&(0,u.Hz)(n);return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(x,{name:"hide_meta_info"}),(0,b.jsx)(x,{name:"is_comments_disabled"}),!o&&(0,b.jsx)(x,{name:"is_comments_closed"}),(0,b.jsx)(x,{name:"is_liking_disabled"}),(0,b.jsx)(x,{name:"is_truncation_disabled"}),a&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(x,{name:"pin_to_top"}),(0,b.jsx)(x,{name:"pinned_at"})]}),!(null!==t&&void 0!==t&&t.hide_from_featured_areas)&&(0,b.jsx)(x,{name:"hide_from_featured_areas"})]})},O=function(e){var t;return"function"===typeof(null===e||void 0===e||null===(t=e.helpers)||void 0===t?void 0:t.findById)},S=function(){var e,t=(0,r.Gc)().watch,n=t("created_at"),o=t("space_id"),i=(0,l.nT)();return O(i)&&(e=i.helpers.findById(o)),(0,b.jsxs)("div",{className:"mx-auto max-w-3xl px-5 pb-5 pt-2",children:[(0,b.jsx)(w,{space:e}),(0,b.jsx)("div",{className:"my-4"}),(0,b.jsx)(g,{space:e}),!!n&&(0,b.jsx)(j,{})]})}},26636:(e,t,n)=>{n.d(t,{L:()=>r});var r=(0,n(30270).Ue)((function(e){return{isFullscreen:!1,toggleFullscreen:function(){return e((function(e){return{isFullscreen:!e.isFullscreen}}))},isSubmitting:!1,setIsSubmitting:function(t){return e({isSubmitting:t})},isDirty:!1,setIsDirty:function(t){return e({isDirty:t})}}}))},80715:(e,t,n)=>{n.d(t,{u:()=>o});var r=n(95172),o=function(e){var t=e.disabled,n=e.onClose;(0,r.y1)("esc",n,{enabled:!t,enableOnContentEditable:!0,enableOnTags:["INPUT","TEXTAREA"]},[t])}},72892:(e,t,n)=>{n.d(t,{c:()=>i});var r=n(86013),o=n(72675),i=function(e){var t=e.shouldPrevent,n=e.message,i=(0,o.dd)();return function(){t&&!confirm(n||(0,r.t)("quick_post_v2.accidental_leave_confirmation"))||i.remove()}}},78163:(e,t,n)=>{n.d(t,{bG:()=>o,r1:()=>i,NU:()=>s,gR:()=>c,vY:()=>u});var r=n(87561),o=function(e){return!!e},i=function(e){return!!e},a=["image","file","embed","mention","horizontalRule"],s=function(e){var t,n;return!(null===e||void 0===e||null===(t=e.body)||void 0===t||null===(n=t.content)||void 0===n||!n.length)&&e.body.content.some((function(e){return!!e.content||a.includes(e.type)}))},l=r.Ry().shape({space_id:r.Rx().required()}),c=r.Ry().shape({name:r.Z_().when("body",{is:function(e){return!o(e)},then:r.Z_().required(),otherwise:r.Z_().nullable()}),body:r.Z_().when("name",{is:function(e){return!i(e)},then:r.Z_().required(),otherwise:r.Z_().nullable()})},[["name","body"]]).concat(l),u=r.Ry().shape({name:r.Z_().when("tiptap_body",{is:function(e){return!s(e)},then:r.Z_().required(),otherwise:r.Z_().nullable()}),tiptap_body:r.Ry().when("name",{is:function(e){return!i(e)},then:r.Ry().test({test:function(e){return s(e)}}),otherwise:r.Ry().nullable()})},[["name","tiptap_body"]]).concat(l)},87868:(e,t,n)=>{n.d(t,{V:()=>r});var r={thumbsup:"\ud83d\udc4d",heart:"\u2764\ufe0f",tada:"\ud83c\udf89",joy:"\ud83e\udd23",open_mouth:"\ud83d\ude2e",cry:"\ud83d\ude22",pray:"\ud83d\ude4f"}},21909:(e,t,n)=>{n.d(t,{D:()=>w});var r=n(67294),o=n(86215),i=n(94184),a=n.n(i),s=n(86013),l=n(77294),c=n(30887),u=n(87958),d=n(87868),m=n(96486),f=n(97012),p=n(42885),v=n(85893);var h=function(e){var t=e.emoji,n=e.reactionableId,r=e.reactionableType,o=e.currentCommunityMemberId,i=e.onClose,a=e.reactions,s=(0,f.wh)().isViewOnlyMasquerading,l=d.V[t],c=(0,p.z)({currentCommunityMemberId:o,emoji:t,reactionableId:n}),u=c.addReaction,h=c.removeReaction;return l?(0,v.jsx)("button",{type:"button",className:"hover:bg-secondary focus-visible:!outline-secondary relative flex gap-1 rounded-md border-transparent px-2 py-0.5 text-sm focus-visible:!outline focus-visible:!outline-2 focus-visible:!outline-offset-2",onClick:s?m.noop:function(){var e,s,l,c=(l=n,(s=r)in(e={emoji:t})?Object.defineProperty(e,s,{value:l,enumerable:!0,configurable:!0,writable:!0}):e[s]=l,e),d=a.find((function(e){return e.emoji===t}));d?d.community_member_ids.includes(o)?h(c):u(c):u(c);i()},children:l}):null},b=function(e){var t=e.reactionableId,n=e.reactionableType,r=e.reactions,o=e.onClose,i=e.currentCommunityMemberId;return(0,v.jsx)("div",{className:"bg-primary flex gap-1 rounded-lg p-1","data-testid":"popover-content",children:Object.keys(d.V).map((function(e){return(0,v.jsx)(h,{emoji:e,reactionableId:t,reactionableType:n,reactions:r,onClose:o,currentCommunityMemberId:i},e)}))})};function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){_(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function j(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return x(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return x(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function x(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var w=function(e){var t=e.reactions,n=e.currentCommunityMemberId,i=e.reactionableId,d=e.reactionableType,m=e.showBorder,f=void 0!==m&&m,p=j((0,r.useState)(null),2),h=p[0],g=p[1],_=j((0,r.useState)(null),2),x=_[0],w=_[1],O=(0,l.D)(h,x,{placement:f?"top-start":"bottom-end"}),S=O.styles,P=O.attributes;return(0,v.jsx)(o.J,{className:"relative",children:function(e){var r=e.close;return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(o.J.Button,{ref:g,className:a()("hover:bg-secondary focus:bg-secondary flex items-center justify-center rounded transition-transform",{"border-primary rounded-full border px-1 hover:border-gray-400":f,"h-6 w-6":!f}),children:(0,v.jsx)(u.T,{placement:"bottom",interactive:!1,content:(0,s.t)("tiptap.add_reaction"),dataTestId:"add_reaction",className:"flex",children:(0,v.jsx)(c.JO,{"aria-label":(0,s.t)("tiptap.add_reaction"),type:"16-reaction",viewBox:"-2 -2 20 20",className:"text-default"})})}),(0,v.jsx)(o.J.Panel,y(y({ref:w,style:S.popper,className:"z-10","data-testid":"filter_component"},P.popper),{},{children:(0,v.jsx)("div",{className:"border-primary mt-1 rounded-lg border shadow-xl",children:(0,v.jsx)(b,{reactions:t,reactionableId:i,reactionableType:d,onClose:r,currentCommunityMemberId:n})})}))]})}})}},42885:(e,t,n)=>{n.d(t,{z:()=>c});var r=n(67294),o=n(88767),i=n(1320),a=n(84495);function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var c=function(e){var t=e.currentCommunityMemberId,n=e.emoji,l=e.reactionableId,c=e.reactionableType,u=e.setCommunityMembers,d=e.communityMemberIds,m=void 0===d?[]:d,f=(0,a.QP)(),p=f.createReactionFromMessage,v=f.removeReactionFromMessage,h=(0,a.Tl)(),b=h.createReactionFromThread,g=h.removeReactionFromThread,y=(0,a.Mk)(),_=y.createReactionFromThreadList,j=y.removeReactionFromThreadList,x=s((0,r.useState)(!1),2),w=x[0],O=x[1],S=(0,o.useMutation)((function(e){return i.ob.addReaction(e)}),{onSettled:function(){O(!1)}}).mutateAsync,P=(0,o.useMutation)((function(e){return i.ob.removeReaction(e)}),{onSettled:function(){O(!1)}}).mutateAsync,C=(0,o.useQuery)(["reaction",l,c,n],(function(){return i.ob.fetchCommunityMemberDetails({ids:m.join(",")})}),{onSuccess:function(e){u&&u(e)},enabled:!1}).refetch,k=function(e){null===p||void 0===p||p(e),null===b||void 0===b||b(e),null===_||void 0===_||_()},I=function(e){null===v||void 0===v||v(e),null===g||void 0===g||g(e),null===j||void 0===j||j()};return{addReaction:function(e){O(!0),k({communityMemberId:t,emoji:e.emoji,reactionableId:e.chat_room_message}),S(e)},removeReaction:function(e){O(!0),I({communityMemberId:t,emoji:e.emoji,reactionableId:e.chat_room_message}),P(e)},fetchCommunityMembers:C,isLoading:w}}},78652:(e,t,n)=>{n.d(t,{pC:()=>r,Kj:()=>o,Rm:()=>i});var r="text-[#6C58E8]",o="copilot",i="activity_scores"},62444:(e,t,n)=>{n.d(t,{b:()=>R});var r=n(72675),o=n(64687),i=n.n(o),a=n(86013),s=n(15610),l=n(65771),c=n(85516),u=n(80360),d=n(53448),m=n(16743),f=n(85893),p=function(e){var t=e.property,n=e.number,r=e.red,o=void 0!==r&&r,i=o?"bg-red-500":"bg-green-700",a=o?"text-red-500":"text-green-700",s=10*parseFloat(n);return(0,f.jsxs)("div",{className:"flex flex-col",children:[(0,f.jsxs)("div",{className:"mb-2 flex justify-between",children:[(0,f.jsx)(m.Z.BodyXs,{children:t}),(0,f.jsx)(m.Z.LabelXxs,{weight:"bold",color:a,children:n})]}),(0,f.jsx)("div",{className:"bg-tertiary h-1 w-full rounded",children:(0,f.jsx)("div",{className:"h-full rounded ".concat(i),style:{width:"".concat(s,"%")}})})]})},v=function(){var e="settings.community_ai.marketing_modal";return(0,f.jsxs)("div",{className:"border-primary rounded border p-5",children:[(0,f.jsx)("div",{className:"mb-1",children:(0,f.jsx)(m.Z.LabelLg,{weight:"bold",color:"text-default",children:(0,a.t)("".concat(e,".activity_score.title"))})}),(0,f.jsx)(m.Z.BodySm,{color:"text-default",children:(0,a.t)("".concat(e,".activity_score.description"))}),(0,f.jsxs)("div",{className:"mt-4 grid grid-cols-2 gap-4",children:[(0,f.jsx)(p,{property:(0,a.t)("".concat(e,".params.presence")),number:"9.5"}),(0,f.jsx)(p,{property:(0,a.t)("".concat(e,".params.contribution")),number:"5.0",red:!0}),(0,f.jsx)(p,{property:(0,a.t)("".concat(e,".params.participation")),number:"8.3"}),(0,f.jsx)(p,{property:(0,a.t)("".concat(e,".params.connection")),number:"8.5"})]})]})},h=n(30887),b=function(e){var t=e.localeItem;return(0,f.jsx)("span",{className:"bg-primary rounded-full px-3 py-1",children:(0,f.jsx)(m.Z.BodyXs,{children:(0,a.t)(["settings.community_ai.marketing_modal","copilot_items",t])})})},g=n(78652),y=function(){var e="settings.community_ai.marketing_modal";return(0,f.jsxs)("div",{className:"border-primary rounded border p-5 pb-0",children:[(0,f.jsx)("div",{className:"mb-1",children:(0,f.jsx)(m.Z.LabelLg,{weight:"bold",color:"text-default",children:(0,a.t)("".concat(e,".copilot.title"))})}),(0,f.jsx)(m.Z.BodySm,{color:"text-default",children:(0,a.t)("".concat(e,".copilot.description"))}),(0,f.jsxs)("div",{className:"relative mt-4 grid grid-cols-2 gap-1 p-4",children:[(0,f.jsx)("div",{className:"absolute inset-0 z-[-1] rounded-t-lg bg-gradient-to-r from-indigo-600 via-purple-600 to-indigo-600 opacity-5"}),(0,f.jsxs)("div",{className:"flex flex-row",children:[(0,f.jsx)(h.JO,{type:"16-artificial-intelligence",className:"text-blue-100"}),(0,f.jsx)(m.Z.LabelXs,{weight:"semibold",color:g.pC,children:(0,a.t)("".concat(e,".ask_ai_to"))})]}),(0,f.jsx)("div",{className:"col-span-2 flex justify-around",children:["give_me_ideas","translate","generate_a_paragraph"].map((function(e){return(0,f.jsx)(b,{localeItem:e},e)}))}),(0,f.jsx)("div",{className:"col-span-2 mt-2 flex justify-around",children:["improve_writing","summarize","adjust_spelling"].map((function(e){return(0,f.jsx)(b,{localeItem:e},e)}))})]})]})},_=n(93826),j=function(e){var t=e.localeItem;return(0,f.jsxs)("li",{className:"mb-4 flex items-start justify-start last:mb-0",children:[(0,f.jsx)("div",{className:"mt-1 flex h-5 w-5 items-center justify-center",children:(0,f.jsx)(h.JO,{size:14,type:"14-magic-ai"})}),(0,f.jsx)("span",{className:"ml-3 text-blue-100",children:(0,f.jsx)(m.Z.BodySm,{color:"text-default",children:(0,f.jsx)(_.w,{content:(0,a.t)(["settings.community_ai.marketing_modal","marketing_items",t]),as:"span"})})})]})},x=function(e){var t=e.feature;return(0,f.jsx)(d.u_.Body,{children:(0,f.jsx)("div",{className:"flex h-full w-full pt-2",children:(0,f.jsxs)("div",{className:"max-w-xl",children:[t===g.Kj&&(0,f.jsx)(y,{}),t===g.Rm&&(0,f.jsx)(v,{}),(0,f.jsxs)("div",{className:"bg-tertiary mt-6 rounded p-4 pt-2",children:[(0,f.jsx)("div",{className:"mb-2",children:(0,f.jsx)(m.Z.LabelXxs,{color:"text-default",children:(0,a.t)("settings.community_ai.marketing_modal.plus")})}),t===g.Kj&&(0,f.jsx)(j,{localeItem:"activity_scores"}),t===g.Rm&&(0,f.jsx)(j,{localeItem:"copilot"}),(0,f.jsx)(j,{localeItem:"transcriptions"})]})]})})})},w=n(24185),O=n(49326),S=n(57956),P=n(21155),C=n(55675);function k(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}function I(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){k(i,r,o,a,s,"next",e)}function s(e){k(i,r,o,a,s,"throw",e)}a(void 0)}))}}var N=function(e){var t=e.plan,n=e.handleClose,r=e.onSuccess,o=e.source,s=(0,P.w)(),l=(0,w.k6)(),c=(0,S.$2)(),u=function(){var e=I(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l.push(O.lA.settings.community_ai),r&&r(),e.next=4,n();case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),p=function(){var e=I(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!c){e.next=6;break}return l.push(O.lA.settings.community_ai),e.next=4,n();case 4:e.next=8;break;case 6:return e.next=8,s.show({planId:t.id,onSuccess:u,source:o,successButtonLabel:(0,a.t)("settings.community_ai.marketing_modal.go_to_community_ai"),showPlanDetails:!0});case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,f.jsxs)(d.u_.Footer,{children:[(0,f.jsx)("div",{children:(0,f.jsx)(C.z,{onClick:p,large:!0,full:!0,variant:"circle",children:(0,a.t)("settings.community_ai.marketing_modal.submit")})}),!c&&(0,f.jsx)("div",{className:"my-3 text-center",children:(0,f.jsx)(m.Z.BodySm,{color:"text-default",children:(0,f.jsx)(_.w,{content:(0,a.t)("settings.community_ai.marketing_modal.by_proceeding",{plan_name:t.display_name,price:t.monthly_base_amount_with_interval}),as:"span"})})})]})},A=function(e){var t=e.handleClose;return(0,f.jsxs)(d.u_.Header,{children:[(0,f.jsxs)(d.u_.Title,{size:"md",className:"w-full text-center",children:[(0,f.jsx)("div",{className:"my-2 inline-block w-auto",children:(0,f.jsxs)("div",{className:"relative",children:[(0,f.jsxs)(m.Z.TitleLg,{children:[(0,a.t)("settings.community_ai.marketing_modal.title.unlock")," ",(0,f.jsx)("span",{className:g.pC,children:(0,a.t)("settings.community_ai.marketing_modal.title.community_ai")})]}),(0,f.jsx)(h.JO,{type:"16-artificial-intelligence",className:"absolute -right-5 -top-1 text-blue-100"})]})}),(0,f.jsx)(m.Z.BodyMd,{color:"text-default",children:(0,a.t)("settings.community_ai.marketing_modal.subtitle")})]}),(0,f.jsx)(d.u_.HeaderActions,{className:"absolute right-0 top-0 mr-6 mt-6",children:(0,f.jsx)(d.u_.CloseButton,{onClick:t})})]})};function E(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}var T=function(e){var t=e.afterClose,n=e.feature,o=void 0===n?g.Rm:n,m=e.source,p=e.onSuccess,v=(0,l.E)().changePlanModalParams,h=(0,r.dd)(),b=v(s.o),y=b.planTier,_=b.planId,j=(0,u.R)({planTier:y,planId:_}),w=j.plan,O=j.isPlanLoading,S=function(){var e,n=(e=i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t&&t(),e.next=3,h.hide();case 3:h.remove();case 4:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){E(i,r,o,a,s,"next",e)}function s(e){E(i,r,o,a,s,"throw",e)}a(void 0)}))});return function(){return n.apply(this,arguments)}}();return(0,f.jsxs)(d.u_,{title:"".concat((0,a.t)("settings.community_ai.marketing_modal.title.unlock")," ").concat((0,a.t)("settings.community_ai.marketing_modal.title.community_ai")),isOpen:h.visible,onClose:S,children:[(0,f.jsx)(d.u_.Overlay,{}),(0,f.jsx)(d.u_.Content,{size:"md",children:O?(0,f.jsx)("div",{className:"my-28",children:(0,f.jsx)(c.u,{})}):(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(A,{handleClose:S}),(0,f.jsx)(x,{feature:o}),(0,f.jsx)(N,{handleClose:S,plan:w,source:m,onSuccess:p})]})})]})},D=r.gk.create((function(e){var t=e.afterClose,n=e.feature,r=void 0===n?g.Rm:n,o=e.source,i=e.onSuccess;return(0,f.jsx)(T,{afterClose:t,feature:r,source:o,onSuccess:i})})),R=function(){return(0,r.dd)(D)}},15610:(e,t,n)=>{n.d(t,{o:()=>r});var r=n(95295).Gb.business},93874:(e,t,n)=>{n.d(t,{QB:()=>p,z4:()=>g,p6:()=>s,cY:()=>l});var r=n(12274),o=n(49546),i=n(86013),a=n(96486),s=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"PP";if(!e)return"\u2500";var n=new Date(e);return(0,r.default)(n)?(0,a.startCase)((0,o.default)(n,t)):"\u2500"},l=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.admin?(0,i.t)("role_admin"):e.moderator?(0,i.t)("moderator"):(0,i.t)("member")},c=n(63367),u=n(48656),d=n(38870),m=n(16743),f=n(85893),p=function(e){var t=e.member,n=e.isAvatarHidden,r=void 0!==n&&n,o=(0,u.H)().showMemberProfileEdit,i=t.name,a=t.avatar_url,s=t.public_uid;return i?(0,f.jsxs)("button",{className:"flex items-center gap-3 text-left",type:"button",onClick:function(){return o({memberPublicId:s})},children:[!r&&(0,f.jsx)(d.s,{src:a,name:i,size:"6"}),(0,f.jsx)(m.Z.LabelSm,{weight:"medium",children:i})]}):(0,f.jsx)(f.Fragment,{children:(0,c.t)("dash")})},v=n(57956),h=n(36843),b=function(e){return{activityScore:{label:e?(0,i.t)("activity_score.view"):(0,i.t)("activity_score.view_score"),activity:"disabled"}}};function g(e){var t=e.memberId,n=e.shortDisabledLabel,r=void 0!==n&&n,o=e.shouldHideIfNoScore,a=void 0!==o&&o,s=(0,h.wW)(),l=s.data,c=s.isLoading,u=(0,v.m3)();if(c)return null;if(u){var d=b(r);return(0,f.jsx)("div",{children:(0,f.jsx)(h.uy,{activityScore:d.activityScore})})}var p=null===l||void 0===l?void 0:l.get(t);return a&&!p?null:p?(0,f.jsx)(h.Yf,{scoreDetail:p}):(0,f.jsx)(m.Z.LabelSm,{color:"text-default",children:(0,i.t)("n/a")})}},48177:(e,t,n)=>{n.d(t,{ij:()=>a,MG:()=>s,N$:()=>l,lU:()=>c,Iq:()=>u,G7:()=>m});var r,o=n(86013);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var a=10,s="all",l="draft",c="scheduled",u="published",d="settings.posts",m=Object.freeze((i(r={},s,(0,o.t)([d,"tabs","all"])),i(r,l,(0,o.t)([d,"tabs","drafts"])),i(r,c,(0,o.t)([d,"tabs","scheduled"])),r))},65998:(e,t,n)=>{n.d(t,{D:()=>d,T:()=>m});var r=n(64687),o=n.n(r),i=n(88767),a=n(34128),s=n(49326),l=n(48177);function c(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}var u=["settings","posts"],d=function(e){var t,n,r=e.page,d=void 0===r?1:r,m=e.filter,f=function(){var e,t=(e=o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,a.UT)(s.av.settings.posts.index({params:{filter:m,page:d,per_page:l.ij}})));case 1:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){c(i,r,o,a,s,"next",e)}function s(e){c(i,r,o,a,s,"throw",e)}a(void 0)}))});return function(){return t.apply(this,arguments)}}(),p=(0,i.useQuery)([].concat(u,[m,d]),f,{keepPreviousData:!0}),v=p.data,h=p.isLoading,b=p.refetch;return{posts:null!==(t=null===v||void 0===v?void 0:v.records)&&void 0!==t?t:[],postsCount:null!==(n=null===v||void 0===v?void 0:v.count)&&void 0!==n?n:0,isLoadingPosts:h,refetchPosts:b}},m=function(){var e=(0,i.useQueryClient)();return{invalidatePostsApiQueries:function(){return e.invalidateQueries(u)}}}},38460:(e,t,n)=>{n.d(t,{V:()=>N});var r=n(64687),o=n.n(r),i=n(67294),a=n(86013),s=n(96486),l=n(58533),c=n(88767),u=n(24185),d=n(98075),m=n(63001),f=n(59393),p=n(49326),v=n(84495),h=n(16743),b=n(97012),g=n(34128),y=n(71032),_=n(3249),j=n(39834),x=n(20633),w=n(1002),O=n(21809),S=n(85893);function P(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}function C(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){P(i,r,o,a,s,"next",e)}function s(e){P(i,r,o,a,s,"throw",e)}a(void 0)}))}}function k(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return I(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return I(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function I(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var N=function(e){var t=e.spaceMembers,n=e.space,r=e.refetchSpaceMembers,P=e.hasMoreSpaceMembers,I=void 0!==P&&P,N=e.fetchNextPage,A=(0,O.p)(),E=(0,u.k6)(),T=(0,v.pB)().findOrCreateChatRoom,D=k((0,i.useState)(!1),2),R=D[0],L=D[1],M=k((0,i.useState)(null),2),F=M[0],U=M[1],B=(0,m.r)(),z=(0,b.wh)(),H=z.currentCommunityMember,q=z.isViewOnlyMasquerading,Z="members_directory.community_members.actions.space",V=(0,c.useMutation)(C(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,g.pC)(p.av.spaceMembers.leaveSpace({spaceId:n.id,memberId:null===F||void 0===F?void 0:F.community_member_id}));case 2:case"end":return e.stop()}}),e)}))),{onError:function(e){A.error(e.message)},onSuccess:function(){A.success((0,a.t)("".concat(Z,".successfully_removed"))),r()},onSettled:function(){L(!1)}}),W=V.mutate,Q=V.isLoading,$=function(e){var t=function(){var t=C(o().mark((function t(){var n;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,T({kind:f.g8,community_member_ids:[null===e||void 0===e?void 0:e.community_member_id]});case 2:n=t.sent,E.push((0,p.co)({url:(0,p.so)({uuid:n})}));case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),n=[{value:"profile",label:(0,a.t)("view_profile"),onClick:function(){return B.show({memberPublicId:null===e||void 0===e?void 0:e.user_public_uid})}}];return function(e,t){return!((null===e||void 0===e?void 0:e.id)===t.community_member_id)&&(null===e||void 0===e?void 0:e.messaging_enabled)&&(t.messaging_enabled||e.is_admin)}(H,e)&&n.push({value:"message",label:(0,a.t)("message"),onClick:q?s.noop:t}),function(e,t){return!((null===e||void 0===e?void 0:e.id)===t.community_member_id)&&(null===e||void 0===e?void 0:e.is_admin)}(H,e)&&n.push({value:"remove",label:(0,a.t)("remove"),onClick:function(){U(e),L(!0)}}),n},G=(0,d.bb)(t),J=G.onlineParticipants,K=G.offlineParticipants,Y=function(e){return e.map((function(e){return(0,S.jsxs)("button",{type:"button",className:"hover:bg-tertiary chat-space-rail__content--member flex w-full cursor-pointer justify-between",onClick:function(){return B.show({memberPublicId:null===e||void 0===e?void 0:e.user_public_uid})},children:[(0,S.jsxs)("div",{className:"text-dark flex w-[90%] items-center text-left",children:[(0,S.jsx)("div",{className:"mr-3",children:(0,S.jsx)(_.g,{name:null===e||void 0===e?void 0:e.name,src:null===e||void 0===e?void 0:e.avatar_url,status:null===e||void 0===e?void 0:e.status,size:"10"})}),(0,S.jsx)("div",{children:null===e||void 0===e?void 0:e.name}),null!==e&&void 0!==e&&e.community_admin?(0,S.jsx)(j.g,{square:!0,className:"ml-2 uppercase",label:(0,a.t)("admin")}):(null===e||void 0===e?void 0:e.moderator)&&(0,S.jsx)(j.g,{square:!0,className:"ml-2 uppercase",label:(0,a.t)("moderator")})]}),(0,S.jsx)("button",{type:"button",onClick:function(e){e.stopPropagation()},children:!q&&(0,S.jsx)(w.Lt,{direction:"bottom-start",menuButtonEl:"div",button:(0,S.jsx)(w.Lt.MenuButton,{id:"action-block",children:(0,S.jsx)(x.h,{name:"20-menu-dots-vertical",iconSize:20,ariaLabel:(0,a.t)("chat_space.view_member_actions")})}),options:$(e)})})]},null===e||void 0===e?void 0:e.id)}))};return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)("div",{id:"scrollableDiv",className:"chat-space-rail__content p-0 md:py-4",style:{height:"100%",overflow:"auto"},children:(0,S.jsxs)(l.Z,{scrollThreshold:.8,next:N,hasMore:I,dataLength:t.length,className:"p-0 px-6 pb-6",scrollableTarget:"scrollableDiv",loader:(0,S.jsx)("div",{className:"flex justify-center",children:(0,S.jsx)(h.Z.LabelXxs,{weight:"semibold",children:(0,a.t)("toggle_with_loader.loading")})}),children:[J.length>0&&(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)("div",{className:"text-default mb-2",children:(0,S.jsx)(h.Z.LabelXxs,{weight:"semibold",children:(0,a.t)("chat_space.online_now")})}),Y(J)]}),K.length>0&&(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)("div",{className:"text-default my-2",children:(0,S.jsx)(h.Z.LabelXxs,{weight:"semibold",children:(0,a.t)("chat_space.offline")})}),Y(K)]})]})}),(0,S.jsx)(y.c,{isOpen:R,title:(0,a.t)("remove"),onClose:function(){return L(!1)},onCancel:function(){return L(!1)},onConfirm:W,confirmText:Q?(0,a.t)("removing"):(0,a.t)("remove"),disabled:Q,confirmVariant:"danger",children:(0,a.t)("".concat(Z,".confirm_remove"),{community_member:null===F||void 0===F?void 0:F.name,space:n.name})})]})}},14929:(e,t,n)=>{n.d(t,{G:()=>O});var r=n(86013),o=n(53448),i=n(72675),a=n(17260),s=n(74284),l=n(81072),c=n(55675),u=n(61926),d=n(16743),m=n(85893),f=function(e){var t=e.createEmbed,n=e.onClose;return(0,m.jsx)(u.l,{onSubmit:function(e){t(e.url),n()},validationSchema:(0,l.o)(),children:(0,m.jsxs)("div",{className:"mx-8 flex h-full flex-col items-center rounded-md",role:"tabpanel",children:[(0,m.jsx)(u.l.Item,{name:"url",fullWidth:!0,hideBorder:!0,hideLabel:!0,hideDescription:!0,className:"!pt-0",placeholder:(0,r.t)("courses.edit.lesson.embed_placeholder"),children:(0,m.jsx)(u.l.Input,{})}),(0,m.jsxs)("div",{className:"mt-12 text-center",children:[(0,m.jsx)(c.z,{type:"submit",variant:"primary",children:(0,r.t)("courses.edit.lesson.embed_media")}),(0,m.jsx)("div",{className:"mt-2",children:(0,m.jsxs)(d.Z.LabelSm,{weight:"semibold",className:"text-light",children:[(0,r.t)("courses.edit.lesson.embed_description")," ",(0,m.jsx)("span",{className:"border-primary inline-flex border-b border-dotted",children:(0,m.jsx)(s.Y,{placement:"bottom-end",content:(0,r.t)("courses.edit.lesson.embed_providers_list"),className:"inline-flex",children:(0,r.t)("courses.edit.lesson.embed_description_more")})})]})})]})]})})},p=n(30887);function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(Object(n),!0).forEach((function(t){b(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function b(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var g=function(e){var t=e.getRootProps,n=e.openFilePicker;return(0,m.jsxs)("div",h(h({className:"border-primary mx-8 my-6 flex flex-col items-center justify-center rounded-md border border-dotted py-6",role:"tabpanel"},t()),{},{children:[(0,m.jsx)(p.JO,{size:42,className:"h-[42px] !w-[42px]",type:"new-file-plus"}),(0,m.jsx)("div",{className:"text-dark mb-1 mt-5",children:(0,m.jsx)(d.Z.LabelSm,{weight:"semibold",children:(0,r.t)("courses.edit.lesson.drop_here")})}),(0,m.jsx)("div",{className:"text-default mb-6",children:(0,m.jsx)(d.Z.LabelSm,{children:(0,r.t)("courses.edit.lesson.drop_placeholder")})}),(0,m.jsx)(c.z,{type:"button",onClick:n,variant:"primary",children:(0,r.t)("courses.edit.lesson.choose_a_file")})]}))};function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var j={upload:(0,r.t)("courses.edit.lesson.upload"),embed:(0,r.t)("courses.edit.lesson.embed")},x=function(e){var t=e.createEmbed,n=e.openFilePicker,r=e.getRootProps,s=(0,i.dd)(),l=s.remove;return(0,m.jsxs)(o.u_,{isOpen:s.visible,onClose:s.remove,children:[(0,m.jsx)(o.u_.Overlay,{}),(0,m.jsx)(o.u_.Content,{size:"lg",className:"h-64 py-3",children:(0,m.jsxs)(a.O.Group,{className:"mt-3 overflow-hidden md:mt-0",children:[(0,m.jsxs)(a.O.List,{className:"border-b px-8",children:[(0,m.jsx)(a.O,{className:"!text-sm md:!text-base",children:j.upload}),(0,m.jsx)(a.O,{className:"!text-sm md:!text-base",children:j.embed})]}),(0,m.jsxs)(a.O.Panels,{children:[(0,m.jsx)(a.O.Panel,{children:(0,m.jsx)(g,{getRootProps:r,openFilePicker:n})}),(0,m.jsx)(a.O.Panel,{className:"py-[52px]",children:(0,m.jsx)(f,{onClose:l,createEmbed:t})})]})]})})]})},w=i.gk.create((function(e){return(0,m.jsx)(x,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach((function(t){_(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e))})),O=function(){return(0,i.dd)(w)}},71791:(e,t,n)=>{n.d(t,{S:()=>_});var r=n(64687),o=n.n(r),i=n(67294),a=n(33315),s=n(48465),l=n(96486),c=n(8322),u=n.n(c),d=n(49326);function m(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}function f(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){m(i,r,o,a,s,"next",e)}function s(e){m(i,r,o,a,s,"throw",e)}a(void 0)}))}}var p=function(){var e=f(o().mark((function e(t){var n,r,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v(t);case 2:return n=e.sent,r=document.querySelector("meta[name=csrf-token]").content,e.next=6,fetch((0,d.hq)(),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-Token":r},body:JSON.stringify({blob:{filename:t.name,content_type:t.type,byte_size:t.size,checksum:n}})});case 6:return i=e.sent,e.next=9,i.json();case 9:return e.abrupt("return",e.sent);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),v=function(){var e=f(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var r=2097152,o=Math.ceil(t.size/r),i=0,a=new(u().ArrayBuffer),s=new FileReader,l=function(){if(i<o||0===i&&0===o){var e=i*r,n=Math.min(e+r,t.size),a=(File.prototype.slice||File.prototype.mozSlice||File.prototype.webkitSlice).call(t,e,n);return s.readAsArrayBuffer(a),i++,!0}return!1};s.addEventListener("load",(function(t){if(a.append(t.target.result),!l()){var n=a.end(!0),r=btoa(n);e(r)}})),s.addEventListener("error",(function(){return n("Error reading ".concat(t.name))})),l()})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),h=n(14929);function b(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}function g(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return y(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return y(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var _=function(e){var t=e.onUploadStarted,n=void 0===t?l.noop:t,r=e.onUploadComplete,c=void 0===r?l.noop:r,u=e.onUploadFailed,d=void 0===u?l.noop:u,m=e.allowedFileTypes,f=void 0===m?void 0:m,v=g((0,i.useState)(!1),2),y=v[0],_=v[1],j=g((0,i.useState)(!1),2),x=j[0],w=j[1],O=g((0,i.useState)(0),2),S=O[0],P=O[1],C=g((0,i.useState)(!1),2),k=C[0],I=C[1],N=(0,h.G)(),A=(0,i.useMemo)((function(){return new s.ZP({restrictions:{maxNumberOfFiles:1,allowedFileTypes:f},autoProceed:!1}).use(a.Z,{limit:10,companionUrl:"/",getChunkSize:function(e){return Math.max(26214400,Math.ceil(e.size/500))}}).on("file-added",function(){var e,t=(e=o().mark((function e(t){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return N.hide(),_(!0),e.prev=2,e.next=5,p(t.data);case 5:n=e.sent,A.setState(n),A.setState({retries:2}),A.setFileMeta(t.id,{key:n.key}),A.upload(),e.next=17;break;case 12:e.prev=12,e.t0=e.catch(2),console.error(e.t0),_(!1),d();case 17:case"end":return e.stop()}}),e,null,[[2,12]])})),function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){b(i,r,o,a,s,"next",e)}function s(e){b(i,r,o,a,s,"throw",e)}a(void 0)}))});return function(e){return t.apply(this,arguments)}}()).on("upload",(function(){_(!1),w(!0),n()})).on("upload-progress",(function(e,t){var n=0;0!==t.bytesUploaded&&(n=t.bytesUploaded/t.bytesTotal),P(100*n)})).on("upload-success",(function(e){var t=A.getState(),n=t.checksum,r=t.id,o=t.created_at,i=t.attachable_sgid,a=t.service_name,s=t.signed_id,l=t.key,u={attachable_sgid:i,byte_size:e.size,checksum:n,content_type:e.type,created_at:o,filename:e.name,id:r,service_name:a,signed_id:s,key:l};c(u),w(!1)})).on("error",(function(){_(!1),w(!1);var e=A.getState().retries;0!==e?(I(!0),setTimeout((function(){A.setState({retries:e-1}),I(!1),A.retryAll()}),5e3)):d()})).on("cancel-all",(function(){w(!1),_(!1)}))}),[]);return{uppy:A,isUploading:x,isRetrying:k,progress:S,isProcessingChecksum:y}}},60142:(e,t,n)=>{n.d(t,{z:()=>m});var r=n(86013),o=n.n(r),i=n(88767),a=n(24185),s=n(34128),l=n(49326),c=n(97012),u=n(71752),d=n(21809),m=function(){var e=(0,a.UO)(),t=e.lessonId,n=e.sectionId,r=(0,i.useQueryClient)(),m=(0,c.L2)().data,f=(0,d.p)(),p=(0,i.useQuery)(["lesson",t,null===m||void 0===m?void 0:m.id,n],(function(){return(0,s.UT)(l.av.courses.getLesson({courseId:m.id,lessonId:t,sectionId:n}))}),{enabled:!!t&&!!m&&!!n,refetchOnWindowFocus:!1,retry:0,onError:function(e){401===(null===e||void 0===e?void 0:e.status)&&(window.location.href="/")}}),v=p.data,h=p.isLoading,b=p.remove,g=(0,i.useMutation)((function(e){return(0,s.aU)(l.av.courses.updateLesson({courseId:m.id,lessonId:t,sectionId:n}),{course_lesson:e})}),{onSuccess:function(){b(),r.removeQueries((0,u.hE)(t)),f.success(o().t("courses.edit.lesson.changes_saved"))},onError:function(e){f.error(e.errorDetails)}});return{currentLesson:v,isLoading:h,updateLesson:g.mutate,isUpdatingLesson:g.isLoading,updateFilesOrder:(0,i.useMutation)((function(e){var r=e.filesOrder;return(0,s.aU)(l.av.courses.updateLesson({courseId:m.id,lessonId:t,sectionId:n}),{course_lesson:{files_order:r}})})).mutate}}},31714:(e,t,n)=>{n.d(t,{l:()=>q});var r=n(67294),o=n(94184),i=n.n(o),a=n(96486),s=n(45338),l=n(30658),c=n(15821),u=n(72675),d=n(97012),m=n(98175),f=n(53448),p=n(85893);function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var b=function(e){var t=e.post,n=e.spaceId,r=e.startingImageIndex,o=(0,u.dd)();return(0,p.jsx)(d.mE,{spaceId:n,children:(0,p.jsx)(m._x,{perPagePostIds:[[null===t||void 0===t?void 0:t.id]],children:(0,p.jsx)(d.DW,{post:t,usedIn:"mobile-full-carousel-modal",children:(0,p.jsxs)(f.u_,{isOpen:o.visible,onClose:o.remove,contentPortalId:"mobile-full-carousel-modal-portal",children:[(0,p.jsx)(f.u_.Overlay,{}),(0,p.jsx)(f.u_.Content,{size:"full",className:"h-full",children:(0,p.jsx)(q,{startingImageIndex:r})})]})})})})},g=u.gk.create((function(e){return(0,p.jsx)(b,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(Object(n),!0).forEach((function(t){h(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e))})),y=n(86013),_=n(30887),j=n(55471),x=function(e){var t=e.image,n=e.canDownload,r=(0,u.dd)();return(0,p.jsxs)("div",{className:"flex justify-end gap-2 pr-2 pt-2",children:[n&&(0,p.jsx)("a",{href:t.original_url,download:!0,"aria-label":(0,y.t)("download"),className:"text-dark hover:text-dark focus:text-dark",children:(0,p.jsx)(_.JO,{type:"16-download",size:16,useWithFillCurrentColor:!0})}),(0,p.jsx)(j.o,{onClick:r.remove})]})},w=n(26953),O=function(e){var t,n=e.image,r=(0,d.Zh)().record,o=(0,w.en)();return(0,p.jsx)("div",{className:i()("absolute right-4 top-4 z-[2] flex",{"hidden group-hover:flex":o}),children:(null===r||void 0===r||null===(t=r.gallery)||void 0===t?void 0:t.downloadable_images)&&(0,p.jsx)("a",{href:n.original_url,download:!0,"aria-label":(0,y.t)("download"),className:"flex h-8 w-8 justify-center rounded-full bg-black p-1 text-white transition-transform hover:text-white focus:text-white",children:(0,p.jsx)(_.JO,{type:"16-download",size:16,useWithFillCurrentColor:!0})})})};function S(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return P(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return P(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function P(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var C=function(e){var t=e.image,n=e.positionClassName,o=e.containerWidth,a=e.currentImageIndex,s=e.index,l=e.usedIn,c=e.shouldAnimate,u=e.zoomLevel,d=e.zoomPosition,m=S((0,r.useState)(),2),f=m[0],v=m[1],h=S((0,r.useState)("lazy"),2),b=h[0],g=h[1];return!f&&a+1>=s&&(v(t.url),s>1&&g("eager")),f&&f!==t.url&&v(t.url),(0,p.jsxs)("div",{className:i()("relative flex h-full w-full shrink-0 grow-0 basis-full items-center justify-center",{"transition-transform duration-300":c,"z-[1]":a===s}),style:{transform:o?"translateX(-".concat(o*a,"px)"):void 0},children:["full-post-modal"===l&&a===s&&(0,p.jsx)(O,{image:t}),"mobile-full-carousel-modal"!==l&&(0,p.jsx)("div",{className:"carousel-image absolute inset-0 scale-110 bg-cover bg-center blur-lg",style:{backgroundImage:f&&"url(".concat(f,")")}}),(0,p.jsx)("img",{className:i()("carousel-image relative select-none",{"transition-transform":u},n),draggable:!1,loading:b,alt:"",src:f,style:{transform:u&&u>1?"translate(".concat(d[0],"px, ").concat(d[1],"px) scale(").concat(u,")"):void 0}})]})},k=n(20633),I=function(e){var t=e.direction,n=e.onClick;return(0,p.jsx)(k.h,{name:"20-chevron-".concat("prev"===t?"left":"right"),iconSize:20,onClick:n,iconClassName:"!text-gray-600",className:i()("absolute top-1/2 z-[2] hidden -translate-y-1/2 rounded-full border border-gray-300 bg-white hover:!bg-[#F7F9FA] focus:!bg-[#F7F9FA] sm:group-hover:flex",{"left-4":"prev"===t,"right-4":"next"===t}),ariaLabel:"prev"===t?(0,y.t)("previous"):(0,y.t)("next")})};function N(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return A(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return A(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function A(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var E=16/9,T=function(e){var t=e.images,n=e.currentImageIndex,o=e.onPrevImage,a=e.onNextImage,s=e.usedIn,l=e.shouldAnimate,c=e.zoomLevel,u=e.zoomPosition,d=e.shouldHaveRoundedBottomCorners,m=void 0!==d&&d,f=(0,r.useRef)(null),v=t[0].width/t[0].height,h=function(e,t,n){var o,i=N((0,r.useState)(),2),a=i[0],s=i[1],l=N((0,r.useState)(),2),c=l[0],u=l[1],d=N((0,r.useState)(),2),m=d[0],f=d[1];return(0,r.useEffect)((function(){if(e&&t.current){var r=t.current,o=r.clientWidth,i=r.clientHeight,a=e>E?E:e,l=o/a;"full-post-modal"===n?(s("100%"),f(o/i)):l>678?(s(678),f(o/678)):(s(l),f(a)),u(o)}}),[t,e,n,null===(o=t.current)||void 0===o?void 0:o.clientWidth]),{containerCalculatedHeight:a,containerWidth:c,containerRatio:m}}(v,f,s),b=h.containerRatio,g=h.containerCalculatedHeight,y=h.containerWidth,_=function(e,t){var n;return e&&t&&(n=e>t?"w-full":e<t?"h-full":"h-full w-full"),n}(v,b);return(0,p.jsxs)("div",{className:i()("group relative flex items-center overflow-hidden",{"lg:h-full":"full-post-modal"===s,"md:rounded-b-lg":m}),style:{height:"full-post-modal"!==s?g:void 0},ref:f,children:[t.map((function(e,t){return(0,p.jsx)(C,{image:e,currentImageIndex:n,index:t,positionClassName:_,containerWidth:y,usedIn:s,shouldAnimate:l,zoomLevel:c,zoomPosition:u},e.id)})),n>0&&(0,p.jsx)(I,{onClick:o,direction:"prev"}),n<t.length-1&&(0,p.jsx)(I,{onClick:a,direction:"next"})]})},D=function(e){var t=e.images,n=e.currentImageIndex,r=e.setCurrentImageIndex,o=e.usedIn,a=(0,w.en)(),s=(0,l.m)().isPostBodyEmpty;return t.length<2?"mobile-full-carousel-modal"===o?(0,p.jsx)("div",{className:"!pt-0 pb-12"}):null:(0,p.jsx)("div",{className:i()("z-[2] w-full justify-center pt-5",{"absolute bottom-4 left-1/2 flex w-auto -translate-x-1/2 !pt-0":a,"pb-5":!a&&("full-post-modal"===o||s),"!pt-0 pb-12":"mobile-full-carousel-modal"===o}),children:(0,p.jsx)("div",{className:i()("bg-primary flex justify-center gap-1 rounded-xl p-0",{"!bg-white !p-2":a}),children:t.map((function(e,o){return(0,p.jsx)("button",{type:"button","aria-label":(0,y.t)("image_space.carousel.indicator_button",{image_index:o+1,total_images:t.length}),onClick:function(){return r(o)},className:i()("border-3 h-1.5 w-1.5 rounded-full",{"border-dark":!a&&o!==n,"border-gray-300":a&&o!==n,"border-darkest":!a&&o===n,"border-gray-900":a&&o===n})},e.id)}))})})};function R(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return L(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return L(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function L(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var M=function(e){var t=R((0,r.useState)(e?1:void 0),2),n=t[0],o=t[1],i=R((0,r.useState)([0,0]),2),s=i[0],l=i[1],c=(0,r.useMemo)((function(){return(0,a.throttle)((function(e){l((function(t){return function(e,t,n){if(void 0===t||1===t)return n;if(!(e.target instanceof HTMLImageElement))return n;var r=e.target,o=r.parentNode;if(!(o instanceof HTMLDivElement))return n;var i=o.getBoundingClientRect(),a=r.getBoundingClientRect(),s=i.left+i.width/2,l=i.top+i.height/2,c=function(e){var t,n;return"clientX"in e&&"clientY"in e?(t=e.clientX,n=e.clientY):"touches"in e&&e.touches.length>0&&(t=e.touches[0].clientX,n=e.touches[0].clientY),[t,n]}(e),u=R(c,2),d=u[0],m=u[1];if(void 0===d||void 0===m)return n;var f=(s-d)*(t-1),p=(l-m)*(t-1),v=f-n[0],h=p-n[1];return(a.left+v>i.left||a.right+v<i.right)&&(f=n[0]),(a.top+h>i.top||a.bottom+h<i.bottom)&&(p=n[1]),[f,p]}(e,n,t)}))}),50)}),[n,l]),u=(0,r.useCallback)((function(e){e.persist(),c(e)}),[c]);return{zoomLevel:n,resetZoom:function(){l([0,0]),o(1)},cycleZoom:function(){o((function(e){return 1===e?2:2===e?3:1}))},zoomPosition:s,setZoomPosition:l,onMouseMove:u}};function F(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function U(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?F(Object(n),!0).forEach((function(t){B(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):F(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function B(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function z(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return H(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return H(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function H(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var q=function(e){var t,n,o=e.onPostChange,m=void 0===o?a.noop:o,f=e.onPostDestroy,v=void 0===f?a.noop:f,h=e.startingImageIndex,b=void 0===h?0:h,y=e.className,_=void 0===y?"":y,j=(0,d.Zh)(),O=j.record,S=j.usedIn,P="full-post-modal"===S,C="mobile-full-carousel-modal"===S,k="full-post-modal"!==S&&"mobile-full-carousel-modal"!==S,I=P,N=(0,d.wh)().currentCommunitySettings,A=(0,l.m)().isPostBodyEmpty,E=k&&(null===O||void 0===O?void 0:O.is_liking_disabled)&&(null===O||void 0===O?void 0:O.is_comments_disabled)&&A,R=null===N||void 0===N?void 0:N.tailwind_posts_enabled,L=z((0,r.useState)(b),2),F=L[0],B=L[1],H=M(I),q=H.zoomLevel,Z=H.onMouseMove,V=H.resetZoom,W=H.cycleZoom,Q=H.zoomPosition,$=z((0,r.useState)(0===b),2),G=$[0],J=$[1],K=(0,d.L2)().data,Y=(0,c.F)(),X=(0,u.dd)(g),ee=(0,w.WJ)(),te=!(0,w.WJ)(),ne=P||C,re=(0,l.m)(),oe=re.isSharedPostView,ie=re.isSharedPostWithTeaserLayout,ae=re.isSharedPostViewWithMinimalLayout,se=null===O||void 0===O||null===(t=O.gallery)||void 0===t?void 0:t.images,le=ie&&se?se.slice(0,1):se,ce=function(){I&&V(),J(!0),B((function(e){return Math.min(e+1,le?le.length-1:e+1)}))},ue=function(){I&&V(),J(!0),B((function(e){return Math.max(e-1,0)}))},de=(0,s.QS)({onSwipedRight:q&&q>1?void 0:ue,onSwipedLeft:q&&q>1?void 0:ce,onTap:function(e){e.event.target.classList.contains("carousel-image")&&!ie&&(I?W():te?X.show({post:O,spaceId:null===K||void 0===K?void 0:K.id,startingImageIndex:F}):ee&&Y.show({post:O,spaceId:null===K||void 0===K?void 0:K.id,onPostChange:m,onPostDestroy:v,isSharedPostView:oe,startingImageIndex:F}))},trackMouse:!0});return O&&le?(0,p.jsxs)("div",U(U({className:i()("group relative w-full cursor-pointer px-0 pt-5",{"!pt-16":O.hide_meta_info&&k&&!R,"!py-0 lg:h-full":P,"flex h-full flex-col justify-between !py-0":C,"!cursor-zoom-in":I,"!pt-0":ae&&!R||R&&!A,"mb-5":R&&!A&&!ne},_),onMouseMove:I?Z:void 0,onTouchMove:I?Z:void 0},de),{},{children:[C&&(0,p.jsx)(x,{canDownload:null===O||void 0===O||null===(n=O.gallery)||void 0===n?void 0:n.downloadable_images,image:le[F]}),(0,p.jsx)(T,{images:le,currentImageIndex:F,onPrevImage:ue,onNextImage:ce,usedIn:S,shouldAnimate:G,zoomLevel:q,zoomPosition:Q,shouldHaveRoundedBottomCorners:E}),(0,p.jsx)(D,{images:le,currentImageIndex:F,setCurrentImageIndex:function(e){I&&V(),B(e)},usedIn:S})]})):null}},15821:(e,t,n)=>{n.d(t,{F:()=>P});var r=n(67294),o=n(94184),i=n.n(o),a=n(88767),s=n(81217),l=n(64209),c=n(72675),u=n(97012),d=n(98175),m=n(53448),f=n(31714),p=n(86013),v=n(43114),h=n(39103),b=n(55471),g=n(16743),y=n(85893),_=function(e){var t=e.onPostChange,n=e.onPostDestroy,r=e.autofocusReplyForm,o=(0,c.dd)(),i=(0,u.wh)().currentCommunitySettings,s=(0,u.Zh)().record,d=null===i||void 0===i?void 0:i.tailwind_posts_enabled,m=d?h.D:v.D,f=(0,a.useQueryClient)();return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsxs)("div",{className:"border-primary flex justify-between border-y p-6 pb-5 sm:border-t-0",children:[(0,y.jsx)(g.Z.TitleSm,{weight:"semibold",children:(0,p.t)("image_space.grid_view.post_details")}),(0,y.jsx)(b.o,{onClick:function(){f.invalidateQueries([l.bx,s.id]),o.remove()}})]}),(0,y.jsx)(m,{defaultShowComment:!0,autofocusReplyForm:r,onPostChange:t,onPostDestroy:function(e){o.remove(),n(e)},hideShareLink:!0,hidePinnedToTopIcon:!0,hideBookmarkButton:!0,hideAuthorHeadline:!d,tagsLimit:1,tagsShowMoreLabelVariant:"numbers",metaInfoWrapperClassName:"!pr-0"})]})},j=function(e){var t=e.onPostChange,n=e.onPostDestroy,r=e.startingImageIndex,o=e.autofocusReplyForm;return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("div",{className:"flex max-h-full w-full flex-col overflow-auto lg:h-full lg:w-3/5 xl:w-2/3",children:(0,y.jsx)(f.l,{startingImageIndex:r})}),(0,y.jsx)("div",{className:"border-primary flex w-full flex-col lg:h-full lg:w-2/5 lg:overflow-scroll lg:border-l xl:w-1/3",children:(0,y.jsx)(_,{onPostChange:t,onPostDestroy:n,autofocusReplyForm:o})})]})};function x(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function w(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var O=function(e){var t=e.post,n=e.spaceId,o=e.onPostChange,f=e.onPostDestroy,p=e.startingImageIndex,v=e.autofocusReplyForm,h=void 0!==v&&v,b=e.isSharedPostView,g=void 0!==b&&b,_=(0,c.dd)(),x=(0,r.useRef)(null),w=(0,s.t)({spaceId:null===t||void 0===t?void 0:t.space_id,spaceSlug:null===t||void 0===t?void 0:t.space_slug,postSlug:null===t||void 0===t?void 0:t.slug}),O=w.post,S=w.onPostChange,P=(0,u.wh)().currentCommunitySettings,C=null===P||void 0===P?void 0:P.tailwind_posts_enabled,k=(0,a.useQueryClient)();return(0,y.jsx)(u.mE,{spaceId:n,children:(0,y.jsx)(d._x,{perPagePostIds:[[null===t||void 0===t?void 0:t.id]],isSharedPostView:g,children:(0,y.jsx)(u.DW,{post:O||t,usedIn:"full-post-modal",children:(0,y.jsxs)(m.u_,{initialFocus:x,isOpen:_.visible,onClose:function(){k.invalidateQueries([l.bx,null===t||void 0===t?void 0:t.id]),_.remove()},contentPortalId:"full-post-modal-portal",children:[(0,y.jsx)(m.u_.Overlay,{}),(0,y.jsxs)(m.u_.Content,{size:"full",className:i()("flex !flex-row flex-wrap content-start sm:!max-h-[836px] sm:!max-w-[1256px]",{"post-v2":!C}),children:[(0,y.jsx)("div",{ref:x,tabIndex:-1}),(0,y.jsx)(j,{onPostChange:function(e,t){o(e),S(e,t)},onPostDestroy:f,startingImageIndex:p,autofocusReplyForm:h})]})]})})})})},S=c.gk.create((function(e){return(0,y.jsx)(O,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?x(Object(n),!0).forEach((function(t){w(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e))})),P=function(){return(0,c.dd)(S)}},82275:(e,t,n)=>{n.d(t,{d:()=>S});var r=n(94184),o=n.n(r),i=n(86478),a=n(36189),s=n(15821),l=n(68375),c=n(26953),u=n(74238),d=n(97012),m=n(32224),f=n(38870),p=n(16743),v=n(85893);function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){g(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function g(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var y=function(e){var t,n,r,h=e.post,y=e.onPostChange,_=e.onPostDestroy,j=(0,m.O)({public_uid:null!==(t=h.community_member.public_uid)&&void 0!==t?t:"",params:{show_back_link:!0}}),x=(0,u.TC)().isDarkAppearance,w=(0,c.en)(),O=(0,s.F)(),S=(0,d.L2)().data,P=x?"bg-[#2B2E33CC] backdrop-blur-[1px]":"bg-[#FFFFFFCC] backdrop-blur-[1px]",C=(0,d.wh)().currentCommunitySettings,k=null===C||void 0===C?void 0:C.tailwind_posts_enabled,I=k?a.S:i.S;return(0,v.jsxs)("div",{className:o()("mt-2 flex w-full flex-row-reverse items-center justify-between gap-2",{"absolute bottom-2 mt-0 hidden px-2 focus:flex focus-visible:flex group-hover:flex peer-hover:flex peer-focus-visible:flex":w}),children:[(0,v.jsx)("div",{className:"flex shrink-0 items-center justify-end gap-2",children:(0,v.jsx)(I,b({type:"list",wrapperClassName:"!mr-0",commentButtonClassName:o()("rounded-md p-1",(n={},g(n,P,w),g(n,"pr-0",!k),n)),commentIconClassName:"text-selector-active md:!mr-0",likeButtonClassName:o()("rounded-md p-1",(r={},g(r,P,w),g(r,"pr-0",!k),r)),likeIconClassName:"text-selector-active md:!mr-0",likedSpanClassName:"text-brand",showLikesCount:!w,showCommentsCount:!w},w&&{onCommentsClick:function(e){e.preventDefault(),O.show({post:h,spaceId:null===S||void 0===S?void 0:S.id,onPostChange:y,onPostDestroy:_,autofocusReplyForm:!0})}}))}),!(0,l.A8)(h)&&(0,v.jsxs)("a",b(b({},j),{},{className:o()("flex items-center justify-start gap-2 overflow-hidden rounded-md py-1 pl-1 pr-2",g({},P,w)),children:[(0,v.jsx)(f.s,{src:h.community_member.avatar_url||"",name:h.community_member.name||"",size:"5"}),(0,v.jsx)(p.Z.LabelSm,{weight:"medium",truncate:!0,children:h.community_member.name})]}))]})},_=n(30887),j=n(86013),x=function(e){var t=e.post,n=e.children,r=e.onPostChange,o=e.onPostDestroy,i=(0,s.F)(),a=(0,d.L2)().data;return(0,v.jsx)("button",{type:"button",className:"focus-visible:outline-secondary peer w-full focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2","aria-label":(0,j.t)("image_space.grid_view.open_full_post"),onClick:function(){return i.show({post:t,spaceId:null===a||void 0===a?void 0:a.id,onPostChange:r,onPostDestroy:o})},children:n})},w=n(40518),O=function(e){var t=e.post,n=e.children;return(0,v.jsx)(w.s,{post:t,className:"focus-visible:outline-secondary peer inline-block focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",children:n})},S=function(e){var t=e.post,n=e.isSquareGrid,r=void 0===n||n,i=e.onPostChange,a=e.onPostDestroy,s=(0,c.WJ)()?x:O;return(0,v.jsxs)("div",{className:"group relative",children:[(0,v.jsxs)("div",{className:"absolute right-2 top-2 flex",children:[t.gallery.images.length>1&&(0,v.jsx)(_.JO,{type:"16-multiple-images",size:16}),t.pinned_at_top_of_space&&(0,v.jsx)(_.JO,{type:"16-pin-sm-white",size:16})]}),(0,v.jsx)(s,{post:t,onPostChange:i,onPostDestroy:a,children:(0,v.jsx)("img",{loading:"lazy",src:t.gallery.images[0].url,alt:t.truncated_content,className:o()("pointer-events-none inline-block w-full rounded-md md:rounded-none",{"aspect-square object-cover":r})})}),(0,v.jsx)(y,{post:t,onPostChange:i,onPostDestroy:a})]})}},11178:(e,t,n)=>{n.d(t,{p:()=>i});var r=n(82275),o=n(85893),i=function(e){var t=e.post,n=e.onPostChange,i=e.onPostDestroy;return(0,o.jsx)(r.d,{post:t,onPostChange:n,onPostDestroy:i,isSquareGrid:!1})}},37292:(e,t,n)=>{n.d(t,{J:()=>a,W:()=>s});var r=n(88767),o=n(34128),i=n(49326),a="topics",s=function(e){var t=e.space_id,n=[a,t],s=(0,r.useQuery)(n,(function(){return(0,o.UT)(i.av.topics.spaceTopics({spaceId:t}))}),{enabled:!!t}),l=s.data,c=s.isLoading;return{topics:(null===l||void 0===l?void 0:l.records)||[],isLoading:c}}},2194:(e,t,n)=>{n.d(t,{$:()=>r});var r=function(e){var t=e.shouldShowLockIconForNonMembers,n=e.isPrivate,r=e.isAdmin;return!(void 0!==r&&r)&&n&&t}},62268:(e,t,n)=>{n.d(t,{O:()=>s});var r=n(94184),o=n.n(r),i=n(86013),a=n(85893),s=function(e){var t=e.value,n=e.handleFeedback,r=e.isFeedbackGiven,s=void 0===r?null:r;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{className:o()("w-full rounded-lg border px-6 py-2.5 align-baseline font-medium",{"text-dark border-gray-300 dark:border-gray-500":null===t||!1===t,"border-circle text-circle border-2":!0===t,"!cursor-not-allowed":s,"hover:border-secondary dark:hover:border-secondary":!s}),onClick:function(){return!0!==t&&n(!0)},type:"button",children:(0,i.t)("support_widget.feedback_yes")}),(0,a.jsx)("button",{className:o()("w-full rounded-lg border px-6 py-2.5 align-baseline font-medium ",{"text-dark border-gray-300 dark:border-gray-500":null===t||!0===t,"border-circle text-circle border-2":!1===t,"!cursor-not-allowed":s,"hover:border-secondary dark:hover:border-secondary":!s}),onClick:function(){return!1!==t&&n(!1)},type:"button",children:(0,i.t)("support_widget.feedback_no")})]})}},89761:(e,t,n)=>{n.d(t,{H:()=>u});var r=n(67294),o=n(87536),i=n(97012),a=n(91741),s=n(61926),l=n(5295),c=n(85893),u=function(e){var t=e.formItemName,n=e.formItemTranslationRoot,u=e.formItemRules,d=e.formItemTooltipText,m=e.disabled,f=e.markDefaultCurrencyDirty,p=void 0!==f&&f,v=(0,o.Gc)(),h=v.watch,b=v.setValue,g=h(t),y=(0,i.wh)(),_=y.data.current_community_settings,j=y.isLoading,x=(0,a.K)(),w=x.data,O=x.isLoading;if((0,r.useEffect)((function(){if(!g){var e=(w||[]).find((function(e){return e.is_default}));e&&(p?b(t,"".concat(e.id),{shouldDirty:!0}):b(t,"".concat(e.id)))}}),[t,b,w,g]),j||O||!w)return(0,c.jsx)(l.a,{});if(!_.currencies_enabled)return null;var S=w.map((function(e){return{label:e.code.toUpperCase(),value:"".concat(e.id)}}));return(0,c.jsx)(s.l.Item,{fullWidth:!1,hideBorder:!0,hideDescription:!0,hidePlaceholder:!0,name:t,rules:u,translationRoot:n,tooltipText:d,children:(0,c.jsx)(s.l.SelectNative,{name:t,options:S,disabled:m})})}},30414:(e,t,n)=>{n.d(t,{T:()=>i});var r=n(97012),o=n(85893),i=function(e){var t=e.children;return(0,r.wh)().isViewOnlyMasquerading?(0,o.jsx)("div",{className:"!cursor-not-allowed",children:(0,o.jsx)("div",{className:"!pointer-events-none",children:t})}):t}},29984:(e,t,n)=>{n.d(t,{d:()=>c,D:()=>u});var r=n(67294),o=n(85893);function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var s={},l=(0,r.createContext)(s);l.displayName="CurrentLessonContext";var c=function(e){var t=e.children,n=i((0,r.useState)(!0),2),a={isSubmitEnabled:n[0],setIsSubmitEnabled:n[1]};return(0,o.jsx)(l.Provider,{value:a,children:t})},u=function(){var e=(0,r.useContext)(l);if(!e)throw new Error("useCurrentLessonContext must be used within a CurrentLessonContextProvider");return e}},1963:(e,t,n)=>{n.d(t,{hg:()=>Z,Vu:()=>V});var r=n(67294),o=n(96486),i=n(72675),a=n(97012),s=n(88767),l=n(73328),c=n(34128),u=n(49326),d=n(83749),m=n(82258),f=n(53448),p=n(86013),v=n(30887),h=n(16743),b=n(85893),g=function(){return(0,b.jsx)("div",{className:"bg-primary m-auto text-center",children:(0,b.jsxs)("div",{className:"m-auto flex h-32 max-w-md flex-col items-center justify-center gap-4 p-8","data-testid":"empty-search",children:[(0,b.jsx)(v.JO,{type:"32-search-v2",className:"text-default !h-8 !w-8",size:32}),(0,b.jsx)("div",{className:"flex flex-col gap-2",children:(0,b.jsx)(h.Z.BodySm,{color:"text-default",children:(0,p.t)("view_only_masquerading.empty_search_placeholder")})})]})})},y=n(19300),_=function(e){var t=e.setCategory,n=e.setQuery;return(0,b.jsxs)("div",{className:"mx-auto flex h-32 flex-col items-center justify-center pb-8 pt-6 leading-tight",children:[(0,b.jsx)("div",{className:"pb-2",children:(0,b.jsx)(h.Z.TitleSm,{weight:"semibold",children:(0,p.t)("view_only_masquerading.no_results")})}),(0,b.jsx)("div",{children:(0,b.jsx)(h.Z.BodySm,{color:"text-default",children:(0,p.t)("view_only_masquerading.try_a_different_term")})}),(0,b.jsx)("div",{className:"pt-2",children:(0,b.jsx)("button",{type:"button",onClick:function(){"function"==typeof t&&t(""),n("")},children:(0,b.jsx)(y.Di,{color:"text-circle",weight:"semibold",children:(0,p.t)("view_only_masquerading.back")})})})]})},j=function(e){var t=e.isLoading,n=e.query,r=e.setQuery;return(0,b.jsx)("div",{className:"bg-primary sticky top-0 isolate z-10 flex items-center justify-between p-4 md:static md:top-auto md:p-0",children:(0,b.jsx)("div",{className:"mr-0 flex w-full items-center md:p-5",children:(0,b.jsxs)("div",{className:"bg-secondary sm:bg-primary border-secondary flex w-full items-center gap-3 rounded-md border px-2 py-1 sm:rounded-md sm:px-2 sm:py-1",children:[(0,b.jsx)("div",{className:"flex",children:t?(0,b.jsx)(v.JO,{type:"loader",className:"text-default",size:20,useWithFillCurrentColor:!0}):(0,b.jsx)(v.JO,{type:"16-search",className:"text-default",size:16,useWithFillCurrentColor:!0})}),(0,b.jsx)("input",{className:"text-dark sm:bg-primary placeholder:text-light h-6 w-full rounded bg-transparent text-sm outline-none placeholder:opacity-100 sm:rounded-none",placeholder:(0,p.t)("view_only_masquerading.input_placeholder"),"aria-autocomplete":"list",value:n,onChange:function(e){return r(e.target.value)}}),(0,b.jsx)("button",{type:"submit",className:"text-default flex pt-1",onClick:function(){return r("")},children:!!n&&(0,b.jsx)(v.JO,{type:"20-close-md",useWithFillCurrentColor:!0})})]})})})},x=n(73952),w=n(38870),O=function(e){var t,n=e.id,r=e.type,o=e.name,i=e.avatarUrl,a=e.onClick;return"CommunityMember"==r?t=(0,b.jsx)(w.s,{src:i,name:o,size:"5"}):"Paywall"==r?t=(0,b.jsx)(v.JO,{type:"credit-card",className:"text-default shrink-0",size:16}):"InvitationLink"==r&&(t=(0,b.jsx)(v.JO,{type:"16-link",className:"text-default shrink-0",size:16})),(0,b.jsx)("li",{children:(0,b.jsx)("button",{tabIndex:0,type:"button",className:"text-dark bg-primary hover:bg-secondary focus:bg-secondary flex w-full cursor-pointer items-center justify-between gap-4 px-5 py-2.5 transition-colors",onClick:function(){return a(n,r)},children:(0,b.jsxs)("div",{className:"truncate-one-line flex items-center gap-3",children:[t,(0,b.jsx)(x.T1,{children:o})]})})})};function S(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return P(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return P(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function P(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var C=function(){var e=(0,i.dd)(),t=(0,r.useRef)(null),n=(0,r.useRef)(null);(0,l.Z)(t,(function(){e.remove()}));var o=S((0,r.useState)(""),2),a=o[0],p=o[1],v=S((0,r.useState)([]),2),h=v[0],y=v[1],x=S((0,r.useState)(!1),2),w=x[0],P=x[1],C=(0,m.c)(a,500),k=(0,s.useQuery)({queryKey:["masquerading/entities",C],queryFn:function(){return(0,c.UT)(u.av.masquerading.entities.index({query:C,members_only:!0}))},refetchOnWindowFocus:!1,enabled:!!C,staleTime:3e5}),I=k.data,N=k.isLoading;(0,r.useEffect)((function(){C||(P(!1),y([]))}),[C]),(0,r.useEffect)((function(){if(I){var e=I.records,t=I.category,n=I.query;t||n?(P(0===e.length),y(e)):(P(!1),y([]))}}),[I]);var A=function(e,t){return(0,d.g)({entityId:e,entityType:t,mode:"edit"}).then((function(e){return window.open(e.masquerade_url,"_self")})).catch((function(e){console.error(e)}))};return(0,b.jsx)(f.u_,{isOpen:e.visible,onClose:e.remove,children:(0,b.jsx)(f.u_.Content,{position:"top",className:"border-primary w-full rounded-[0px] sm:rounded-lg sm:border md:!mt-[3.25rem] md:w-[335px]",size:"xl",children:(0,b.jsxs)("div",{ref:t,children:[(0,b.jsx)(j,{isLoading:N,query:a,setQuery:p}),h.length>0?(0,b.jsx)("div",{className:"overflow-y-auto md:max-h-96",ref:n,children:(0,b.jsx)("ul",{className:"list-none",children:h.map((function(e){return(0,b.jsx)(O,{id:e.id,type:e.type,name:e.name,avatarUrl:e.avatar_url,onClick:A},"".concat(e.type,"-").concat(e.id))}))})}):w?(0,b.jsx)(_,{setQuery:p}):(0,b.jsx)(g,{})]})})})};function k(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return I(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return I(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function I(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var N=function(){var e=(0,i.dd)(),t=(0,r.useRef)(null),n=(0,r.useRef)(null);(0,l.Z)(t,(function(){e.remove()}));var a=k((0,r.useState)(""),2),c=a[0],d=a[1],h=k((0,r.useState)([]),2),y=h[0],j=h[1],x=k((0,r.useState)(!1),2),w=x[0],S=x[1],P=(0,r.useCallback)((function(){d(""),j([]),S(!1)}),[]),C=(0,m.c)(c,500),I=(0,s.useQuery)(u.av.masquerading.entities.index({query:C}),{refetchOnWindowFocus:!1,enabled:!1}),N=I.data,A=I.isLoading,E=I.refetch;return(0,r.useEffect)((function(){C&&E()}),[C,E]),(0,r.useEffect)((function(){if(c&&null!==N&&void 0!==N&&N.records){var e=N.records;j(e),S(0===e.length)}else j([]),S(!1)}),[N,c]),(0,b.jsx)(f.u_,{isOpen:e.visible,onClose:e.remove,children:(0,b.jsx)(f.u_.Content,{position:"top",className:"border-primary w-full rounded-[0px] sm:rounded-lg sm:border md:!mt-[3.25rem] md:w-[335px]",size:"xl",children:(0,b.jsxs)("div",{ref:t,children:[(0,b.jsx)("div",{className:"bg-primary sticky top-0 isolate z-10 flex items-center justify-between p-4 md:static md:top-auto md:p-0",children:(0,b.jsx)("div",{className:"mr-0 flex w-full items-center md:p-5",children:(0,b.jsxs)("div",{className:"bg-secondary sm:bg-primary border-secondary flex w-full items-center gap-3 rounded-md border px-2 py-1 sm:rounded-md sm:px-2 sm:py-1",children:[(0,b.jsx)("div",{className:"flex",children:A?(0,b.jsx)(v.JO,{type:"loader",className:"text-default",size:20,useWithFillCurrentColor:!0}):(0,b.jsx)(v.JO,{type:"16-search",className:"text-default",size:16,useWithFillCurrentColor:!0})}),(0,b.jsx)("input",{className:"text-dark sm:bg-primary placeholder:text-light h-6 w-full rounded bg-transparent text-sm outline-none placeholder:opacity-100 sm:rounded-none",placeholder:(0,p.t)("view_only_masquerading.input_placeholder"),"aria-autocomplete":"list",value:c,onChange:function(e){return d(e.target.value)}}),(0,b.jsx)("button",{type:"submit",className:"text-default flex pt-1",onClick:P,children:!!c&&(0,b.jsx)(v.JO,{type:"20-close-md",useWithFillCurrentColor:!0})})]})})}),y.length>0?(0,b.jsx)("div",{className:"overflow-y-auto md:max-h-96",ref:n,children:(0,b.jsx)("ul",{className:"list-none",children:y.map((function(e){return(0,b.jsx)(O,{id:e.id,type:e.type,name:e.name,avatarUrl:e.avatar_url,onClick:o.noop},"community-member-".concat(e.id))}))})}):w?(0,b.jsx)(_,{}):(0,b.jsx)(g,{})]})})})},A=n(81906),E=function(e){var t=e.category,n=e.setCategory;return(0,b.jsx)("button",{tabIndex:0,type:"button",className:"text-dark bg-primary hover:bg-secondary focus:bg-secondary flex w-full cursor-pointer items-center justify-between gap-4 px-5 py-2.5 transition-colors",onClick:function(){return n("")},children:(0,b.jsxs)("div",{className:"flex items-center gap-3 text-gray-500",children:[(0,b.jsx)(v.JO,{type:"chevron-left",className:"text-default",size:16}),(0,b.jsx)(A.c,{color:"text-gray-500",children:(0,p.t)("view_only_masquerading.categories.".concat(t))})]})})},T=function(e){var t=e.name,n=e.icon,r=e.onClick;return(0,b.jsx)("li",{children:(0,b.jsxs)("button",{tabIndex:0,type:"button",className:"text-dark bg-primary hover:bg-secondary focus:bg-secondary flex w-full cursor-pointer items-center justify-between gap-4 px-5 py-2.5 transition-colors",onClick:r,children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)(v.JO,{type:n,className:"text-default",size:16}),(0,b.jsx)(x.T1,{children:t})]}),(0,b.jsx)(v.JO,{type:"16-chevron-right",className:"text-default",size:16})]})})},D=function(e){var t=e.setCategory;return(0,b.jsx)("div",{className:"mb-2 overflow-y-auto md:max-h-96",children:(0,b.jsxs)("ul",{className:"list-none",children:[(0,b.jsx)(T,{name:(0,p.t)("view_only_masquerading.categories.members"),icon:"16-account",onClick:function(){return t("members")}}),(0,b.jsx)(T,{name:(0,p.t)("view_only_masquerading.categories.paywalls"),icon:"credit-card",onClick:function(){return t("paywalls")}}),(0,b.jsx)(T,{name:(0,p.t)("view_only_masquerading.categories.links"),icon:"16-link",onClick:function(){return t("links")}})]})})};function R(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return L(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return L(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function L(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var M=function(){var e=(0,i.dd)(),t=(0,r.useRef)(null),n=(0,r.useRef)(null);(0,l.Z)(t,(function(){e.remove()}));var o=R((0,r.useState)(""),2),a=o[0],p=o[1],v=R((0,r.useState)(""),2),h=v[0],g=v[1],y=R((0,r.useState)(""),2),x=y[0],w=y[1],S=R((0,r.useState)(""),2),P=S[0],C=S[1],k=R((0,r.useState)([]),2),I=k[0],N=k[1],A=R((0,r.useState)(!1),2),T=A[0],L=A[1],M=(0,m.c)(h,500),F=(0,s.useQuery)({category:a,queryKey:["masquerading/entities",M,a],queryFn:function(){return(0,c.UT)(u.av.masquerading.entities.index({query:M,category:a}))},refetchOnWindowFocus:!1,enabled:!(!M&&!a),staleTime:3e5}),U=F.data,B=F.isLoading;(0,r.useEffect)((function(){M||a||(L(!1),N([]))}),[M,a]),(0,r.useEffect)((function(){if(U){var e=U.records,t=U.category,n=U.query;w(t),C(n),t||n?(L(0===e.length),N(e)):(L(!1),N([]))}}),[U]);var z=function(e,t){return(0,d.g)({entityId:e,entityType:t}).then((function(e){return window.open(e.masquerade_url,"_self")})).catch((function(e){console.error(e)}))};return(0,b.jsx)(f.u_,{isOpen:e.visible,onClose:e.remove,children:(0,b.jsx)(f.u_.Content,{position:"top",className:"border-primary w-full rounded-[0px] sm:rounded-lg sm:border md:!mt-[3.25rem] md:w-[335px]",size:"xl",children:(0,b.jsxs)("div",{ref:t,children:[(0,b.jsx)(j,{isLoading:B,query:h,setQuery:g}),I.length>0?(0,b.jsxs)("div",{className:"mb-2 overflow-y-auto md:max-h-96",ref:n,children:[x&&!P&&(0,b.jsx)(E,{category:x,setCategory:p}),(0,b.jsx)("ul",{className:"list-none",children:I.map((function(e){return(0,b.jsx)(O,{id:e.id,type:e.type,name:e.name,avatarUrl:e.avatar_url,onClick:z},"".concat(e.type,"-").concat(e.id))}))})]}):T?(0,b.jsx)(_,{setCategory:p,setQuery:g}):(0,b.jsx)(D,{setCategory:p})]})})})},F=i.gk.create((function(){return(0,b.jsx)(C,{})})),U=i.gk.create((function(){var e=(0,a.wh)().currentCommunitySettings;return null!==e&&void 0!==e&&e.masquerading_entities_enabled?(0,b.jsx)(M,{}):(0,b.jsx)(N,{})}));function B(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return z(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return z(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function z(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var H={isBannerVisible:!1,showBanner:o.noop,hideBanner:o.noop,openViewMasqueradingSearch:o.noop,openEditMasqueradingSearch:o.noop},q=(0,r.createContext)(H);q.displayName="MasqueradeContext";var Z=function(e){var t=e.children,n=B((0,r.useState)(!1),2),o=n[0],a=n[1],s=(0,i.dd)(U),l=(0,i.dd)(F),c={isBannerVisible:o,showBanner:function(){a(!0),s.show()},hideBanner:function(){return a(!1)},openViewMasqueradingSearch:function(){s.show()},openEditMasqueradingSearch:function(){l.show()}};return(0,b.jsx)(q.Provider,{value:c,children:t})},V=function(){var e=(0,r.useContext)(q);if(!e)throw new Error("useMasqueradeContext must be used within a MasqueradeContextProvider");return e}},32194:(e,t,n)=>{n.d(t,{Rl:()=>h,h4:()=>b,Wj:()=>g});var r=n(67294),o=n(85893);function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||s(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e){return function(e){if(Array.isArray(e))return l(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||s(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){if(e){if("string"===typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(e,t):void 0}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var m=function(e,t){var n=t.type,r=t.payload;switch(n){case"SET_SPACE_NOTIFICATIONS":return r;case"UPDATE_SPACE_NOTIFICATIONS":var o=e.spaces,i=o.findIndex((function(e){return e.id===r.space.id}));return i>-1?u(u({},e),{},{spaces:[].concat(a(o.slice(0,i)),[r.space],a(o.slice(i+1)))}):e;default:throw new Error("Unhandled action type: ".concat(n))}},f=(0,r.createContext)();f.displayName="SpaceNotificationsStateContext";var p=(0,r.createContext)();p.displayName="SpaceNotificationsDispatchContext";var v={spaces:[]},h=function(e){var t=e.children,n=i((0,r.useReducer)(m,v),2),a=n[0],s=n[1];return(0,o.jsx)(f.Provider,{value:a,children:(0,o.jsx)(p.Provider,{value:s,children:t})})},b=function(){var e=(0,r.useContext)(f);if(void 0===e)throw new Error("useSpaceNotificationsState must be used within a SpaceNotificationsProvider");return e},g=function(){var e=(0,r.useContext)(p);if(void 0===e)throw new Error("useSpaceNotificationsDispatch must be used within a SpaceNotificationsProvider");return e}},61642:(e,t,n)=>{n.d(t,{I:()=>l});var r=n(88767),o=n(49326);function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var l=function(e){var t,n=e.spaceId,i=e.enabled,s=void 0===i||i,l=o.av.spaces.activeMembersCount({id:n}),c=(0,r.useQuery)(l,{enabled:!!n&&s});return a(a({},c),{},{count:(null===(t=c.data)||void 0===t?void 0:t.members_count)||0})}},10869:(e,t,n)=>{n.d(t,{ND:()=>i,GL:()=>a,G5:()=>s,BU:()=>l,el:()=>c});var r=n(56163),o=n.n(r),i=function(e){return o()(e,{defaultProtocol:"https",target:{url:"_blank"},rel:{url:"noreferrer"},ignoreTags:["a","style","script","img","iframe","action-text-attachment","video","audio"],validate:{url:function(e){return/^[^A-Z]/.test(e)}}})},a=function(e){e.querySelectorAll("video").forEach((function(e){e.setAttribute("controlsList","nodownload")}))},s=function(e){var t=e.containerElement,n=e.shouldIncludeInternalLinks,r=void 0!==n&&n;t.querySelectorAll("a").forEach((function(e){"A"!==e.tagName||e.isContentEditable||!r&&e.host===window.location.host||(e.setAttribute("target","_blank"),e.setAttribute("rel","noreferrer"))}))},l=function(e){e.querySelectorAll("[data-background-image]").forEach((function(e){var t=document.createElement("img");t.src=e.dataset.backgroundImage,e.style.backgroundImage='url("'.concat(e.dataset.backgroundImage,'")'),t.onload=function(){var t=e.parentElement;t.classList.add("show"),t.classList.remove("hide")}}))};function c(e){e.querySelectorAll("[data-target~='downloadAttachment']").forEach((function(e){e.addEventListener("click",u)}))}function u(e){e.preventDefault(),e.stopPropagation();var t=e.currentTarget.dataset,n=t.url,r=t.fileName,o=t.logUrl;!function(e,t){var n=document.createElement("a");n.href=e,n.download=t,n.setAttribute("download",t),n.click()}(n,r),function(e){fetch(e,{method:"POST"})}(o)}},70544:(e,t,n)=>{n.d(t,{N:()=>i});var r=n(96486),o=n(15830),i=function(e,t){var n,i;try{var a=new Date(e),s=(0,o.Ed)(),l=new Intl.DateTimeFormat(s,{month:"short",timeZone:t}).format(a);n=a.getDate(),i=(0,r.upperFirst)(l).replace(".","")}catch(c){c instanceof Error&&console.error("dateComponents - Could not parse date: ".concat(c.message))}return{dayOfMonth:n,shortMonthString:i}}},87811:(e,t,n)=>{n.d(t,{H:()=>s});var r=n(28366),o=n(34587),i=n(86013),a=n(48895),s=function(e){var t=new Date(e),n=new Date,s=(0,r.Z)(),l=(0,o.Z)();return{day:t.getFullYear()===n.getFullYear()?t>s?(0,i.t)("today"):t>l?(0,i.t)("yesterday"):(0,a.w)({dateTime:t,format:"short_month_and_date"}):(0,a.w)({dateTime:t,format:"short_date"}),time:(0,a.w)({dateTime:t,format:"short_time"})}}},28772:(e,t,n)=>{n.d(t,{ie:()=>i,Dk:()=>a,r_:()=>s});var r=n(96486),o=n(15830),i=function(e,t){try{var n=(0,o.Ed)(),i=new Intl.DateTimeFormat(n,t);return(0,r.upperFirst)(i.format(new Date(e)))}catch(a){return a instanceof Error&&console.error("Could not parse date: ".concat(a.message)),""}},a=function(e,t){return i(e,{hour12:!0,hour:"2-digit",minute:"2-digit",timeZone:t})},s=function(e,t){return i(e,{month:"long",year:"numeric",timeZone:t})}},90283:(e,t,n)=>{n.d(t,{UZ:()=>s,mM:()=>l,ZY:()=>c,cz:()=>u,Rc:()=>m});var r=n(49546),o=n(96486),i=n(63367),a=n(20073),s=function(e){try{return(0,o.capitalize)((0,r.default)(new Date(e),"EEEE"))}catch(t){return console.error(t),""}},l=function(e){try{return(0,o.capitalize)((0,r.default)(new Date(e),"EEE")).substring(0,2)}catch(t){return console.error(t),""}},c=function(e){try{return(0,o.capitalize)((0,r.default)(new Date(e),"MMMM"))}catch(t){return console.error(t),""}},u=function(e){try{return(0,r.default)(new Date(e),"do")}catch(t){return console.error(t),""}},d={1:(0,i.t)("date.ordinal.first"),2:(0,i.t)("date.ordinal.second"),3:(0,i.t)("date.ordinal.third"),4:(0,i.t)("date.ordinal.fourth"),5:(0,i.t)("date.ordinal.last")},m=function(e){try{var t=(0,a.SA)(e),n=s(e);return"".concat(d[t]||""," ").concat(n)}catch(r){return console.error(r),""}}},20073:(e,t,n)=>{n.d(t,{eC:()=>u,aA:()=>d,qG:()=>m,He:()=>f,Cp:()=>v,Xz:()=>h,TP:()=>b,ZX:()=>g,Gs:()=>y,tq:()=>_,ED:()=>j,bl:()=>x,SA:()=>w,tX:()=>O,qe:()=>S,qB:()=>P});var r=n(64687),o=n.n(r),i=n(15830),a=n(90283);function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function c(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}var u=function(e,t){return Math.round((t.getTime()-e.getTime())/864e5)},d=function(e){var t=new Date,n=new Date(e);return!n.valueOf()||n<t},m=function(e){var t=new Date,n=new Date(e);return Math.floor((t.getTime()-n.getTime())/1e3)},f=function(e){var t=function(e){return("0"+e).slice(-2)};if(e>=0&&e<3600){var n=Math.floor(e/60),r=e-60*n;return"".concat(t(n),":").concat(t(r))}var o=Math.floor(e/3600),i=Math.floor((e-3600*o)/60),a=e-60*i-3600*o;return"".concat(t(o),":").concat(t(i),":").concat(t(a))},p=function(e){return new Promise((function(t){return setTimeout(t,e)}))},v=function(){var e,t=(e=o().mark((function e(t){var n,r,i,a,l=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=p(l.length>1&&void 0!==l[1]?l[1]:1500),e.next=4,Promise.all([t,n]);case 4:return r=e.sent,i=s(r,1),a=i[0],e.abrupt("return",a);case 8:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){c(i,r,o,a,s,"next",e)}function s(e){c(i,r,o,a,s,"throw",e)}a(void 0)}))});return function(e){return t.apply(this,arguments)}}(),h=function(e,t){var n=new Date(e);return n.setDate(n.getDate()+t),n},b=function(e){return e.setMinutes(e.getMinutes()+60),e.setMinutes(0,0,0),e},g=function(e,t){var n=e?new Date(e):new Date;return n.setSeconds(n.getSeconds()+t),n},y=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:25;return(new Date).getTime()>=new Date(e).getTime()-60*t*1e3},_=Intl.DateTimeFormat().resolvedOptions().timeZone,j=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Date,r=(0,i.Ed)();return(null===(t=new Intl.DateTimeFormat([r,"en-US"],{timeZone:e,timeZoneName:"short"}).formatToParts(n).find((function(e){return"timeZoneName"==e.type})))||void 0===t?void 0:t.value)||""},x=function(e){return e?new Date(e):new Date},w=function(e){var t=new Date(e);return Math.ceil(t.getDate()/7)},O=function(e){var t=w(e);return"".concat(5==t?"-1":t).concat((0,a.mM)(e))},S=function(e){var t=9e5;return new Date(Math.ceil(e.getTime()/t)*t)},P=function(e){return 0===e.getHours()&&0===e.getMinutes()&&0===e.getSeconds()}},25401:(e,t,n)=>{n.d(t,{lc:()=>u,TF:()=>d,_z:()=>m});var r=n(11699),o=n(69295),i=n(86013),a=n(88391),s=n(21795),l=n(1483),c=n(15830);a.Z.addDefaultLocale(s.Z),a.Z.addLocale(l.Z);var u={default:"default",short:"short"},d=function(e,t){return m(new Date(e),t)},m=function(e,t){var n=(null===t||void 0===t?void 0:t.format)||"default",s=(0,c.Ed)(),l=new a.Z(s);return"short"===n?function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:60,n=new Date;return(0,r.Z)(n,e)<t}(e)?(0,i.t)("time_format.just_now"):function(e){var t=new Date;return 0===(0,o.Z)(t,e)}(e)?l.format(e,"mini"):l.format(e,"twitter-minute-now"):l.format(e)}},26047:(e,t,n)=>{function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}n.d(t,{y:()=>u,q:()=>d});var l="OvDGLovptOPNSO5JjplEIssLF1x8Yxc3",c=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=new URL("".concat("https://api.giphy.com/v1/gifs","/").concat(e)),r=0,o=Object.entries(t);r<o.length;r++){var i=a(o[r],2),s=i[0],l=i[1];n.searchParams.set(s,l)}return n.toString()},u=function(e){return fetch(c("search",o(o({},arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),{},{q:e,api_key:l}))).then((function(e){return e.json()}))},d=function(){return fetch(c("trending",o(o({},arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),{},{api_key:l}))).then((function(e){return e.json()}))}},11909:(e,t,n)=>{n.d(t,{LV:()=>r,H0:()=>o,_d:()=>i,Bk:()=>a,VM:()=>s,iD:()=>l,wA:()=>c,ln:()=>d,SS:()=>m,fN:()=>f,B8:()=>p,UT:()=>v,ee:()=>h,$e:()=>b,Gi:()=>g,HN:()=>y,Zo:()=>_,kx:()=>j,If:()=>x,vX:()=>w,eM:()=>O,lH:()=>S,_V:()=>P,L6:()=>C,a_:()=>k,dF:()=>I,Vq:()=>N,mP:()=>A,Hq:()=>E,jN:()=>T});var r=Object.freeze({INITIALIZING:"initializing",BACKSTAGE:"backstage",LIVE:"active",ENDED:"inactive",CLOSING:"closing"}),o=Object.freeze({CONFERENCE:"conference",STREAM:"stream",EVENT:"event"}),i=Object.freeze({OPEN:"open",SECRET:"secret",PUBLIC_STREAM:"public_stream"}),a=Object.freeze({SPEAKER:"speaker_view",GRID:"grid_view"}),s=Object.freeze({HOST:"host",SPECTATOR:"spectator",HLS_SPECTATOR:"hlsspectator",MODERATOR:"moderator"}),l=Object.freeze({HOST:"host",MODERATOR:"moderator",COHOST:"cohost",PARTICIPANT:"participant"}),c=Object.freeze({JOINING:"joining",ACTIVE:"active",INACTIVE:"inactive"}),u=Object.freeze({HMS:"hms",LIVEKIT:"livekit"}),d=1,m=function(e){return(null===e||void 0===e?void 0:e.status)===r.BACKSTAGE},f=function(e){return(null===e||void 0===e?void 0:e.status)===r.LIVE},p=function(e){return(null===e||void 0===e?void 0:e.status)===r.CLOSING},v=function(e){return(null===e||void 0===e?void 0:e.status)===r.ENDED},h=function(e){return(null===e||void 0===e?void 0:e.room_type)===o.STREAM},b=function(e){return(null===e||void 0===e?void 0:e.room_type)===o.CONFERENCE},g=function(e){return!0===(null===e||void 0===e?void 0:e.recording_enabled)},y=function(e){return!(null===e||void 0===e||!e.can_manage)},_=function(e){return!(null===e||void 0===e||!e.can_host)},j=function(e){return!(null===e||void 0===e||!e.host_capacity_reached)},x=function(e){return!(null===e||void 0===e||!e.spectator_capacity_reached)},w=function(e){return(null===e||void 0===e?void 0:e.room_type)||o.STREAM},O=function(e){return!(null!==e&&void 0!==e&&e.view_type)||(null===e||void 0===e?void 0:e.view_type)===a.SPEAKER},S=function(e){return(null===e||void 0===e?void 0:e.view_type)===a.GRID},P=function(e){return(null===e||void 0===e?void 0:e.access_type)===i.SECRET},C=function(e){return(null===e||void 0===e?void 0:e.access_type)===i.PUBLIC_STREAM},k=function(e){return"inactive"===(null===e||void 0===e?void 0:e.status)},I=function(e){return(null===e||void 0===e?void 0:e.role)===s.SPECTATOR},N=function(e){return(null===e||void 0===e?void 0:e.role)===s.HLS_SPECTATOR},A=function(e){return(null===e||void 0===e?void 0:e.room_provider)===u.LIVEKIT},E=function(e){return C(e)&&y(e)},T=function(e){return!0===(null===e||void 0===e?void 0:e.limit_url_sharing)}},22229:(e,t,n)=>{n.d(t,{J:()=>o,U:()=>i});var r=n(49326),o=function(e){if(e){var t=window.location.href;e.querySelectorAll("a[data-dynamic-login-link]").forEach((function(e){var n=new URL(e.href),r=new URLSearchParams(n.search);r.set("post_login_redirect",encodeURI(t)),n.search=r.toString(),e.href=n.toString()}))}},i=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2]?{post_login_redirect:window.location.href}:{post_login_redirect:window.location.href,signup:!0};return e?t:r.$T.signIn({params:n})}},15130:(e,t,n)=>{n.d(t,{cT:()=>r,sR:()=>o,$q:()=>i});var r=function(e){var t;return(null===(t=e.member_tags)||void 0===t?void 0:t.length)>0},o=function(e){return!!e.website_url||!!e.facebook_url||!!e.twitter_url||!!e.linkedin_url||!!e.instagram_url},i={SIGNUP:"signup",EDIT_PROFILE:"edit_profile",PROFILE_VIEW:"profile_view"}},61666:(e,t,n)=>{n.d(t,{I:()=>l});var r=n(15830),o=n(36762);function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var l=function(e,t){var n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=(0,r.Kd)((null===(n=window)||void 0===n?void 0:n.locale)||"en"),l=a(a({},{amountInCents:!0,includeCurrencyCode:!0,includeCurrencySymbol:!0,forceMaxFractionDigits:!1}),i),c=l.amountInCents?t/100:t,u=l.forceMaxFractionDigits||c%1!==0?2:0,d=new Intl.NumberFormat(s,{style:"decimal",minimumFractionDigits:u,maximumFractionDigits:u}).format(c),m=l.includeCurrencyCode?e.code.toUpperCase():"",f=l.includeCurrencySymbol?e.symbol:"";return(e.direction===o.RV.rtl?"".concat(m," ").concat(d).concat(f):"".concat(f).concat(d," ").concat(m)).trim()}},29647:(e,t,n)=>{n.d(t,{B:()=>s,H:()=>l});var r=n(86013),o=n(96486),i=n(49326);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var s=function(e){return(0,o.isString)(e)?e.replace(/(^\w+:|^)\/\//,""):e},l=function(e){var t=e.isProfileDrawerEnabled,n=e.name,s=e.params,l=e.publicUid,c=e.shouldOpenInNewTab,u=void 0!==c&&c,d=e.showMemberProfileDrawer,m=n||(0,r.t)("view_user_profile_name"),f=(0,r.t)("view_user_profile",{user:m});return l?a(u?{href:(0,i.zd)({public_uid:l,params:s}),target:"_blank",rel:"noreferrer"}:t?{onClick:function(e){e.preventDefault(),d({memberPublicId:l,params:s})},href:(0,i.zd)({public_uid:l})}:{href:(0,i.zd)({public_uid:l,params:s})},"aria-label",f):a({onClick:o.noop,href:"#"},"aria-label","")}},72831:(e,t,n)=>{n.d(t,{i:()=>r,h:()=>o});var r=function(e){var t;return null===e||void 0===e||null===(t=e.currentCommunitySettings)||void 0===t?void 0:t.profile_drawer_enabled},o=function(e){var t;return!(null===e||void 0===e||null===(t=e.currentUser)||void 0===t||!t.id)}},79599:(e,t,n)=>{n.d(t,{lu:()=>r,i4:()=>o,OT:()=>i});var r=/[(http(s)?)://(www.)?a-zA-Z0-9@:%._+~#=]{2,256}\.[a-z]{2,15}\b([-a-zA-Z0-9@:%_+.~#?&//=]*)/,o=/^[-a-zA-Z0-9%_+.~#?&//=]+$/,i=/(^mailto:(?!.*\.\.)[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\.[a-zA-Z0-9-.]+$)|(^https?:\/\/(?!.*\.\.)[-a-zA-Z0-9_]+\.[a-zA-Z0-9-.]+[^ ]*$)/},46854:(e,t,n)=>{n.d(t,{r:()=>o});var r=n(74238),o=function(){return(0,r.ww)().isAdminUsageContext?"circle":"primary"}},96795:(e,t,n)=>{n.d(t,{K:()=>s});var r=n(17187);function o(e,t){return o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},o(e,t)}function i(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=a(e);if(t){var o=a(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===typeof t||"function"===typeof t))return t;return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function a(e){return a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},a(e)}var s=new(function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&o(e,t)}(n,e);var t=i(n);function n(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(e=t.call(this)).toggleMessageBookmark=function(t){e.emit("onBookmarkToggle",t)},e}return n}(r.EventEmitter))},35877:(e,t,n)=>{function r(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,{y:()=>l,z:()=>c});var l=function(e){var t=e.chatMessages,n=e.setChatRoomMessages,o=e.newMessage,i=o.parent_message_id,s=o.sent_at,l=o.sender,c=t.map((function(e){return e.id})).indexOf(i);if(c>-1){var u=t[c],d=u.thread_participants_preview,m=void 0===d?[]:d,f=u.replies_count,p=void 0===f?0:f,v=a(a({},u),{},{replies_count:p+1,last_reply_at:s});l&&m.length<3&&!m.some((function(e){return e.community_member_id===l.community_member_id}))&&(v.thread_participants_preview=[].concat(r(m),[a({},l)])),n([].concat(r(t.slice(0,c)),[v],r(t.slice(c+1))))}},c=function(e){if(!e)return!1;var t=e.getBoundingClientRect();return t.top>=0&&t.left>=0&&t.right<=window.innerWidth&&t.bottom<=window.innerHeight}},84495:(e,t,n)=>{n.d(t,{Cz:()=>s.Cz,k0:()=>l.k,Nh:()=>a.N,x3:()=>z,Kb:()=>X.K,Bk:()=>ie.B,Lx:()=>Z,QP:()=>oe,ub:()=>r.u,K$:()=>o.K,uk:()=>i.u,pB:()=>K.p,f4:()=>Y.f,aK:()=>Y.a,Tl:()=>l.T,nw:()=>b,Mk:()=>k,TC:()=>a.T,_q:()=>s._q,xX:()=>I.x,KR:()=>N.K,ih:()=>ae,rZ:()=>H,gJ:()=>J});var r=n(94762),o=n(6382),i=n(98090),a=n(76063),s=n(75062),l=n(20447),c=n(67294),u=n(96486),d=n(88767),m=n(34128),f=n(49326),p=n(21809);function v(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return h(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return h(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var b=function(e){var t=e.parentMessage,n=e.threadMessageId,r=e.successCallback,o=void 0===r?u.noop:r,i=v((0,c.useState)([]),2),a=i[0],s=i[1],l=(0,p.p)().error,h=(0,d.useQuery)(["THREAD_MESSAGES",null===t||void 0===t?void 0:t.id,null===t||void 0===t?void 0:t.chat_room_uuid],(function(e){var r=e.previousPerPage,o=void 0===r?15:r,i=e.nextPerPage,a={previous_per_page:o,next_per_page:void 0===i?0:i,parent_message_id:t.id,id:n};return(0,m.UT)(f.av.chatRoomMessages.index({uuid:t.chat_room_uuid,params:a}))}),{enabled:!!t,onSuccess:function(e){s(e.records),o()},onError:function(e){l(e.message)}}),b=h.isLoading;return{fetchThreadMessages:h.refetch,threadMessages:a,isLoading:b}},g=n(64687),y=n.n(g),_=n(97012);function j(e){return function(e){if(Array.isArray(e))return x(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return x(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return x(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function x(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function w(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function S(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(Object(n),!0).forEach((function(t){P(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function P(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var C=["chat-threads-list"],k=function(){var e,t=(0,_.wh)().currentCommunityMember,n=(0,d.useQueryClient)(),r=function(e){n.setQueryData(C,(function(t){return S(S({},t),{},{pages:t.pages.map((function(t,n){return S(S({},t),{},{records:e.slice(10*n,10*(n+1))})}))})}))},o=(0,d.useInfiniteQuery)(C,(function(e){var t,n=e.pageParam;return t=void 0===n?1:n,(0,m.UT)(f.av.chatThreads.index({params:{page:t,per_page:10}}))}),{select:function(e){var t=e.pages,n=void 0===t?[]:t;return(0,u.flatten)(n.map((function(e){return e.records})))},enabled:!(null===t||void 0===t||null===(e=t.policies)||void 0===e||!e.can_access_threads_tab),getNextPageParam:function(e){return e.has_next_page?e.page+1:void 0}}),i=o.data,a=void 0===i?[]:i,s=o.isLoading,l=o.refetch,c=o.hasNextPage,p=o.fetchNextPage,v=function(){var e,t=(e=y().mark((function e(t){var n;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,m.UT)(f.av.chatThreads.show({id:t}));case 3:n=e.sent,r([n].concat(j(a))),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})),function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){w(i,r,o,a,s,"next",e)}function s(e){w(i,r,o,a,s,"throw",e)}a(void 0)}))});return function(e){return t.apply(this,arguments)}}(),h=function(e){if(null===e||void 0===e||!e.unread_flow)if(a.every((function(t){return t.parent_message.id!==e.parent_message_id})))v(e.chat_thread_id);else{var t=a.map((function(t){if(t.parent_message.id===e.parent_message_id){var n=t.parent_message,r=t.replies;return S(S({},t),{},{parent_message:S(S({},n),{},{replies_count:n.replies_count+1}),replies:[].concat(j(r),[e])})}return t}));r(t)}},b=function(e){if((0,u.isNull)(e.parent_message_id))!function(e){var t=a.map((function(t){return t.parent_message.id!==e.id?t:S(S({},t),{},{parent_message:S(S({},t.parent_message),e)})}));r(t)}(e);else{var t=a.map((function(t){if(t.parent_message.id!==e.parent_message_id)return t;var n=t.replies.map((function(t){return t.id===e.id?e:t}));return S(S({},t),{},{replies:n})}));r(t)}},g=function(e){var t=e||{},n=t.id,o=t.parent_message,i=o||{},s=i.id,l=i.replies_count;if(a.some((function(e){return e.parent_message.id===n})))r(a.filter((function(e){return e.parent_message.id!==n})));else if(0===l)r(a.filter((function(e){return e.parent_message.id!==s})));else{var c=a.map((function(e){if(e.parent_message.id!==s)return e;var t=e.replies.filter((function(e){return e.id!==n}));return S(S({},e),{},{parent_message:o,replies:t})}));r(c)}},x=a.length>0,O=function(e){var t=e.refetchChatThreads,n=function(){t()},r=function(){t()};return{createReactionFromThreadList:n,removeReactionFromThreadList:r,handleReactionFromWebsocket:function(e){"ChatRoomMessage"===e.json_message.reactionable_type&&("createReaction"===e.event?n():"destroyReaction"===e.event&&r())}}}({refetchChatThreads:l}),P=O.createReactionFromThreadList,k=O.removeReactionFromThreadList,I=O.handleReactionFromWebsocket;return{chatThreads:a,setChatThreads:r,isLoading:s,refetchChatThreads:l,isChatThreadsAvailable:x,hasNextPage:c,fetchNextPage:p,onEventReceive:function(e){switch(e.event){case"newMessage":h(e.json_message);break;case"updatedMessage":b(e.json_message);break;case"deletedMessage":g(e)}},createReactionFromThreadList:P,removeReactionFromThreadList:k,handleReactionFromWebsocket:I}},I=n(37803),N=n(98379),A=n(24185),E=n(24897),T=n(35877),D=n(85893);function R(e){return function(e){if(Array.isArray(e))return F(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||M(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function L(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||M(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function M(e,t){if(e){if("string"===typeof e)return F(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?F(e,t):void 0}}function F(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var U=(0,c.createContext)(B);U.displayName="UnreadChatThreadsContext";var B={chatThreadIds:[]},z=function(e){var t,n=e.children,r=(0,_.wh)().currentCommunityMember,o=L((0,c.useState)([]),2),i=o[0],a=o[1],s=L((0,c.useState)(!1),2),l=s[0],u=s[1],v=(0,p.p)().error,h="/threads"===(0,A.TH)().pathname;(0,E.s)({channel:"Chats::CommunityMemberThreadsChannel",onMessageReceive:function(e){j(e)},community_member_id:null===r||void 0===r?void 0:r.id,canCreateConnection:Boolean(null===r||void 0===r?void 0:r.id)},[null===r||void 0===r?void 0:r.id]);var b=(0,d.useQuery)(["thread_messages","unread",null===r||void 0===r?void 0:r.id],(function(){return(0,m.UT)(f.av.chatThreads.unreadChatThreads())}),{enabled:!(null===r||void 0===r||null===(t=r.policies)||void 0===t||!t.can_access_threads_tab),onSuccess:function(e){a(e.chat_thread_ids)},onError:function(e){v(e.message)}}),g=b.isLoading,y=b.refetch,j=function(e){"chatThreadRead"===e.event?x(e.chat_thread_id):"newMessage"===e.event&&w(e.json_message)},x=function(e){if(i.includes(e)){var t=i.filter((function(t){return t!==Number(e)}));a(t)}},w=function(e){var t;null!==e&&void 0!==e&&e.unread_flow&&u(!0);var n=(null===(t=e.sender)||void 0===t?void 0:t.community_member_id)===(null===r||void 0===r?void 0:r.id),o=!e.chat_thread_id,s=i.includes(e.chat_thread_id);if(!(o||n||s)){if(h){var l=e.chat_thread_id,c=document.getElementById(l);if((0,T.z)(c))return}a((function(t){return[].concat(R(t),[e.chat_thread_id])}))}},O={fetchUnreadChatThreads:y,unreadChatThreadIds:i,unreadThreadsCount:i.length,isLoading:g,onEventReceive:j,isUnreadThreadFlow:l};return(0,D.jsx)(U.Provider,{value:O,children:n})},H=function(){return(0,c.useContext)(U)},q=n(59393),Z=function(e){var t=e.current_participant,n=e.chat_room_kind===q.g8,r=null===t||void 0===t?void 0:t.can_send_message_in_room,o=!(0,u.isEmpty)(t)&&!t.deleted_at;return{canSendMessage:n?r:o,canParticipantsMessage:r}};function V(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function W(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?V(Object(n),!0).forEach((function(t){Q(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):V(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Q(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $(e){return function(e){if(Array.isArray(e))return G(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return G(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return G(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function G(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var J=function(e){var t=e.uuid,n=e.ids,r=e.enabled,o=e.shouldUpdateCache,a=void 0===o||o,s=(0,d.useQueryClient)(),l=(0,d.useQuery)(["chatroom","missing-participants",n],(function(){return(0,m.UT)(f.av.chatRoomParticipants.index({uuid:t,params:{ids:n}}))}),{enabled:r,select:function(e){return e.records},onSuccess:function(e){var n;a&&(n=e,s.setQueryData(["chat-participants",t],(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{pages:[]},t=(0,u.flatten)((e.pages||[]).map((function(e){return e.records}))),r=[].concat($(t),$(n)),o=Math.ceil(r.length/i.U);return o>e.pages.length&&(e.pages=Array.from({length:o}).fill(e.pages[o]||e.pages[e.pages.length-1])),W(W({},e),{},{pages:e.pages.map((function(e,t){return W(W({},e||{}),{},{records:r.slice(i.U*t,i.U*(t+1))})}))})})))},onError:function(e){console.error("err:",e)}}),c=l.isLoading,p=l.data;return{isLoading:c,participants:void 0===p?[]:p}},K=n(69010),Y=n(24878),X=n(96795),ee=n(11860);function te(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ne(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?te(Object(n),!0).forEach((function(t){re(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):te(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function re(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var oe=function(){var e=(0,Y.f)(),t=e.chatRoomMessages,n=e.setChatRoomMessages,r=e.setScrollInfo,o=(0,ee.O)().calculateScrollInfo,i=(0,I.x)(),a=i.parentMessage,s=i.updateParentMessage,l=function(e){var i=e.communityMemberId,l=e.emoji,c=e.reactionableId,u=structuredClone(t),d=u.findIndex((function(e){return e.id===c}));if(-1!==d){var m,f,p=u[d].reactions.findIndex((function(e){return e.emoji===l}));if(null!==(m=u[d].reactions[p])&&void 0!==m&&null!==(f=m.community_member_ids)&&void 0!==f&&f.includes(i))return;if(-1!==p?(u[d].reactions[p].community_member_ids.push(i),u[d].reactions[p].count+=1):u[d].reactions.push({emoji:l,community_member_ids:[i],count:1}),r(o({event:"reaction"})),n(u),(null===a||void 0===a?void 0:a.id)===c){var v=t.find((function(e){return e.id===a.id}));v&&s(ne({},v))}}},c=function(e){var i=e.communityMemberId,l=e.emoji,c=e.reactionableId,u=structuredClone(t),d=u.findIndex((function(e){return e.id===c}));if(-1!==d){var m,f,p=u[d].reactions.findIndex((function(e){return e.emoji===l}));if(null===(m=u[d].reactions[p])||void 0===m||null===(f=m.community_member_ids)||void 0===f||!f.includes(i))return;if(-1!==p&&(1===u[d].reactions[p].count?u[d].reactions.splice(p,1):(u[d].reactions[p].community_member_ids=u[d].reactions[p].community_member_ids.filter((function(e){return e!==i})),u[d].reactions[p].count-=1)),r(o({event:"reaction"})),n(u),(null===a||void 0===a?void 0:a.id)===c){var v=t.find((function(e){return e.id===a.id}));v&&s(ne({},v))}}},u=function(e){if("ChatRoomMessage"===e.json_message.reactionable_type){var t=e.json_message,n=t.community_member_id,r=t.emoji,o=t.reactionable_id;"createReaction"===e.event?l({communityMemberId:n,emoji:r,reactionableId:o}):"destroyReaction"===e.event&&c({communityMemberId:n,emoji:r,reactionableId:o})}};return{createReactionFromMessage:l,removeReactionFromMessage:c,handleReactionFromWebsocket:u,onReactionWebsocketEvent:function(e){switch(e.event){case"createReaction":case"destroyReaction":u(e)}}}},ie=n(48135),ae=function(e){var t=e.communityId,n=(0,_.wh)().currentCommunity,r=t||(null===n||void 0===n?void 0:n.id),o=(0,Y.a)().unreadChatRoomUuids;return(0,u.isNull)(r)?[]:o[r]||[]}},48135:(e,t,n)=>{n.d(t,{B:()=>f});var r=n(64687),o=n.n(r),i=n(67294),a=n(34128),s=n(49326),l=n(96795);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function m(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}var f=function(e,t){var n=(0,i.useCallback)(function(){var n,r=(n=o().mark((function n(r){var i,l,c;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(i=e.find((function(e){return e.id===r}))){n.next=3;break}return n.abrupt("return");case 3:if(null===i||void 0===i||!i.bookmark_id){n.next=7;break}l=u(u({},i),{},{bookmark_id:null}),n.next=10;break;case 7:return n.next=9,(0,a.UT)(s.av.chatRoomMessages.show({uuid:i.chat_room_uuid,id:i.id}));case 9:l=n.sent;case 10:if(l){n.next=12;break}return n.abrupt("return");case 12:c=e.map((function(e){return e.id===i.id?l:e})),t(c);case 14:case"end":return n.stop()}}),n)})),function(){var e=this,t=arguments;return new Promise((function(r,o){var i=n.apply(e,t);function a(e){m(i,r,o,a,s,"next",e)}function s(e){m(i,r,o,a,s,"throw",e)}a(void 0)}))});return function(e){return r.apply(this,arguments)}}(),[e,t]);return(0,i.useEffect)((function(){var e=function(e){n(e)};return l.K.on("onBookmarkToggle",e),function(){l.K.off("onBookmarkToggle",e)}}),[n]),n}},94762:(e,t,n)=>{n.d(t,{u:()=>w});var r=n(64687),o=n.n(r),i=n(67294),a=n(96486),s=n(34128),l=n(49326),c=n(84495),u=n(37803),d=n(35877),m=n(88767),f=n(11860);function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){h(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function b(e){return function(e){if(Array.isArray(e))return x(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||j(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}function y(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){g(i,r,o,a,s,"next",e)}function s(e){g(i,r,o,a,s,"throw",e)}a(void 0)}))}}function _(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||j(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function j(e,t){if(e){if("string"===typeof e)return x(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?x(e,t):void 0}}function x(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var w=function(){var e=(0,c.f4)(),t=e.chatRoomMessages,n=e.setChatRoomMessages,r=e.isLoading,p=e.setIsLoading,h=e.hasNextPage,g=e.hasPrevPage,j=e.setHasNextPage,x=e.setHasPrevPage,w=e.scrollInfo,O=e.setScrollInfo,S=e.firstMessageId,P=e.setFirstMessageId,C=e.lastMessageId,k=e.setLastMessageId,I=e.shouldShowLatestMessageBtn,N=e.setShouldShowLatestMessageBtn,A=e.topMessageId,E=e.setTopMessageId,T=e.isInitialPageLoaded,D=e.setIsInitialPageLoaded,R=_((0,i.useState)(!1),2),L=R[0],M=R[1],F=(0,u.x)(),U=F.parentMessage,B=F.updateParentMessage,z={markChatRoomAsRead:(0,m.useMutation)((function(e){var t=l.av.chatRooms.markAllAsRead({uuid:e});return(0,s.Cu)(t)})).mutateAsync}.markChatRoomAsRead,H=(0,f.O)().calculateScrollInfo,q=(0,c.aK)().resetChatRoom,Z=function(){var e=y(o().mark((function e(i){var c,u,d,m,f,v,y,_,w,S,C,I,N,A,T;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=i.id,u=i.previousPerPage,d=void 0===u?20:u,m=i.nextPerPage,f=void 0===m?0:m,v=i.chatRoomUuid,y=i.isInitialPage,_=void 0!==y&&y,w=i.parentMessageId,!(S=0===d)||!r){e.next=4;break}return e.abrupt("return");case 4:return p(!0),C={previous_per_page:d,next_per_page:f},c&&(C.id=c),w&&(C.parent_message_id=w),e.next=10,(0,s.UT)(l.av.chatRoomMessages.index({uuid:v,params:C}));case 10:I=e.sent,_?(O(H({event:"chatRoomLoad"})),I.records&&n(I.records),j(I.has_next_page),x(I.has_previous_page),P(I.first_id),k(I.last_id),D(!0)):(S?(O(H({event:"nextPaginatedMessageLoad"})),k(I.last_id)):(O(H({event:"paginatedMessageLoad"})),P(I.first_id)),(N=b(t)).length>60?S?(N=N.slice(0,40),A=(0,a.sortBy)(N,"sent_at"),P(A[0].id),x(!0)):(E(c),N=N.slice(0,40),T=(0,a.sortBy)(N,"sent_at"),k(T[N.length-1].id),j(!0)):E(null),n([].concat(b(I.records),b(N))),h&&j(I.has_next_page),g&&x(I.has_previous_page)),!I.has_next_page&&!L&&z(v),p(!1);case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),V=function(){var e=y(o().mark((function e(t,n){var r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,q(),r={chatRoomUuid:t,isInitialPage:!0},n&&(r=v(v({},r),{},{id:n,previousPerPage:20,nextPerPage:20})),e.next=6,Z(r);case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,n){return e.apply(this,arguments)}}(),W=function(e,t){var r=e.id,o=e.parent_message;if(o){var i=t.map((function(e){return e.id===o.id?o:e}));n(i)}else{var a=t.filter((function(e){return e.id!==r}));n(a)}},Q=function(e,t){O(H({event:"messageUpdated"}));var r=e.json_message,o=t.reduce((function(e,t){return t.id===r.id?e.push(v(v({},t),r)):e.push(t),e}),[]);n(b(o)),r.id===(null===U||void 0===U?void 0:U.id)&&B(r)},$=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=e.json_message;r.parent_message_id&&(O(H({event:"parentMessageUpdated"})),(0,d.y)({chatMessages:t,setChatRoomMessages:n,newMessage:r}))};return{chatRoomMessages:t,setChatRoomMessages:n,messagesHasNextPage:h,messagesHasPrevPage:g,setScrollInfo:O,fetchChatMessages:Z,fetchChatMessagesFirstPage:V,calculateScrollInfo:H,adjustScroller:function(){var e=document.getElementById("message-scroll-view"),t=document.getElementById("unread-message-breakpoint");switch(w.action){case"scrollToBottom":e.scrollTop=e.scrollHeight;break;case"adjustTop":if(A){var n=document.getElementById(A);null===n||void 0===n||n.scrollIntoView()}else e.scrollTop=e.scrollHeight-(w.scrollHeightValue-w.scrollTopValue);break;case"scrollToUnreadMessageIndicator":t?t.scrollIntoView({behavior:"smooth"}):e.scrollTop=e.scrollHeight}},isLoading:r,firstMessageId:S,lastMessageId:C,onEventReceive:function(e,t){switch(e.event){case"newMessage":$(e,t);break;case"deletedMessage":W(e,t);break;case"updatedMessage":Q(e,t)}},isInitialPageLoaded:T,shouldShowLatestMessageBtn:I,setShouldShowLatestMessageBtn:N,setFirstMessageId:P,setMessagesHasPrevPage:x,setUnreadMessageFlow:M}}},6382:(e,t,n)=>{n.d(t,{K:()=>_});var r=n(67294),o=n(88767),i=n(34128),a=n(49326),s=n(64687),l=n.n(s),c=n(59393),u=n(84495),d=n(1320);function m(e){return function(e){if(Array.isArray(e))return h(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||v(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}function p(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||v(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(e,t){if(e){if("string"===typeof e)return h(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?h(e,t):void 0}}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var b=function(e){var t=e.communityId,n=(0,u.aK)().setUnreadChatRoomUuids,s=(0,u.ih)({communityId:t}),v=p((0,r.useState)([]),2),h=v[0],b=v[1],g=p((0,r.useState)(null),2),y=g[0],_=g[1],j=(0,r.useRef)(s),x=(0,r.useRef)(h),w=function(e){return(0,o.useMutation)((function(){return d.MS.getChatRoomCurrentParticipant(e)}),{mutationKey:["chatroom","participant",e]})}(y),O=function(){var e,t=(e=l().mark((function e(t,n,r){var o,i,a,s,u,d,f,p,v,h,g,y,j;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.json_message,s=a.chat_room_uuid,u=a.chat_room_kind,d=a.sender,f=a.embedded,p=null===(o=window.location.pathname)||void 0===o?void 0:o.split("messages/")[1],v=d.community_member_id,h=p===s,g=u===c.g8,!0!==f&&!h){e.next=8;break}return e.abrupt("return");case 8:if(_(s),!g){e.next=13;break}e.t0={},e.next=16;break;case 13:return e.next=15,w.mutateAsync();case 15:e.t0=e.sent;case 16:if(y=e.t0,j=y.chat_room_participant,!(v===r||null!==j&&void 0!==j&&null!==(i=j.preferences)&&void 0!==i&&i.muted)){e.next=20;break}return e.abrupt("return");case 20:t.find((function(e){return e===s}))||(b([].concat(m(x.current),[s])),setTimeout((function(){return S()}),2e3));case 22:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){f(i,r,o,a,s,"next",e)}function s(e){f(i,r,o,a,s,"throw",e)}a(void 0)}))});return function(e,n,r){return t.apply(this,arguments)}}(),S=function(){n(t,m(new Set([].concat(m(j.current),m(x.current)))))};return{unreadChatRoomUuids:s,onEventReceive:function(e,r,o){switch(r.event){case"newMessage":O(e,r,o);break;case"chatRoomRead":!function(e,r){var o=r.chat_room_uuid,i=e.filter((function(e){return e!==o})),a=x.current.filter((function(e){return e!==o}));b(a),n(t,i)}(e,r)}},fetchUnreadChatRoomUuids:function(e){(0,i.UT)(a.av.chatRooms.unreadChatRooms({params:{community_id:e}})).then((function(t){t.chat_room_uuids&&n(e,t.chat_room_uuids)})).catch((function(e){console.error(e)}))},unreadChatRoomUuidsRef:j,newUnreadChatRoomBatch:h,newUnreadChatRoomBatchRef:x,setUnreadChatRoomUuids:n}},g=n(24897),y=n(97012),_=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).community,t=(0,y.wh)(),n=t.currentCommunity,s=t.currentCommunityMember,l=e?e.community_member_id:null===s||void 0===s?void 0:s.id,c=e?e.id:null===n||void 0===n?void 0:n.id,u=b({communityId:c}),d=u.unreadChatRoomUuids,m=u.onEventReceive,f=u.setUnreadChatRoomUuids,p=u.unreadChatRoomUuidsRef,v=u.newUnreadChatRoomBatch,h=u.newUnreadChatRoomBatchRef;return(0,o.useQuery)(["UNREAD_CHAT_ROOMS_COUNT",c,l],(function(){return(0,i.UT)(a.av.chatRooms.unreadChatRooms({params:{community_id:c}}))}),{enabled:Boolean(c&&l),onSuccess:function(e){e.chat_room_uuids&&f(c,e.chat_room_uuids)}}),(0,g.s)({channel:"ChatRoomChannel",onMessageReceive:function(e){m(p.current,e,l)},community_member_id:l,canCreateConnection:Boolean(c&&l)}),(0,r.useEffect)((function(){p.current=d}),[d]),(0,r.useEffect)((function(){h.current=v}),[v]),{unreadChatCount:d.length,unreadChatRoomUuids:d}}},98090:(e,t,n)=>{n.d(t,{U:()=>d,u:()=>m});var r=n(96486),o=n(88767),i=n(34128),a=n(49326),s=n(75752);function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var d=20,m=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{per_page:d},l=["chat-participants",e],u=function(){var e=(s.Eh.getQueryState({queryKey:l})||{}).data,t=(0,r.flatten)(((null===e||void 0===e?void 0:e.pages)||[]).map((function(e){return e.records})));return(0,r.uniqBy)(t,"id")},m=(0,o.useInfiniteQuery)(l,(function(t){var r,o=t.pageParam;return r=void 0===o?1:o,(0,i.UT)(a.av.chatRoomParticipants.index({uuid:e,params:c({page:r},n)}))}),{select:function(e){var t=e.pages,n=void 0===t?[]:t;return{participants:(0,r.uniqBy)((0,r.flatten)((n||[]).map((function(e){return e.records}))),"id"),totalCount:n[0].count}},enabled:0===(null===(t=u())||void 0===t?void 0:t.length)&&Boolean(e),getNextPageParam:function(e){return e.has_next_page?e.page+1:void 0}}),f=m.data,p=m.isLoading,v=m.refetch,h=m.hasNextPage,b=m.fetchNextPage,g=(f||{}).totalCount,y=void 0===g?0:g;return{chatParticipants:u(),isLoading:p,refetchChatParticipants:e?v:r.noop,hasNextPage:h,totalCount:y,fetchNextPage:b}}},69010:(e,t,n)=>{n.d(t,{p:()=>y});var r=n(64687),o=n.n(r),i=n(86013),a=n(24185),s=n(34128),l=n(81967),c=n(49326),u=n(21809),d=["shouldNavigate"],m=["shouldNavigate"];function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){v(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function h(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function b(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}function g(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){b(i,r,o,a,s,"next",e)}function s(e){b(i,r,o,a,s,"throw",e)}a(void 0)}))}}var y=function(){var e=(0,a.k6)(),t=(0,u.p)(),n=function(){var n=g(o().mark((function n(r){var a,u,m,f,p,v;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=r.shouldNavigate,u=void 0!==a&&a,m=h(r,d),n.prev=1,f=m.community_member_ids,n.next=5,(0,s.UT)(c.av.chatRooms.fetch({params:{community_member_ids:f}}));case 5:return p=n.sent,v=p.uuid,u&&e.push((0,c.so)({uuid:v})),n.abrupt("return",v);case 11:n.prev=11,n.t0=n.catch(1),t.error((0,i.t)("something_went_wrong")),(0,l.d)(n.t0);case 15:case"end":return n.stop()}}),n,null,[[1,11]])})));return function(e){return n.apply(this,arguments)}}(),r=function(){var n=g(o().mark((function n(r){var a,u,d,f,v,b;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=r.shouldNavigate,u=void 0!==a&&a,d=h(r,m),n.prev=1,f={chat_room:d},n.next=5,(0,s.Cu)(c.av.chatRooms.create(),p({},f));case 5:return v=n.sent,b=v.chat_room.uuid,u&&e.push((0,c.so)({uuid:v.chat_room.uuid})),n.abrupt("return",b);case 11:n.prev=11,n.t0=n.catch(1),t.error((0,i.t)("something_went_wrong")),(0,l.d)(n.t0);case 15:case"end":return n.stop()}}),n,null,[[1,11]])})));return function(e){return n.apply(this,arguments)}}();return{findChatRoom:n,findOrCreateChatRoom:r}}},24878:(e,t,n)=>{n.d(t,{a:()=>d,f:()=>m});var r=n(30270),o=n(32714);function i(e){return function(e){if(Array.isArray(e))return a(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var u={chatRoomMessages:[],isLoading:!1,hasNextPage:!1,hasPrevPage:!1,scrollInfo:{},firstMessageId:null,lastMessageId:null,shouldShowLatestMessageBtn:!1,topMessageId:null,isInitialPageLoaded:!1,activeMessageId:null},d=(0,r.Ue)((0,o.n)((function(e){return{chatRoom:l(l({},u),{},{setChatRoomMessages:function(t){return e((function(e){e.chatRoom.chatRoomMessages=t}))},setIsLoading:function(t){return e((function(e){e.chatRoom.isLoading=t}))},setIsInitialPageLoaded:function(t){return e((function(e){e.chatRoom.isInitialPageLoaded=t}))},setHasNextPage:function(t){return e((function(e){e.chatRoom.hasNextPage=t}))},setHasPrevPage:function(t){return e((function(e){e.chatRoom.hasPrevPage=t}))},setScrollInfo:function(t){return e((function(e){e.chatRoom.scrollInfo=t}))},setFirstMessageId:function(t){return e((function(e){e.chatRoom.firstMessageId=t}))},setLastMessageId:function(t){return e((function(e){e.chatRoom.lastMessageId=t}))},setShouldShowLatestMessageBtn:function(t){return e((function(e){e.chatRoom.shouldShowLatestMessageBtn=t}))},setTopMessageId:function(t){return e((function(e){e.chatRoom.topMessageId=t}))},setActiveMessageId:function(t){return e((function(e){e.chatRoom.activeMessageId=t}))}}),unreadChatRoomUuids:{},setUnreadChatRoomUuids:function(t,n){return e((function(e){e.unreadChatRoomUuids=l(l({},e.unreadChatRoomUuids),{},c({},t,n))}))},appendUnreadChatRoomUuids:function(t,n){return e((function(e){e.unreadChatRoomUuids=l(l({},e.unreadChatRoomUuids),{},c({},t,[].concat(i(e.unreadChatRoomUuids[t]||[]),[n])))}))},resetChatRoom:function(){return e((function(e){e.chatRoom=l(l({},e.chatRoom),u)}))}}}))),m=function(){return d((function(e){return e.chatRoom}))}},20447:(e,t,n)=>{n.d(t,{k:()=>C,T:()=>k});var r=n(64687),o=n.n(r),i=n(67294),a=n(86013),s=n(34128),l=n(49326),c=n(1320),u=n(37803),d=n(21809),m=n(6364),f=n(48135);function p(e){return function(e){if(Array.isArray(e))return v(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return v(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return v(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){g(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function g(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var y=n(85893);function _(e){return function(e){if(Array.isArray(e))return O(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||w(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function j(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}function x(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||w(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function w(e,t){if(e){if("string"===typeof e)return O(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?O(e,t):void 0}}function O(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var S={chatMessages:[]},P=(0,i.createContext)(S);P.displayName="ChatThreadsContext";var C=function(e){var t=e.children,n=x((0,i.useState)(S.chatMessages),2),r=n[0],v=n[1],h=x((0,i.useState)(!1),2),g=h[0],w=h[1],O=x((0,i.useState)(!1),2),C=O[0],k=O[1],I=x((0,i.useState)(!1),2),N=I[0],A=I[1],E=x((0,i.useState)({}),2),T=E[0],D=E[1],R=x((0,i.useState)(null),2),L=R[0],M=R[1],F=x((0,i.useState)(null),2),U=F[0],B=F[1],z=x((0,i.useState)(!1),2),H=z[0],q=z[1],Z=x((0,i.useState)(0),2),V=Z[0],W=Z[1],Q=x((0,i.useState)({}),2),$=Q[0],G=Q[1],J=(0,m.j)().isMobileView,K=(0,u.x)(),Y=K.parentMessage,X=K.updateParentMessage,ee=(0,d.p)().error,te=function(){var e,t=(e=o().mark((function e(t){var n,r,i,u,d,m,f,p,h,b,y,j,x;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.id,r=t.previousPerPage,i=void 0===r?20:r,u=t.nextPerPage,d=void 0===u?0:u,m=t.chatRoomUuid,f=t.isInitialPage,p=void 0!==f&&f,h=t.parentMessage,!(b=0===i)&&!p||!g){e.next=4;break}return e.abrupt("return");case 4:return w(!0),y={previous_per_page:i,next_per_page:d,parent_message_id:h.id},n&&(y.id=n),e.prev=7,e.next=10,(0,s.UT)(l.av.chatRoomMessages.index({uuid:m,params:y}));case 10:j=e.sent,p?(null!==(x=j.meta)&&void 0!==x&&x.chat_thread_participant_id&&(D(ne({event:"chatThreadsLoad"})),(0,c.ex)(h.chat_thread_id)),G(j.meta),v(j.records),k(j.has_next_page),A(j.has_previous_page),W(j.total_count),M(j.first_id),B(j.last_id),q(!0)):(b?(D(ne({event:"nextPaginatedMessageLoad"})),B(j.last_id)):(D(ne({event:"paginatedMessageLoad"})),M(j.first_id)),v((function(e){return[].concat(_(j.records),_(e))})),C&&k(j.has_next_page),N&&A(j.has_previous_page)),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(7),ee((0,a.t)("request_failure_message")),console.error(e.t0);case 18:return e.prev=18,w(!1),e.finish(18);case 21:case"end":return e.stop()}}),e,null,[[7,14,18,21]])})),function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){j(i,r,o,a,s,"next",e)}function s(e){j(i,r,o,a,s,"throw",e)}a(void 0)}))});return function(e){return t.apply(this,arguments)}}(),ne=function(e){var t=e.event,n=document.getElementById("message-thread-scroll-view"),r="noScroll";switch(t){case"messageSent":r="scrollToBottom";break;case"messageReceived":var o=n.scrollTop-n.scrollHeight+n.offsetHeight;(J()&&0===o||(o<=1||o>14))&&(r="scrollToBottom");break;case"chatThreadsLoad":r="scrollToUnreadMessageIndicator";break;case"paginatedMessageLoad":r="adjustTop";break;case"nextPaginatedMessageLoad":case"messageUpdated":case"messageDeleted":r="noScroll"}return{action:r,scrollTopValue:n.scrollTop,scrollHeightValue:n.scrollHeight}},re=function(e,t){var n=e.id,r=t.filter((function(e){return e.id!==n}));v(r)},oe=function(e,t){var n=e.json_message,r=t.reduce((function(e,t){return t.id===n.id?e.push(n):e.push(t),e}),[]);v(_(r)),n.id===(null===Y||void 0===Y?void 0:Y.id)&&X(n)},ie=function(e,t){var n=e.json_message;D(ne({event:n.sender.id===t.id?"messageSent":"messageReceived"})),v([].concat(_(r),[n]))},ae=(0,f.B)(r,v),se=function(e){var t=e.parentMessage,n=e.updateParentMessage,r=e.chatMessages,o=e.setChatMessages,i=e.setScrollInfo,a=e.scrollInfo,s=function(e){var s=e.communityMemberId,l=e.emoji,c=e.reactionableId;if(t.id===c){var u,d,m=b({},t),f=m.reactions.findIndex((function(e){return e.emoji===l}));if(null!==(u=m.reactions[f])&&void 0!==u&&null!==(d=u.community_member_ids)&&void 0!==d&&d.includes(s))return;-1!==f?(m.reactions[f].community_member_ids.push(s),m.reactions[f].count+=1):m.reactions.push({emoji:l,community_member_ids:[s],count:1}),n(m)}else{var v=p(r),h=v.findIndex((function(e){return e.id===c}));if(-1!==h){var g,y,_=v[h].reactions.findIndex((function(e){return e.emoji===l}));if(null!==(g=v[h].reactions[_])&&void 0!==g&&null!==(y=g.community_member_ids)&&void 0!==y&&y.includes(s))return;-1!==_?(v[h].reactions[_].community_member_ids.push(s),v[h].reactions[_].count+=1):v[h].reactions.push({emoji:l,community_member_ids:[s],count:1}),i(b(b({},a),{},{action:"noScroll"})),o(v)}}},l=function(e){var s=e.communityMemberId,l=e.emoji,c=e.reactionableId;if(t.id===c){var u,d,m=b({},t),f=m.reactions.findIndex((function(e){return e.emoji===l}));if(null===(u=m.reactions[f])||void 0===u||null===(d=u.community_member_ids)||void 0===d||!d.includes(s))return;-1!==f&&(1===m.reactions[f].count?m.reactions.splice(f,1):(m.reactions[f].community_member_ids=m.reactions[f].community_member_ids.filter((function(e){return e!==s})),m.reactions[f].count-=1),n(m))}else{var v=p(r),h=v.findIndex((function(e){return e.id===c}));if(-1!==h){var g,y,_,j,x=null===(g=v[h])||void 0===g||null===(y=g.reactions)||void 0===y?void 0:y.findIndex((function(e){return e.emoji===l}));if(null===(_=v[h].reactions[x])||void 0===_||null===(j=_.community_member_ids)||void 0===j||!j.includes(s))return;-1!==x&&(1===v[h].reactions[x].count?v[h].reactions.splice(x,1):(v[h].reactions[x].community_member_ids=v[h].reactions[x].community_member_ids.filter((function(e){return e!==s})),v[h].reactions[x].count-=1)),i(b(b({},a),{},{action:"noScroll"})),o(v)}}};return{createReactionFromThread:s,removeReactionFromThread:l,handleReactionFromWebsocket:function(e){if("ChatRoomMessage"===e.json_message.reactionable_type){var t=e.json_message,n=t.community_member_id,r=t.emoji,o=t.reactionable_id;"createReaction"===e.event?s({communityMemberId:n,emoji:r,reactionableId:o}):"destroyReaction"===e.event&&l({communityMemberId:n,emoji:r,reactionableId:o})}}}}({parentMessage:Y,updateParentMessage:X,chatMessages:r,setChatMessages:v,setScrollInfo:D,scrollInfo:T}),le=se.createReactionFromThread,ce=se.removeReactionFromThread,ue=se.handleReactionFromWebsocket,de={chatMessages:r,setChatMessages:v,messagesHasNextPage:C,messagesHasPrevPage:N,setScrollInfo:D,fetchChatMessages:te,calculateScrollInfo:ne,adjustScroller:function(){var e=document.getElementById("message-thread-scroll-view"),t=document.getElementById("unread-thread-message-breakpoint");switch(T.action){case"scrollToBottom":e.scrollTop=e.scrollHeight;break;case"adjustTop":e.scrollTop=e.scrollHeight-(T.scrollHeightValue-T.scrollTopValue);break;case"scrollToUnreadMessageIndicator":t?t.scrollIntoView({behavior:"smooth"}):e.scrollTop=e.scrollHeight}},isLoading:g,firstMessageId:L,lastMessageId:U,onEventReceive:function(e,t,n){switch(e.event){case"newMessage":ie(e,n);break;case"deletedMessage":re(e,t);break;case"updatedMessage":oe(e,t)}},isInitialPageLoaded:H,totalMessagesCount:V,metaData:$,createReactionFromThread:le,removeReactionFromThread:ce,handleReactionFromWebsocket:ue,onBookmarkToggle:ae};return(0,y.jsx)(P.Provider,{value:de,children:t})},k=function(){return(0,i.useContext)(P)}},76063:(e,t,n)=>{n.d(t,{N:()=>b,T:()=>y});var r=n(64687),o=n.n(r),i=n(67294),a=n(96486),s=n(88767),l=n(34128),c=n(49326);function u(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}function d(e){return function(e){if(Array.isArray(e))return m(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return m(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return m(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){v(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var h=["sidebar","chat-rooms","all"],b=["messaging","chat-rooms","all"],g=["sidebar","chat-rooms","unread"],y=function(e){var t=e.openChatRoomUuid,n=e.uuids,r=(0,s.useQueryClient)(),m=(0,i.useMemo)((function(){return n?g:t?b:h}),[n,t]),f=function(e){r.setQueryData(m,(function(t){return p(p({},t),{},{pages:t.pages.map((function(t,n){return p(p({},t||{}),{},{records:e.slice(20*n,20*(Number(n)+1))})}))})}))},v=(0,s.useInfiniteQuery)(m,(function(e){var t,r=e.pageParam;return t={page:void 0===r?1:r,per_page:20},n&&(t.uuids=n),(0,l.UT)(c.av.chatRooms.index({params:t}))}),{select:function(e){var t=e.pages,n=void 0===t?[]:t;return{pages:(0,a.flatten)(n.map((function(e){return e.records}))),pageParams:n.map((function(e){return e.page}))}},onSuccess:function(){I(t)},getNextPageParam:function(e){return e.has_next_page?Number(e.page)+1:void 0}}),y=v.isLoading,_=v.refetch,j=v.data,x=(j=void 0===j?{}:j).pages,w=void 0===x?[]:x,O=v.hasNextPage,S=void 0!==O&&O,P=v.fetchNextPage,C=function(e){return w.find((function(t){return t.uuid===e}))},k=function(e){(0,l.UT)(c.av.chatRooms.show({uuid:e})).then((function(e){e.chat_room&&f([e.chat_room].concat(d(w)))}))},I=function(e){e&&"new"!==e&&(w.find((function(e){var t=e.isOpen;return Boolean(t)}))&&k(e))},N=function(e){var t=e.chat_room_uuid,n=w.filter((function(e){return e.uuid!==t}));f(n)},A=function(){var e,t=(e=o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.invalidateQueries(m);case 2:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){u(i,r,o,a,s,"next",e)}function s(e){u(i,r,o,a,s,"throw",e)}a(void 0)}))});return function(){return t.apply(this,arguments)}}();return{chatRooms:w,setChatRooms:f,fetchChatRoomForUuid:C,onEventReceive:function(e,t){switch(e.event){case"newMessage":!function(e,t){var n=e.json_message,r=n.chat_room_uuid,o=n.sender,i=n.embedded,a=o.community_member_id,s=C(r);if(s){var l=s.isOpen,c=s.unread_messages_count,u=w.filter((function(e){return e!==s})),m=l?0:a===t?c:Number(c)+1,v=p(p({},s),{},{last_message:n,unread_messages_count:m});f([v].concat(d(u)))}else!0!==i&&k(r)}(e,t);break;case"chatRoomRead":!function(e){var t=e.chat_room_uuid,n=w.findIndex((function(e){return e.uuid===t}));if(n>-1){var r=w[n],o=[].concat(d(w.slice(0,n)),[p(p({},r),{},{unread_messages_count:0})],d(w.slice(Number(n)+1)));f(o)}}(e);break;case"chatRoomCreated":A();break;case"chatRoomUpdated":!function(e){var t="string"===typeof e.chat_room?JSON.parse(e.chat_room):e.chat_room,n=w.map((function(e){return e.uuid===t.uuid?p(p({},e),{},{chat_room_name:t.chat_room_name}):e}));f(n)}(e);break;case"chatRoomDeleted":case"chatRoomParticipantDestroy":N(e);break;case"chatRoomParticipantsUpdated":!function(e){var t=JSON.parse(e.chat_room),n=w.map((function(e){return e.uuid===t.uuid?t:e}));f(n)}(e)}},chatRoomsHasNextPage:S,hasNextPage:S,fetchNextPage:P,fetchUserChatRooms:_,isLoading:y}}},75062:(e,t,n)=>{n.d(t,{Cz:()=>k,tF:()=>N,_q:()=>I});var r=n(64687),o=n.n(r),i=n(67294),a=n(86013),s=n(88767),l=n(24185),c=n(34128),u=n(81967),d=n(49326),m=n(21809),f=n(59393),p=n(40754),v=n(85244),h=n(85893);function b(e){return function(e){if(Array.isArray(e))return S(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||O(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){_(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function j(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}function x(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){j(i,r,o,a,s,"next",e)}function s(e){j(i,r,o,a,s,"throw",e)}a(void 0)}))}}function w(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||O(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function O(e,t){if(e){if("string"===typeof e)return S(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?S(e,t):void 0}}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var P=(0,i.createContext)(C);P.displayName="ChatRoomsContext";var C={chatRooms:[]},k=function(e){var t,n=e.children,r=w((0,i.useState)(C.chatRooms),2),g=r[0],_=r[1],j=(0,v.j)().addDirectMessageParticipantNameInTitle,O=(0,l.k6)(),S=(0,m.p)(),k=(0,s.useQueryClient)(),I=(t=(0,i.useRef)(null),(0,i.useEffect)((function(){return clearTimeout(t.current)}),[]),{debouncedFunction:function(e,n){for(var r=arguments.length,o=new Array(r>2?r-2:0),i=2;i<r;i++)o[i-2]=arguments[i];clearTimeout(t.current),t.current=setTimeout((function(){e.apply(void 0,o)}),n)}}),A=I.debouncedFunction,E=function(e,t){return e.find((function(e){return e.uuid===t}))},T=function(){var e=x(o().mark((function e(t){var n,r,i,s,l,m,f,p,v,h;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.chatRoom,r=t.rich_text_body,i=t.currentCommunityMember,s=t.localAttachments,l=t.localSgidToObjectMap,m=t.parentMessageId,e.prev=1,f=n.current_participant.id,!B){e.next=12;break}return p={chat_room_participant_id:f,rich_text_body:r},m&&(p.parent_message_id=m),e.next=8,(0,c.Cu)(d.av.chatRoomMessages.create({uuid:n.uuid}),{chat_room_message:p});case 8:v=e.sent,h={id:null,rich_text_body:y(y({},r),{},{attachments:s,sgids_to_object_map:l}),body:null,chat_room_uuid:n.uuid,chat_room_participant_id:f,creation_uuid:v.creation_uuid,sender:n.current_participant,sent_at:v.sent_at},m&&(h.parent_message_id=m),D({json_message:h},i.id,g);case 12:e.next=18;break;case 14:e.prev=14,e.t0=e.catch(1),S.error((0,a.t)("something_went_wrong")),(0,u.d)(e.t0);case 18:case"end":return e.stop()}}),e,null,[[1,14]])})));return function(t){return e.apply(this,arguments)}}(),D=function(e,t,n,r){var o=e.json_message,i=o.chat_room_uuid,a=o.sender,s=o.embedded;if(!o.parent_message_id){var l=a.community_member_id,u=E(n,i);if(u){var m=u.unread_messages_count;r&&A(N,2e3,i);var f=n.filter((function(e){return e!==u})),p=r?0:l===t?m:m+1,v=y(y({},u),{},{last_message:o,unread_messages_count:p});_([v].concat(b(f)))}else!0!==s&&function(e,t){(0,c.UT)(d.av.chatRooms.show({uuid:e})).then((function(e){e.chat_room&&_(b(new Set([e.chat_room].concat(b(t)))))})).catch((function(e){console.error(e)}))}(i,n)}},R=function(e){var t=e.chat_room_uuid,n=g.findIndex((function(e){return e.uuid===t}));if(n>-1){var r=g[n],o=[].concat(b(g.slice(0,n)),[y(y({},r),{},{unread_messages_count:0})],b(g.slice(n+1)));_(o)}},L=function(e){var t=JSON.parse(e.chat_room),n=g.map((function(e){return e.uuid===t.uuid?t:e}));_(n),k.invalidateQueries((0,p.S)(t.uuid))},M=function(e){var t=e.chat_room_uuid,n=g.filter((function(e){return e.uuid!==t}));_(n),O.push((0,d.yg)())},F=function(){var e=x(o().mark((function e(t){var n,r,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.chatRoomUuid,r=t.rich_text_body,i=t.messageId,e.prev=1,e.next=4,(0,c.gN)(d.av.chatRoomMessages.update({uuid:n,id:i}),{chat_room_message:{rich_text_body:r}});case 4:e.next=10;break;case 6:e.prev=6,e.t0=e.catch(1),S.error((0,a.t)("something_went_wrong")),(0,u.d)(e.t0);case 10:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(t){return e.apply(this,arguments)}}(),U=function(){var e=x(o().mark((function e(t){var n,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.chatRoomUuid,r=t.messageId,e.prev=1,e.next=4,(0,c.pC)(d.av.chatRoomMessages.delete({uuid:n,id:r}));case 4:e.next=10;break;case 6:e.prev=6,e.t0=e.catch(1),S.error((0,a.t)("something_went_wrong")),(0,u.d)(e.t0);case 10:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(t){return e.apply(this,arguments)}}(),B={chatRooms:g,setChatRooms:_,fetchChatRoomForUuid:E,onEventReceive:function(e,t,n,r){switch(e.event){case"newMessage":D(e,t,n,r);break;case"chatRoomRead":R(e);break;case"chatRoomCreated":!function(e){var t=(e||{}).chat_room;-1==g.findIndex((function(e){return e.uuid==t.uuid}))&&_((function(e){return[t].concat(b(e))}))}(e);break;case"chatRoomUpdated":!function(e){var t=(e||{}).chat_room,n=g.map((function(e){return e.uuid===t.uuid?y(y({},e),{},{chat_room_name:t.chat_room_name}):e}));_(n)}(e);break;case"chatRoomParticipantsUpdated":L(e);break;case"chatRoomParticipantDestroy":case"chatRoomDeleted":M(e)}},onEmbedEventReceive:function(e,t){switch(e.event){case"chatRoomRead":R(e);break;case"chatRoomUpdated":!function(){var e=arguments.length>1?arguments[1]:void 0,t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).chat_room,n=g.map((function(n){return n.uuid===e?y(y({},n),{},{chat_room_description:t.chat_room_description,chat_room_show_history:t.chat_room_show_history,pinned_message:t.pinned_message}):n}));_(n)}(e,t);break;case"chatRoomParticipantsUpdated":L(e);break;case"chatRoomParticipantDestroy":M(e)}},updateTitleBar:function(e,t){var n=E(e,t);n&&j(n.chat_room_kind===f.g8?n.other_participants_preview[0].name:n.chat_room_name)},sendRichTextMessage:T,updateRichTextMessage:F,deleteRichTextMessage:U};return(0,h.jsx)(P.Provider,{value:B,children:n})},I=function(){return(0,i.useContext)(P)},N=function(e){return(0,c.Cu)(d.av.chatRooms.markAllAsRead({uuid:e}))}},37803:(e,t,n)=>{n.d(t,{G:()=>Q,x:()=>$});var r=n(67294),o=n(80621),i=n(86013),a=n(67621),s=n(59393),l=n(15130),c=n(98090),u=n(88291),d=n(30990),m=n(49164),f=n(82487),p=n(58533),v=n(88767),h=n(1320),b=n(63001),g=n(16743),y=n(84495),_=n(3249),j=n(39834),x=n(20633),w=n(1002),O=n(21809),S=n(98075),P=n(85893);function C(e){return function(e){if(Array.isArray(e))return k(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return k(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return k(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var I=function(e){var t=e.chatRoom,n=e.refetchChatRoom,r=(0,O.p)(),o=(0,b.r)(),a=t.uuid,s=t.current_participant,l=(0,y.uk)(a),c=l.chatParticipants,u=void 0===c?[]:c,d=l.refetchChatParticipants,m=l.totalCount,f=l.hasNextPage,k=l.fetchNextPage,I=C((0,S.F2)(u)),N=(0,v.useMutation)((function(e){var t=e.participantId,n=e.status;return h.M.update({uuid:a,id:t,admin:n},{forReactQuery:!0})}),{onSuccess:function(e){var t=e.chat_room_participant,o=t.name,a=t.roles.admin,s=o||(0,i.t)("messaging.member");d(),n(),r.success(a?(0,i.t)("messaging.member_made_admin",{name:s}):(0,i.t)("messaging.member_removed_as_admin",{name:s}),{duration:"short",shouldUseProgress:!1})},onError:function(){r.error((0,i.t)("request_failure_message"))}}).mutateAsync,A=(0,v.useMutation)((function(e){var t=e.participantId;return h.M.destroy({uuid:a,id:t},{forReactQuery:!0})}),{onSuccess:function(e){var t=e.message;d(),n(),r.success(t)},onError:function(){r.error((0,i.t)("request_failure_message"))}}).mutateAsync,E=function(e){return o.show({memberPublicId:e})},T=(0,S.bb)(I),D=T.onlineParticipants,R=T.offlineParticipants,L=function(e){return e.map((function(e){var t=function(e){return[{value:"view-profile",label:(0,i.t)("messaging.actions.view_profile"),onClick:function(){return E(e.user_public_uid)}},{value:e.admin?"remove-admin":"make-admin",label:e.admin?(0,i.t)("messaging.remove_admin"):(0,i.t)("messaging.make_admin"),onClick:function(){return N({participantId:e.id,status:!e.admin})}},{value:"remove",label:(0,i.t)("messaging.remove"),onClick:function(){return A({participantId:e.id})}}]}(e),n=s.id===e.id,r=!n&&s.admin;return(0,P.jsxs)("button",{type:"button",className:"hover:bg-tertiary messaging-rail__content--member focus-visible:bg-tertiary w-full","aria-label":(0,i.t)("messaging.open_member_profile_button_aria_label",{name:e.name}),onClick:function(){return E(e.user_public_uid)},children:[(0,P.jsxs)("div",{className:"text-dark flex w-[90%] items-center text-left",children:[(0,P.jsx)("div",{className:"mr-3",children:(0,P.jsx)(_.g,{name:e.name,src:e.avatar_url,status:e.status,size:"10"})}),(0,P.jsx)("div",{children:n?(0,i.t)("messaging.you"):e.name}),e.admin&&(0,P.jsx)(j.g,{className:"ml-2 uppercase",square:!0,label:(0,i.t)("moderator")})]}),r&&(0,P.jsx)(w.Lt,{direction:"bottom-start",menuButtonEl:"div",button:(0,P.jsx)(w.Lt.MenuButton,{id:"action-block",children:(0,P.jsx)(x.h,{name:"20-menu-dots-vertical",iconSize:20})}),options:t})]},e.id)}))};return(0,P.jsx)("div",{id:"scrollableDiv",className:"messaging-rail__content h-full overflow-auto",children:(0,P.jsxs)(p.Z,{scrollThreshold:.8,next:k,hasMore:f,dataLength:m,className:"px-6 pb-6",scrollableTarget:"scrollableDiv",children:[D.length>0&&(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)("div",{className:"text-default mb-2",children:(0,P.jsx)(g.Z.LabelXxs,{weight:"semibold",children:(0,i.t)("chat_space.online_now")})}),L(D)]}),R.length>0&&(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)("div",{className:"text-default my-2",children:(0,P.jsx)(g.Z.LabelXxs,{weight:"semibold",children:(0,i.t)("chat_space.offline")})}),L(R)]})]})})},N=function(e){var t=e.chatRoom,n=e.isDirect,r=e.refetchChatRoom,o=e.otherParticipant,i=e.member;return n?(0,P.jsx)(f.N,{memberPublicId:null===o||void 0===o?void 0:o.user_public_uid,member:i,isFullPageProfile:!1,isRenderedOnRailBar:!0,shouldHideMessageButton:!0,shouldHideBadge:!0,shouldFixTabsTop:!0}):(0,P.jsx)(I,{chatRoom:t,refetchChatRoom:r})},A=n(96486),E=n(30887),T=n(26953),D=function(e){var t=e.title,n=e.memberCount,r=e.isDirect,o=e.description,i=e.onClose,a=void 0===i?A.noop:i,s=Boolean(!r&&o),l=(0,T.BT)();return(0,P.jsxs)("div",{className:"flex w-full flex-col gap-4",children:[(0,P.jsxs)("div",{className:"flex w-full items-center justify-between",children:[(0,P.jsx)(g.Z.TitleSm,{as:"h2",weight:"semibold",children:t}),l?(0,P.jsx)("button",{type:"submit",onClick:a,children:(0,P.jsx)(E.JO,{type:"close-v2",className:"text-dark mr-1 mt-2.5",useWithFillCurrentColor:!0})}):(0,P.jsx)(P.Fragment,{children:!r&&(0,P.jsxs)("div",{className:"flex",children:[(0,P.jsx)("div",{className:"text-default mr-2 pb-0.5",children:(0,P.jsx)(g.Z.LabelSm,{weight:"medium",children:n})}),(0,P.jsx)(E.JO,{type:"space-chat-members",className:"text-dark",useWithFillCurrentColor:!0})]})})]}),s&&(0,P.jsx)("div",{className:"text-default whitespace-pre-line",children:(0,P.jsx)(g.Z.BodySm,{children:o})})]})},R={page_name:l.$q.PROFILE_VIEW},L=function(e){var t=e.chatRoom,n=void 0===t?{}:t,r=e.chatRoomUuid,o=e.refetchChatRoom,l=n.chat_room_name,f=n.chat_room_kind,p=n.chat_room_description,v=n.current_participant,h=f===s.g8,b=(0,c.u)(r),g=b.chatParticipants,y=b.isLoading,_=b.totalCount,j=(g||[]).find((function(e){return e.id!==(null===v||void 0===v?void 0:v.id)})),x=$().toggleShowRailBar,w=(0,u.P)({memberPublicId:null===j||void 0===j?void 0:j.user_public_uid,params:R}).getProfileInfoQuery,O=w.data,S=void 0===O?{}:O,C=w.isLoading,k=(0,d.T)(),I=k.ref,A=k.height;return(0,P.jsxs)(a.x,{isLoading:h&&C||y,loaderVariant:h?"rail-profile":"rail-member-list",children:[(0,P.jsx)("div",{ref:I,children:(0,P.jsx)(m.S0.Header,{children:(0,P.jsx)(D,{title:h?(0,i.t)("profile"):l,memberCount:_,isDirect:h,description:p,onClose:x})})}),(0,P.jsx)(m.S0.Content,{noPadding:!0,heightGap:A,children:(0,P.jsx)(N,{chatRoom:n,isDirect:h,otherParticipant:j,member:S,refetchChatRoom:o})})]})},M=n(38460),F=function(e){var t=e.description,n=e.shouldHideMembersCount,r=e.memberCount,o=void 0===r?0:r,a=e.onClose,s=void 0===a?A.noop:a,l=(0,T.BT)();return(0,T.kK)()?(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)("div",{className:"border-primary border-b px-6 py-4",children:(0,P.jsx)(x.h,{name:"16-arrow-left",onClick:s})}),(0,P.jsxs)("div",{className:"px-6 py-4",children:[(0,P.jsxs)("div",{className:"flex items-center justify-between",children:[(0,P.jsx)(g.Z.TitleSm,{as:"h2",weight:"semibold",children:(0,i.t)("chat_space.details")}),!n&&(0,P.jsxs)("div",{className:"flex items-center",children:[(0,P.jsx)("div",{className:"text-default mr-2",children:(0,P.jsx)(g.Z.LabelSm,{weight:"medium",children:o})}),(0,P.jsx)(E.JO,{type:"20-members",size:20,className:"text-dark",useWithFillCurrentColor:!0})]})]}),t&&(0,P.jsx)("div",{className:"text-default mt-4 max-h-[200px] overflow-y-auto whitespace-pre-line",children:(0,P.jsx)(g.Z.BodySm,{children:t})})]})]}):(0,P.jsxs)("div",{className:"flex w-full flex-col gap-4",children:[(0,P.jsxs)("div",{className:"flex w-full items-center justify-between",children:[(0,P.jsx)(g.Z.TitleSm,{as:"h2",weight:"semibold",children:(0,i.t)("chat_space.details")}),l?(0,P.jsx)("button",{type:"submit",onClick:s,children:(0,P.jsx)(E.JO,{type:"close-v2",className:"text-dark mr-1 mt-2.5 cursor-pointer",useWithFillCurrentColor:!0})}):(0,P.jsx)(P.Fragment,{children:!n&&(0,P.jsxs)("div",{className:"flex",children:[(0,P.jsx)("div",{className:"text-dark mr-2",children:(0,P.jsx)(g.Z.LabelSm,{weight:"medium",children:o})}),(0,P.jsx)(E.JO,{type:"space-chat-members",className:"mt-1"})]})})]}),t&&(0,P.jsx)("div",{className:"text-dark max-h-[200px] overflow-y-auto whitespace-pre-line",children:(0,P.jsx)(g.Z.BodySm,{children:t})})]})},U=function(e){var t=e.space,n=(0,c.u)(t.chat_room_uuid),r=n.chatParticipants,o=n.isLoading,i=n.refetchChatParticipants,s=n.hasNextPage,l=n.fetchNextPage,u=n.totalCount,f=$().toggleShowRailBar,p=(0,d.T)(),v=p.ref,h=p.height;return(0,P.jsxs)(a.x,{isLoading:o,loaderVariant:"rail-member-list",children:[(0,P.jsx)(m.S0.Header,{className:"mb-4 !p-0 md:mb-0 md:!px-6 md:!py-4",children:(0,P.jsx)("div",{ref:v,className:"w-full",children:(0,P.jsx)(F,{shouldHideMembersCount:t.hide_members_count,memberCount:u,description:t.chat_room_description,onClose:f})})}),(0,P.jsx)(m.S0.Content,{heightGap:h,noPadding:!0,children:(0,P.jsx)(M.V,{spaceMembers:r,hasMoreSpaceMembers:s,space:t,refetchSpaceMembers:i,fetchNextPage:l})})]})},B=n(63099);function z(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return H(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return H(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function H(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var q="PARTICIPANTS",Z="CHAT_THREADS",V={chatRoom:null,closeThreadsRailbar:function(){},isCourseSpace:!1,isLiveStream:!1,messageHighlightId:null,openThreadsRailbar:function(){},parentMessage:null,RailbarComponent:function(){return null},setMessageHighlightId:function(){},shouldShowRailBar:!1,toggleShowRailBar:function(){},type:q,updateParentMessage:function(){}},W=(0,r.createContext)(V);W.displayName="RailbarContext";var Q=function(e){var t=e.isChatSpace,n=void 0!==t&&t,i=e.children,a=e.isLiveStream,s=void 0!==a&&a,l=e.isCourseSpace,c=void 0!==l&&l,u=z((0,r.useState)(V.type),2),d=u[0],m=u[1],f=z((0,B.k)(!1),3),p=f[0],v=f[1],h=f[2],b=z((0,r.useState)(V.parentMessage),2),g=b[0],y=b[1],_=z((0,r.useState)(V.chatRoom),2),j=_[0],x=_[1],w=z((0,r.useState)(V.messageHighlightId),2),O=w[0],S=w[1],C=(0,T.BT)();(0,r.useEffect)((function(){h(!C)}),[C]);var k={chatRoom:j,closeThreadsRailbar:function(){y(null),x(null),m(q),C&&h(!1)},isCourseSpace:c,isLiveStream:s,messageHighlightId:O,openThreadsRailbar:function(e,t){y(e),x(t),m(Z),h(!0)},parentMessage:g,RailbarComponent:d===q?n?U:L:o.I,setMessageHighlightId:S,shouldShowRailBar:p,toggleShowRailBar:v,type:d,updateParentMessage:function(e){y(e)}};return(0,P.jsx)(W.Provider,{value:k,children:i})},$=function(){return(0,r.useContext)(W)}},11860:(e,t,n)=>{n.d(t,{O:()=>i});var r=n(6364),o=n(24878),i=function(){var e=(0,o.f)().setShouldShowLatestMessageBtn,t=(0,r.j)().isMobileView;return{calculateScrollInfo:function(n){var r=n.event,o=document.getElementById("message-scroll-view");if(!o)return{};var i="noScroll";switch(r){case"messageSent":i="scrollToBottom",e(!1);break;case"messageReceived":var a=o.scrollTop-o.scrollHeight+o.offsetHeight,s=t()&&0===a,l=a>=-.8*o.offsetHeight||a>14;s||l?(i="scrollToBottom",e(!1)):e(!0);break;case"chatRoomLoad":i="scrollToUnreadMessageIndicator";break;case"paginatedMessageLoad":i="adjustTop";break;case"nextPaginatedMessageLoad":case"messageUpdated":case"messageDeleted":case"parentMessageUpdated":i="noScroll";break;case"reaction":o.scrollTop-o.scrollHeight+o.offsetHeight>=-80&&(i="scrollToBottom")}return{action:i,scrollTopValue:o.scrollTop,scrollHeightValue:o.scrollHeight}}}}},98379:(e,t,n)=>{n.d(t,{K:()=>s});var r=n(96486),o=n(24185),i=n(72810),a=n(37803),s=function(){var e=(0,o.k6)(),t=(0,a.x)(),n=t.openThreadsRailbar,s=t.setMessageHighlightId,l=t.messageHighlightId,c=(0,i.t)().message_id;return{removeThreadIdUrlParam:function(){l&&(e.replace({search:"",hash:window.location.hash}),s(null))},openThreadsRailbarOnThreadsNotification:function(e){var t=e.messageHashId,o=e.chatRoomMessages,i=e.chatRoom;if(c){var a=o.find((function(e){return e.id===Number(t)}));a&&(0,r.delay)((function(){s(Number(c)),n(a,i)}),500)}}}}},71752:(e,t,n)=>{n.d(t,{bD:()=>a,rF:()=>s,hE:()=>l,RN:()=>c});var r=n(88767),o=n(34128),i=n(49326),a=function(e){return"course-sections-".concat(e)},s=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,r.useQuery)(a(e),(function(){return(0,o.UT)(i.av.courses.listSections({courseId:e}))}),t)},l=function(e){return"lesson-".concat(e)},c=function(e){var t=e.courseId,n=e.lessonId,a=e.sectionId,s=e.options,c=void 0===s?{}:s;return(0,r.useQuery)(l(n),(function(){return(0,o.UT)(i.av.courses.getLesson({courseId:t,lessonId:n,sectionId:a}))}),c)}},6364:(e,t,n)=>{n.d(t,{j:()=>r});var r=function(){return{isMobileView:function(){return window.matchMedia("(max-width: 992px)").matches}}}},40754:(e,t,n)=>{n.d(t,{S:()=>d,m:()=>m});var r=n(96486),o=n(88767),i=n(34128),a=n(49326),s=n(75752);function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var d=function(e){return"embeddable-chat-room-".concat(e)},m=function(e){var t=(0,o.useQueryClient)(s.Vr),n=function(n){t.setQueryData(d(e),(function(){return c(c({},arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),{},{chat_room:n})}))},l=(0,o.useQuery)({queryKey:d(e),queryFn:function(){return(0,i.UT)(a.av.chatRooms.show({uuid:e}))},enabled:!!e,refetchOnWindowFocus:!1}),u=l.isLoading,m=l.refetch,f=l.data,p=(f=void 0===f?{}:f).chat_room;return{isLoading:u,chatRoom:p,refetchChatRoom:e?m:r.noop,onEventReceive:function(e){var t,r;"chatRoomUpdated"===e.event&&function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).chat_room;n(c(c({},p||{}),{},{chat_room_name:e.chat_room_name,chat_room_description:e.chat_room_description,chat_room_show_history:e.chat_room_show_history,pinned_message:e.pinned_message}))}(e),"updatedMessage"===e.event&&(null===(t=p.pinned_message)||void 0===t?void 0:t.id)===e.json_message.id&&n(c(c({},p||{}),{},{pinned_message:e.json_message})),"deletedMessage"===e.event&&(null===(r=p.pinned_message)||void 0===r?void 0:r.id)===e.id&&n(c(c({},p||{}),{},{pinned_message:null}))}}}},55734:(e,t,n)=>{n.d(t,{K:()=>u});var r=n(67294),o=n(86013),i=n(88767),a=n(1320),s=n(21809);function l(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return c(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var u=function(e){var t=e.event,n=l((0,r.useState)([]),2),c=n[0],u=n[1],d=(0,s.p)().error,m=function(e){return d(null!==e&&void 0!==e&&e.message?null===e||void 0===e?void 0:e.message:(0,o.t)("something_went_wrong"))},f=(0,i.useMutation)((function(){return a.S1.fetchRecurring({event:t})}),{onSuccess:function(e){return u(e)},onError:m}),p=f.mutate;return{isLoading:f.isLoading,events:c,fetchEvents:p,onRecurringRsvpSubmit:(0,i.useMutation)((function(e){return a.S1.recurringRsvp({event:t,params:e})}),{onError:m}).mutateAsync,onRecurringUnRsvpSubmit:(0,i.useMutation)((function(e){return a.S1.recurringUnRsvp({event:t,params:e})}),{onError:m}).mutateAsync}}},85244:(e,t,n)=>{n.d(t,{j:()=>l});var r=n(67294);function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var a=/^\(\d+\)\s/,s=/| [a-z 0-9@_\-#.!]+ $/i,l=function(){var e=o((0,r.useState)(document.title.replace(a,"")),1)[0];return{originalTitle:e,prependTitle:function(t){return document.title="".concat(t).concat(e)},resetTitleToOriginal:function(){return document.title=e},addDirectMessageParticipantNameInTitle:function(t){var n=document.title.match(a),r=e.replace(s,"".concat(t," "));n&&(r="".concat(n[0]).concat(r)),document.title=r}}}},20254:(e,t,n)=>{n.d(t,{I:()=>o});var r=n(24897),o=function(e,t){(0,r.s)({channel:"NotificationChannel",onMessageReceive:t,community_member_id:e,canCreateConnection:!!e},[e])}},91741:(e,t,n)=>{n.d(t,{K:()=>s});var r=n(88767),o=n(34128),i=n(49326),a=function(){return(0,o.UT)(i.av.supportedCurrencies.index())},s=function(){return(0,r.useQuery)("paywalls-currencies",a)}},70905:(e,t,n)=>{n.d(t,{N:()=>b,P:()=>g});var r=n(64687),o=n.n(r),i=n(67294),a=n(96486),s=n(88767),l=n(34128),c=n(31023),u=n(97012),d=n(61345),m=n(20557);function f(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){h(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var b=function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=(0,s.useQueryClient)(),p=(0,c.d)(),h=p.removeRecord,b=p.findAndReplaceRecord;n=v(v({},n),{},{per_page:(null===(e=n)||void 0===e?void 0:e.per_page)||12}),Object.keys(n).forEach((function(e){"undefined"===typeof n[e]&&delete n[e]}));var g=(0,u.L2)().data,y=["posts",null===g||void 0===g?void 0:g.id,n],_="calendar"===(null===(t=n)||void 0===t?void 0:t.used_on),j=(0,s.useInfiniteQuery)(y,(function(e){var t,r=e.pageParam;return t=void 0===r?1:r,(0,l.UT)(m.a.posts.index({spaceId:g.id,params:v({page:t},n)}))}),{getNextPageParam:function(e){return e.has_next_page?e.page+1:void 0},keepPreviousData:_,enabled:!(null===g||void 0===g||!g.id)&&((0,d.H3)(g)||(0,d.V5)(g)||(0,d.Ds)(g))}),x=j.data,w=j.hasNextPage,O=j.isLoading,S=j.refetch,P=j.fetchNextPage,C=(0,i.useCallback)(function(){var e,t=(e=o().mark((function e(t){var n,i,a,s=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=(s.length>1&&void 0!==s[1]?s[1]:{}).refetch,i=t,void 0!==n&&!n){e.next=13;break}return e.prev=3,a=m.a.posts.show({spaceId:t.space_id,postSlug:t.slug}),e.next=7,r.fetchQuery(a);case 7:i=e.sent,e.next=13;break;case 10:e.prev=10,e.t0=e.catch(3),console.error(e.t0);case 13:b(i,y);case 14:case"end":return e.stop()}}),e,null,[[3,10]])})),function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){f(i,r,o,a,s,"next",e)}function s(e){f(i,r,o,a,s,"throw",e)}a(void 0)}))});return function(e){return t.apply(this,arguments)}}(),[b]),k=(0,i.useCallback)((function(e){h(e,y)}),[h]),I=[];!O&&x&&(I=(0,a.uniqBy)((0,a.flatten)(x.pages.map((function(e){return e.records}))),"id"));return{mapPages:function(e){return O||!x?[]:x.pages.map(e)},hasNextPage:w,refetch:S,isLoading:O,fetchNextPage:P,posts:I,onPostChange:C,onPostDestroy:k}},g=function(e){return b({only_pinned:!0,per_page:e||50,used_on:"pinned_post_sidebar"})}},81217:(e,t,n)=>{n.d(t,{j:()=>m,t:()=>f});var r=n(64687),o=n.n(r),i=n(88767),a=n(34128),s=n(49326);function l(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(r,o)}function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var m="post-show",f=function(e){var t=e.spaceId,n=e.postSlug,r=e.spaceSlug,c=void 0===r?"":r,d=e.queryOptions,f=void 0===d?{}:d,p=e.context,v=void 0===p?"default":p,h=e.disabled,b=void 0!==h&&h,g=[m,n,t||c,v],y=s.av.posts.show({spaceId:t,spaceSlug:c,postSlug:n}),_=(0,i.useQuery)(g,(function(){return(0,a.UT)(y)}),u(u({enabled:!b&&!(!t&&!c||!n),staleTime:0},f),{},{retry:function(e,t){return 404!==(null===t||void 0===t?void 0:t.status)}})),j=(0,i.useQueryClient)(),x=function(){var e,t=(e=o().mark((function e(t){var n,r=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===(n=(r.length>1&&void 0!==r[1]?r[1]:{}).refetch)||n){e.next=3;break}return e.abrupt("return",j.setQueryData(g,(function(){return t})));case 3:return e.abrupt("return",_.refetch());case 4:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){l(i,r,o,a,s,"next",e)}function s(e){l(i,r,o,a,s,"throw",e)}a(void 0)}))});return function(e){return t.apply(this,arguments)}}();return u(u({},_),{},{post:_.data,onPostChange:x})}},32224:(e,t,n)=>{n.d(t,{O:()=>f});var r=n(67294),o=n(63001),i=n(97012),a=n(95071),s=n(29647),l=n(72831),c=n(84702);function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){m(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var f=function(e){var t=e.name,n=e.params,u=void 0===n?{}:n,m=e.public_uid,f=(0,i.wh)(),p=(0,o.r)().show,v=(0,c.I)(),h=(0,r.useCallback)((function(e){!((0,a.n2)(e)||v)&&(0,l.i)(f)&&(e.preventDefault(),p({memberPublicId:m,params:u}))}),[v,f,m,u,p]);return d(d({},(0,s.H)({isProfileDrawerEnabled:(0,l.i)(f),name:t,params:u,publicUid:m,shouldOpenInNewTab:v,showMemberProfileDrawer:p})),{},{onClick:h})}},48656:(e,t,n)=>{n.d(t,{H:()=>u});var r=n(67294),o=n(86013),i=n(24185),a=n(97012),s=n(31889),l=n(49326),c=n(49313),u=function(){var e=(0,i.TH)(),t=(0,i.k6)(),n=(0,a.wh)().currentCommunityMember,u=(0,s.vb)(n),d=(0,c.a)();return{showOwnProfileEdit:(0,r.useCallback)((function(){t.push(l.du.profile(e))}),[t,e]),showMemberProfileEdit:(0,r.useCallback)((function(e){console.assert(u,{message:(0,o.t)("show_member_profile_no_admin"),currentCommunityMember:n});var t,r=(t=e.member,e.memberPublicId||(null===t||void 0===t?void 0:t.public_uid));return d(r)}),[n,u,d])}}},31023:(e,t,n)=>{n.d(t,{d:()=>l});var r=n(67294),o=n(88767);function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var l=function(){var e=(0,o.useQueryClient)();return{findAndReplaceRecord:(0,r.useCallback)((function(t,n){if(!n)throw new Error("queryKey is required");return e.setQueryData(n,(function(e){return{pages:e.pages.map((function(e){return a(a({},e),{},{records:e.records.map((function(e){return e.id===t.id?t:e}))})})),pageParams:e.pageParams}}))}),[e]),removeRecord:(0,r.useCallback)((function(t,n){if(!n)throw new Error("queryKey is required");return e.setQueryData(n,(function(e){return{pages:e.pages.map((function(e){return a(a({},e),{},{records:e.records.filter((function(e){return e.id!==t}))})})),pageParams:e.pageParams}}))}),[e])}}},13521:(e,t,n)=>{n.d(t,{m:()=>u});var r=n(88767),o=n(34128);function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var u=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,i=Array.isArray(n)?n:[n||e],a=(0,r.useInfiniteQuery)(i,(function(t){var n,r=t.pageParam;return n=void 0===r?1:r,(0,o.UT)(d(e,{page:n}))}),l({getNextPageParam:function(e){return e.has_next_page?e.page+1:void 0}},t));return l(l({},a),{},{mapPages:function(e){var t=a.isLoading,n=a.data;return t||!n?[]:n.pages.map(e)}})},d=function(e,t){for(var n=new URL(window.location.origin+e),r=0,o=Object.entries(t);r<o.length;r++){var a=i(o[r],2),s=a[0],l=a[1];n.searchParams.set(s,l)}return n.pathname+n.search}},49313:(e,t,n)=>{n.d(t,{a:()=>i});var r=n(24185),o=n(49326),i=function(){var e=(0,r.TH)(),t=(0,r.k6)();return function(n){t.push(o.I3.index(n,e))}}},81196:(e,t,n)=>{n.d(t,{H:()=>o});var r=n(67294),o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";(0,r.useEffect)((function(){if(e){var t=e.split(" ");return t.forEach((function(e){document.body.classList.add(e)})),function(){t.forEach((function(e){document.body.classList.remove(e)}))}}}),[e])}},62720:(e,t,n)=>{n.d(t,{U:()=>a});var r=n(26953),o=n(59393),i=n(97012),a=function(){var e,t=(0,i.wh)(),n=t.currentCommunitySettings,a=t.isLoading,s=(0,r.BT)(),l=(n||{}).dms_v3_enabled,c=Boolean(l);return{isDmsV3Enabled:!s&&c,isDmsV3MobileViewEnabled:s&&c,isMessagingModalOpen:(e=document.getElementById(o.vl),Boolean(e)),isLoading:a}}},26198:(e,t,n)=>{n.d(t,{k:()=>o});var r=n(67294),o=function(e){return(0,r.useCallback)((function(t){"Enter"!==t.key&&" "!==t.key||(t.preventDefault(),e(t))}),[e])}},46027:(e,t,n)=>{n.d(t,{n:()=>o});var r=n(97012),o=function(){var e=(0,r.wh)().currentCommunitySettings||{};return{eventsThumbnailEnabled:e.events_thumbnail_enabled,isShareEventEnabled:e.share_event_enabled,limitUrlSharingEnabled:e.limit_url_sharing_enabled}}},57956:(e,t,n)=>{n.d(t,{ov:()=>o,rV:()=>i,$2:()=>a,m3:()=>s});var r=n(97012);function o(){var e=(0,r.wh)().currentCommunity;return Boolean(null===e||void 0===e?void 0:e.activity_score_ui_enabled)}function i(){var e=(0,r.wh)(),t=e.currentCommunitySettings,n=e.currentCommunityMember,i=null===n||void 0===n?void 0:n.is_admin,a=o(),s=null===t||void 0===t?void 0:t.upgrade_flows_for_activity_scores_enabled;return Boolean(i&&(a||s))}function a(){var e=(0,r.wh)().currentCommunity;return Boolean(null===e||void 0===e?void 0:e.community_ai_feature_flag_enabled)}function s(){var e=(0,r.wh)(),t=e.currentCommunitySettings,n=e.currentCommunityMember,i=null===n||void 0===n?void 0:n.is_admin,s=null===t||void 0===t?void 0:t.upgrade_flows_for_activity_scores_enabled,l=!a(),c=!o();return i&&s&&(l||c)}},67144:(e,t,n)=>{n.d(t,{R:()=>o});var r=n(97012),o=function(){var e=(0,r.wh)(),t=e.currentCommunitySettings||{};return{isLoading:e.isLoading,liveStreamsHlsEnabled:t.live_streams_hls_enabled,liveStreamsLimitsEnabled:t.live_streams_limits_enabled,livekitEnabled:t.livekit_enabled,liveMobileWebEnabled:t.live_mobile_web_enabled,liveMobileWebRTCEnabled:t.live_mobile_webrtc_enabled,publicLiveStreamsEnabled:t.public_live_streams_enabled,limitUrlSharingEnabled:t.limit_url_sharing_enabled,isLargeLiveStreamsEnabled:t.large_live_streams_enabled}}},1227:(e,t,n)=>{n.d(t,{f:()=>i});var r=n(1963),o=n(74238),i=function(){var e=(0,o.wC)().masquerade_referrer_url,t=(0,r.Vu)().isBannerVisible;return!!e||t}},22954:(e,t,n)=>{n.d(t,{k:()=>s});var r=n(67294),o=n(24897);function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var s=function(e){var t,n=e.enabled,a=void 0===n||n,s=e.signedId,l=e.mediaTranscoding,c=e.onSuccess,u=e.onError,d=i((0,r.useState)(null!==(t=null===l||void 0===l?void 0:l.status)&&void 0!==t?t:"pending"),2),m=d[0],f=d[1],p=a&&Boolean(s)&&function(e){return"pending"===e||"started"===e}(m);return(0,o.s)({canCreateConnection:p,channel:"MediaTranscodingChannel",blob_signed_id:s,onMessageReceive:function(e){"transcodingStatusUpdated"===e.event&&(f(e.json_message.status),"succeeded"===e.json_message.status?null===c||void 0===c||c(e.json_message.hls_url):"failed"===e.json_message.status&&(null===u||void 0===u||u()))}}),{status:m}}},24113:(e,t,n)=>{n.d(t,{k:()=>i});var r=n(88767),o=n(49326),i=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,r.useQuery)(o.av.planFeatureFlags.show(),e)}},67746:(e,t,n)=>{n.d(t,{J:()=>a});var r=n(67294);function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var a=function(e,t){var n=o((0,r.useReducer)(e,t),2),i=n[0],a=n[1],s=(0,r.useRef)((function(){return i}));(0,r.useEffect)((function(){s.current=function(){return i}}),[i]);var l=(0,r.useCallback)((function(e){"function"===typeof e?e(l,s.current):a(e)}),[]);return[i,l]}},60060:(e,t,n)=>{n.d(t,{L:()=>l,d:()=>c});var r=n(88767),o=n(97012),i=n(32194),a=n(34128),s=n(49326),l=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=(0,i.Wj)(),n=(0,r.useQuery)(["space-sidebar-notifications",e],(function(){return(0,a.UT)(s.av.sidebarNotifications.index({space_ids:e}))}),{enabled:!1,onSuccess:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];1===e.length?t({type:"UPDATE_SPACE_NOTIFICATIONS",payload:{space:e[0]}}):t({type:"SET_SPACE_NOTIFICATIONS",payload:{spaces:e||[]}})},onError:function(e){console.error("Something went wrong",e)}}),o=n.isLoading;return{refetchSpaceNotifications:n.refetch,isLoading:o}},c=function(e){var t=(0,o.nT)(),n=l([e]).refetchSpaceNotifications;return{resetUnreadCount:(0,r.useMutation)((function(){return(0,a.Cu)(s.av.spaces.resetUnreadCount({spaceId:e}),{forReactQuery:!0})}),{onSuccess:function(e){t.actions.updateSpace(e),n()},onError:function(e){console.error("Error while resetting the unread count",e)}}).mutateAsync}}},24897:(e,t,n)=>{n.d(t,{s:()=>v});var r=n(67294),o=n(96486),i=(0,n(40924).tx)(),a=["channel"],s=["channel"];function l(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var c=new Map,u=["channel","onMessageReceive","canCreateConnection"];function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){f(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function p(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var v=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=e.channel,d=e.onMessageReceive,f=e.canCreateConnection,v=void 0===f||f,h=p(e,u),b=(0,r.useRef)(d);(0,r.useEffect)((function(){b.current=d}),[n,d]),(0,r.useEffect)((function(){if(v)return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=e.channel,r=l(e,a);if(n&&t){c.has(n)||c.set(n,[]);var s=c.get(n),u=s.find((function(e){var t=e.params;return(0,o.isEqual)(r,t)}));u?u.callbacks.push(t):(u={subscription:i.subscribeTo(n,r),params:r,callbacks:[t]},s.push(u),u.subscription.on("message",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];u.callbacks.forEach((function(e){return e.apply(void 0,t)}))})))}}(m({channel:n},h),b.current),function(){return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=e.channel,r=l(e,s);if(n&&t){var i=c.get(n);if(i){var a=i.find((function(e){var t=e.params;return(0,o.isEqual)(r,t)}));a&&(a.callbacks=a.callbacks.filter((function(e){return e!==t})),a.callbacks.length||(a.subscription.disconnect(),c.set(n,i.filter((function(e){var t=e.params;return!(0,o.isEqual)(r,t)})))))}}}(m({channel:n},h),b.current)}}),[n,v,h,t])}},23905:(e,t,n)=>{n.d(t,{m:()=>r});var r=function(e,t){var n={};return Object.keys(t).forEach((function(t){n["".concat(e,"--").concat(t)]=t})),{modifiers:n}}},63099:(e,t,n)=>{n.d(t,{k:()=>a});var r=n(67294);function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var a=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=o((0,r.useState)(e),2),n=t[0],i=t[1];return[n,(0,r.useCallback)((function(){return i((function(e){return!e}))}),[i]),i]}},82258:(e,t,n)=>{n.d(t,{c:()=>a});var r=n(67294);function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var a=function(e,t){var n=o((0,r.useState)(e),2),i=n[0],a=n[1];return(0,r.useEffect)((function(){var n=setTimeout((function(){a(e)}),t);return function(){clearTimeout(n)}}),[e,t]),i}},30990:(e,t,n)=>{n.d(t,{T:()=>a});var r=n(67294);function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var a=function(){var e=o((0,r.useState)(),2),t=e[0],n=e[1];return{ref:(0,r.useCallback)((function(e){e&&n(e.clientHeight)}),[]),height:t}}},59675:(e,t,n)=>{n.d(t,{A:()=>a});var r=n(67294);function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var a=function(){var e=(0,r.useRef)(null),t=o((0,r.useState)(!0),2),n=t[0],i=t[1];return(0,r.useEffect)((function(){var t=new IntersectionObserver((function(e){i(null===e||void 0===e?void 0:e[0].isIntersecting)}));return e.current&&t.observe(e.current),function(){t.disconnect()}}),[]),[e,n]}},47267:(e,t,n)=>{n.d(t,{t:()=>s});var r=n(67294),o=n(45697),i=n.n(o),a=n(96486),s=function(e){var t=e.onArrowDown,n=e.onArrowUp,o=e.onEnter,i=e.onEscape,s=e.enabled,l=void 0===s||s,c=e.elementRef,u=void 0===c?null:c;(0,r.useEffect)((function(){var e=(null===u||void 0===u?void 0:u.current)||document,r={ArrowDown:t,ArrowUp:n,Enter:o,Escape:i},s=function(e){var t=r[null===e||void 0===e?void 0:e.key];(0,a.isFunction)(t)&&t(e)};return l&&e?e.addEventListener("keydown",s):null===e||void 0===e||e.removeEventListener("keydown",s),function(){return null===e||void 0===e?void 0:e.removeEventListener("keydown",s)}}),[l,t,n,o,i,u])};s.propTypes={options:i().shape({onArrowDown:i().func,onArrowUp:i().func,onEnter:i().func,onEscape:i().func,enabled:i().bool})}},22972:(e,t,n)=>{n.d(t,{K:()=>s,d:()=>l});var r=n(67294),o=n(96486),i=n(87536),a=n(44133),s=function(e){var t=e.cacheKey,n=e.fields,s=void 0===n?[]:n,l=e.enabled,c=void 0===l||l,u=(0,i.qo)(),d=(0,o.pick)(u,s),m=(0,a._)(t).setValue;(0,r.useEffect)((function(){c&&m(d)}),[d])},l=function(e){var t=e.cacheKey;if(!t)throw new Error("CacheKey is required");var n=(0,a._)(t);return{getPersistedFormFieldValues:n.getValue,resetValues:n.resetValue}}},55629:(e,t,n)=>{n.d(t,{g:()=>o});var r=n(67294),o=function(e){var t=(0,r.useRef)(null);return(0,r.useLayoutEffect)((function(){var n;e&&(null===(n=t.current)||void 0===n||n.scrollIntoView({behavior:"smooth",block:"center"}))}),[e]),t}},99834:(e,t,n)=>{n.d(t,{M:()=>i});var r=n(67294),o=n(87536),i=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).enabled,t=void 0===e||e,n=(0,o.Gc)().triggerFormSubmit;(0,r.useEffect)((function(){if(t){var e=function(e){"Enter"===e.key&&(e.metaKey||e.ctrlKey)&&n()};return document.addEventListener("keydown",e),function(){document.removeEventListener("keydown",e)}}}),[t,n])}},36762:(e,t,n)=>{n.d(t,{RV:()=>r,Wo:()=>o,E4:()=>a,Ex:()=>i});var r={ltr:"ltr",rtl:"rtl"},o={decimal:"decimal",zero_decimal:"zero_decimal"},i={space:"space",event:"event"},a={onetime:"onetime",subscription:"subscription",installments:"installments"}},71806:(e,t,n)=>{n.d(t,{o:()=>l});var r=n(32224),o=n(85893);function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var l=function(e){var t=e.member,n=e.children,i=t.name,s=t.public_uid,l=(0,r.O)({public_uid:s});return(0,o.jsx)("a",a(a({},l),{},{title:i,children:n}))}},91699:(e,t,n)=>{function r(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n.d(t,{W:()=>a});var a=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.element=t}var t,n,o;return t=e,(n=[{key:"addAttachmentClickEventHandler",value:function(e){var t=this;this.element.addEventListener("click",(function(n){var r=n.target.closest("action-text-attachment");if(r){var o=t.parseAttachmentAttributes(r);if(t.isPreviewableAttachment(o)){var i=t.getSimilarAttachments(o),a=i.findIndex((function(e){return e.sgid===o.sgid}));e({attachments:i,currentIndex:a})}}}))}},{key:"getSimilarAttachments",value:function(e){var t=this.isImageAttachment(e)&&this.isImageAttachment||this.isPdfAttachment(e)&&this.isPdfAttachment;return r(this.element.querySelectorAll("action-text-attachment")).map(this.parseAttachmentAttributes).filter(t)}},{key:"isPreviewableAttachment",value:function(e){return this.isPdfAttachment(e)||this.isImageAttachment(e)}},{key:"isImageAttachment",value:function(e){var t=e.contentType;return["image/png","image/jpeg","image/jpg","image/gif"].includes(t)}},{key:"isPdfAttachment",value:function(e){var t=e.contentType;return["application/pdf"].includes(t)}},{key:"parseAttachmentAttributes",value:function(e){var t,n;return{sgid:e.getAttribute("sgid"),contentType:e.getAttribute("content-type"),url:null===(t=e.querySelector("[data-target~='blob-container']"))||void 0===t||null===(n=t.dataset)||void 0===n?void 0:n.blobUrl,filename:e.getAttribute("filename"),filesize:e.getAttribute("filesize"),width:e.getAttribute("width"),height:e.getAttribute("height")}}}])&&i(t.prototype,n),o&&i(t,o),e}()},80812:(e,t,n)=>{n.d(t,{Z:()=>a});var r=n(86013),o=n.n(r),i=n(67617);o().translations=i;const a=o()},56065:(e,t,n)=>{e.exports=n.p+"static/assets/images/logo-27b43009da10b6d9d05f.svg"},62596:(e,t,n)=>{e.exports=n.p+"static/components/Events/Rsvp/RsvpAction/RsvpIcons/img/attending-6f58a1aa030cb2a57df3.svg"}}]);
//# sourceMappingURL=3373-3789cbb920bb03121285.js.map